/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{287:function(e,t,r){var content=r(411);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(91).default)("0dd2479d",content,!0,{sourceMap:!1})},295:function(e,t,r){e.exports=r.p+"img/blob.5ed4189.png"},297:function(e,t,r){"use strict";r.r(t),function(e,n){r.d(t,"SpeRuntime",(function(){return B}));r(299);var o=r(23),l=r(418),c=r(301),h=r(7),d=r(24),f=r(17),v=r(302),m=r(271),y=r(416),A=r(158),w=r(159),x=r(303),O=r(304),E=r(270);r(52),r(306),r(42),r(307),r(74),r(309),r(310),r(311),r(47),r(191),r(48),r(132),r(312),r(12),r(314),r(317),r(318),r(319),r(320),r(323),r(324),r(325),r(326),r(327),r(328),r(329),r(330),r(332),r(333),r(334),r(335),r(336),r(337),r(338),r(339),r(340),r(341),r(342),r(343),r(344),r(345),r(36),r(346),r(347),r(76),r(34),r(35),r(348),r(349),r(28),r(351),r(352),r(353),r(354),r(355),r(356),r(358),r(359),r(360),r(361),r(362),r(363),r(364),r(32),r(44),r(37),r(365),r(366),r(367),r(368),r(369),r(370),r(371),r(131),r(54),r(372),r(133),r(188),r(373),r(374),r(375),r(376),r(377),r(185),r(75),r(378),r(379),r(381),r(382),r(383),r(384),r(385),r(386),r(387),r(388),r(389),r(390),r(391),r(392),r(393),r(394),r(395),r(72),r(73),r(189),r(396),r(186),r(397),r(398),r(399),r(401),r(403),r(53),r(404),r(33),r(180),r(45),r(46),r(406),r(408);function C(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==r.return||r.return()}finally{if(c)throw o}}}}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=Object(E.a)(e);if(t){var o=Object(E.a)(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return Object(O.a)(this,r)}}var B=function(t,r){var O=function(e){Object(x.a)(n,e);var t=S(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return Object(w.a)(n,[{key:"setFromCamera",value:function(e,t){"OrthographicCamera"===t.cameraType?(this.ray.origin.set(e.x,e.y,-1).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):"PerspectiveCamera"===t.cameraType?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):console.error("Raycaster: Unsupported camera type.")}},{key:"createRaycastLineHelper",value:function(){var e=new r.LineBasicMaterial({color:16711680,linewidth:10}),t=new r.Vector3(this.ray.origin.x,this.ray.origin.y,this.ray.origin.z),i=new r.Vector3(this.ray.direction.x,this.ray.direction.y,this.ray.direction.z),n=(new r.Vector3).lerpVectors(t,i,.5);i.multiplyScalar(0);var s=new r.BufferGeometry;return s.setAttribute("position",new r.BufferAttribute([t.x,t.y,t.z,n.x,n.y,n.z,i.x,i.y,i.z],3)),new r.Line(s,e)}}]),n}(r.Raycaster);function i(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function D(e){return new r.Vector2(e.y,-e.x)}var s=function(e){Object(x.a)(s,e);var t=S(s);function s(e,n,o,l,a,c,h,d,u,f,p,v){var m,w=arguments.length>12&&void 0!==arguments[12]&&arguments[12];Object(A.a)(this,s),(m=t.call(this)).type="RoundedCylinderBufferGeometry",e=void 0!==e?e:1,n=void 0!==n?n:1,o=o||1,l=Math.floor(l)||8,a=Math.floor(a)||1,c=void 0!==c&&c,h=void 0!==h?h:0,d=void 0!==d?d:2*Math.PI,c&&(u=0,f=0);var g=[],x=[],O=[],E=[],S=0,B=o/2,b=new r.Vector3,T=new r.Vector3;w&&0==e&&(e=u),w&&0==n&&(n=f);var k=new r.Vector2(e,B),_=new r.Vector2(n,-B),M=null,L=null,N=null,F=null,I=k.clone().sub(_),j=0,P=0,R=0;v>0&&(j=Math.min(e,n)*(1-v),P=e-j,R=n-j);var z=k.clone();z.x-=j;var U=Math.PI-I.angle(),G=I.angle(),V=Math.tan(G/2),H=Math.tan(U/2),J=V+H,Q=v?J:H,Y=v?J:V;if(u=Math.min(u,(e-P)/Q,I.length()/J),f=Math.min(f,(n-R)/Y,I.length()/J),u>0){var W=u/V;M=k.clone().sub(new r.Vector2(W,u)),v&&((N=M.clone()).x-=j-J*u),k.sub(I.clone().setLength(W))}if(f>0){var X=f/H;L=_.clone().sub(new r.Vector2(X,-f)),_.add(I.clone().setLength(X)),v&&((F=L.clone()).x-=j-J*f,z.sub(I.clone().setLength(X)))}for(var K=(I=k.clone().sub(_)).length()<.5,Z=[],$=0;$<=l;$++){var ee=[],te=$/l,re=te*d+h,ne=new r.Vector2(Math.sin(re),Math.cos(re));if(F&&L?(me(ee,te,ne,U,f,F,-1,!0),me(ee,te,ne,G,f,L,-1,!1)):L?(ge(ee,ne,L.x,0,-1),me(ee,te,ne,G,f,L,-1,!1)):c||ge(ee,ne,n,R,-1),i(D(I).normalize(),ne,b),!K)for(var ie=0;ie<=a;ie++){var ae=ie/a;i(I.clone().multiplyScalar(ae).add(_),ne,T),x.push(T.x,T.y,T.z),O.push(b.x,b.y,b.z),E.push(te,.5+T.y/o),ee.push(S++)}if(N&&M?(me(ee,te,ne,U,u,M,1,!1),me(ee,te,ne,G,u,N,1,!0)):M?(me(ee,te,ne,U,u,M,1,!1),ge(ee,ne,M.x,0,1)):c||ge(ee,ne,e,P,1),v&&!K){i(D(I).multiplyScalar(-1).normalize(),ne,b);for(var oe=0;oe<=a;oe++){var se=oe/a;i(I.clone().multiplyScalar(-se).add(z),ne,T),x.push(T.x,T.y,T.z),O.push(b.x,b.y,b.z),E.push(te,.5+T.y/o),ee.push(S++)}}v&&!c&&ee.push(ee[0]),Z.push(ee)}for(var ue=0;ue<Z.length-1;ue++)for(var le=0;le<Z[0].length-1;le++)if(!c||!v||le!=a){var ce=Z[ue][le],he=Z[ue+1][le],de=Z[ue+1][le+1],fe=Z[ue][le+1],ve=x[3*de+0],pe=x[3*de+2];g.push(ce,he,fe),0==ve&&0==pe||g.push(he,de,fe)}function me(e,t,n,l,a,c,h,d){for(var f=0;f<p+1;f++){var v=f/p,m=h<0?v:1-v;d&&(m-=1),m*=l;var y=new r.Vector2(Math.sin(m),Math.cos(m)*h);i(y.clone().multiplyScalar(a).add(c),n,T),x.push(T.x,T.y,T.z),i(y,n,b),O.push(b.x,b.y,b.z),E.push(t,.5+T.y/o),e.push(S++)}}function ge(e,t,n,s,o){var a=new r.Vector3,l=new r.Vector2,c=[n,s];o<0&&c.reverse();for(var h=0,d=c;h<d.length;h++){var f=d[h];l.set(f,B*o),i(l,t,a),x.push(a.x,a.y,a.z),O.push(0,o,0),E.push(.5,.5),e.push(S++)}}function ye(t,s,o){var a=new r.Vector2(Math.sin(o),Math.cos(o)),l=new r.Vector2(-Math.cos(o),Math.sin(o)),c=new r.Vector3,h=t<0?function(e,t,r){return g.push(e,t,r)}:function(e,t,r){return g.push(e,r,t)};i(new r.Vector2((e+n+P+R)/4,0),a,c),x.push(c.x,c.y,c.z),O.push(l.x,0,l.y),E.push(.5,.5);var d,u=S++,f=C(s);try{for(f.s();!(d=f.n()).done;){var v=d.value,m=x.slice(3*v,3*v+3);x.push.apply(x,Object(y.a)(m)),O.push(l.x,0,l.y);var A=E.slice(2*v,2*v+2);E.push.apply(E,Object(y.a)(A)),S++}}catch(e){f.e(e)}finally{f.f()}for(var w=u+1;w<S-1;w++)h(u,w,w+1);h(u,S-1,u+1)}return d<2*Math.PI&&(ye(-1,Z[0],h),ye(1,Z[Z.length-1],h+d)),m.setIndex(g),m.setAttribute("position",new r.Float32BufferAttribute(x,3)),m.setAttribute("normal",new r.Float32BufferAttribute(O,3)),m.setAttribute("uv",new r.Float32BufferAttribute(E,2)),m}return s}(r.BufferGeometry),B=Math.PI/2,a=function(e){Object(x.a)(a,e);var t=S(a);function a(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:4;Object(A.a)(this,a),(e=t.call(this)).type="BoxBufferGeometry";var f=Object(m.a)(e);l=Math.floor(l),s=Math.floor(s),c=Math.floor(c),d=Math.floor(d),h=Math.min(h,n/2,o/2,i/2);var u=[],v=[],p=[],y=[],w=0,g=0;function x(e,t,i,n,s,o,a,l,c,d,m){for(var A=(o-2*h)/c,x=(a-2*h)/d,b=o/2-h,O=a/2-h,E=l/2,C=c+1,D=d+1,S=0,B=0,T=new r.Vector3,k=0;k<D;k++)for(var _=k*x-O,M=0;M<C;M++){var L=M*A-b;T[e]=L*n,T[t]=_*s,T[i]=E,v.push(T.x,T.y,T.z),T[e]=0,T[t]=0,T[i]=l>0?1:-1,p.push(T.x,T.y,T.z),y.push(M/c),y.push(1-k/d),S+=1}for(var N=0;N<d;N++)for(var F=0;F<c;F++){var I=w+F+C*N,j=w+F+C*(N+1),P=w+(F+1)+C*(N+1),R=w+(F+1)+C*N;u.push(I,j,R),u.push(j,P,R),B+=6}f.addGroup(g,B,m),g+=B,w+=S}function O(e,t,i,n,s,a,o,l,c,m,A){for(var b=(o-2*h)/m,x=o/2-h,O=l/2-h,E=c/2,C=m+1,D=0,S=0,T=new r.Vector3,k=new r.Vector3,_=0;_<d+1;_++){var M=_/d*B,L=Math.sin(M)*h,N=(1-Math.cos(M))*h,F=Math.sin(M),I=Math.cos(M);T[t]=(O+L)*s,T[i]=(E-N)*a,k[e]=0,k[t]=F*Math.sign(T[t]),k[i]=I*Math.sign(T[i]);for(var j=0;j<C;j++){var P=j*b-x;T[e]=P*n,v.push(T.x,T.y,T.z),p.push(k.x,k.y,k.z),y.push(j/m),y.push(0),D+=1}}for(var R=0;R<d;R++)for(var z=0;z<m;z++){var U=w+z+C*R,G=w+z+C*(R+1),V=w+(z+1)+C*(R+1),H=w+(z+1)+C*R;u.push(U,G,H),u.push(G,V,H),S+=6}f.addGroup(g,S,A),g+=S,w+=D}function E(e,s,a){var t=new r.Vector3,g=new r.Vector3(n/2,o/2,i/2);g.subScalar(h);for(var l=[],c=e*s*a>0?function(e,t,r){return u.push(e,t,r)}:function(e,t,r){return u.push(e,r,t)},f=0;f<=d;f++){for(var m=[],A=B*(1-f/d),x=Math.cos(A),O=Math.sin(A),E=0,C=0;C<=f;C++){var D=Math.cos(E),S=Math.sin(E);t.x=x*D,t.y=O,t.z=x*S;var T=g.clone().addScaledVector(t,h);v.push(e*T.x,s*T.y,a*T.z),p.push(e*t.x,s*t.y,a*t.z),y.push(0,0),m.push(w++),E+=B/f}l.push(m)}for(var k=l.length-1,_=0;_<k;_++){var M=l[_],L=l[_+1],N=M.length-1;c(M[0],L[1],L[0]);for(var F=1;F<=N;F++)c(M[F-1],M[F],L[F]),c(M[F],L[F+1],L[F])}}return x("z","y","x",-1,-1,i,o,n,c,s,0),x("z","y","x",1,-1,i,o,-n,c,s,1),x("x","z","y",1,1,n,i,o,l,c,2),x("x","z","y",1,-1,n,i,-o,l,c,3),x("x","y","z",1,-1,n,o,i,l,s,4),x("x","y","z",-1,-1,n,o,-i,l,s,5),h>0&&(O("z","y","x",-1,-1,1,i,o,n,c,0),O("z","y","x",1,-1,-1,i,o,n,c,1),O("z","y","x",-1,1,-1,i,o,n,c,1),O("z","y","x",1,1,1,i,o,n,c,0),O("x","y","z",-1,-1,-1,n,o,i,l,0),O("x","y","z",1,-1,1,n,o,i,l,1),O("x","y","z",-1,1,1,n,o,i,l,0),O("x","y","z",1,1,-1,n,o,i,l,1),O("y","x","z",-1,-1,1,o,n,i,s,0),O("y","x","z",1,-1,-1,o,n,i,s,1),O("y","x","z",1,1,1,o,n,i,s,1),O("y","x","z",-1,1,-1,o,n,i,s,0),E(1,1,1),E(-1,1,1),E(1,-1,1),E(-1,-1,1),E(1,1,-1),E(-1,1,-1),E(1,-1,-1),E(-1,-1,-1)),e.setIndex(u),e.setAttribute("position",new r.Float32BufferAttribute(v,3)),e.setAttribute("normal",new r.Float32BufferAttribute(p,3)),e.setAttribute("uv",new r.Float32BufferAttribute(y,2)),e}return a}(r.BufferGeometry),T=1e-12,k=function(){function e(t){Object(A.a)(this,e),this.position=new r.Vector2,this.startPosition=new r.Vector2,this.uuid=r.MathUtils.generateUUID(),this.position=t.clone()}return Object(w.a)(e,[{key:"start",value:function(){this.reset()}},{key:"reset",value:function(){this.startPosition.copy(this.position)}},{key:"applyOffset",value:function(e){this.position.copy(this.startPosition).add(e)}},{key:"copy",value:function(e){return this.position.copy(e.position),this.startPosition.copy(e.startPosition),this}},{key:"clone",value:function(){return new e(this.position).copy(this)}},{key:"toJSON",value:function(){return[this.position.x,this.position.y]}}]),e}(),_=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,e.position)).parent=e,n}return Object(w.a)(r,[{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this}},{key:"clone",value:function(){return new r(this.parent).copy(this)}}]),r}(k),u=function(e){Object(x.a)(u,e);var t=S(u);function u(e,r){var n;return Object(A.a)(this,u),(n=t.call(this,r)).controls=[],n.roundness=0,n.areControlsDirectionsMirrored=!0,n.uuid=e,n.controls.push(new _(Object(m.a)(n)),new _(Object(m.a)(n))),n}return Object(w.a)(u,[{key:"getOppositeControl",value:function(e){var t=this.controls.indexOf(e);return 0===t?this.controls[1]:1===t?this.controls[0]:null}},{key:"applyOffsetToControls",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=0,n=this.controls.length;r<n;r++){var o=this.controls[r];this.position.distanceTo(o.position)<=t?o.position.copy(this.position):o.applyOffset(e)}}},{key:"controlsMoved",value:function(){return!(this.position.equals(this.controls[0].position)&&this.position.equals(this.controls[1].position))}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(u.prototype),"copy",this).call(this,e),this.controls[0].copy(e.controls[0]),this.controls[1].copy(e.controls[1]),this.roundness=e.roundness,this.uuid=e.uuid,this}},{key:"clone",value:function(){return new u(this.uuid,this.position).copy(this)}},{key:"toJSON",value:function(){return Object(v.a)(Object(E.a)(u.prototype),"toJSON",this).call(this).concat(this.controls[0].toJSON(),this.controls[1].toJSON(),[this.roundness])}}]),u}(k),M=new r.Vector2,p=new r.Vector2,L=new r.Vector2,N=new r.Vector2,g=new r.Vector2,F=new r.Vector2,I=new r.Vector3,j=new r.Vector3;function P(e){var t=new r.Vector2;t.addVectors(e.v0,M.subVectors(e.v1,e.v0).multiplyScalar(2/3));var i=new r.Vector2;return i.addVectors(e.v2,p.subVectors(e.v1,e.v2).multiplyScalar(2/3)),new r.CubicBezierCurve(e.v0,t,i,e.v2)}function R(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return Math.abs(e-t)<r}function b(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<r}function z(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.EPSILON;return e.distanceTo(t)<r}function U(e,t,r){var i=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),n=Math.sqrt(Math.pow(t.x-r.x,2)+Math.pow(t.y-r.y,2)),s=Math.sqrt(Math.pow(r.x-e.x,2)+Math.pow(r.y-e.y,2));return Math.acos((n*n+i*i-s*s)/(2*n*i))}function G(e,t,r,i,n){var s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),o=(e.y+t.y)/2,a=(e.x+t.x)/2,l=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(e.y-t.y)/s,c=Math.sqrt(Math.pow(r,2)-Math.pow(s/2,2))*(t.x-e.x)/s;return i.set(a+l,o+c),n.set(a-l,o-c),[i,n]}function V(e,t,r,i,n,s){var o,l=t.x-e.x,a=t.y-e.y,c=r.x-e.x,h=r.y-e.y,u=Math.sqrt((l+c)*(l+c)+(a+h)*(a+h));return U(t,e,r)>Math.PI&&(u*=-1),o=R(h,a)?(a+h)*(i/u-.5)*8/3/(l-c):(l+c)*(i/u-.5)*8/3/(h-a),n.set(t.x-o*a,t.y+o*l),s.set(r.x+o*h,r.y-o*c),[n,s]}function H(e,t){return e.position.equals(e.controls[1].position)&&t.position.equals(t.controls[0].position)}function J(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[],n=0,o=e.length;n<o;n++){var l=e[n],c=0;if(r&&void 0!==l.roundedCurveCorner){var h=.5*Q(l.roundedCurveCorner,t);n>0&&(i[n-1]+=h),c+=h}void 0!==l.curveAfter&&(c+=Q(l.curveAfter,t)),i.push(c)}return e.length>0&&r&&void 0!==e[0].roundedCurveCorner&&(i[e.length-1]+=.5*Q(e[0].roundedCurveCorner,t)),i}function Q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return e&&e instanceof r.EllipseCurve?2*t:e&&(e instanceof r.LineCurve||e instanceof r.LineCurve3)?1:e&&e instanceof r.SplineCurve?t*e.points.length:t}var Y,W,X=new r.Vector2,K=new r.Vector2,Z=new r.Vector2,$=new r.Vector2,ee=new r.Vector2,te=new r.Vector2,re=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return Object(A.a)(this,n),(e=t.call(this)).points=[],e.shapeHoles=[],e.eventDispatcher=new r.EventDispatcher,e.plane=new r.Plane(new r.Vector3(0,0,-1)),e.subdivision=0,e.controlSnapDistance=4,e.pointIDs=0,e.isMesh2D=!1,e._roundness=0,e.isClosed=!1,e.useCubicForRoundedCorners=!0,e.uuid=r.MathUtils.generateUUID(),e.needsUpdate=!1,e.roundedCurves=[],e._width=o,e._height=l,e}return Object(w.a)(n,[{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"roundness",get:function(){return this._roundness},set:function(e){if(this._roundness!==e){this._roundness=e;for(var t=0,r=this.points.length;t<r;t++)this.points[t].roundness=e;this.needsUpdate=!0}}},{key:"getBezierPoint",value:function(e){if(e<=this.points.length-1)return this.points[e];if(this.shapeHoles.length>0)for(var t=0,r=this.shapeHoles.length;t<r;t++){var n=this.shapeHoles[t],o=e-this.points.length;if(o<=n.points.length-1)return n.points[o]}throw new Error("This shape does not have a point for this index: "+e)}},{key:"getBezierPointIndex",value:function(e){var t=this.points.indexOf(e);if(t>=0)return t;if(t=this.points.length,this.shapeHoles.length>0)for(var r=0,n=this.shapeHoles.length;r<n;r++){var o=this.shapeHoles[r],l=o.points.indexOf(e);if(l>=0)return t+l;t+=o.points.length}return-1}},{key:"getAllPoints",value:function(){var e,t=(e=[]).concat.apply(e,Object(y.a)(this.shapeHoles.map((function(e){return e.points}))));return[].concat(Object(y.a)(this.points),Object(y.a)(t))}},{key:"applySize",value:function(e,t){0===e&&(e=.001),0===t&&(t=.001),this.applyScale(e/this.width,t/this.height),this._width=e,this._height=t}},{key:"applyScale",value:function(e,t){for(var r=X.set(e,t),n=0,o=this.points.length;n<o;n++){var l=this.points[n];l.position.multiply(r),l.controls[0].position.multiply(r),l.controls[1].position.multiply(r)}for(var c=0,h=this.shapeHoles.length;c<h;c++)this.shapeHoles[c].applyScale(e,t);this._update(!1)}},{key:"createPoint",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.MathUtils.generateUUID();t=e instanceof r.Vector2?e:new r.Vector2(e,n);var s=new u(i,t);return s.roundness=this.roundness,s}},{key:"addPoint",value:function(e){this.points.push(e),this.needsUpdate=!0}},{key:"addPointAt",value:function(e,t){this.points.splice(t,0,e),this.needsUpdate=!0}},{key:"getPointByUuid",value:function(e){for(var t=0,r=this.points.length;t<r;t++){var n=this.points[t];if(n.uuid===e)return n}return null}},{key:"getFirstPoint",value:function(){return this.points[0]}},{key:"getLastPoint",value:function(){return this.points[this.points.length-1]}},{key:"removePoint",value:function(e){var t=this.points.indexOf(e);t>=0&&this.points.splice(t,1),this.needsUpdate=!0}},{key:"update",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=0,r=this.shapeHoles.length;t<r;t++)this.shapeHoles[t].update(!1);this._update(e)}},{key:"extractShapePointsToBuffer",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t);var n=i?this.roundedCurveDivisions:this.curveDivisions;return function(e,t){for(var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=j.set(0,0,0),a=0,l=0;l<t.length;l++)for(var c=t[l],h=M,d=Q(c,i),f=0;f<=d;f++)if(c instanceof r.CubicBezierCurve||c instanceof r.QuadraticBezierCurve||c instanceof r.LineCurve){if(c.getPoint(f/d,h),s.set(h.x,h.y,0),void 0!==n&&z(n,s))continue;void 0===n&&(n=I),n.copy(s),e.setXYZ(a,s.x,s.y,s.z),a++}o&&a>1&&(e.getX(a-1)!==e.getX(0)||e.getY(a-1)!==e.getY(0)||e.getZ(a-1)!==e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++)}(e,i?this.roundedCurves:this.curves,t,this.autoClose),n.reduce((function(e,t){return e+t}),0)+1}},{key:"computeCurveDivisions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12;this.curveDivisions=J(this.points,e,!1),this.roundedCurveDivisions=J(this.points,e,!0)}},{key:"extractFilteredShapePointsToBuffer",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12;return 2*function(e,t,i){for(var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=j.set(0,0,0),a=0,l=[],c=0;c<t.length;c++)if(!1!==i[c]){var h=void 0,d=t[c],f=M,v=Q(d,n);l.push(v);for(var m=0;m<=v;m++)if(d instanceof r.CubicBezierCurve||d instanceof r.QuadraticBezierCurve||d instanceof r.LineCurve){if(d.getPoint(m/v,f),o.set(f.x,f.y,0),null==h?void 0:h.equals(o))continue;void 0===h?h=I:(e.setXYZ(a,h.x,h.y,h.z),a++,e.setXYZ(a,o.x,o.y,o.z),a++),h.copy(o)}}return s&&a>1&&(e.getX(a-1)!==e.getX(0)||e.getY(a-1)!==e.getY(0)||e.getZ(a-1)!==e.getZ(0))&&(e.setXYZ(a,e.getX(0),e.getY(0),e.getZ(0)),a++),l}(e,this.curves,t,i,this.autoClose).reduce((function(e,t){return e+t}),0)}},{key:"extractShapePointsToFlatArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return this.subdivision=t,void 0===this.curveDivisions&&this.computeCurveDivisions(t),function(e,t){for(var s,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:12,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=0,l=0;l<t.length;l++)for(var c=t[l],h=Q(c,i),d=M,f=0;f<=h;f++)if(c instanceof r.CubicBezierCurve||c instanceof r.QuadraticBezierCurve||c instanceof r.LineCurve){if(c.getPoint(f/h,d),void 0!==s&&b(s,d,T))continue;void 0===s&&(s=p),s.copy(d),e.push(d.x,d.y),o++}return R(e[0],e[e.length-2],T)&&R(e[1],e[e.length-1],T)&&(e.pop(),e.pop()),!(n&&o>1)||R(e[o-1],e[1],T)&&R(e[o-2],e[0],T)||(e.push(e[0],e[1]),o++),e}(e,this.roundedCurves,t,this.autoClose)}},{key:"getCurveIndexFromVertexId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=0;void 0===this.curveDivisions&&this.computeCurveDivisions(this.subdivision);var i=t?this.roundedCurveDivisions:this.curveDivisions,n=0;t&&void 0!==this.points[0].roundedCurveCorner&&(n=.5*Q(this.points[0].roundedCurveCorner,this.subdivision));var s=e-n;s<0&&(s+=i.reduce((function(e,t){return e+t}),0));for(var o=0,l=i.length;o<l;o++){var c=i[o];if(s<r+c)return[o,(s-r+1)/c];r+=c}return[0,1]}},{key:"getCurveT",value:function(e,t,r){var i=this.points[e],n=this.points[e>=this.points.length-1?0:e+1],s=this.curveDivisions,o=s[e];if(H(i,n)){var l=i.position.distanceTo(n.position);return i.position.distanceTo(X.set(r.x,r.y))/l}for(var a=0,c=0;c<e;c++)a+=s[c];return(t-a)/o}},{key:"dispose",value:function(){this.eventDispatcher=null}},{key:"_applyCurveForPoint",value:function(e,t){H(t,e)?this.lineTo(e.position.x,e.position.y):this.bezierCurveTo(t.controls[1].position.x,t.controls[1].position.y,e.controls[0].position.x,e.controls[0].position.y,e.position.x,e.position.y);var r=this.curves[this.curves.length-1];e.curveBefore=r,t.curveAfter=r;var i=r.clone();e.roundedCurveBefore=i,t.roundedCurveAfter=i,e.roundedCurveCorner=void 0,this.roundedCurves.push(i)}},{key:"_update",value:function(){var e,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.curves=[],this.roundedCurves=[];for(var n=0,o=this.points.length;n<o;n++){var l=this.points[n];if(0===n)this.moveTo(l.position.x,l.position.y);else{var c=this.points[n-1];this._applyCurveForPoint(l,c)}}var h,s,d,i=this.getLastPoint();if((null==i?void 0:i.curveAfter)&&(i.curveAfter=void 0),this.isClosed){var v=this.points[0],m=this.points[this.points.length-1];this._applyCurveForPoint(v,m)}if(this.points.length>2)for(var y=0,A=0,w=this.points.length;A<w;A++){var x=this.points[A],O=x.roundness;if(!x.controlsMoved()&&O>0){var E=x.curveBefore,C=x.curveAfter;if(void 0===E||void 0===C)continue;var D=x.roundedCurveBefore,S=x.roundedCurveAfter,B=E.getLength(),T=C.getLength(),k=Math.min(O,.499*B),_=Math.min(O,.499*T),M=Math.min(k,_),L=1-M/B,N=M/T,F=E.getPointAt(L,X),I=C.getPointAt(N,K),j=void 0;if(this._subSplitCurve(E,D,L,F,void 0),this._subSplitCurve(C,S,N,void 0,I),this.useCubicForRoundedCorners){var P=U(F,x.position,I)/2,R=Math.tan(P)*F.distanceTo(x.position),z=G(F,I,R,Z,$),H=Object(f.a)(z,2),J=H[0],Q=H[1],Y=(h=J,s=Q,d=x.position,h.distanceTo(d)<s.distanceTo(d)?s:h),W=V(Y,F,I,R,ee,te),re=Object(f.a)(W,2),ne=re[0],ie=re[1];j=new r.CubicBezierCurve(F.clone(),ne.clone(),ie.clone(),I.clone())}else j=new r.QuadraticBezierCurve(F.clone(),x.position.clone(),I.clone());x.roundedCurveCorner=j,this.roundedCurves.splice(A+y,0,j),y++}}t&&(null===(e=this.eventDispatcher)||void 0===e||e.dispatchEvent({type:"update"}))}},{key:"_subSplitCurve",value:function(e,t,i,n,s){if(!(e instanceof r.LineCurve)){var o=e,l=t,c=o.getUtoTmapping(i,0),h=function(e,t,r,i){var n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,s=M.subVectors(t,e).multiplyScalar(n).add(e),o=p.subVectors(r,t).multiplyScalar(n).add(t),a=L.subVectors(i,r).multiplyScalar(n).add(r),l=s,c=N.subVectors(o,s).multiplyScalar(n).add(s),h=g.subVectors(a,o).multiplyScalar(n).add(o),u=a,d=F.subVectors(h,c).multiplyScalar(n).add(c);return[e.x,e.y,l.x,l.y,c.x,c.y,d.x,d.y,h.x,h.y,u.x,u.y,i.x,i.y]}(o.v0,o.v1,o.v2,o.v3,c);return void 0!==n&&(l.v0.set(h[0],h[1]),l.v1.set(h[2],h[3]),l.v2.set(h[4],h[5]),l.v3.set(h[6],h[7])),void 0!==s&&(l.v0.set(h[6],h[7]),l.v1.set(h[8],h[9]),l.v2.set(h[10],h[11]),l.v3.set(h[12],h[13])),l}return void 0!==n&&t.v2.copy(n),void 0!==s&&t.v1.copy(s),t}},{key:"clone",value:function(){var e=new n(this._width,this._height);return e.points=this.points.map((function(e){return e.clone()})),e.isClosed=this.isClosed,e.roundness=this.roundness,e.isMesh2D=this.isMesh2D,e}},{key:"toJSON",value:function(){return{points:this.points.reduce((function(e,t){return e.concat(t.toJSON())}),[]),shapeHoles:this.shapeHoles.map((function(e){return e.toJSON()})),isClosed:this.isClosed,roundness:this.roundness}}},{key:"fromJSON",value:function(e){var t;this.points=[],this.pointIDs=0;for(var i=e.points.length/7,o=0;o<i;o++){var l=7*o,c=e.points[l+0],h=e.points[l+1],d=e.points[l+2],f=e.points[l+3],v=e.points[l+4],m=e.points[l+5],y=e.points[l+6],A=new u(r.MathUtils.generateUUID(),new r.Vector2(c,h));A.controls[0].position.set(d,f),A.controls[1].position.set(v,m),A.roundness=y,this.points.push(A)}return this.shapeHoles=(null===(t=e.shapeHoles)||void 0===t?void 0:t.length)?e.shapeHoles.map((function(e){var t=new n;return t.fromJSON(e),t})):[],this.isClosed=e.isClosed,this._roundness=e.roundness,this._update(),this}},{key:"fromShape",value:function(e){var t=this,o=function(e,t){t instanceof r.CubicBezierCurve&&t.v3.equals(e.position)&&e.controls[0].position.copy(t.v2)};return this.points=function(e){var n,s,i=[];for(n=0,s=e.length;n<s;n++)e[n]instanceof r.QuadraticBezierCurve&&(e[n]=P(e[n]));for(n=0,s=e.length;n<s;n++){var l=e[n],c=n>0?e[n-1]:null,h=void 0;l instanceof r.CubicBezierCurve?(h=t.createPoint(l.v0)).controls[1].position.copy(l.v1):l instanceof r.LineCurve&&(h=t.createPoint(l.v1)),void 0!==h&&(null!==c&&o(h,c),i.push(h))}var d=e[e.length-1],a=!1;return d instanceof r.CubicBezierCurve?d.v3.equals(i[0].position)&&(i[0].controls[0].position.copy(d.v2),a=!0):d instanceof r.LineCurve&&d.v2.equals(i[0].position)&&(a=!0),t.isClosed=a,i}(e.curves),e instanceof r.Shape&&(this.shapeHoles=e.holes.map((function(e){var t=new n;return t.fromShape(e),t}))),this.update(),this}}]),n}(r.Shape),ne=2*Math.PI;function ie(e,t,i,r,s){return{x:e.x*t+r,y:e.y*i+s}}function ae(e,t){var r=1.5707963267948966===t?.551915024494:-1.5707963267948966===t?-.551915024494:4/3*Math.tan(t/4),i=Math.cos(e),n=Math.sin(e),s=Math.cos(e+t),o=Math.sin(e+t);return[{x:i-n*r,y:n+i*r},{x:s+o*r,y:o-s*r},{x:s,y:o}]}function oe(e,t,r,i){var n=e*i-t*r<0?-1:1,s=Math.min(1,Math.max(-1,e*r+t*i));return n*Math.acos(s)}function se(e,t){if(!e)throw t||"Assertion Failed!"}!function(e){e[e.ODD=0]="ODD",e[e.NONZERO=1]="NONZERO",e[e.POSITIVE=2]="POSITIVE",e[e.NEGATIVE=3]="NEGATIVE",e[e.ABS_GEQ_TWO=4]="ABS_GEQ_TWO"}(Y||(Y={})),function(e){e[e.POLYGONS=0]="POLYGONS",e[e.CONNECTED_POLYGONS=1]="CONNECTED_POLYGONS",e[e.BOUNDARY_CONTOURS=2]="BOUNDARY_CONTOURS"}(W||(W={}));var ue=function(){function e(){}return e.vertEq=function(e,t){return e.s===t.s&&e.t===t.t},e.vertLeq=function(e,t){return e.s<t.s||e.s===t.s&&e.t<=t.t},e.transLeq=function(e,t){return e.t<t.t||e.t===t.t&&e.s<=t.s},e.edgeGoesLeft=function(t){return e.vertLeq(t.Dst,t.Org)},e.edgeGoesRight=function(t){return e.vertLeq(t.Org,t.Dst)},e.vertL1dist=function(e,t){return Math.abs(e.s-t.s)+Math.abs(e.t-t.t)},e.edgeEval=function(t,r,i){se(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?n<s?r.t-t.t+(t.t-i.t)*(n/(n+s)):r.t-i.t+(i.t-t.t)*(s/(n+s)):0},e.edgeSign=function(t,r,i){se(e.vertLeq(t,r)&&e.vertLeq(r,i));var n=r.s-t.s,s=i.s-r.s;return n+s>0?(r.t-i.t)*n+(r.t-t.t)*s:0},e.transEval=function(t,r,i){se(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?n<s?r.s-t.s+(t.s-i.s)*(n/(n+s)):r.s-i.s+(i.s-t.s)*(s/(n+s)):0},e.transSign=function(t,r,i){se(e.transLeq(t,r)&&e.transLeq(r,i));var n=r.t-t.t,s=i.t-r.t;return n+s>0?(r.s-i.s)*n+(r.s-t.s)*s:0},e.vertCCW=function(e,t,r){return e.s*(t.t-r.t)+t.s*(r.t-e.t)+r.s*(e.t-t.t)>=0},e.interpolate=function(e,t,r,i){return(e=e<0?0:e)<=(r=r<0?0:r)?0===r?(t+i)/2:t+e/(e+r)*(i-t):i+r/(e+r)*(t-i)},e.intersect=function(t,r,i,n,s){var o,a,l;e.vertLeq(t,r)||(l=t,t=r,r=l),e.vertLeq(i,n)||(l=i,i=n,n=l),e.vertLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.vertLeq(i,r)?e.vertLeq(r,n)?((o=e.edgeEval(t,i,r))+(a=e.edgeEval(i,r,n))<0&&(o=-o,a=-a),s.s=e.interpolate(o,i.s,a,r.s)):((o=e.edgeSign(t,i,r))+(a=-e.edgeSign(t,n,r))<0&&(o=-o,a=-a),s.s=e.interpolate(o,i.s,a,n.s)):s.s=(i.s+r.s)/2,e.transLeq(t,r)||(l=t,t=r,r=l),e.transLeq(i,n)||(l=i,i=n,n=l),e.transLeq(t,i)||(l=t,t=i,i=l,l=r,r=n,n=l),e.transLeq(i,r)?e.transLeq(r,n)?((o=e.transEval(t,i,r))+(a=e.transEval(i,r,n))<0&&(o=-o,a=-a),s.t=e.interpolate(o,i.t,a,r.t)):((o=e.transSign(t,i,r))+(a=-e.transSign(t,n,r))<0&&(o=-o,a=-a),s.t=e.interpolate(o,i.t,a,n.t)):s.t=(i.t+r.t)/2},e}(),le=function(){this.next=null,this.prev=null,this.anEdge=null,this.trail=null,this.n=0,this.marked=!1,this.inside=!1},ce=function(){function e(e){this.side=e,this.next=null,this.Org=null,this.Sym=null,this.Onext=null,this.Lnext=null,this.Lface=null,this.activeRegion=null,this.winding=0}return Object.defineProperty(e.prototype,"Rface",{get:function(){return this.Sym.Lface},set:function(e){this.Sym.Lface=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dst",{get:function(){return this.Sym.Org},set:function(e){this.Sym.Org=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Oprev",{get:function(){return this.Sym.Lnext},set:function(e){this.Sym.Lnext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Lprev",{get:function(){return this.Onext.Sym},set:function(e){this.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dprev",{get:function(){return this.Lnext.Sym},set:function(e){this.Lnext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rprev",{get:function(){return this.Sym.Onext},set:function(e){this.Sym.Onext=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Dnext",{get:function(){return this.Sym.Onext.Sym},set:function(e){this.Sym.Onext.Sym=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Rnext",{get:function(){return this.Sym.Lnext.Sym},set:function(e){this.Sym.Lnext.Sym=e},enumerable:!0,configurable:!0}),e}(),he=function(){this.next=null,this.prev=null,this.anEdge=null,this.coords=[0,0,0],this.s=0,this.t=0,this.pqHandle=0,this.n=0,this.idx=0},de=function(){function e(){var e=new he,t=new le,r=new ce(0),i=new ce(1);e.next=e.prev=e,e.anEdge=null,t.next=t.prev=t,r.next=r,r.Sym=i,i.next=i,i.Sym=r,this.vHead=e,this.fHead=t,this.eHead=r,this.eHeadSym=i}return e.prototype.makeEdge_=function(e){var t=new ce(0),r=new ce(1);e.Sym.side<e.side&&(e=e.Sym);var i=e.Sym.next;return r.next=i,i.Sym.next=t,t.next=e,e.Sym.next=r,t.Sym=r,t.Onext=t,t.Lnext=r,t.Org=null,t.Lface=null,t.winding=0,t.activeRegion=null,r.Sym=t,r.Onext=r,r.Lnext=t,r.Org=null,r.Lface=null,r.winding=0,r.activeRegion=null,t},e.prototype.splice_=function(e,t){var r=e.Onext,i=t.Onext;r.Sym.Lnext=t,i.Sym.Lnext=e,e.Onext=i,t.Onext=r},e.prototype.makeVertex_=function(e,t,r){var i=e;se(i,"Vertex can't be null!");var n=r.prev;i.prev=n,n.next=i,i.next=r,r.prev=i,i.anEdge=t;var s=t;do{s.Org=i,s=s.Onext}while(s!==t)},e.prototype.makeFace_=function(e,t,r){var i=e;se(i,"Face can't be null");var n=r.prev;i.prev=n,n.next=i,i.next=r,r.prev=i,i.anEdge=t,i.trail=null,i.marked=!1,i.inside=r.inside;var s=t;do{s.Lface=i,s=s.Lnext}while(s!==t)},e.prototype.killEdge_=function(e){e.Sym.side<e.side&&(e=e.Sym);var t=e.next,r=e.Sym.next;t.Sym.next=r,r.Sym.next=t},e.prototype.killVertex_=function(e,t){var r=e.anEdge,i=r;do{i.Org=t,i=i.Onext}while(i!==r);var n=e.prev,s=e.next;s.prev=n,n.next=s},e.prototype.killFace_=function(e,t){var r=e.anEdge,i=r;do{i.Lface=t,i=i.Lnext}while(i!==r);var n=e.prev,s=e.next;s.prev=n,n.next=s},e.prototype.makeEdge=function(){var e=new he,t=new he,r=new le,i=this.makeEdge_(this.eHead);return this.makeVertex_(e,i,this.vHead),this.makeVertex_(t,i.Sym,this.vHead),this.makeFace_(r,i,this.fHead),i},e.prototype.splice=function(e,t){var r=!1,i=!1;if(e!==t){if(t.Org!==e.Org&&(i=!0,this.killVertex_(t.Org,e.Org)),t.Lface!==e.Lface&&(r=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(t,e),!i){var n=new he;this.makeVertex_(n,t,e.Org),e.Org.anEdge=e}if(!r){var s=new le;this.makeFace_(s,t,e.Lface),e.Lface.anEdge=e}}},e.prototype.delete=function(e){var t=e.Sym,r=!1;if(e.Lface!==e.Rface&&(r=!0,this.killFace_(e.Lface,e.Rface)),e.Onext===e)this.killVertex_(e.Org,null);else if(e.Rface.anEdge=e.Oprev,e.Org.anEdge=e.Onext,this.splice_(e,e.Oprev),!r){var i=new le;this.makeFace_(i,e,e.Lface)}t.Onext===t?(this.killVertex_(t.Org,null),this.killFace_(t.Lface,null)):(e.Lface.anEdge=t.Oprev,t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),this.killEdge_(e)},e.prototype.addEdgeVertex=function(e){var t=this.makeEdge_(e),r=t.Sym;this.splice_(t,e.Lnext),t.Org=e.Dst;var i=new he;return this.makeVertex_(i,r,t.Org),t.Lface=r.Lface=e.Lface,t},e.prototype.splitEdge=function(e){var t=this.addEdgeVertex(e).Sym;return this.splice_(e.Sym,e.Sym.Oprev),this.splice_(e.Sym,t),e.Dst=t.Org,t.Dst.anEdge=t.Sym,t.Rface=e.Rface,t.winding=e.winding,t.Sym.winding=e.Sym.winding,t.idx=e.idx,t.Sym.idx=e.Sym.idx,t},e.prototype.connect=function(e,t){var r=!1,i=this.makeEdge_(e),n=i.Sym;if(t.Lface!==e.Lface&&(r=!0,this.killFace_(t.Lface,e.Lface)),this.splice_(i,e.Lnext),this.splice_(n,t),i.Org=e.Dst,n.Org=t.Org,i.Lface=n.Lface=e.Lface,e.Lface.anEdge=n,!r){var s=new le;this.makeFace_(s,i,e.Lface)}return i},e.prototype.zapFace=function(e){var t,r,i,n,s,o=e.anEdge;r=o.Lnext;do{r=(t=r).Lnext,t.Lface=null,null===t.Rface&&(t.Onext===t?this.killVertex_(t.Org,null):(t.Org.anEdge=t.Onext,this.splice_(t,t.Oprev)),(i=t.Sym).Onext===i?this.killVertex_(i.Org,null):(i.Org.anEdge=i.Onext,this.splice_(i,i.Oprev)),this.killEdge_(t))}while(t!=o);n=e.prev,(s=e.next).prev=n,n.next=s},e.prototype.countFaceVerts_=function(e){var t=e.anEdge,r=0;do{r++,t=t.Lnext}while(t!==e.anEdge);return r},e.prototype.mergeConvexFaces=function(e){var t,r,i,n,s;for(t=this.fHead.next;t!==this.fHead;t=t.next)if(t.inside)for(s=(r=t.anEdge).Org;i=r.Lnext,(n=r.Sym)&&n.Lface&&n.Lface.inside&&this.countFaceVerts_(t)+this.countFaceVerts_(n.Lface)-2<=e&&ue.vertCCW(r.Lprev.Org,r.Org,n.Lnext.Lnext.Org)&&ue.vertCCW(n.Lprev.Org,n.Org,r.Lnext.Lnext.Org)&&(i=n.Lnext,this.delete(n),r=null,n=null),!r||r.Lnext.Org!==s;)r=i;return!0},e.prototype.check=function(){var e,t,r,i,n,s,o=this.fHead,a=this.vHead,l=this.eHead;for(t=o,t=o;(e=t.next)!==o;t=e){se(e.prev===t),n=e.anEdge;do{se(n.Sym!==n),se(n.Sym.Sym===n),se(n.Lnext.Onext.Sym===n),se(n.Onext.Sym.Lnext===n),se(n.Lface===e),n=n.Lnext}while(n!==e.anEdge)}for(se(e.prev===t&&null===e.anEdge),i=a,i=a;(r=i.next)!==a;i=r){se(r.prev===i),n=r.anEdge;do{se(n.Sym!==n),se(n.Sym.Sym===n),se(n.Lnext.Onext.Sym===n),se(n.Onext.Sym.Lnext===n),se(n.Org===r),n=n.Onext}while(n!==r.anEdge)}for(se(r.prev===i&&null===r.anEdge),s=l,s=l;(n=s.next)!==l;s=n)se(n.Sym.next===s.Sym),se(n.Sym!==n),se(n.Sym.Sym===n),se(null!==n.Org),se(null!==n.Dst),se(n.Lnext.Onext.Sym===n),se(n.Onext.Sym.Lnext===n);se(n.Sym.next===s.Sym&&n.Sym===this.eHeadSym&&n.Sym.Sym===n&&null===n.Org&&null===n.Dst&&null===n.Lface&&null===n.Rface)},e}(),fe=function(){this.handle=null},q=function(){this.key=null,this.node=0},ve=function(){function e(e,t){this.leq=t,this.max=0,this.nodes=[],this.handles=[],this.initialized=!1,this.freeList=0,this.size=0,this.max=e,this.nodes=[],this.handles=[];for(var r=0;r<e+1;r++)this.nodes[r]=new fe,this.handles[r]=new q;this.initialized=!1,this.nodes[1].handle=1,this.handles[1].key=null}return e.prototype.floatDown_=function(e){var t,r,i,n=this.nodes,s=this.handles;for(t=n[e].handle;;){if((i=e<<1)<this.size&&this.leq(s[n[i+1].handle].key,s[n[i].handle].key)&&++i,se(i<=this.max),r=n[i].handle,i>this.size||this.leq(s[t].key,s[r].key)){n[e].handle=t,s[t].node=e;break}n[e].handle=r,s[r].node=e,e=i}},e.prototype.floatUp_=function(e){var t,r,i,n=this.nodes,s=this.handles;for(t=n[e].handle;;){if(r=n[i=e>>1].handle,0===i||this.leq(s[r].key,s[t].key)){n[e].handle=t,s[t].node=e;break}n[e].handle=r,s[r].node=e,e=i}},e.prototype.init=function(){for(var e=this.size;e>=1;--e)this.floatDown_(e);this.initialized=!0},e.prototype.min=function(){return this.handles[this.nodes[1].handle].key},e.prototype.insert=function(e){var t,r;if(2*(t=++this.size)>this.max){var i,n;for(this.max*=2,n=this.nodes.length,this.nodes.length=this.max+1,i=n;i<this.nodes.length;i++)this.nodes[i]=new fe;for(n=this.handles.length,this.handles.length=this.max+1,i=n;i<this.handles.length;i++)this.handles[i]=new q}return 0===this.freeList?r=t:(r=this.freeList,this.freeList=this.handles[r].node),this.nodes[t].handle=r,this.handles[r].node=t,this.handles[r].key=e,this.initialized&&this.floatUp_(t),r},e.prototype.extractMin=function(){var e=this.nodes,t=this.handles,r=e[1].handle,i=t[r].key;return this.size>0&&(e[1].handle=e[this.size].handle,t[e[1].handle].node=1,t[r].key=null,t[r].node=this.freeList,this.freeList=r,--this.size,this.size>0&&this.floatDown_(1)),i},e.prototype.delete=function(e){var t,r=this.nodes,i=this.handles;se(e>=1&&e<=this.max&&null!==i[e].key),r[t=i[e].node].handle=r[this.size].handle,i[r[t].handle].node=t,--this.size,t<=this.size&&(t<=1||this.leq(i[r[t>>1].handle].key,i[r[t].handle].key)?this.floatDown_(t):this.floatUp_(t)),i[e].key=null,i[e].node=this.freeList,this.freeList=e},e}(),pe=function(){this.eUp=null,this.nodeUp=null,this.windingNumber=0,this.inside=!1,this.sentinel=!1,this.dirty=!1,this.fixUpperEdge=!1},me=function(){this.key=null,this.next=null,this.prev=null},ge=function(){function e(e,t){this.frame=e,this.leq=t,this.head=new me,this.head.next=this.head,this.head.prev=this.head}return e.prototype.min=function(){return this.head.next},e.prototype.max=function(){return this.head.prev},e.prototype.insert=function(e){return this.insertBefore(this.head,e)},e.prototype.search=function(e){var t=this.head;do{t=t.next}while(null!==t.key&&!this.leq(this.frame,e,t.key));return t},e.prototype.insertBefore=function(e,t){do{e=e.prev}while(null!==e.key&&!this.leq(this.frame,e.key,t));var r=new me;return r.key=t,r.next=e.next,e.next.prev=r,r.prev=e,e.next=r,r},e.prototype.delete=function(e){e.next.prev=e.prev,e.prev.next=e.next},e}(),ye=function(){function e(){}return e.regionBelow=function(e){return e.nodeUp.prev.key},e.regionAbove=function(e){return e.nodeUp.next.key},e.debugEvent=function(e){},e.addWinding=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.edgeLeq=function(e,t,r){var i=e.event,n=t.eUp,s=r.eUp;return n.Dst===i?s.Dst===i?ue.vertLeq(n.Org,s.Org)?ue.edgeSign(s.Dst,n.Org,s.Org)<=0:ue.edgeSign(n.Dst,s.Org,n.Org)>=0:ue.edgeSign(s.Dst,i,s.Org)<=0:s.Dst===i?ue.edgeSign(n.Dst,i,n.Org)>=0:ue.edgeEval(n.Dst,i,n.Org)>=ue.edgeEval(s.Dst,i,s.Org)},e.deleteRegion=function(e,t){t.fixUpperEdge&&se(0===t.eUp.winding),t.eUp.activeRegion=null,e.dict.delete(t.nodeUp)},e.fixUpperEdge=function(e,t,r){se(t.fixUpperEdge),e.mesh.delete(t.eUp),t.fixUpperEdge=!1,t.eUp=r,r.activeRegion=t},e.topLeftRegion=function(t,r){var i,n=r.eUp.Org;do{r=e.regionAbove(r)}while(r.eUp.Org===n);if(r.fixUpperEdge){if(null===(i=t.mesh.connect(e.regionBelow(r).eUp.Sym,r.eUp.Lnext)))return null;e.fixUpperEdge(t,r,i),r=e.regionAbove(r)}return r},e.topRightRegion=function(t){var r=t.eUp.Dst;do{t=e.regionAbove(t)}while(t.eUp.Dst===r);return t},e.addRegionBelow=function(e,t,r){var i=new pe;return i.eUp=r,i.nodeUp=e.dict.insertBefore(t.nodeUp,i),i.fixUpperEdge=!1,i.sentinel=!1,i.dirty=!1,r.activeRegion=i,i},e.isWindingInside=function(e,t){switch(e.windingRule){case Y.ODD:return 0!=(1&t);case Y.NONZERO:return 0!==t;case Y.POSITIVE:return t>0;case Y.NEGATIVE:return t<0;case Y.ABS_GEQ_TWO:return t>=2||t<=-2}throw new Error("Invalid winding rulle")},e.computeWinding=function(t,r){r.windingNumber=e.regionAbove(r).windingNumber+r.eUp.winding,r.inside=e.isWindingInside(t,r.windingNumber)},e.finishRegion=function(t,r){var i=r.eUp,n=i.Lface;n.inside=r.inside,n.anEdge=i,e.deleteRegion(t,r)},e.finishLeftRegions=function(t,r,i){for(var n,s=null,o=r,a=r.eUp;o!==i;){if(o.fixUpperEdge=!1,(n=(s=e.regionBelow(o)).eUp).Org!=a.Org){if(!s.fixUpperEdge){e.finishRegion(t,o);break}n=t.mesh.connect(a.Lprev,n.Sym),e.fixUpperEdge(t,s,n)}a.Onext!==n&&(t.mesh.splice(n.Oprev,n),t.mesh.splice(a,n)),e.finishRegion(t,o),a=s.eUp,o=s}return a},e.addRightEdges=function(t,r,i,n,s,o){var a,l,c,h,u=!0;c=i;do{se(ue.vertLeq(c.Org,c.Dst)),e.addRegionBelow(t,r,c.Sym),c=c.Onext}while(c!==n);for(null===s&&(s=e.regionBelow(r).eUp.Rprev),l=r,h=s;(c=(a=e.regionBelow(l)).eUp.Sym).Org===h.Org;)c.Onext!==h&&(t.mesh.splice(c.Oprev,c),t.mesh.splice(h.Oprev,c)),a.windingNumber=l.windingNumber-c.winding,a.inside=e.isWindingInside(t,a.windingNumber),l.dirty=!0,!u&&e.checkForRightSplice(t,l)&&(e.addWinding(c,h),e.deleteRegion(t,l),t.mesh.delete(h)),u=!1,l=a,h=c;l.dirty=!0,se(l.windingNumber-c.winding===a.windingNumber),o&&e.walkDirtyRegions(t,l)},e.spliceMergeVertices=function(e,t,r){e.mesh.splice(t,r)},e.vertexWeights=function(e,t,r){var i=ue.vertL1dist(t,e),n=ue.vertL1dist(r,e),s=.5*n/(i+n),o=.5*i/(i+n);e.coords[0]+=s*t.coords[0]+o*r.coords[0],e.coords[1]+=s*t.coords[1]+o*r.coords[1],e.coords[2]+=s*t.coords[2]+o*r.coords[2]},e.getIntersectData=function(t,r,i,n,s,o){r.coords[0]=r.coords[1]=r.coords[2]=0,r.idx=-1,e.vertexWeights(r,i,n),e.vertexWeights(r,s,o)},e.checkForRightSplice=function(t,r){var i=e.regionBelow(r),n=r.eUp,s=i.eUp;if(ue.vertLeq(n.Org,s.Org)){if(ue.edgeSign(s.Dst,n.Org,s.Org)>0)return!1;ue.vertEq(n.Org,s.Org)?n.Org!==s.Org&&(t.pq.delete(n.Org.pqHandle),e.spliceMergeVertices(t,s.Oprev,n)):(t.mesh.splitEdge(s.Sym),t.mesh.splice(n,s.Oprev),r.dirty=i.dirty=!0)}else{if(ue.edgeSign(n.Dst,s.Org,n.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(n.Sym),t.mesh.splice(s.Oprev,n)}return!0},e.checkForLeftSplice=function(t,r){var i,n=e.regionBelow(r),s=r.eUp,o=n.eUp;if(se(!ue.vertEq(s.Dst,o.Dst)),ue.vertLeq(s.Dst,o.Dst)){if(ue.edgeSign(s.Dst,o.Dst,s.Org)<0)return!1;e.regionAbove(r).dirty=r.dirty=!0,i=t.mesh.splitEdge(s),t.mesh.splice(o.Sym,i),i.Lface.inside=r.inside}else{if(ue.edgeSign(o.Dst,s.Dst,o.Org)>0)return!1;r.dirty=n.dirty=!0,i=t.mesh.splitEdge(o),t.mesh.splice(s.Lnext,o.Sym),i.Rface.inside=r.inside}return!0},e.checkForIntersect=function(t,r){var i,n,s=e.regionBelow(r),o=r.eUp,a=s.eUp,l=o.Org,c=a.Org,h=o.Dst,u=a.Dst,d=new he;if(se(!ue.vertEq(u,h)),se(ue.edgeSign(h,t.event,l)<=0),se(ue.edgeSign(u,t.event,c)>=0),se(l!==t.event&&c!==t.event),se(!r.fixUpperEdge&&!s.fixUpperEdge),l===c)return!1;if(Math.min(l.t,h.t)>Math.max(c.t,u.t))return!1;if(ue.vertLeq(l,c)){if(ue.edgeSign(u,l,c)>0)return!1}else if(ue.edgeSign(h,c,l)<0)return!1;return e.debugEvent(t),ue.intersect(h,l,u,c,d),se(Math.min(l.t,h.t)<=d.t),se(d.t<=Math.max(c.t,u.t)),se(Math.min(u.s,h.s)<=d.s),se(d.s<=Math.max(c.s,l.s)),ue.vertLeq(d,t.event)&&(d.s=t.event.s,d.t=t.event.t),i=ue.vertLeq(l,c)?l:c,ue.vertLeq(i,d)&&(d.s=i.s,d.t=i.t),ue.vertEq(d,l)||ue.vertEq(d,c)?(e.checkForRightSplice(t,r),!1):!ue.vertEq(h,t.event)&&ue.edgeSign(h,t.event,d)>=0||!ue.vertEq(u,t.event)&&ue.edgeSign(u,t.event,d)<=0?u===t.event?(t.mesh.splitEdge(o.Sym),t.mesh.splice(a.Sym,o),r=e.topLeftRegion(t,r),o=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),s),e.addRightEdges(t,r,o.Oprev,o,o,!0),!0):h===t.event?(t.mesh.splitEdge(a.Sym),t.mesh.splice(o.Lnext,a.Oprev),s=r,r=e.topRightRegion(r),n=e.regionBelow(r).eUp.Rprev,s.eUp=a.Oprev,a=e.finishLeftRegions(t,s,null),e.addRightEdges(t,r,a.Onext,o.Rprev,n,!0),!0):(ue.edgeSign(h,t.event,d)>=0&&(e.regionAbove(r).dirty=r.dirty=!0,t.mesh.splitEdge(o.Sym),o.Org.s=t.event.s,o.Org.t=t.event.t),ue.edgeSign(u,t.event,d)<=0&&(r.dirty=s.dirty=!0,t.mesh.splitEdge(a.Sym),a.Org.s=t.event.s,a.Org.t=t.event.t),!1):(t.mesh.splitEdge(o.Sym),t.mesh.splitEdge(a.Sym),t.mesh.splice(a.Oprev,o),o.Org.s=d.s,o.Org.t=d.t,o.Org.pqHandle=t.pq.insert(o.Org),e.getIntersectData(t,o.Org,l,h,c,u),e.regionAbove(r).dirty=r.dirty=s.dirty=!0,!1)},e.walkDirtyRegions=function(t,r){for(var i,n,s=e.regionBelow(r);;){for(;s.dirty;)r=s,s=e.regionBelow(s);if(!r.dirty&&(s=r,null===(r=e.regionAbove(r))||!r.dirty))return;if(r.dirty=!1,i=r.eUp,n=s.eUp,i.Dst!==n.Dst&&e.checkForLeftSplice(t,r)&&(s.fixUpperEdge?(e.deleteRegion(t,s),t.mesh.delete(n),n=(s=e.regionBelow(r)).eUp):r.fixUpperEdge&&(e.deleteRegion(t,r),t.mesh.delete(i),i=(r=e.regionAbove(s)).eUp)),i.Org!==n.Org)if(i.Dst===n.Dst||r.fixUpperEdge||s.fixUpperEdge||i.Dst!==t.event&&n.Dst!==t.event)e.checkForRightSplice(t,r);else if(e.checkForIntersect(t,r))return;i.Org===n.Org&&i.Dst===n.Dst&&(e.addWinding(n,i),e.deleteRegion(t,r),t.mesh.delete(i),r=e.regionAbove(s))}},e.connectRightVertex=function(t,r,i){var n,s=i.Onext,o=e.regionBelow(r),a=r.eUp,l=o.eUp,c=!1;a.Dst!==l.Dst&&e.checkForIntersect(t,r),ue.vertEq(a.Org,t.event)&&(t.mesh.splice(s.Oprev,a),r=e.topLeftRegion(t,r),s=e.regionBelow(r).eUp,e.finishLeftRegions(t,e.regionBelow(r),o),c=!0),ue.vertEq(l.Org,t.event)&&(t.mesh.splice(i,l.Oprev),i=e.finishLeftRegions(t,o,null),c=!0),c?e.addRightEdges(t,r,i.Onext,s,s,!0):(n=ue.vertLeq(l.Org,a.Org)?l.Oprev:a,n=t.mesh.connect(i.Lprev,n),e.addRightEdges(t,r,n,n.Onext,n.Onext,!1),n.Sym.activeRegion.fixUpperEdge=!0,e.walkDirtyRegions(t,r))},e.connectLeftDegenerate=function(t,r,i){var n,s,o,a,l;return n=r.eUp,ue.vertEq(n.Org,i)?(se(!1),void e.spliceMergeVertices(t,n,i.anEdge)):ue.vertEq(n.Dst,i)?(se(!1),r=e.topRightRegion(r),s=a=(o=(l=e.regionBelow(r)).eUp.Sym).Onext,l.fixUpperEdge&&(se(s!==o),e.deleteRegion(t,l),t.mesh.delete(o),o=s.Oprev),t.mesh.splice(i.anEdge,o),ue.edgeGoesLeft(s)||(s=null),void e.addRightEdges(t,r,o.Onext,a,s,!0)):(t.mesh.splitEdge(n.Sym),r.fixUpperEdge&&(t.mesh.delete(n.Onext),r.fixUpperEdge=!1),t.mesh.splice(i.anEdge,n),void e.sweepEvent(t,i))},e.connectLeftVertex=function(t,r){var i,n,s,o,a,l,c=new pe;c.eUp=r.anEdge.Sym,i=t.dict.search(c).key,(n=e.regionBelow(i))&&(o=i.eUp,a=n.eUp,0!==ue.edgeSign(o.Dst,r,o.Org)?(s=ue.vertLeq(a.Dst,o.Dst)?i:n,i.inside||s.fixUpperEdge?(l=s===i?t.mesh.connect(r.anEdge.Sym,o.Lnext):t.mesh.connect(a.Dnext,r.anEdge).Sym,s.fixUpperEdge?e.fixUpperEdge(t,s,l):e.computeWinding(t,e.addRegionBelow(t,i,l)),e.sweepEvent(t,r)):e.addRightEdges(t,i,r.anEdge,r.anEdge,null,!0)):e.connectLeftDegenerate(t,i,r))},e.sweepEvent=function(t,r){t.event=r,e.debugEvent(t);for(var i=r.anEdge;null===i.activeRegion;)if((i=i.Onext)===r.anEdge)return void e.connectLeftVertex(t,r);var n=e.topLeftRegion(t,i.activeRegion);se(null!==n);var s=e.regionBelow(n),o=s.eUp,a=e.finishLeftRegions(t,s,null);a.Onext===o?e.connectRightVertex(t,n,a):e.addRightEdges(t,n,a.Onext,o,o,!0)},e.addSentinel=function(e,t,r,i){var n=new pe,s=e.mesh.makeEdge();s.Org.s=r,s.Org.t=i,s.Dst.s=t,s.Dst.t=i,e.event=s.Dst,n.eUp=s,n.windingNumber=0,n.inside=!1,n.fixUpperEdge=!1,n.sentinel=!0,n.dirty=!1,n.nodeUp=e.dict.insert(n)},e.initEdgeDict=function(t){t.dict=new ge(t,e.edgeLeq);var r=t.bmax[0]-t.bmin[0],i=t.bmax[1]-t.bmin[1],n=t.bmin[0]-r,s=t.bmax[0]+r,o=t.bmin[1]-i,a=t.bmax[1]+i;e.addSentinel(t,n,s,o),e.addSentinel(t,n,s,a)},e.doneEdgeDict=function(t){for(var r,i=0;null!==(r=t.dict.min().key);)r.sentinel||(se(r.fixUpperEdge),se(1==++i)),se(0===r.windingNumber),e.deleteRegion(t,r)},e.removeDegenerateEdges=function(t){var r,i,n,s=t.mesh.eHead;for(r=s.next;r!==s;r=i)i=r.next,n=r.Lnext,ue.vertEq(r.Org,r.Dst)&&r.Lnext.Lnext!==r&&(e.spliceMergeVertices(t,n,r),t.mesh.delete(r),n=(r=n).Lnext),n.Lnext===r&&(n!==r&&(n!==i&&n!==i.Sym||(i=i.next),t.mesh.delete(n)),r!==i&&r!==i.Sym||(i=i.next),t.mesh.delete(r))},e.initPriorityQ=function(e){var t,r,i,n=0;for(r=(i=e.mesh.vHead).next;r!==i;r=r.next)n++;for(n+=8,t=e.pq=new ve(n,ue.vertLeq),r=(i=e.mesh.vHead).next;r!==i;r=r.next)r.pqHandle=t.insert(r);return r===i&&(t.init(),!0)},e.donePriorityQ=function(e){e.pq=null},e.removeDegenerateFaces=function(t,r){var i,n,s;for(i=r.fHead.next;i!==r.fHead;i=n)n=i.next,se((s=i.anEdge).Lnext!==s),s.Lnext.Lnext===s&&(e.addWinding(s.Onext,s),t.mesh.delete(s));return!0},e.computeInterior=function(t,r){var i,n;if(void 0===r&&(r=!0),e.removeDegenerateEdges(t),!e.initPriorityQ(t))return!1;for(e.initEdgeDict(t);null!==(i=t.pq.extractMin());){for(;null!==(n=t.pq.min())&&ue.vertEq(n,i);)n=t.pq.extractMin(),e.spliceMergeVertices(t,i.anEdge,n.anEdge);e.sweepEvent(t,i)}return t.event=t.dict.min().key.eUp.Org,e.debugEvent(t),e.doneEdgeDict(t),e.donePriorityQ(t),!!e.removeDegenerateFaces(t,t.mesh)&&(r&&t.mesh.check(),!0)},e}(),Ae=function(){function e(){this.mesh=new de,this.normal=[0,0,0],this.sUnit=[0,0,0],this.tUnit=[0,0,0],this.bmin=[0,0],this.bmax=[0,0],this.windingRule=Y.ODD,this.dict=null,this.pq=null,this.event=null,this.vertexIndexCounter=0,this.vertices=[],this.vertexIndices=[],this.vertexCount=0,this.elements=[],this.elementCount=0}return e.prototype.dot_=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},e.prototype.normalize_=function(e){var t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(!t)throw"Zero-size vector!";t=Math.sqrt(t),e[0]/=t,e[1]/=t,e[2]/=t},e.prototype.longAxis_=function(e){var t=0;return Math.abs(e[1])>Math.abs(e[0])&&(t=1),Math.abs(e[2])>Math.abs(e[t])&&(t=2),t},e.prototype.computeNormal_=function(e){var t,r,i,n,s,o,a=[0,0,0],l=[0,0,0],c=[0,0,0],h=[0,0,0],u=[0,0,0],d=[null,null,null],p=[null,null,null],f=this.mesh.vHead;t=f.next;for(var v=0;v<3;++v)n=t.coords[v],l[v]=n,p[v]=t,a[v]=n,d[v]=t;for(t=f.next;t!==f;t=t.next)for(var g=0;g<3;++g)(n=t.coords[g])<l[g]&&(l[g]=n,p[g]=t),n>a[g]&&(a[g]=n,d[g]=t);var m=0;if(a[1]-l[1]>a[0]-l[0]&&(m=1),a[2]-l[2]>a[m]-l[m]&&(m=2),l[m]>=a[m])return e[0]=0,e[1]=0,void(e[2]=1);for(o=0,r=p[m],i=d[m],c[0]=r.coords[0]-i.coords[0],c[1]=r.coords[1]-i.coords[1],c[2]=r.coords[2]-i.coords[2],t=f.next;t!==f;t=t.next)h[0]=t.coords[0]-i.coords[0],h[1]=t.coords[1]-i.coords[1],h[2]=t.coords[2]-i.coords[2],u[0]=c[1]*h[2]-c[2]*h[1],u[1]=c[2]*h[0]-c[0]*h[2],u[2]=c[0]*h[1]-c[1]*h[0],(s=u[0]*u[0]+u[1]*u[1]+u[2]*u[2])>o&&(o=s,e[0]=u[0],e[1]=u[1],e[2]=u[2]);o<=0&&(e[0]=e[1]=e[2]=0,e[this.longAxis_(c)]=1)},e.prototype.checkOrientation_=function(){for(var e,t,r=this.mesh.fHead,i=this.mesh.vHead,n=0,s=r.next;s!==r;s=s.next)if(!((t=s.anEdge).winding<=0))do{n+=(t.Org.s-t.Dst.s)*(t.Org.t+t.Dst.t),t=t.Lnext}while(t!==s.anEdge);if(n<0){for(e=i.next;e!==i;e=e.next)e.t=-e.t;this.tUnit[0]=-this.tUnit[0],this.tUnit[1]=-this.tUnit[1],this.tUnit[2]=-this.tUnit[2]}},e.prototype.projectPolygon_=function(){var e,t,r=this.mesh.vHead,i=[0,0,0],n=!1;i[0]=this.normal[0],i[1]=this.normal[1],i[2]=this.normal[2],i[0]||i[1]||i[2]||(this.computeNormal_(i),n=!0),e=this.sUnit,t=this.tUnit;var s=this.longAxis_(i);e[s]=0,e[(s+1)%3]=1,e[(s+2)%3]=0,t[s]=0,t[(s+1)%3]=0,t[(s+2)%3]=i[s]>0?1:-1;for(var o=r.next;o!==r;o=o.next)o.s=this.dot_(o.coords,e),o.t=this.dot_(o.coords,t);n&&this.checkOrientation_();for(var a=!0,l=r.next;l!==r;l=l.next)a?(this.bmin[0]=this.bmax[0]=l.s,this.bmin[1]=this.bmax[1]=l.t,a=!1):(l.s<this.bmin[0]&&(this.bmin[0]=l.s),l.s>this.bmax[0]&&(this.bmax[0]=l.s),l.t<this.bmin[1]&&(this.bmin[1]=l.t),l.t>this.bmax[1]&&(this.bmax[1]=l.t))},e.prototype.addWinding_=function(e,t){e.winding+=t.winding,e.Sym.winding+=t.Sym.winding},e.prototype.tessellateMonoRegion_=function(e,t){var r,i;if((r=t.anEdge).Lnext===r||r.Lnext.Lnext===r)throw"Mono region invalid";for(;ue.vertLeq(r.Dst,r.Org);r=r.Lprev);for(;ue.vertLeq(r.Org,r.Dst);r=r.Lnext);for(i=r.Lprev;r.Lnext!==i;)if(ue.vertLeq(r.Dst,i.Org)){for(;i.Lnext!==r&&(ue.edgeGoesLeft(i.Lnext)||ue.edgeSign(i.Org,i.Dst,i.Lnext.Dst)<=0);)i=e.connect(i.Lnext,i).Sym;i=i.Lprev}else{for(;i.Lnext!==r&&(ue.edgeGoesRight(r.Lprev)||ue.edgeSign(r.Dst,r.Org,r.Lprev.Org)>=0);)r=e.connect(r,r.Lprev).Sym;r=r.Lnext}if(i.Lnext===r)throw"Mono region invalid";for(;i.Lnext.Lnext!==r;)i=e.connect(i.Lnext,i).Sym;return!0},e.prototype.tessellateInterior_=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t)if(t=r.next,r.inside&&!this.tessellateMonoRegion_(e,r))return!1;return!0},e.prototype.discardExterior_=function(e){for(var t,r=e.fHead.next;r!==e.fHead;r=t)t=r.next,r.inside||e.zapFace(r)},e.prototype.setWindingNumber_=function(e,t,r){for(var i,n=e.eHead.next;n!==e.eHead;n=i)i=n.next,n.Rface.inside!==n.Lface.inside?n.winding=n.Lface.inside?t:-t:r?e.delete(n):n.winding=0},e.prototype.getNeighbourFace_=function(e){return e.Rface&&e.Rface.inside?e.Rface.n:-1},e.prototype.outputPolymesh_=function(e,t,r,i){var n,s,o=0,a=0;r>3&&e.mergeConvexFaces(r);for(var l=e.vHead.next;l!==e.vHead;l=l.next)l.n=-1;for(var c=e.fHead.next;c!==e.fHead;c=c.next)if(c.n=-1,c.inside){n=c.anEdge,s=0;do{-1===(l=n.Org).n&&(l.n=a,a++),s++,n=n.Lnext}while(n!==c.anEdge);if(s>r)throw"Face vertex greater that support polygon";c.n=o,++o}for(this.elementCount=o,t===W.CONNECTED_POLYGONS&&(o*=2),this.elements=[],this.elements.length=o*r,this.vertexCount=a,this.vertices=[],this.vertices.length=a*i,this.vertexIndices=[],this.vertexIndices.length=a,l=e.vHead.next;l!==e.vHead;l=l.next)if(-1!==l.n){var h=l.n*i;this.vertices[h+0]=l.coords[0],this.vertices[h+1]=l.coords[1],i>2&&(this.vertices[h+2]=l.coords[2]),this.vertexIndices[l.n]=l.idx}var u=0;for(c=e.fHead.next;c!==e.fHead;c=c.next)if(c.inside){n=c.anEdge,s=0;do{l=n.Org,this.elements[u++]=l.n,s++,n=n.Lnext}while(n!==c.anEdge);for(var d=s;d<r;++d)this.elements[u++]=-1;if(t===W.CONNECTED_POLYGONS){n=c.anEdge;do{this.elements[u++]=this.getNeighbourFace_(n),n=n.Lnext}while(n!==c.anEdge);for(var p=s;p<r;++p)this.elements[u++]=-1}}},e.prototype.outputContours_=function(e,t){var r,i,n=0,s=0;this.vertexCount=0,this.elementCount=0;for(var o=e.fHead.next;o!==e.fHead;o=o.next)if(o.inside){i=r=o.anEdge;do{this.vertexCount++,r=r.Lnext}while(r!==i);this.elementCount++}this.elements=[],this.elements.length=2*this.elementCount,this.vertices=[],this.vertices.length=this.vertexCount*t,this.vertexIndices=[],this.vertexIndices.length=this.vertexCount;var a=0,l=0,c=0;for(n=0,o=e.fHead.next;o!==e.fHead;o=o.next)if(o.inside){s=0,i=r=o.anEdge;do{this.vertices[a++]=r.Org.coords[0],this.vertices[a++]=r.Org.coords[1],t>2&&(this.vertices[a++]=r.Org.coords[2]),this.vertexIndices[l++]=this.vertexIdCallback?this.vertexIdCallback(r):r.Org.idx,s++,r=r.Lnext}while(r!==i);this.elements[c++]=n,this.elements[c++]=s,n+=s}},e.prototype.addContour=function(e,t){null===this.mesh&&(this.mesh=new de),e<2&&(e=2),e>3&&(e=3);for(var r=null,i=0;i<t.length;i+=e)null===r?(r=this.mesh.makeEdge(),this.mesh.splice(r,r.Sym)):(this.mesh.splitEdge(r),r=r.Lnext),r.Org.coords[0]=t[i+0],r.Org.coords[1]=t[i+1],r.Org.coords[2]=e>2?t[i+2]:0,r.Org.idx=this.vertexIndexCounter++,this.edgeCreateCallback&&this.edgeCreateCallback(r),r.winding=1,r.Sym.winding=-1},e.prototype.tesselate=function(e,t,r,i,n,s){if(void 0===e&&(e=Y.ODD),void 0===t&&(t=W.POLYGONS),void 0===s&&(s=!0),this.vertices=[],this.elements=[],this.vertexIndices=[],this.vertexIndexCounter=0,n&&(this.normal[0]=n[0],this.normal[1]=n[1],this.normal[2]=n[2]),this.windingRule=e,i<2&&(i=2),i>3&&(i=3),!this.mesh)return!1;this.projectPolygon_(),ye.computeInterior(this,s);var o=this.mesh;return t===W.BOUNDARY_CONTOURS?this.setWindingNumber_(o,1,!0):this.tessellateInterior_(o),s&&o.check(),t===W.BOUNDARY_CONTOURS?this.outputContours_(o,i):this.outputPolymesh_(o,t,r,i),!0},e}();function be(e){var t=e.windingRule,r=void 0===t?Y.ODD:t,i=e.elementType,n=void 0===i?W.POLYGONS:i,s=e.polySize,o=void 0===s?3:s,a=e.vertexSize,l=void 0===a?2:a,c=e.normal,h=void 0===c?[0,0,1]:c,u=e.contours,d=void 0===u?[]:u,p=e.strict,f=void 0===p||p,v=e.debug,g=void 0!==v&&v;if(!d&&f)throw new Error("Contours can't be empty");if(d){var m=new Ae;e.edgeCreateCallback&&(m.edgeCreateCallback=e.edgeCreateCallback),e.vertexIdCallback&&(m.vertexIdCallback=e.vertexIdCallback);for(var y=0;y<d.length;y++)m.addContour(l||2,d[y]);return m.tesselate(r,n,o,l,h,f),{vertices:m.vertices,vertexIndices:m.vertexIndices,vertexCount:m.vertexCount,elements:m.elements,elementCount:m.elementCount,mesh:g?m.mesh:void 0}}}Y.ODD,Y.NONZERO,Y.POSITIVE,Y.NEGATIVE,Y.ABS_GEQ_TWO,W.POLYGONS,W.CONNECTED_POLYGONS,W.BOUNDARY_CONTOURS;var we=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Object(A.a)(this,n),(o=t.call(this)).type="ShapeGeometry",o.windingRule=Y.ODD,o.elementType=W.POLYGONS,o.polySize=3,o.vertexSize=2,o.strict=!0,o._drawCount=0,o._shape=e,o._curveSegments=l,o._maxCount=i,o._maxDrawCount=3*i,o._triangulationOptions=Object.assign({windingRule:Y.ODD,elementType:W.POLYGONS,polySize:3,vertexSize:2,strict:!0},c),o._positionAttribute=new r.BufferAttribute(new Float32Array(3*i),3),o._normalAttribute=new r.BufferAttribute(new Float32Array(3*i),3),o._uvAttribute=new r.BufferAttribute(new Float32Array(2*i),2),o._indexAttribute=new r.BufferAttribute(new Uint32Array(3*i),1),o.setAttribute("position",o._positionAttribute),o.setAttribute("normal",o._normalAttribute),o.setAttribute("uv",o._uvAttribute),o.setIndex(o._indexAttribute),o.updateFromShape(),o}return Object(w.a)(n,[{key:"copy",value:function(e){return this._drawCount=e.drawCount,this._maxDrawCount=e._maxDrawCount,this._maxCount=e.maxCount,Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e)}},{key:"curveSegments",get:function(){return this._curveSegments},set:function(e){this._curveSegments=e,this.updateFromShape()}},{key:"drawCount",get:function(){return this._drawCount}},{key:"maxDrawCount",get:function(){return this._maxDrawCount}},{key:"maxCount",get:function(){return this._maxCount}},{key:"updateFromShape",value:function(){for(var e,i,t,r=this,n=this._shape.extractShapePointsToFlatArray([],this._curveSegments),o=this._shape.shapeHoles.map((function(e){return e.extractShapePointsToFlatArray([],r._curveSegments)})),s=!0,l=!0,c=0,h=n.length/2;c<h;c++){var d=2*c,f=n[d+0],v=n[d+1];if(void 0!==i&&f!==i&&(s=!1),void 0!==t&&v!==t&&(l=!1),i=f,t=v,!s&&!l)break}if(s||l||(e=be({contours:[n].concat(Object(y.a)(o)),windingRule:this._triangulationOptions.windingRule,elementType:this._triangulationOptions.elementType,polySize:this._triangulationOptions.polySize,vertexSize:this._triangulationOptions.vertexSize,strict:this._triangulationOptions.strict})),e){this._positionAttribute.array.fill(0),this._normalAttribute.array.fill(0),this._uvAttribute.array.fill(0),this._indexAttribute.array.fill(0),this._drawCount=0;for(var m=1/0,A=-1/0,w=1/0,x=-1/0,O=0,E=e.vertexCount;O<E;O++){var C=2*O,D=e.vertices[C+0],S=e.vertices[C+1];D<m&&(m=D),D>A&&(A=D),S<w&&(w=S),S>x&&(x=S)}for(var B=A-m,T=x-w,k=0,_=e.vertexCount;k<_;k++){var M=2*k,L=e.vertices[M+0],N=e.vertices[M+1],F=(L-m)/B,I=(N-w)/T;this._positionAttribute.setXYZ(k,L,N,0),this._normalAttribute.setXYZ(k,0,0,1),this._uvAttribute.setXY(k,F,I)}for(var j=0,P=e.elementCount;j<P;j++){var R=3*j,z=e.elements[R+0],U=e.elements[R+1],G=e.elements[R+2];this._indexAttribute.setX(R+0,z),this._indexAttribute.setX(R+1,U),this._indexAttribute.setX(R+2,G),this._drawCount+=3}this._positionAttribute.needsUpdate=!0,this._normalAttribute.needsUpdate=!0,this._uvAttribute.needsUpdate=!0,this._indexAttribute.needsUpdate=!0,this.setDrawRange(0,this._drawCount)}return this._drawCount>this._maxDrawCount}}]),n}(r.BufferGeometry),xe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];Object(A.a)(this,e),this.capacity=t,this.size=0,this.debug=r,this.debug&&console.log("allocating with cap ".concat(t));var n=t*e.eSize;this.buffer=new ArrayBuffer(n);var i=Float32Array.BYTES_PER_ELEMENT,o=0;this.positions=new Float32Array(this.buffer,o*i,3*t),o+=3*t,this.normals=new Float32Array(this.buffer,o*i,3*t),o+=3*t,this.uvs=new Float32Array(this.buffer,o*i,2*t)}return Object(w.a)(e,[{key:"realloc",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t<this.size)throw Error("cannot shrink buffer");if(!(t<=this.capacity)||r){this.debug&&console.log("resizing from ".concat(this.capacity,"  ").concat(t));var n=t*e.eSize,i=new ArrayBuffer(n),o=Float32Array.BYTES_PER_ELEMENT,s=0,l=new Float32Array(i,s*o,3*t);s+=3*t;var a=new Float32Array(i,s*o,3*t);s+=3*t;var c=new Float32Array(i,s*o,2*t);l.set(this.positions.slice(0,3*this.size)),a.set(this.normals.slice(0,3*this.size)),c.set(this.uvs.slice(0,2*this.size)),this.buffer=i,this.positions=l,this.normals=a,this.uvs=c,this.capacity=t}}},{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.size+e;if(t>this.capacity){for(var r=this.capacity;t>r;)r*=2;this.realloc(r)}var n=this.size;return this.size=t,n}},{key:"reserve",value:function(e){var t=this.size+e;t>this.capacity&&this.realloc(t)}},{key:"shrink",value:function(){this.debug&&console.log("shrinking ".concat(this.capacity,"  ").concat(this.size)),this.realloc(this.size,!0)}}]),e}();xe.eSize=8*Float32Array.BYTES_PER_ELEMENT;var Oe=function(e,t){return function(r){var n=Object(f.a)(r,2),o=n[0],i=n[1];return i<o&&(i+=t),(e>=o?e:e+t)<=i}},Ee=function(e){Object(x.a)(n,e);var t=S(n);function n(e,o){var l,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:3;Object(A.a)(this,n),(l=t.call(this)).type="ShapeGeometry",l.vertexCache={},l._shape=e,l._depth=o,i<=0?(l._bevelSize=0,l._bevelSegments=0):(l._bevelSize=Math.min(i,o/2-1e-12),l._bevelSegments=Math.floor(s));var h=l._shape.extractShapePointsToFlatArray([],c),a=l._shape.shapeHoles.map((function(e){return e.extractShapePointsToFlatArray([],c)})),d=be({windingRule:Y.ODD,elementType:W.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[h].concat(Object(y.a)(a))});if(!d)throw new Error("error generating geometry");for(var v=1/0,m=-1/0,u=1/0,w=-1/0,x=0,O=d.vertexCount;x<O;x++){var E=2*x,C=d.vertices[E+0],D=d.vertices[E+1];C<v&&(v=C),C>m&&(m=C),D<u&&(u=D),D>w&&(w=D)}l._minX=v,l._minY=u,l._width=m-v,l._height=w-u;var p=2*d.vertexCount*(2+l._bevelSegments);l._buffer=new xe(p);for(var S=[],B=0,T=d.elementCount;B<T;B++){var k=2*B,_=d.elements[k+0],M=d.elements[k+1],L=_+M,N={start:_,count:M,normals:[],continuous:[],concave:[]},F=_,I=L-1,j=_+1,P=l._shape.roundedCurves.length;do{var R,z=F-_,U=d.vertices[2*I+0],G=d.vertices[2*I+1],V=d.vertices[2*F+0],H=d.vertices[2*F+1],J=d.vertices[2*j+0],Q=d.vertices[2*j+1],X=V-U,K=H-G,Z=Math.sqrt(X*X+K*K);X/=Z,K/=Z;var $=V-J,ee=H-Q,te=Math.sqrt($*$+ee*ee);$/=te,ee/=te,N.normals[2*z+0]=-ee,N.normals[2*z+1]=$,N.concave[z]=X*ee-K*$>0;var re=d.vertexIndices[F];if(Array.isArray(re))N.continuous[z]=!1;else{var ne=l._shape.getCurveIndexFromVertexId(re-1,!0),ie=Object(f.a)(ne,2),ae=ie[0],oe=ie[1];if(oe>0&&oe<1)N.continuous[z]=!0;else{var se=1===oe?ae+1:ae-1;se=(se+P)%P;var ue=1===oe?0:1,le=l._shape.roundedCurves[ae].getTangent(oe),ce=l._shape.roundedCurves[se].getTangent(ue);N.continuous[z]=le.dot(ce)>.95}}I=(R=[F,j,j+1])[0],F=R[1],(j=R[2])>=L&&(j-=M)}while(j!==_+1);var he=[];he.push({bevelI:0,angle:0,size:0,boundary:{vertices:d.vertices.slice(2*_,2*L),vertexCount:M,vertexIndices:new Array(M).fill(!0).map((function(e,t){return[t,t]})),elements:[0,M],elementCount:1,mesh:null},reverseMap:[],insetPoints:d.vertices.slice(2*_,2*L)});for(var de=function(e){for(var t=e/l._bevelSegments*Math.PI/2,r=(1-Math.cos(t))*l._bevelSize,s=[],a=[],n=[],o=[],u=0,h=0;h<M;h++){var v=2*h,m=(h-1+M)%M*2,y=d.vertices[2*N.start+v+0],A=d.vertices[2*N.start+v+1],w=-N.normals[m+0]*r,x=-N.normals[m+1]*r,O=-N.normals[v+0]*r,E=-N.normals[v+1]*r;if(N.concave[h]){var C=Math.atan2(x,w),D=Math.atan2(E,O);D>C&&(D-=2*Math.PI);var S=D-C;if(N.continuous[h]){var B=C+S/2,T=Math.cos(B)*r,k=Math.sin(B)*r;s[2*u+0]=y+T,s[2*u+1]=A+k,o[u]=h,u++}else for(var _=Math.max(1,Math.floor(c/4*Math.abs(S)/Math.PI)),L=0;L<=_;L++){var F=C+S*(L/_),I=Math.cos(F)*r,j=Math.sin(F)*r;s[2*u+0]=y+I,s[2*u+1]=A+j,o[u]=h,u++}}else s[2*u+0]=y+w,s[2*u+1]=A+x,o[u]=h,a[h]=u,s[2*++u+0]=y,s[2*u+1]=A,o[u]=h,s[2*++u+0]=y+O,s[2*u+1]=A+E,o[u]=h,n[h]=u,u++}var P=be({windingRule:Y.POSITIVE,elementType:W.BOUNDARY_CONTOURS,vertexSize:2,strict:!0,contours:[s],edgeCreateCallback:function(e){var t=e.Org.idx,r=o[t],i=o[(t+1)%o.length];e.idx=[r,i],e.Sym.idx=[i,r]},vertexIdCallback:function(e){var t=e.Lprev.idx;return[t?t[1]:0,e.idx[0]]}});if(!P)throw new Error("error generating bevel geometry for ".concat(e,"'th loop"));if(!P.vertexCount)return"break";for(var R=0;R<P.vertexIndices.length;R++){var z=Object(f.a)(P.vertexIndices[R],2),U=z[0],G=z[1];if(U!==G){var V=G;G<U&&(V+=M);for(var H=U;H<V;H++){var J=H%M,Q=(H+1)%M;if(!N.continuous[J]||!N.continuous[Q]){P.vertexIndices[R]=[U,J],P.vertexIndices.splice(R+1,0,[Q,G]),P.vertices.splice(2*(R+1),0,P.vertices[2*R],P.vertices[2*R+1]);break}}}}he.push({bevelI:e,angle:t,size:r,boundary:P,reverseMap:o,insetPoints:s})},fe=1;fe<=l._bevelSegments;fe++){var ve=de(fe);if("break"===ve)break}for(var pe=function(e,t,r){for(var i=0,n=e.boundary.vertexIndices.length;i<n&&r(e.boundary.vertexIndices[t]);)t=(t+1)%n,i++;return i},me=1;me<he.length;me++){var ge=he[me-1],ye=he[me],Ae=ge.boundary.vertexIndices.length,we=ye.boundary.vertexIndices.length;if(!Ae||!we)break;for(var Ee=N.concave.length,Ce=0,De=Oe(Ce,M);!ge.boundary.vertexIndices.filter(De).length||!ye.boundary.vertexIndices.filter(De).length;)Ce++,De=Oe(Ce,M);var Se=ge.boundary.vertexIndices.findIndex(De),Be=ye.boundary.vertexIndices.findIndex(De);do{Se=(Se+1)%Ae}while(De(ge.boundary.vertexIndices[Se]));do{Be=(Be+1)%we}while(De(ye.boundary.vertexIndices[Be]));var Te=Ce=(Ce+1)%M,ke=void 0,_e=void 0,Me=l.buildBevelVert(N,ge,(Se-1+Ae)%Ae),Le=l.buildBevelVert(N,ye,(Be-1+we)%we),Ne=!1;do{var Fe=pe(ge,Se,De=Oe(Ce,M)),Ie=pe(ye,Be,De),je=Ne;if(Ne=!1,Fe&&!Ie){for(var Pe=0;Pe<Fe;Pe++)ke=l.buildBevelVert(N,ge,(Se+Pe)%Ae,Pe/(Fe-1)),S.push(Me.topN,ke.topP,Le.topN),S.push(ke.bottomP,Me.bottomN,Le.bottomN),Me=ke;Ne=!0}else if(!Fe&&Ie)for(var Re=0;Re<Ie;Re++)_e=l.buildBevelVert(N,ye,(Be+Re)%we,Re/(Ie-1)),S.push(Le.topN,Me.topP,_e.topP),S.push(Me.bottomP,Le.bottomN,_e.bottomP),Le=_e;else if(Fe&&Ie)if(ke=l.buildBevelVert(N,ge,Se,0),_e=l.buildBevelVert(N,ye,Be,0),je?(S.push(Me.topN,_e.topP,Le.topN),S.push(Me.topN,ke.topP,_e.topP),S.push(_e.bottomP,Me.bottomN,Le.bottomN),S.push(ke.bottomP,Me.bottomN,_e.bottomP)):(S.push(Me.topN,ke.topP,Le.topN),S.push(Le.topN,ke.topP,_e.topP),S.push(ke.bottomP,Me.bottomN,Le.bottomN),S.push(ke.bottomP,Le.bottomN,_e.bottomP)),Me=ke,Le=_e,Fe===Ie)for(var ze=1;ze<Fe;ze++)ke=l.buildBevelVert(N,ge,(Se+ze)%Ae,ze/(Fe-1)),_e=l.buildBevelVert(N,ye,(Be+ze)%we,ze/(Ie-1)),S.push(Me.topN,ke.topP,Le.topN),S.push(Le.topN,ke.topP,_e.topP),S.push(ke.bottomP,Me.bottomN,Le.bottomN),S.push(ke.bottomP,Le.bottomN,_e.bottomP),Me=ke,Le=_e;else if(Fe>Ie)for(var Ue=Fe/Ie,Ge=0,Ve=1;Ve<Fe;Ve++)ke=l.buildBevelVert(N,ge,(Se+Ve)%Ae,Ve/(Fe-1)),S.push(Me.topN,ke.topP,Le.topN),S.push(ke.bottomP,Me.bottomN,Le.bottomN),Me=ke,Ve>(Ge+1)*Ue&&(Ge++,_e=l.buildBevelVert(N,ye,(Be+Ge)%we,Ge/(Ie-1)),S.push(Le.topN,ke.topP,_e.topP),S.push(ke.bottomP,Le.bottomN,_e.bottomP),Le=_e);else for(var He=Ie/Fe,Je=0,Qe=1;Qe<Ie;Qe++)_e=l.buildBevelVert(N,ye,(Be+Qe)%we,Qe/(Ie-1)),S.push(Le.topN,ke.topP,_e.topP),S.push(ke.bottomP,Le.bottomN,_e.bottomP),Le=_e,Qe>(Je+1)*He&&(Je++,ke=l.buildBevelVert(N,ge,(Se+Je)%Ae,Je/(Fe-1)),S.push(Me.topN,ke.topP,Le.topN),S.push(ke.bottomP,Me.bottomN,Le.bottomN),Me=ke);Se=(Se+Fe)%Ae,Be=(Be+Ie)%we,Ce=(Ce+1)%Ee}while(Ce!==Te)}for(var Ye=he[0],We=0,Xe=Ye.boundary.vertexCount;We<Xe;We++){var Ke=l.buildBevelVert(N,Ye,We),qe=l.buildBevelVert(N,Ye,(We+1)%Xe);S.push(qe.topP,Ke.topN,Ke.bottomN),S.push(qe.topP,Ke.bottomN,qe.bottomP)}var Ze=he[he.length-1],$e=be({windingRule:he.length>1?Y.POSITIVE:Y.ODD,elementType:W.POLYGONS,vertexSize:2,strict:!0,contours:[Ze.insetPoints].concat(Object(y.a)(a))});if(!$e)throw new Error("Error generating geometry for surface");for(var et=0;et<3*$e.elementCount;et+=3){var tt=l.buildSurfaceVert($e,$e.elements[et+0]),nt=l.buildSurfaceVert($e,$e.elements[et+1]),it=l.buildSurfaceVert($e,$e.elements[et+2]);S.push(tt.top,nt.top,it.top),S.push(it.bottom,nt.bottom,tt.bottom)}l.vertexCache={}}l._buffer.shrink();var at=new r.BufferAttribute(Uint32Array.from(S),1),g=new r.BufferAttribute(l._buffer.positions,3),ot=new r.BufferAttribute(l._buffer.normals,3),st=new r.BufferAttribute(l._buffer.uvs,2);return g.needsUpdate=!0,ot.needsUpdate=!0,st.needsUpdate=!0,at.needsUpdate=!0,l.setAttribute("position",g),l.setAttribute("normal",ot),l.setAttribute("uv",st),l.setIndex(at),l}return Object(w.a)(n,[{key:"buildSurfaceVert",value:function(e,t){var r=t.toString();if(r in this.vertexCache)return this.vertexCache[r];var i=e.vertices[2*t+0],n=e.vertices[2*t+1],s=(i-this._minX)/this._width,o=(n-this._minY)/this._height,a=this._buffer.get(2),l=3*a,c=2*a,h={top:a+0,bottom:a+1};return this._buffer.positions[l+0]=i,this._buffer.positions[l+1]=n,this._buffer.positions[l+2]=this._depth,this._buffer.normals[l+0]=0,this._buffer.normals[l+1]=0,this._buffer.normals[l+2]=1,this._buffer.uvs[c+0]=s,this._buffer.uvs[c+1]=o,this._buffer.positions[l+3]=i,this._buffer.positions[l+4]=n,this._buffer.positions[l+5]=0,this._buffer.normals[l+3]=0,this._buffer.normals[l+4]=0,this._buffer.normals[l+5]=-1,this._buffer.uvs[c+2]=s,this._buffer.uvs[c+3]=o,this.vertexCache[r]=h,h}},{key:"buildBevelVert",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n="".concat(t.bevelI,":").concat(r);if(n in this.vertexCache)return this.vertexCache[n];var a,o,l,c,h=Object(f.a)(t.boundary.vertexIndices[r],2),s=h[0],d=h[1];s!==d?(o=s,a=d,c=!1,l=e.continuous[o]&&e.continuous[a]):(o=((a=s)-1+e.count)%e.count,c=e.concave[a]&&t.bevelI>0,l=e.continuous[a]||c);var u=Math.cos(t.angle),v=Math.sin(t.angle),p=2*r,m=2*a,y=2*o,g=t.boundary.vertices[p+0],A=t.boundary.vertices[p+1],w=(1-v)*this._bevelSize,x=(g-this._minX)/this._width,O=(A-this._minY)/this._height,E=e.normals[m+0],b=e.normals[m+1],C=e.normals[y+0],D=e.normals[y+1];if(c){E+=(C-E)*(1-i),b+=(D-b)*(1-i);var S=Math.sqrt(E*E+b*b);E/=S,b/=S}var B=this._buffer.get(l?2:4),T=3*B,k=2*B,_={i:r,fi:a,topP:B+0,topN:B+0,bottomP:B+1,bottomN:B+1};return this._buffer.positions[T+0]=g,this._buffer.positions[T+1]=A,this._buffer.positions[T+2]=this._depth-w,this._buffer.normals[T+0]=E*u,this._buffer.normals[T+1]=b*u,this._buffer.normals[T+2]=v,this._buffer.uvs[k+0]=x,this._buffer.uvs[k+1]=O,this._buffer.positions[T+3]=g,this._buffer.positions[T+4]=A,this._buffer.positions[T+5]=w,this._buffer.normals[T+3]=E*u,this._buffer.normals[T+4]=b*u,this._buffer.normals[T+5]=-v,this._buffer.uvs[k+2]=O,this._buffer.uvs[k+3]=x,l||(B+=2,T+=6,k+=4,_.topP=B+0,_.bottomP=B+1,this._buffer.positions[T+0]=g,this._buffer.positions[T+1]=A,this._buffer.positions[T+2]=this._depth-w,this._buffer.normals[T+0]=C*u,this._buffer.normals[T+1]=D*u,this._buffer.normals[T+2]=v,this._buffer.uvs[k+0]=x,this._buffer.uvs[k+1]=O,this._buffer.positions[T+3]=g,this._buffer.positions[T+4]=A,this._buffer.positions[T+5]=w,this._buffer.normals[T+3]=C*u,this._buffer.normals[T+4]=D*u,this._buffer.normals[T+5]=-v,this._buffer.uvs[k+2]=O,this._buffer.uvs[k+3]=x),this.vertexCache[n]=_,_}}]),n}(r.BufferGeometry),Ce=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s,o,a,l=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,subdivisions:40,roundness:0,extrudeDepth:0,surfaceMaxCount:100,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters),c=Math.abs(l.width),h=Math.abs(null!==(i=l.height)&&void 0!==i?i:l.width),u=null!==(n=e.shape)&&void 0!==n?n:null==t?void 0:t.shape,d=null!==(s=null==u?void 0:u.roundness)&&void 0!==s?s:l.roundness;void 0!==u&&(u instanceof re?u.width===c&&u.height===h||u.applySize(c,h):u=new re(c,h).fromJSON(u),void 0!==(null===(o=e.parameters)||void 0===o?void 0:o.roundness)&&(null===(a=e.parameters)||void 0===a?void 0:a.roundness)>0&&u.update(!1));var p=null!=u?u:new re(c,h);return{parameters:Object.assign(l,{width:c,height:h,roundness:d}),shape:p}}},{key:"build",value:function(e){var a,t=e.parameters,r=t.extrudeDepth,n=t.extrudeBevelSize,i=t.extrudeBevelSegments,o=t.subdivisions,s=t.roundness,l=t.surfaceMaxCount;return e.shape.roundness=s,a=r<=0?new we(e.shape,o,l):new Ee(e.shape,r,n,o,i),Object.assign(a,{userData:Object.assign(Object.assign({},e),{type:"VectorGeometry"})})}}]),e}(),De=2*Math.PI;function Se(e,t,r,i,n,s){for(var o=-t/r,l=0;l<=r;l++){var c=o*l,h=Math.sin(c)*i,d=Math.cos(c)*n;e.addPoint(Be(h,d))}return t<De?s>0?ke(e,i,n,s):e.addPoint(Be(0,0)):(e.removePoint(e.points[e.points.length-1]),s>0&&_e(e,i,n,s)),1}function Be(e,t){return new u(r.MathUtils.generateUUID(),new r.Vector2(e,t))}function Te(e,t,r,i,n,s){var o=Be(e,t);return o.controls[0].position.set(r,i),o.controls[1].position.set(n,s),o}function ke(e,t,r,i){Me(e,t,r,i).forEach((function(t){return e.addPoint(t)}))}function _e(e,t,r,i){var n=Me(e,t,r,i),s=new re;n.forEach((function(e){return s.addPoint(e)})),s.isClosed=!0,e.shapeHoles.push(s)}function Me(e,t,i,n){var s=n*t/100,o=s*(Math.abs(i)/Math.abs(t)),a=new r.Vector2(s/t,o/i),l=e.points.map((function(e){return e.clone()})).reverse();return l.forEach((function(e){e.position.multiply(a);var t=e.controls[0].position.clone().multiply(a),r=e.controls[1].position.clone().multiply(a);e.controls[0].position.copy(r),e.controls[1].position.copy(t)})),l}var Le=function(e){Object(x.a)(n,e);var t=S(n);function n(e,o,i,l,s,c,a,h,d,f,u,v){var m;Object(A.a)(this,n),m=t.call(this);var w,x,O,E,C,D,S,B,p=[],T=[],k=[],g=[],_=[],M=[],L=[],N=new r.Vector3,F=new r.Vector3,b=new r.Vector3,I=new r.Vector3,j=new r.Vector3,P=new r.Vector3,R=new r.Vector3,z=new r.Vector3,U=new r.Vector3,G=new r.Vector3,V=new r.Vector3,H=s-h,J=i-2*h+.001,Q=J/c,Y=Math.ceil(a*c),W=J/Y,X=-J/2,K=2*Math.PI/f,Z=Math.PI/2/v,$=Math.min((1-u/100)*h,h-.1),ee=h-$,te=e&&1==c;function re(t,r){var i=Math.PI/2;D=r*W,B=2*Math.PI*(D%Q)/Q+i,D+=X,S=Math.sin(B)*H,C=Math.cos(B)*H,e?t.set(C,S,D):t.set(C,D,S)}te&&(v=0),re(b,-1),re(I,0),j.copy(b);for(var q=b.distanceTo(I),ne=q*Y+2*ee,ie=ne-ee,ae=0;ae<=Y;ae++){re(N,ae),V.subVectors(N,j).normalize(),j.copy(N),U.copy(N).setComponent(+e+1,0).normalize(),G.crossVectors(V,U).normalize();for(var oe=0==ae?3*Math.PI/2:Z,se=0==ae?0:ie,ue=0,le=0;ue<=f;le=++ue*K){if(P.addVectors(b.copy(U).multiplyScalar(h*Math.cos(le)),I.copy(G).multiplyScalar(h*Math.sin(le))),z.copy(P).normalize(),0==ae||ae==Y){I.copy(z).multiplyScalar($),F.addVectors(N,I);for(var ce=0,he=oe;ce<v;he=++ce*Z+oe){R.addVectors(b.copy(V).multiplyScalar(ee*Math.sin(he)),I.copy(z).multiplyScalar(ee*Math.cos(he))),I.addVectors(F,R),R.normalize(),_.push(I.x,I.y,I.z),M.push(R.x,R.y,R.z);var de=+(0==ae)+Math.sin(he);L.push((se+ee*de)/ne,ue/f,0)}}I.addVectors(N,P),T.push(I.x,I.y,I.z),k.push(z.x,z.y,z.z),g.push((ee+ae*q)/ne,ue/f)}}for(var fe=_.length/2,ve=0;ve<v;ve++)for(var pe=0;pe<=f;pe++){var me=fe+3*(pe*v+ve),ge=3*((f-pe)*v+v-ve-1);T.push.apply(T,Object(y.a)(_.slice(me,me+3))),T.unshift.apply(T,Object(y.a)(_.slice(ge,ge+3))),k.push.apply(k,Object(y.a)(M.slice(me,me+3))),k.unshift.apply(k,Object(y.a)(M.slice(ge,ge+3))),g.push.apply(g,Object(y.a)(L.slice(me,me+2))),g.unshift.apply(g,Object(y.a)(L.slice(ge,ge+2)))}for(var ye=f+1,Ae=0;Ae<Y+2*v;Ae++)for(var be=te&&Ae==Y-1,we=0;we<ye-1;we++)x=(w=Ae*ye+we)+1,O=be?we:w+ye,E=be?we+1:x+ye,p.push(w,x,O,x,E,O);if(w=T.length/3-f-1,!te)for(var xe=0;xe<f-2;xe++)p.push(w,w+xe+1,w+xe+2),p.push(0,xe+2,xe+1);return m.setIndex(p),m.setAttribute("position",new r.Float32BufferAttribute(T,3)),m.setAttribute("normal",new r.Float32BufferAttribute(k,3)),m.setAttribute("uv",new r.Float32BufferAttribute(g,2)),m}return n}(r.BufferGeometry),Ne=new r.Matrix4,Fe=new r.Object3D,Ie=new r.Vector3,je=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this)).isGeometry=!0,e.uuid=r.MathUtils.generateUUID(),e.name="",e.type="Geometry",e.vertices=[],e.colors=[],e.faces=[],e.faceVertexUvs=[[]],e.morphTargets=[],e.morphNormals=[],e.skinWeights=[],e.skinIndices=[],e.lineDistances=[],e.boundingBox=null,e.boundingSphere=null,e.elementsNeedUpdate=!1,e.verticesNeedUpdate=!1,e.uvsNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.lineDistancesNeedUpdate=!1,e.groupsNeedUpdate=!1,e}return Object(w.a)(n,[{key:"applyMatrix4",value:function(e){for(var t=(new r.Matrix3).getNormalMatrix(e),n=0,o=this.vertices.length;n<o;n++)this.vertices[n].applyMatrix4(e);for(var l=0,c=this.faces.length;l<c;l++){var h=this.faces[l];h.normal.applyMatrix3(t).normalize();for(var d=0,f=h.vertexNormals.length;d<f;d++)h.vertexNormals[d].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this}},{key:"rotateX",value:function(e){return Ne.makeRotationX(e),this.applyMatrix4(Ne),this}},{key:"rotateY",value:function(e){return Ne.makeRotationY(e),this.applyMatrix4(Ne),this}},{key:"rotateZ",value:function(e){return Ne.makeRotationZ(e),this.applyMatrix4(Ne),this}},{key:"translate",value:function(e,t,r){return Ne.makeTranslation(e,t,r),this.applyMatrix4(Ne),this}},{key:"scale",value:function(e,t,r){return Ne.makeScale(e,t,r),this.applyMatrix4(Ne),this}},{key:"lookAt",value:function(e){return Fe.lookAt(e),Fe.updateMatrix(),this.applyMatrix4(Fe.matrix),this}},{key:"fromBufferGeometry",value:function(e){var t=this,i=null!==e.index?e.index:void 0,n=e.attributes;if(void 0===n.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var s=n.position,o=n.normal,a=n.color,l=n.uv,c=n.uv2;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var h=0;h<s.count;h++)t.vertices.push((new r.Vector3).fromBufferAttribute(s,h)),void 0!==a&&t.colors.push((new r.Color).fromBufferAttribute(a,h));function d(e,i,n,s){var h=void 0===a?[]:[t.colors[e].clone(),t.colors[i].clone(),t.colors[n].clone()],u=void 0===o?[]:[(new r.Vector3).fromBufferAttribute(o,e),(new r.Vector3).fromBufferAttribute(o,i),(new r.Vector3).fromBufferAttribute(o,n)],d=new Re(e,i,n,u,h,s);t.faces.push(d),void 0!==l&&t.faceVertexUvs[0].push([(new r.Vector2).fromBufferAttribute(l,e),(new r.Vector2).fromBufferAttribute(l,i),(new r.Vector2).fromBufferAttribute(l,n)]),void 0!==c&&t.faceVertexUvs[1].push([(new r.Vector2).fromBufferAttribute(c,e),(new r.Vector2).fromBufferAttribute(c,i),(new r.Vector2).fromBufferAttribute(c,n)])}var u=e.groups;if(u.length>0)for(var f=0;f<u.length;f++)for(var v=u[f],m=v.start,y=m,A=m+v.count;y<A;y+=3)void 0!==i?d(i.getX(y),i.getX(y+1),i.getX(y+2),v.materialIndex):d(y,y+1,y+2,v.materialIndex);else if(void 0!==i)for(var w=0;w<i.count;w+=3)d(i.getX(w),i.getX(w+1),i.getX(w+2));else for(var x=0;x<s.count;x+=3)d(x,x+1,x+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ie).negate(),this.translate(Ie.x,Ie.y,Ie.z),this}},{key:"normalize",value:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,i=0===t?1:1/t,n=new r.Matrix4;return n.set(i,0,0,-i*e.x,0,i,0,-i*e.y,0,0,i,-i*e.z,0,0,0,1),this.applyMatrix4(n),this}},{key:"computeFaceNormals",value:function(){for(var e=new r.Vector3,t=new r.Vector3,n=0,o=this.faces.length;n<o;n++){var l=this.faces[n],c=this.vertices[l.a],h=this.vertices[l.b],d=this.vertices[l.c];e.subVectors(d,h),t.subVectors(c,h),e.cross(t),e.normalize(),l.normal.copy(e)}}},{key:"computeVertexNormals",value:function(){for(var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=new Array(this.vertices.length),n=0,o=this.vertices.length;n<o;n++)t[n]=new r.Vector3;if(e)for(var l=new r.Vector3,c=new r.Vector3,h=0,d=this.faces.length;h<d;h++){var f=this.faces[h],v=this.vertices[f.a],m=this.vertices[f.b],y=this.vertices[f.c];l.subVectors(y,m),c.subVectors(v,m),l.cross(c),t[f.a].add(l),t[f.b].add(l),t[f.c].add(l)}else{this.computeFaceNormals();for(var A=0,w=this.faces.length;A<w;A++){var x=this.faces[A];t[x.a].add(x.normal),t[x.b].add(x.normal),t[x.c].add(x.normal)}}for(var O=0,E=this.vertices.length;O<E;O++)t[O].normalize();for(var C=0,D=this.faces.length;C<D;C++){var S=this.faces[C],B=S.vertexNormals;3===B.length?(B[0].copy(t[S.a]),B[1].copy(t[S.b]),B[2].copy(t[S.c])):(B[0]=t[S.a].clone(),B[1]=t[S.b].clone(),B[2]=t[S.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}},{key:"computeFlatVertexNormals",value:function(){this.computeFaceNormals();for(var e=0,t=this.faces.length;e<t;e++){var r=this.faces[e],n=r.vertexNormals;3===n.length?(n[0].copy(r.normal),n[1].copy(r.normal),n[2].copy(r.normal)):(n[0]=r.normal.clone(),n[1]=r.normal.clone(),n[2]=r.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)}},{key:"computeMorphNormals",value:function(){for(var e=0,t=this.faces.length;e<t;e++){var o=this.faces[e];o.__originalFaceNormal?o.__originalFaceNormal.copy(o.normal):o.__originalFaceNormal=o.normal.clone(),o.__originalVertexNormals||(o.__originalVertexNormals=[]);for(var l=0,c=o.vertexNormals.length;l<c;l++)o.__originalVertexNormals[l]?o.__originalVertexNormals[l].copy(o.vertexNormals[l]):o.__originalVertexNormals[l]=o.vertexNormals[l].clone()}var h=new n;h.faces=this.faces;for(var d=0,f=this.morphTargets.length;d<f;d++){if(!this.morphNormals[d]){this.morphNormals[d]={},this.morphNormals[d].faceNormals=[],this.morphNormals[d].vertexNormals=[];for(var v=this.morphNormals[d].faceNormals,m=this.morphNormals[d].vertexNormals,y=0,A=this.faces.length;y<A;y++){var w=new r.Vector3,x={a:new r.Vector3,b:new r.Vector3,c:new r.Vector3};v.push(w),m.push(x)}}var O=this.morphNormals[d];h.vertices=this.morphTargets[d].vertices,h.computeFaceNormals(),h.computeVertexNormals();for(var E=0,C=this.faces.length;E<C;E++){var D=this.faces[E],S=O.faceNormals[E],B=O.vertexNormals[E];S.copy(D.normal),B.a.copy(D.vertexNormals[0]),B.b.copy(D.vertexNormals[1]),B.c.copy(D.vertexNormals[2])}}for(var T=0,k=this.faces.length;T<k;T++){var _=this.faces[T];_.normal=_.__originalFaceNormal,_.vertexNormals=_.__originalVertexNormals}}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new r.Box3),this.boundingBox.setFromPoints(this.vertices)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new r.Sphere),this.boundingSphere.setFromPoints(this.vertices)}},{key:"merge",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e&&e.isGeometry){var n,s=this.vertices.length,o=this.vertices,a=e.vertices,l=this.faces,c=e.faces,h=this.colors,u=e.colors;void 0!==t&&(n=(new r.Matrix3).getNormalMatrix(t));for(var d=0,f=a.length;d<f;d++){var v=a[d].clone();void 0!==t&&v.applyMatrix4(t),o.push(v)}for(var m=0,y=u.length;m<y;m++)h.push(u[m].clone());for(var A=0,w=c.length;A<w;A++){var x=c[A],O=void 0,E=void 0,C=x.vertexNormals,D=x.vertexColors,S=new Re(x.a+s,x.b+s,x.c+s);S.normal.copy(x.normal),void 0!==n&&S.normal.applyMatrix3(n).normalize();for(var B=0,T=C.length;B<T;B++)O=C[B].clone(),void 0!==n&&O.applyMatrix3(n).normalize(),S.vertexNormals.push(O);S.color.copy(x.color);for(var k=0,_=D.length;k<_;k++)E=D[k],S.vertexColors.push(E.clone());S.materialIndex=x.materialIndex+i,l.push(S)}for(var M=0,L=e.faceVertexUvs.length;M<L;M++){var N=e.faceVertexUvs[M];void 0===this.faceVertexUvs[M]&&(this.faceVertexUvs[M]=[]);for(var F=0,I=N.length;F<I;F++){for(var j=N[F],P=[],R=0,z=j.length;R<z;R++)P.push(j[R].clone());this.faceVertexUvs[M].push(P)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)}},{key:"mergeMesh",value:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)}},{key:"mergeVertices",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4,t={},r=[],i=[],n=Math.pow(10,e),o=0,l=this.vertices.length;o<l;o++){var c=this.vertices[o],h="".concat(Math.round(c.x*n),"_").concat(Math.round(c.y*n),"_").concat(Math.round(c.z*n));void 0===t[h]?(t[h]=o,r.push(this.vertices[o]),i[o]=r.length-1):i[o]=i[t[h]]}for(var s=[],d=0,f=this.faces.length;d<f;d++){var v=this.faces[d];v.a=i[v.a],v.b=i[v.b],v.c=i[v.c];for(var m=[v.a,v.b,v.c],y=0;y<3;y++)if(m[y]===m[(y+1)%3]){s.push(d);break}}for(var A=s.length-1;A>=0;A--){var w=s[A];this.faces.splice(w,1);for(var x=0,O=this.faceVertexUvs.length;x<O;x++)this.faceVertexUvs[x].splice(w,1)}var E=this.vertices.length-r.length;return this.vertices=r,E}},{key:"setFromPoints",value:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var o=e[t];this.vertices.push(new r.Vector3(o.x,o.y,o.z||0))}return this}},{key:"sortFacesByMaterialIndex",value:function(){for(var e=this.faces,t=e.length,r=0;r<t;r++)e[r]._id=r;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var n,s,o=this.faceVertexUvs[0],i=this.faceVertexUvs[1];o&&o.length===t&&(n=[]),i&&i.length===t&&(s=[]);for(var l=0;l<t;l++){var c=e[l]._id;n&&n.push(o[c]),s&&s.push(i[c])}n&&(this.faceVertexUvs[0]=n),s&&(this.faceVertexUvs[1]=s)}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var r in t)void 0!==t[r]&&(e[r]=t[r]);return e}for(var n=[],o=0;o<this.vertices.length;o++){var l=this.vertices[o];n.push(l.x,l.y,l.z)}for(var c=[],i=[],h={},s=[],d={},a=[],f={},v=0;v<this.faces.length;v++){var m=this.faces[v],y=void 0!==this.faceVertexUvs[0][v],A=m.normal.length()>0,w=m.vertexNormals.length>0,x=1!==m.color.r||1!==m.color.g||1!==m.color.b,O=m.vertexColors.length>0,E=0;if(E=B(E,0,0),E=B(E,1,!0),E=B(E,2,!1),E=B(E,3,y),E=B(E,4,A),E=B(E,5,w),E=B(E,6,x),E=B(E,7,O),c.push(E),c.push(m.a,m.b,m.c),c.push(m.materialIndex),y){var C=this.faceVertexUvs[0][v];c.push(k(C[0]),k(C[1]),k(C[2]))}if(A&&c.push(T(m.normal)),w){var D=m.vertexNormals;c.push(T(D[0]),T(D[1]),T(D[2]))}if(x&&c.push(u(m.color)),O){var S=m.vertexColors;c.push(u(S[0]),u(S[1]),u(S[2]))}}function B(e,t,r){return r?e|1<<t:e&~(1<<t)}function T(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==h[t]||(h[t]=i.length/3,i.push(e.x,e.y,e.z)),h[t]}function u(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==d[t]||(d[t]=s.length,s.push(e.getHex())),d[t]}function k(e){var t=e.x.toString()+e.y.toString();return void 0!==f[t]||(f[t]=a.length/2,a.push(e.x,e.y)),f[t]}return e.data={},e.data.vertices=n,e.data.normals=i,s.length>0&&(e.data.colors=s),a.length>0&&(e.data.uvs=[a]),e.data.faces=c,e}},{key:"clone",value:function(){return(new n).copy(this)}},{key:"copy",value:function(e){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;for(var t=e.vertices,r=0,n=t.length;r<n;r++)this.vertices.push(t[r].clone());for(var o=e.colors,l=0,c=o.length;l<c;l++)this.colors.push(o[l].clone());for(var i=e.faces,h=0,d=i.length;h<d;h++)this.faces.push(i[h].clone());for(var f=0,v=e.faceVertexUvs.length;f<v;f++){var m=e.faceVertexUvs[f];void 0===this.faceVertexUvs[f]&&(this.faceVertexUvs[f]=[]);for(var y=0,A=m.length;y<A;y++){for(var w=m[y],x=[],O=0,E=w.length;O<E;O++){var C=w[O];x.push(C.clone())}this.faceVertexUvs[f].push(x)}}for(var D=e.morphTargets,S=0,B=D.length;S<B;S++){var T={};if(T.name=D[S].name,void 0!==D[S].vertices){T.vertices=[];for(var k=0,_=D[S].vertices.length;k<_;k++)T.vertices.push(D[S].vertices[k].clone())}if(void 0!==D[S].normals){T.normals=[];for(var M=0,L=D[S].normals.length;M<L;M++)T.normals.push(D[S].normals[M].clone())}this.morphTargets.push(T)}for(var s=e.morphNormals,N=0,F=s.length;N<F;N++){var I={};if(void 0!==s[N].vertexNormals){I.vertexNormals=[];for(var j=0,P=s[N].vertexNormals.length;j<P;j++){var R=s[N].vertexNormals[j],z={};z.a=R.a.clone(),z.b=R.b.clone(),z.c=R.c.clone(),I.vertexNormals.push(z)}}if(void 0!==s[N].faceNormals){I.faceNormals=[];for(var U=0,G=s[N].faceNormals.length;U<G;U++)I.faceNormals.push(s[N].faceNormals[U].clone())}this.morphNormals.push(I)}for(var V=e.skinWeights,H=0,J=V.length;H<J;H++)this.skinWeights.push(V[H].clone());for(var a=e.skinIndices,Q=0,Y=a.length;Q<Y;Q++)this.skinIndices.push(a[Q].clone());for(var W=e.lineDistances,X=0,K=W.length;X<K;X++)this.lineDistances.push(W[X]);var Z=e.boundingBox;null!==Z&&(this.boundingBox=Z.clone());var $=e.boundingSphere;return null!==$&&(this.boundingSphere=$.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this}},{key:"toBufferGeometry",value:function(){var e=(new Pe).fromGeometry(this),t=new r.BufferGeometry,i=new Float32Array(3*e.vertices.length);if(t.setAttribute("position",new r.BufferAttribute(i,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);t.setAttribute("normal",new r.BufferAttribute(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var o=new Float32Array(3*e.colors.length);t.setAttribute("color",new r.BufferAttribute(o,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var l=new Float32Array(2*e.uvs.length);t.setAttribute("uv",new r.BufferAttribute(l,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var c=new Float32Array(2*e.uvs2.length);t.setAttribute("uv2",new r.BufferAttribute(c,2).copyVector2sArray(e.uvs2))}for(var h in t.groups=e.groups,e.morphTargets){for(var d=[],f=e.morphTargets[h],v=0,m=f.length;v<m;v++){var y=f[v],A=new r.Float32BufferAttribute(3*y.data.length,3);A.name=y.name,d.push(A.copyVector3sArray(y.data))}t.morphAttributes[h]=d}if(e.skinIndices.length>0){var w=new r.Float32BufferAttribute(4*e.skinIndices.length,4);t.setAttribute("skinIndex",w.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var x=new r.Float32BufferAttribute(4*e.skinWeights.length,4);t.setAttribute("skinWeight",x.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(t.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(t.boundingBox=e.boundingBox.clone()),t}},{key:"computeTangents",value:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")}},{key:"computeLineDistances",value:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}},{key:"applyMatrix",value:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(r.EventDispatcher);je.createBufferGeometryFromObject=function(e){var t=new r.BufferGeometry,i=e.geometry;if(e.isPoints||e.isLine){var n=new r.Float32BufferAttribute(3*i.vertices.length,3),o=new r.Float32BufferAttribute(3*i.colors.length,3);if(t.setAttribute("position",n.copyVector3sArray(i.vertices)),t.setAttribute("color",o.copyColorsArray(i.colors)),i.lineDistances&&i.lineDistances.length===i.vertices.length){var l=new r.Float32BufferAttribute(i.lineDistances.length,1);t.setAttribute("lineDistance",l.copyArray(i.lineDistances))}null!==i.boundingSphere&&(t.boundingSphere=i.boundingSphere.clone()),null!==i.boundingBox&&(t.boundingBox=i.boundingBox.clone())}else e.isMesh&&(t=i.toBufferGeometry());return t};var Pe=function(){function e(){Object(A.a)(this,e),this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}return Object(w.a)(e,[{key:"computeGroups",value:function(e){var t,i,r,n=[],s=e.faces;for(i=0;i<s.length;i++){var o=s[i];o.materialIndex!==r&&(r=o.materialIndex,void 0!==t&&(t.count=3*i-t.start,n.push(t)),t={start:3*i,materialIndex:r})}void 0!==t&&(t.count=3*i-t.start,n.push(t)),this.groups=n}},{key:"fromGeometry",value:function(e){var t,n=e.faces,i=e.vertices,o=e.faceVertexUvs,s=o[0]&&o[0].length>0,l=o[1]&&o[1].length>0,a=e.morphTargets,c=a.length;if(c>0){t=[];for(var h=0;h<c;h++)t[h]={name:a[h].name,data:[]};this.morphTargets.position=t}var d,f=e.morphNormals,u=f.length;if(u>0){d=[];for(var v=0;v<u;v++)d[v]={name:f[v].name,data:[]};this.morphTargets.normal=d}var p=e.skinIndices,m=e.skinWeights,y=p.length===i.length,g=m.length===i.length;i.length>0&&0===n.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(var A=0;A<n.length;A++){var w=n[A];this.vertices.push(i[w.a],i[w.b],i[w.c]);var x=w.vertexNormals;if(3===x.length)this.normals.push(x[0],x[1],x[2]);else{var O=w.normal;this.normals.push(O,O,O)}var E=w.vertexColors;if(3===E.length)this.colors.push(E[0],E[1],E[2]);else{var C=w.color;this.colors.push(C,C,C)}if(!0===s){var D=o[0][A];void 0!==D?this.uvs.push(D[0],D[1],D[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",A),this.uvs.push(new r.Vector2,new r.Vector2,new r.Vector2))}if(!0===l){var S=o[1][A];void 0!==S?this.uvs2.push(S[0],S[1],S[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",A),this.uvs2.push(new r.Vector2,new r.Vector2,new r.Vector2))}for(var B=0;B<c;B++){var T=a[B].vertices;t[B].data.push(T[w.a],T[w.b],T[w.c])}for(var k=0;k<u;k++){var _=f[k].vertexNormals[A];d[k].data.push(_.a,_.b,_.c)}y&&this.skinIndices.push(p[w.a],p[w.b],p[w.c]),g&&this.skinWeights.push(m[w.a],m[w.b],m[w.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}}]),e}(),Re=function(){function e(t,n,i,o,s){var l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;Object(A.a)(this,e),this.a=t,this.b=n,this.c=i,this.normal=o&&o.isVector3?o:new r.Vector3,this.vertexNormals=Array.isArray(o)?o:[],this.color=s&&s.isColor?s:new r.Color,this.vertexColors=Array.isArray(s)?s:[],this.materialIndex=l}return Object(w.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,r=e.vertexNormals.length;t<r;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(var n=0,o=e.vertexColors.length;n<o;n++)this.vertexColors[n]=e.vertexColors[n].clone();return this}}]),e}(),ze=["a","b","c"];function Ue(e,t){switch(t){case"c":return e.c;case"b":return e.b;case"a":default:return e.a}}function Ge(e,t,r){var i=Math.min(e,t)+"_"+Math.max(e,t);return r.get(i)}function Ve(e,t,r,i,n,s){var o,l=Math.min(e,t),a=Math.max(e,t),c=l+"_"+a;i.has(c)?o=i.get(c):(o={a:r[l],b:r[a],newEdge:null,faces:[]},i.set(c,o)),o.faces.push(n),s[e].edges.push(o),s[t].edges.push(o)}function He(e,t,r,i,n){e.push(new Re(t,r,i,void 0,void 0,n))}function Je(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function Qe(e,t,r,i){e.push([t.clone(),r.clone(),i.clone()])}var Ye=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Object(A.a)(this,e),this.subdivisions=t}return Object(w.a)(e,[{key:"modify",value:function(e){(e=e instanceof r.BufferGeometry?(new je).fromBufferGeometry(e):e.clone()).mergeVertices();for(var t=this.subdivisions;t-- >0;)this._smooth(e);return e.computeFaceNormals(),e.computeVertexNormals(),e}},{key:"_smooth",value:function(e){var i,t,s,n,a,o=new r.Vector3,l=e.vertices,c=e.faces,h=e.faceVertexUvs[0],u=void 0!==h&&h.length>0,d=[],p=new Map;!function(e,t,r,i){var n,s,o;for(n=0,s=e.length;n<s;n++)r[n]={edges:[]};for(n=0,s=t.length;n<s;n++)Ve((o=t[n]).a,o.b,e,i,o,r),Ve(o.b,o.c,e,i,o,r),Ve(o.c,o.a,e,i,o,r)}(l,c,d,p);for(var f,g,v,m,y,A,w,b,x,O,E,C,D,S,B=[],T=0,k=Array.from(p.keys());T<k.length;T++){var _=k[T];for(g=p.get(_),v=new r.Vector3,y=3/8,A=1/8,2!=(w=g.faces.length)&&(y=.5,A=0),v.addVectors(g.a,g.b).multiplyScalar(y),o.set(0,0,0),n=0;n<w;n++){for(m=g.faces[n],a=0;a<3&&((f=l[Ue(m,ze[a])])===g.a||f===g.b);a++);f&&o.add(f)}o.multiplyScalar(A),v.add(o),g.newEdge=B.length,B.push(v)}var M=[];for(t=0,s=l.length;t<s;t++){for(D=l[t],3==(i=(C=d[t].edges).length)?b=3/16:i>3&&(b=3/(8*i)),x=1-i*Number(b),O=b,i<=2&&2==i&&(x=3/4,O=1/8),S=D.clone().multiplyScalar(x),o.set(0,0,0),n=0;n<i;n++)f=(E=C[n]).a!==D?E.a:E.b,o.add(f);o.multiplyScalar(Number(O)),S.add(o),M.push(S)}var L,N,F,I,j,P,R,z=M.concat(B),U=M.length,G=[],V=[],H=new r.Vector2,J=new r.Vector2,Q=new r.Vector2;for(t=0,s=c.length;t<s;t++)m=c[t],He(G,L=Number(Ge(m.a,m.b,p).newEdge)+U,N=Number(Ge(m.b,m.c,p).newEdge)+U,F=Number(Ge(m.c,m.a,p).newEdge)+U,m.materialIndex),He(G,m.a,L,F,m.materialIndex),He(G,m.b,N,L,m.materialIndex),He(G,m.c,F,N,m.materialIndex),u&&(j=(I=h[t])[0],P=I[1],R=I[2],H.set(Je(j.x,P.x),Je(j.y,P.y)),J.set(Je(P.x,R.x),Je(P.y,R.y)),Q.set(Je(j.x,R.x),Je(j.y,R.y)),Qe(V,H,J,Q),Qe(V,j,H,Q),Qe(V,P,J,H),Qe(V,R,Q,J));e.vertices=z,e.faces=G,u&&(e.faceVertexUvs[0]=V)}}]),e}(),We=new r.Vector3,Xe=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var i,n,o,s=null!==(n=null!==(i=e.geometry)&&void 0!==i?i:null==t?void 0:t.geometry)&&void 0!==n?n:(new r.BufferGeometry).copy(new r.BoxBufferGeometry(100,100,100));void 0===t?(s.computeBoundingBox(),s.boundingBox.getSize(We),o={width:We.x,height:We.y,depth:We.z,subdivisions:0}):o=t.parameters;var a=Object.assign(Object.assign({},o),e.parameters);return{parameters:{width:Math.abs(a.width),height:Math.abs(a.height),depth:Math.abs(a.depth),subdivisions:Math.abs(a.subdivisions)},geometry:s}}},{key:"build",value:function(e){var t,n=e.parameters,i=n.width,o=n.height,s=n.depth,l=n.subdivisions,a=null!==(t=e.geometry)&&void 0!==t?t:(new r.BufferGeometry).copy(new r.BoxBufferGeometry(100,100,100)),c=a.userData.parameters;void 0===c?(a.computeBoundingBox(),a.boundingBox.getSize(We)):We.set(c.width,c.height,c.depth),i===We.x&&o===We.y&&s===We.z||a.scale(0===We.x?1:i/We.x,0===We.y?1:o/We.y,0===We.z?1:s/We.z);var h=a.originalGeometry;return l>0?(void 0===h||(null==c?void 0:c.subdivisions)>l)&&(void 0===h&&(h=a),a=new Ye(l).modify(h).toBufferGeometry()):(void 0!==h&&(a=h),h=void 0),void 0!==h&&Object.assign(a,{originalGeometry:h}),delete e.geometry,Object.assign(a,{userData:Object.assign(Object.assign({},e),{type:"NonParametricGeometry"})})}},{key:"loadFromUrl",value:function(e,t,i){var n=this;new r.BufferGeometryLoader(i).load(e,(function(e){var r=n.normalizeInputs({geometry:e});e.boundingBox.getSize(We);var i=100/We.x;Object.assign(r.parameters,{width:100,height:We.y*i,depth:We.z*i}),t(n.build(r))}))}}]),e}();function Ke(e,t,r){r.x=e.x*t.x,r.y=e.y,r.z=e.x*t.y}function qe(e,t,r,i,n,s){var o=t.clone().sub(e),a=r.clone().sub(e),l=o.angleTo(a);if(o.normalize(),a.normalize(),i===n){var c=o.add(a).normalize();s.copy(e).addScaledVector(c,i/Math.sin(l/2))}else{var h=o.angleTo(a);s.copy(e),s.addScaledVector(o,n/Math.sin(h)),s.addScaledVector(a,i/Math.sin(h))}}function Ze(e,t,r){var i=e.clone().sub(t),n=r.clone().sub(t);return i.projectOnVector(n),i.add(t)}var $e,et,tt,nt=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:4;Object(A.a)(this,n),e=t.call(this),i=Math.floor(Math.max(3,i)),c=Math.floor(c),a=Math.floor(a);var d,v=[],m=[],y=[],u=[],w=0,p=l/2,x=Math.PI/i,O=o*Math.cos(Math.PI/i),g=2*Math.PI/i,E=(i-2)*Math.PI/i,C=Math.PI-E,D=new r.Vector3(0,-p,0),S=new r.Vector3(0,p,0),B=new r.Vector2(o,-p),b=new r.Vector2(O,-p),T=new r.Vector2(0,S.y).sub(b),k=new r.Vector2(0,S.y).sub(B),_=new r.Vector2(T.y,-T.x).normalize(),M=new r.Vector2(k.y,-k.x).normalize(),L=o*Math.cos(Math.PI/i)*Math.tan((Math.PI-T.angle())/2)-1e-8;h=Math.min(h,L);var N=new r.Vector3(_.x,_.y,0),F=new r.Vector3(Math.cos(g)*N.x,N.y,Math.sin(g)*N.x);d=N.angleTo(F);var I=h/Math.tan((Math.PI-T.angle())/2),j=h/Math.tan((Math.PI-d)/2),P=new r.Vector3;if(!s){m.push(D.x,D.y,D.z),y.push(0,-1,0),u.push(0,0);var R=w++,z=[],U=B.clone(),G=I/Math.cos(Math.PI/i);U.x-=G;for(var V=0;V<i;V++){var H=V/i*Math.PI*2+x;Ke(U,new r.Vector2(Math.sin(H),Math.cos(H)),P),m.push(P.x,P.y,P.z),y.push(0,-1,0),u.push(0,0),z.push(w++)}for(var J=0;J<z.length;J++)v.push(z[J],R,z[(J+1)%z.length])}for(var Q=new r.Vector3,Y=new r.Vector3,W=new r.Vector3,X=new r.Vector3,K=new r.Vector3,Z=new r.Vector3,$=0;$<i;$++){var ee=$/i*Math.PI*2+x,te=($+.5)/i*Math.PI*2+x,re=($+1)/i*Math.PI*2+x,ne=new r.Vector2(Math.sin(ee),Math.cos(ee)),ie=new r.Vector2(Math.sin(te),Math.cos(te)),ae=new r.Vector2(Math.sin(re),Math.cos(re));Ke(B,ne,Y),Ke(B,ae,W),Ke(_,ie,Q),qe(S,Y,W,j,j,X),m.push(X.x,X.y,X.z),qe(Y,S,W,j,I,K),m.push(K.x,K.y,K.z),qe(W,Y,S,I,j,Z),m.push(Z.x,Z.y,Z.z),y.push(Q.x,Q.y,Q.z),y.push(Q.x,Q.y,Q.z),y.push(Q.x,Q.y,Q.z),u.push(0,0),u.push(0,0),u.push(0,0);var oe=w++,se=w++,ue=w++;if(v.push(oe,se,ue),h>0){var le=Y.clone().add(W).multiplyScalar(.5),ce=S.clone().sub(le).normalize(),he=D.clone().sub(le).normalize().add(ce).normalize().multiplyScalar(-1);Ve(le,Z.clone().sub(K),he,T.angle());var de=void 0,fe=void 0,ve=new r.Vector3;Ke(M,ae,ve);var pe=Z.clone().add(X).multiplyScalar(.5);pe=Ze(pe,W,S);var me=Z.clone().sub(X),ge=Ve(pe,me,ve,d,X.y),ye=Object(f.a)(ge,2);de=ye[0],fe=ye[1];var Ae=de,be=Ae.clone().setY(0).normalize(),we=new r.Vector3(0,-1,0),xe=be.clone().cross(we);He(Ae,be,we,xe);var Oe=T.angle(),Ee=Math.PI-Oe,Ce=S.clone();Ce.y-=h/Math.sin(Oe-Math.PI/2);for(var De=new r.Vector3,Se=[],Be=0;Be<a;Be++){for(var Te=[],ke=Math.PI/2-Ee*Be/a,_e=Math.cos(ke),Me=Math.sin(ke),Le=te,Ne=0;Ne<=Be;Ne++){var Fe=Math.cos(Le),Ie=Math.sin(Le);Q.x=_e*Ie,Q.y=Me,Q.z=_e*Fe,De.copy(Ce).addScaledVector(Q,h),m.push(De.x,De.y,De.z),y.push(Q.x,Q.y,Q.z),u.push(0,0),Te.push(w++),Le+=2*Math.PI/Be/i}Se.push(Te)}fe.reverse(),Se.push(fe);for(var je=Se.length-1,Pe=0;Pe<je;Pe++){var Re=Se[Pe],ze=Se[Pe+1],Ue=Re.length-1;v.push(ze[1],Re[0],ze[0]);for(var Ge=1;Ge<=Ue;Ge++)v.push(Re[Ge],Re[Ge-1],ze[Ge]),v.push(ze[Ge+1],Re[Ge],ze[Ge])}}}function Ve(e,t,i,n,s){var p=-n/2,o=(Math.PI-n)/2,l=t.clone().normalize().cross(i);e.addScaledVector(i,-h/Math.sin(o));for(var g=new r.Vector3,c=new r.Vector3,d=w,f=[],A=0;A<=a;A++){var x=p+A/a*n;c.set(0,0,0),c.addScaledVector(l,Math.sin(x)),c.addScaledVector(i,Math.cos(x));for(var O=0;O<=1;O++){var E=O/1-.5;if(g.copy(e),g.addScaledVector(t,E),g.addScaledVector(c,h),null!=s){var C=Math.max(0,g.y-s);g.addScaledVector(t,-C/t.y)}m.push(g.x,g.y,g.z),y.push(c.x,c.y,c.z),u.push(0,0),0===O&&f.push(w),w++}}for(var D=0;D<a;D++)for(var S=0;S<1;S++){var B=d+S+2*D,T=B+2,k=T+1,_=B+1;v.push(B,T,_),v.push(T,k,_)}return[e.clone().addScaledVector(t,.5),f]}function He(e,t,i,n){for(var s=Math.PI/2,p=k.angle()-s,o=[],l=new r.Vector3,g=new r.Vector3,c=0;c<=a;c++){for(var d=[],f=c/a,A=0;A<=c;A++){var x=((c?A/c:0)-.5)*C,O=Math.cos(x),E=Math.sin(x),D=(s+Math.atan(Math.tan(p)*O))*f,S=Math.cos(D),B=Math.sin(D);l.set(0,0,0),l.addScaledVector(t,B*O),l.addScaledVector(i,S),l.addScaledVector(n,B*E),g.copy(e).addScaledVector(l,h),m.push(g.x,g.y,g.z),y.push(l.x,l.y,l.z),u.push(0,0),d.push(w++)}o.push(d)}for(var T=o.length-1,_=0;_<T;_++){var M=o[_],L=o[_+1],N=M.length-1;v.push(M[0],L[1],L[0]);for(var F=1;F<=N;F++)v.push(M[F-1],M[F],L[F]),v.push(M[F],L[F+1],L[F])}}return e.setIndex(v),e.setAttribute("position",new r.Float32BufferAttribute(m,3)),e.setAttribute("normal",new r.Float32BufferAttribute(y,3)),e.setAttribute("uv",new r.Float32BufferAttribute(u,2)),e}return n}(r.BufferGeometry),it=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s,o=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,cornerRadius:[0,0,0,0],cornerType:1,extrudeDepth:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters),a=Object.assign(null!==(i=null==t?void 0:t.ui)&&void 0!==i?i:{enabledIndieCorners:!1},e.ui),l=o.cornerRadius.reduce((function(e,t){return e+t}),0);return{shape:new re,parameters:Object.assign(o,{surfaceMaxCount:(null!==(n=o.surfaceMaxCount)&&void 0!==n?n:l>0)?1e3:100,width:Math.abs(o.width),height:Math.abs(null!==(s=o.height)&&void 0!==s?s:o.width)}),ui:a}}},{key:"build",value:function(e){var t=e.shape,r=e.parameters,n=r.width,i=r.height,o=r.cornerRadius,s=r.cornerType,l=r.extrudeDepth,a=r.extrudeBevelSize,c=r.extrudeBevelSegments,h=r.surfaceMaxCount,d={x:.5*n,y:.5*i},u={x:-d.x,y:-d.y},f={x:d.x,y:d.y};function p(e,t,r){return t>n&&r>i?Math.min(e*n/t,e*i/r):t>n?e*n/t:r>i?e*i/r:e}var v=[];v[0]=0===o[0]?0:p(o[0],o[0]+o[3],o[0]+o[1]),v[1]=0===o[1]?0:p(o[1],o[1]+o[2],o[1]+o[0]),v[2]=0===o[2]?0:p(o[2],o[2]+o[1],o[2]+o[3]),v[3]=0===o[3]?0:p(o[3],o[3]+o[0],o[3]+o[2]);var m=u.x,g=f.x,y=f.y,A=u.y;t.addPoint(t.createPoint(m,y)),t.addPoint(t.createPoint(g,y)),t.addPoint(t.createPoint(g,A)),t.addPoint(t.createPoint(m,A)),t.isClosed=!0;for(var w=!0,x=0,O=t.points.length;x<O;x++)t.points[x].roundness=v[x],x>0&&v[x]!==v[x-1]&&(w=!1);w&&(t.roundness=v[0]),t.useCubicForRoundedCorners=1!==s,t.update();var E=Ce.create({shape:t,parameters:{surfaceMaxCount:h,extrudeDepth:l,extrudeBevelSize:a,extrudeBevelSegments:c}});return Object.assign(E,{userData:Object.assign(Object.assign({},e),{type:"RectangleGeometry"})})}}]),e}();function at(e){for(var t=0,r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];for(var l=0,c=n;l<c.length;l++){var h=c[l];t+=h.length}for(var i=new e(t),d=0,f=0,v=n;f<v.length;f++){var m=v[f];i.set(m,d),d+=m.length}return i}function ot(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);for(var i={},n=e.getIndex(),s=e.getAttribute("position"),o=n?n.count:s.count,a=0,l=Object.keys(e.attributes),c={},h={},u=[],d=["getX","getY","getZ","getW"],f=0,v=l.length;f<v;f++){var m=l[f];c[m]=[];var y=e.morphAttributes[m];y&&(h[m]=new Array(y.length).fill(0).map((function(){return[]})))}for(var p=Math.log10(1/t),A=Math.pow(10,p),w=0;w<o;w++){for(var x=n?n.getX(w):w,O="",E=0,C=l.length;E<C;E++)for(var D=l[E],S=e.getAttribute(D),B=S.itemSize,T=0;T<B;T++)O+=~~(S[d[T]](x)*A)+",";if(O in i)u.push(i[O]);else{for(var k=0,_=l.length;k<_;k++)for(var M=l[k],L=e.getAttribute(M),N=e.morphAttributes[M],F=L.itemSize,I=c[M],j=h[M],P=0;P<F;P++){var R=d[P];if(I.push(L[R](x)),N)for(var z=0,U=N.length;z<U;z++)j[z].push(N[z][R](x))}i[O]=a,u.push(a),a++}}for(var G=e.clone(),V=0,H=l.length;V<H;V++){var J=l[V],Q=e.getAttribute(J),Y=new Q.array.constructor(c[J]),W=new r.BufferAttribute(Y,Q.itemSize,Q.normalized);if(G.setAttribute(J,W),J in h)for(var X=0;X<h[J].length;X++){var K=e.morphAttributes[J][X],Z=new K.array.constructor(h[J][X]),$=new r.BufferAttribute(Z,K.itemSize,K.normalized);G.morphAttributes[J][X]=$}}return G.setIndex(u),G}($e="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var t,r;(e=void 0!==(e=e||{})?e:{}).ready=new Promise((function(e,i){t=e,r=i}));var i,n={};for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);var s,o="./this.program",a="";"undefined"!=typeof document&&document.currentScript&&(a=document.currentScript.src),$e&&(a=$e),a=0!==a.indexOf("blob:")?a.substr(0,a.lastIndexOf("/")+1):"",s=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText};var l,c,h=e.print||console.log.bind(console),u=e.printErr||console.warn.bind(console);for(i in n)n.hasOwnProperty(i)&&(e[i]=n[i]);n=null,e.arguments&&e.arguments,e.thisProgram&&(o=e.thisProgram),e.quit&&e.quit,e.wasmBinary&&(l=e.wasmBinary),e.noExitRuntime&&e.noExitRuntime,"object"!=("undefined"==typeof WebAssembly?"undefined":Object(d.a)(WebAssembly))&&W("no native wasm support detected");var f=!1;function p(e,t){e||W("Assertion failed: "+t)}var v="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function m(e,t,r){for(var i=t+r,n=t;e[n]&&!(n>=i);)++n;if(n-t>16&&e.subarray&&v)return v.decode(e.subarray(t,n));for(var s="";t<n;){var o=e[t++];if(128&o){var a=63&e[t++];if(192!=(224&o)){var l=63&e[t++];if((o=224==(240&o)?(15&o)<<12|a<<6|l:(7&o)<<18|a<<12|l<<6|63&e[t++])<65536)s+=String.fromCharCode(o);else{var c=o-65536;s+=String.fromCharCode(55296|c>>10,56320|1023&c)}}else s+=String.fromCharCode((31&o)<<6|a)}else s+=String.fromCharCode(o)}return s}function g(e,t){return e?m(b,e,t):""}function y(e,t,r,i){if(!(i>0))return 0;for(var n=r,s=r+i-1,o=0;o<e.length;++o){var a=e.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++o)),a<=127){if(r>=s)break;t[r++]=a}else if(a<=2047){if(r+1>=s)break;t[r++]=192|a>>6,t[r++]=128|63&a}else if(a<=65535){if(r+2>=s)break;t[r++]=224|a>>12,t[r++]=128|a>>6&63,t[r++]=128|63&a}else{if(r+3>=s)break;t[r++]=240|a>>18,t[r++]=128|a>>12&63,t[r++]=128|a>>6&63,t[r++]=128|63&a}}return t[r]=0,r-n}function A(e,t,r){return y(e,b,t,r)}function w(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&e.charCodeAt(++r)),i<=127?++t:t+=i<=2047?2:i<=65535?3:4}return t}var x,O,b,E,C,D,S,B,T,k="undefined"!=typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function _(e,t){for(var r=e,i=r>>1,n=i+t/2;!(i>=n)&&C[i];)++i;if((r=i<<1)-e>32&&k)return k.decode(b.subarray(e,r));for(var s="",o=0;!(o>=t/2);++o){var a=E[e+2*o>>1];if(0==a)break;s+=String.fromCharCode(a)}return s}function M(e,t,r){if(void 0===r&&(r=2147483647),r<2)return 0;for(var i=t,n=(r-=2)<2*e.length?r/2:e.length,s=0;s<n;++s){var o=e.charCodeAt(s);E[t>>1]=o,t+=2}return E[t>>1]=0,t-i}function L(e){return 2*e.length}function N(e,t){for(var r=0,i="";!(r>=t/4);){var n=D[e+4*r>>2];if(0==n)break;if(++r,n>=65536){var s=n-65536;i+=String.fromCharCode(55296|s>>10,56320|1023&s)}else i+=String.fromCharCode(n)}return i}function F(e,t,r){if(void 0===r&&(r=2147483647),r<4)return 0;for(var i=t,n=i+r-4,s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o>=55296&&o<=57343&&(o=65536+((1023&o)<<10)|1023&e.charCodeAt(++s)),D[t>>2]=o,(t+=4)+4>n)break}return D[t>>2]=0,t-i}function I(e){for(var t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=55296&&i<=57343&&++r,t+=4}return t}function j(e,t){O.set(e,t)}function P(t){x=t,e.HEAP8=O=new Int8Array(t),e.HEAP16=E=new Int16Array(t),e.HEAP32=D=new Int32Array(t),e.HEAPU8=b=new Uint8Array(t),e.HEAPU16=C=new Uint16Array(t),e.HEAPU32=S=new Uint32Array(t),e.HEAPF32=B=new Float32Array(t),e.HEAPF64=T=new Float64Array(t)}e.INITIAL_MEMORY;var R,z=[],U=[],G=[],V=[];U.push({func:function(){St()}});var H=0,J=null;function Q(t){H++,e.monitorRunDependencies&&e.monitorRunDependencies(H)}function Y(t){if(H--,e.monitorRunDependencies&&e.monitorRunDependencies(H),0==H&&J){var r=J;J=null,r()}}function W(t){e.onAbort&&e.onAbort(t),u(t+=""),f=!0,t="abort("+t+"). Build with -s ASSERTIONS=1 for more info.";var i=new WebAssembly.RuntimeError(t);throw r(i),i}function X(e){return t=e,r="data:application/octet-stream;base64,",String.prototype.startsWith?t.startsWith(r):0===t.indexOf(r);var t,r}e.preloadedImages={},e.preloadedAudios={};var K,Z,q,$="process.wasm";function ee(e){try{if(e==$&&l)return new Uint8Array(l);throw"both async and sync fetching of the wasm failed"}catch(e){W(e)}}function te(t){for(;t.length>0;){var r=t.shift();if("function"!=typeof r){var i=r.func;"number"==typeof i?void 0===r.arg?R.get(i)():R.get(i)(r.arg):i(void 0===r.arg?null:r.arg)}else r(e)}}X($)||(K=$,$=e.locateFile?e.locateFile(K,a):a+K);function re(e){this.excPtr=e,this.ptr=e-16,this.set_type=function(e){D[this.ptr+8>>2]=e},this.get_type=function(){return D[this.ptr+8>>2]},this.set_destructor=function(e){D[this.ptr+0>>2]=e},this.get_destructor=function(){return D[this.ptr+0>>2]},this.set_refcount=function(e){D[this.ptr+4>>2]=e},this.set_caught=function(e){e=e?1:0,O[this.ptr+12>>0]=e},this.get_caught=function(){return 0!=O[this.ptr+12>>0]},this.set_rethrown=function(e){e=e?1:0,O[this.ptr+13>>0]=e},this.get_rethrown=function(){return 0!=O[this.ptr+13>>0]},this.init=function(e,t){this.set_type(e),this.set_destructor(t),this.set_refcount(0),this.set_caught(!1),this.set_rethrown(!1)},this.add_ref=function(){var e=D[this.ptr+4>>2];D[this.ptr+4>>2]=e+1},this.release_ref=function(){var e=D[this.ptr+4>>2];return D[this.ptr+4>>2]=e-1,1===e}}var ne={};function ie(e){for(;e.length;){var t=e.pop();e.pop()(t)}}function ae(e){return this.fromWireType(S[e>>2])}var oe={},se={},ue={};function le(e){if(void 0===e)return"_unknown";var t=(e=e.replace(/[^a-zA-Z0-9_]/g,"$")).charCodeAt(0);return t>=48&&t<=57?"_"+e:e}function ce(e,t){return e=le(e),new Function("body","return function "+e+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(t)}function he(e,t){var r=ce(t,(function(e){this.name=t,this.message=e;var r=new Error(e).stack;void 0!==r&&(this.stack=this.toString()+"\n"+r.replace(/^Error(:[^\n]*)?\n/,""))}));return r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message},r}var de=void 0;function fe(e){throw new de(e)}function ve(e,t,r){function i(t){var i=r(t);i.length!==e.length&&fe("Mismatched type converter count");for(var n=0;n<e.length;++n)we(e[n],i[n])}e.forEach((function(e){ue[e]=t}));var n=new Array(t.length),s=[],o=0;t.forEach((function(e,t){se.hasOwnProperty(e)?n[t]=se[e]:(s.push(e),oe.hasOwnProperty(e)||(oe[e]=[]),oe[e].push((function(){n[t]=se[e],++o===s.length&&i(n)})))})),0===s.length&&i(n)}var pe={};function me(e){switch(e){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+e)}}var ge=void 0;function ye(e){for(var t="",r=e;b[r];)t+=ge[b[r++]];return t}var Ae=void 0;function be(e){throw new Ae(e)}function we(e,t,r){if(r=r||{},!("argPackAdvance"in t))throw new TypeError("registerType registeredInstance requires argPackAdvance");var i=t.name;if(e||be('type "'+i+'" must have a positive integer typeid pointer'),se.hasOwnProperty(e)){if(r.ignoreDuplicateRegistrations)return;be("Cannot register type '"+i+"' twice")}if(se[e]=t,delete ue[e],oe.hasOwnProperty(e)){var n=oe[e];delete oe[e],n.forEach((function(e){e()}))}}function xe(e){be(e.$$.ptrType.registeredClass.name+" instance already deleted")}var Oe=!1;function Ee(e){}function Ce(e){e.count.value-=1,0===e.count.value&&function(e){e.smartPtr?e.smartPtrType.rawDestructor(e.smartPtr):e.ptrType.registeredClass.rawDestructor(e.ptr)}(e)}function De(e){return"undefined"==typeof FinalizationGroup?(De=function(e){return e},e):(Oe=new FinalizationGroup((function(e){for(var t=e.next();!t.done;t=e.next()){var r=t.value;r.ptr?Ce(r):console.warn("object already deleted: "+r.ptr)}})),Ee=function(e){Oe.unregister(e.$$)},(De=function(e){return Oe.register(e,e.$$,e.$$),e})(e))}var Se=void 0,Be=[];function Te(){for(;Be.length;){var e=Be.pop();e.$$.deleteScheduled=!1,e.delete()}}function ke(){}var _e={};function Me(e,t,r){if(void 0===e[t].overloadTable){var i=e[t];e[t]=function(){return e[t].overloadTable.hasOwnProperty(arguments.length)||be("Function '"+r+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+e[t].overloadTable+")!"),e[t].overloadTable[arguments.length].apply(this,arguments)},e[t].overloadTable=[],e[t].overloadTable[i.argCount]=i}}function Le(t,r,i){e.hasOwnProperty(t)?((void 0===i||void 0!==e[t].overloadTable&&void 0!==e[t].overloadTable[i])&&be("Cannot register public name '"+t+"' twice"),Me(e,t,t),e.hasOwnProperty(i)&&be("Cannot register multiple overloads of a function with the same number of arguments ("+i+")!"),e[t].overloadTable[i]=r):(e[t]=r,void 0!==i&&(e[t].numArguments=i))}function Ne(e,t,r,i,n,s,o,a){this.name=e,this.constructor=t,this.instancePrototype=r,this.rawDestructor=i,this.baseClass=n,this.getActualType=s,this.upcast=o,this.downcast=a,this.pureVirtualFunctions=[]}function Fe(e,t,r){for(;t!==r;)t.upcast||be("Expected null or instance of "+r.name+", got an instance of "+t.name),e=t.upcast(e),t=t.baseClass;return e}function Ie(e,t){if(null===t)return this.isReference&&be("null is not a valid "+this.name),0;t.$$||be('Cannot pass "'+at(t)+'" as a '+this.name),t.$$.ptr||be("Cannot pass deleted object as a pointer of type "+this.name);var r=t.$$.ptrType.registeredClass;return Fe(t.$$.ptr,r,this.registeredClass)}function je(e,t){var r;if(null===t)return this.isReference&&be("null is not a valid "+this.name),this.isSmartPointer?(r=this.rawConstructor(),null!==e&&e.push(this.rawDestructor,r),r):0;t.$$||be('Cannot pass "'+at(t)+'" as a '+this.name),t.$$.ptr||be("Cannot pass deleted object as a pointer of type "+this.name),!this.isConst&&t.$$.ptrType.isConst&&be("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);var i=t.$$.ptrType.registeredClass;if(r=Fe(t.$$.ptr,i,this.registeredClass),this.isSmartPointer)switch(void 0===t.$$.smartPtr&&be("Passing raw pointer to smart pointer is illegal"),this.sharingPolicy){case 0:t.$$.smartPtrType===this?r=t.$$.smartPtr:be("Cannot convert argument of type "+(t.$$.smartPtrType?t.$$.smartPtrType.name:t.$$.ptrType.name)+" to parameter type "+this.name);break;case 1:r=t.$$.smartPtr;break;case 2:if(t.$$.smartPtrType===this)r=t.$$.smartPtr;else{var n=t.clone();r=this.rawShare(r,tt((function(){n.delete()}))),null!==e&&e.push(this.rawDestructor,r)}break;default:be("Unsupporting sharing policy")}return r}function Pe(e,t){if(null===t)return this.isReference&&be("null is not a valid "+this.name),0;t.$$||be('Cannot pass "'+at(t)+'" as a '+this.name),t.$$.ptr||be("Cannot pass deleted object as a pointer of type "+this.name),t.$$.ptrType.isConst&&be("Cannot convert argument of type "+t.$$.ptrType.name+" to parameter type "+this.name);var r=t.$$.ptrType.registeredClass;return Fe(t.$$.ptr,r,this.registeredClass)}function Re(e,t,r){if(t===r)return e;if(void 0===r.baseClass)return null;var i=Re(e,t,r.baseClass);return null===i?null:r.downcast(i)}var ze={};function Ue(e,t){return t.ptrType&&t.ptr||fe("makeClassHandle requires ptr and ptrType"),!!t.smartPtrType!=!!t.smartPtr&&fe("Both smartPtrType and smartPtr must be specified"),t.count={value:1},De(Object.create(e,{$$:{value:t}}))}function Ge(e,t,r,i,n,s,o,a,l,c,h){this.name=e,this.registeredClass=t,this.isReference=r,this.isConst=i,this.isSmartPointer=n,this.pointeeType=s,this.sharingPolicy=o,this.rawGetPointee=a,this.rawConstructor=l,this.rawShare=c,this.rawDestructor=h,n||void 0!==t.baseClass?this.toWireType=je:i?(this.toWireType=Ie,this.destructorFunction=null):(this.toWireType=Pe,this.destructorFunction=null)}function Ve(t,r,i){e.hasOwnProperty(t)||fe("Replacing nonexistant public symbol"),void 0!==e[t].overloadTable&&void 0!==i?e[t].overloadTable[i]=r:(e[t]=r,e[t].argCount=i)}function He(t,r,i){return-1!=t.indexOf("j")?function(t,r,i){var n=e["dynCall_"+t];return i&&i.length?n.apply(null,[r].concat(i)):n.call(null,r)}(t,r,i):R.get(r).apply(null,i)}function Je(e,t){var r,i,n,s=-1!=(e=ye(e)).indexOf("j")?(r=e,i=t,n=[],function(){n.length=arguments.length;for(var e=0;e<arguments.length;e++)n[e]=arguments[e];return He(r,i,n)}):R.get(t);return"function"!=typeof s&&be("unknown function pointer with signature "+e+": "+t),s}var Qe=void 0;function dt(e){var t=kt(e),r=ye(t);return Tt(t),r}function Ye(e,t){var r=[],i={};throw t.forEach((function e(t){i[t]||se[t]||(ue[t]?ue[t].forEach(e):(r.push(t),i[t]=!0))})),new Qe(e+": "+r.map(dt).join([", "]))}function We(e,t){for(var r=[],i=0;i<e;i++)r.push(D[(t>>2)+i]);return r}function Xe(e,t,r,i,n){var s=t.length;s<2&&be("argTypes array size mismatch! Must at least get return value and 'this' types!");for(var o=null!==t[1]&&null!==r,a=!1,l=1;l<t.length;++l)if(null!==t[l]&&void 0===t[l].destructorFunction){a=!0;break}var c="void"!==t[0].name,h="",u="";for(l=0;l<s-2;++l)h+=(0!==l?", ":"")+"arg"+l,u+=(0!==l?", ":"")+"arg"+l+"Wired";var f="return function "+le(e)+"("+h+") {\nif (arguments.length !== "+(s-2)+") {\nthrowBindingError('function "+e+" called with ' + arguments.length + ' arguments, expected "+(s-2)+" args!');\n}\n";a&&(f+="var destructors = [];\n");var p=a?"destructors":"null",v=["throwBindingError","invoker","fn","runDestructors","retType","classParam"],m=[be,i,n,ie,t[0],t[1]];for(o&&(f+="var thisWired = classParam.toWireType("+p+", this);\n"),l=0;l<s-2;++l)f+="var arg"+l+"Wired = argType"+l+".toWireType("+p+", arg"+l+"); // "+t[l+2].name+"\n",v.push("argType"+l),m.push(t[l+2]);if(o&&(u="thisWired"+(u.length>0?", ":"")+u),f+=(c?"var rv = ":"")+"invoker(fn"+(u.length>0?", ":"")+u+");\n",a)f+="runDestructors(destructors);\n";else for(l=o?1:2;l<t.length;++l){var g=1===l?"thisWired":"arg"+(l-2)+"Wired";null!==t[l].destructorFunction&&(f+=g+"_dtor("+g+"); // "+t[l].name+"\n",v.push(g+"_dtor"),m.push(t[l].destructorFunction))}return c&&(f+="var ret = retType.fromWireType(rv);\nreturn ret;\n"),f+="}\n",v.push(f),function(e,t){if(!(e instanceof Function))throw new TypeError("new_ called with constructor type "+Object(d.a)(e)+" which is not a function");var r=ce(e.name||"unknownFunctionName",(function(){}));r.prototype=e.prototype;var i=new r,n=e.apply(i,t);return n instanceof Object?n:i}(Function,v).apply(null,m)}function Ke(e,t,r){return e instanceof Object||be(r+' with invalid "this": '+e),e instanceof t.registeredClass.constructor||be(r+' incompatible with "this" of type '+e.constructor.name),e.$$.ptr||be("cannot call emscripten binding method "+r+" on deleted object"),Fe(e.$$.ptr,e.$$.ptrType.registeredClass,t.registeredClass)}var qe=[],Ze=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function et(e){e>4&&0==--Ze[e].refcount&&(Ze[e]=void 0,qe.push(e))}function tt(e){switch(e){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var t=qe.length?qe.pop():Ze.length;return Ze[t]={refcount:1,value:e},t}}function nt(e,t,r){switch(t){case 0:return function(e){var t=r?O:b;return this.fromWireType(t[e])};case 1:return function(e){var t=r?E:C;return this.fromWireType(t[e>>1])};case 2:return function(e){var t=r?D:S;return this.fromWireType(t[e>>2])};default:throw new TypeError("Unknown integer type: "+e)}}function it(e,t){var r=se[e];return void 0===r&&be(t+" has unknown type "+dt(e)),r}function at(e){if(null===e)return"null";var t=Object(d.a)(e);return"object"===t||"array"===t||"function"===t?e.toString():""+e}function ot(e,t){switch(t){case 2:return function(e){return this.fromWireType(B[e>>2])};case 3:return function(e){return this.fromWireType(T[e>>3])};default:throw new TypeError("Unknown float type: "+e)}}function st(e,t,r){switch(t){case 0:return r?function(e){return O[e]}:function(e){return b[e]};case 1:return r?function(e){return E[e>>1]}:function(e){return C[e>>1]};case 2:return r?function(e){return D[e>>2]}:function(e){return S[e>>2]};default:throw new TypeError("Unknown integer type: "+e)}}function ut(e){try{return c.grow(e-x.byteLength+65535>>>16),P(c.buffer),1}catch(e){}}var lt={};function ct(){if(!ct.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==("undefined"==typeof navigator?"undefined":Object(d.a)(navigator))&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:o||"./this.program"};for(var t in lt)e[t]=lt[t];var r=[];for(var t in e)r.push(t+"="+e[t]);ct.strings=r}return ct.strings}var ht={splitPath:function(e){return/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(e).slice(1)},normalizeArray:function(e,t){for(var r=0,i=e.length-1;i>=0;i--){var n=e[i];"."===n?e.splice(i,1):".."===n?(e.splice(i,1),r++):r&&(e.splice(i,1),r--)}if(t)for(;r;r--)e.unshift("..");return e},normalize:function(e){var t="/"===e.charAt(0),r="/"===e.substr(-1);return(e=ht.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||t||(e="."),e&&r&&(e+="/"),(t?"/":"")+e},dirname:function(e){var t=ht.splitPath(e),r=t[0],i=t[1];return r||i?(i&&(i=i.substr(0,i.length-1)),r+i):"."},basename:function(e){if("/"===e)return"/";var t=(e=(e=ht.normalize(e)).replace(/\/$/,"")).lastIndexOf("/");return-1===t?e:e.substr(t+1)},extname:function(e){return ht.splitPath(e)[3]},join:function(){var e=Array.prototype.slice.call(arguments,0);return ht.normalize(e.join("/"))},join2:function(e,t){return ht.normalize(e+"/"+t)}},ft={resolve:function(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var i=r>=0?arguments[r]:mt.cwd();if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");if(!i)return"";e=i+"/"+e,t="/"===i.charAt(0)}return(t?"/":"")+(e=ht.normalizeArray(e.split("/").filter((function(e){return!!e})),!t).join("/"))||"."},relative:function(e,t){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=ft.resolve(e).substr(1),t=ft.resolve(t).substr(1);for(var i=r(e.split("/")),n=r(t.split("/")),s=Math.min(i.length,n.length),o=s,a=0;a<s;a++)if(i[a]!==n[a]){o=a;break}var l=[];for(a=o;a<i.length;a++)l.push("..");return(l=l.concat(n.slice(o))).join("/")}},vt={ttys:[],init:function(){},shutdown:function(){},register:function(e,t){vt.ttys[e]={input:[],output:[],ops:t},mt.registerDevice(e,vt.stream_ops)},stream_ops:{open:function(e){var t=vt.ttys[e.node.rdev];if(!t)throw new mt.ErrnoError(43);e.tty=t,e.seekable=!1},close:function(e){e.tty.ops.flush(e.tty)},flush:function(e){e.tty.ops.flush(e.tty)},read:function(e,t,r,i,n){if(!e.tty||!e.tty.ops.get_char)throw new mt.ErrnoError(60);for(var s=0,o=0;o<i;o++){var a;try{a=e.tty.ops.get_char(e.tty)}catch(e){throw new mt.ErrnoError(29)}if(void 0===a&&0===s)throw new mt.ErrnoError(6);if(null==a)break;s++,t[r+o]=a}return s&&(e.node.timestamp=Date.now()),s},write:function(e,t,r,i,n){if(!e.tty||!e.tty.ops.put_char)throw new mt.ErrnoError(60);try{for(var s=0;s<i;s++)e.tty.ops.put_char(e.tty,t[r+s])}catch(e){throw new mt.ErrnoError(29)}return i&&(e.node.timestamp=Date.now()),s}},default_tty_ops:{get_char:function(e){if(!e.input.length){var t=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(t=window.prompt("Input: "))&&(t+="\n"):"function"==typeof readline&&null!==(t=readline())&&(t+="\n"),!t)return null;e.input=Et(t,!0)}return e.input.shift()},put_char:function(e,t){null===t||10===t?(h(m(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(h(m(e.output,0)),e.output=[])}},default_tty1_ops:{put_char:function(e,t){null===t||10===t?(u(m(e.output,0)),e.output=[]):0!=t&&e.output.push(t)},flush:function(e){e.output&&e.output.length>0&&(u(m(e.output,0)),e.output=[])}}};var pt={ops_table:null,mount:function(e){return pt.createNode(null,"/",16895,0)},createNode:function(e,t,r,i){if(mt.isBlkdev(r)||mt.isFIFO(r))throw new mt.ErrnoError(63);pt.ops_table||(pt.ops_table={dir:{node:{getattr:pt.node_ops.getattr,setattr:pt.node_ops.setattr,lookup:pt.node_ops.lookup,mknod:pt.node_ops.mknod,rename:pt.node_ops.rename,unlink:pt.node_ops.unlink,rmdir:pt.node_ops.rmdir,readdir:pt.node_ops.readdir,symlink:pt.node_ops.symlink},stream:{llseek:pt.stream_ops.llseek}},file:{node:{getattr:pt.node_ops.getattr,setattr:pt.node_ops.setattr},stream:{llseek:pt.stream_ops.llseek,read:pt.stream_ops.read,write:pt.stream_ops.write,allocate:pt.stream_ops.allocate,mmap:pt.stream_ops.mmap,msync:pt.stream_ops.msync}},link:{node:{getattr:pt.node_ops.getattr,setattr:pt.node_ops.setattr,readlink:pt.node_ops.readlink},stream:{}},chrdev:{node:{getattr:pt.node_ops.getattr,setattr:pt.node_ops.setattr},stream:mt.chrdev_stream_ops}});var n=mt.createNode(e,t,r,i);return mt.isDir(n.mode)?(n.node_ops=pt.ops_table.dir.node,n.stream_ops=pt.ops_table.dir.stream,n.contents={}):mt.isFile(n.mode)?(n.node_ops=pt.ops_table.file.node,n.stream_ops=pt.ops_table.file.stream,n.usedBytes=0,n.contents=null):mt.isLink(n.mode)?(n.node_ops=pt.ops_table.link.node,n.stream_ops=pt.ops_table.link.stream):mt.isChrdev(n.mode)&&(n.node_ops=pt.ops_table.chrdev.node,n.stream_ops=pt.ops_table.chrdev.stream),n.timestamp=Date.now(),e&&(e.contents[t]=n,e.timestamp=n.timestamp),n},getFileDataAsTypedArray:function(e){return e.contents?e.contents.subarray?e.contents.subarray(0,e.usedBytes):new Uint8Array(e.contents):new Uint8Array(0)},expandFileStorage:function(e,t){var r=e.contents?e.contents.length:0;if(!(r>=t)){t=Math.max(t,r*(r<1048576?2:1.125)>>>0),0!=r&&(t=Math.max(t,256));var i=e.contents;e.contents=new Uint8Array(t),e.usedBytes>0&&e.contents.set(i.subarray(0,e.usedBytes),0)}},resizeFileStorage:function(e,t){if(e.usedBytes!=t)if(0==t)e.contents=null,e.usedBytes=0;else{var r=e.contents;e.contents=new Uint8Array(t),r&&e.contents.set(r.subarray(0,Math.min(t,e.usedBytes))),e.usedBytes=t}},node_ops:{getattr:function(e){var t={};return t.dev=mt.isChrdev(e.mode)?e.id:1,t.ino=e.id,t.mode=e.mode,t.nlink=1,t.uid=0,t.gid=0,t.rdev=e.rdev,mt.isDir(e.mode)?t.size=4096:mt.isFile(e.mode)?t.size=e.usedBytes:mt.isLink(e.mode)?t.size=e.link.length:t.size=0,t.atime=new Date(e.timestamp),t.mtime=new Date(e.timestamp),t.ctime=new Date(e.timestamp),t.blksize=4096,t.blocks=Math.ceil(t.size/t.blksize),t},setattr:function(e,t){void 0!==t.mode&&(e.mode=t.mode),void 0!==t.timestamp&&(e.timestamp=t.timestamp),void 0!==t.size&&pt.resizeFileStorage(e,t.size)},lookup:function(e,t){throw mt.genericErrors[44]},mknod:function(e,t,r,i){return pt.createNode(e,t,r,i)},rename:function(e,t,r){if(mt.isDir(e.mode)){var i;try{i=mt.lookupNode(t,r)}catch(e){}if(i)for(var n in i.contents)throw new mt.ErrnoError(55)}delete e.parent.contents[e.name],e.parent.timestamp=Date.now(),e.name=r,t.contents[r]=e,t.timestamp=e.parent.timestamp,e.parent=t},unlink:function(e,t){delete e.contents[t],e.timestamp=Date.now()},rmdir:function(e,t){var r=mt.lookupNode(e,t);for(var i in r.contents)throw new mt.ErrnoError(55);delete e.contents[t],e.timestamp=Date.now()},readdir:function(e){var t=[".",".."];for(var r in e.contents)e.contents.hasOwnProperty(r)&&t.push(r);return t},symlink:function(e,t,r){var i=pt.createNode(e,t,41471,0);return i.link=r,i},readlink:function(e){if(!mt.isLink(e.mode))throw new mt.ErrnoError(28);return e.link}},stream_ops:{read:function(e,t,r,i,n){var s=e.node.contents;if(n>=e.node.usedBytes)return 0;var o=Math.min(e.node.usedBytes-n,i);if(o>8&&s.subarray)t.set(s.subarray(n,n+o),r);else for(var a=0;a<o;a++)t[r+a]=s[n+a];return o},write:function(e,t,r,i,n,s){if(t.buffer===O.buffer&&(s=!1),!i)return 0;var o=e.node;if(o.timestamp=Date.now(),t.subarray&&(!o.contents||o.contents.subarray)){if(s)return o.contents=t.subarray(r,r+i),o.usedBytes=i,i;if(0===o.usedBytes&&0===n)return o.contents=t.slice(r,r+i),o.usedBytes=i,i;if(n+i<=o.usedBytes)return o.contents.set(t.subarray(r,r+i),n),i}if(pt.expandFileStorage(o,n+i),o.contents.subarray&&t.subarray)o.contents.set(t.subarray(r,r+i),n);else for(var a=0;a<i;a++)o.contents[n+a]=t[r+a];return o.usedBytes=Math.max(o.usedBytes,n+i),i},llseek:function(e,t,r){var i=t;if(1===r?i+=e.position:2===r&&mt.isFile(e.node.mode)&&(i+=e.node.usedBytes),i<0)throw new mt.ErrnoError(28);return i},allocate:function(e,t,r){pt.expandFileStorage(e.node,t+r),e.node.usedBytes=Math.max(e.node.usedBytes,t+r)},mmap:function(e,t,r,i,n,s){if(0!==t)throw new mt.ErrnoError(28);if(!mt.isFile(e.node.mode))throw new mt.ErrnoError(43);var o,a,l=e.node.contents;if(2&s||l.buffer!==x){if((i>0||i+r<l.length)&&(l=l.subarray?l.subarray(i,i+r):Array.prototype.slice.call(l,i,i+r)),a=!0,!(o=function(e){for(var t=function(e,t){return t||(t=16),Math.ceil(e/t)*t}(e,16384),r=Bt(t);e<t;)O[r+e++]=0;return r}(r)))throw new mt.ErrnoError(48);O.set(l,o)}else a=!1,o=l.byteOffset;return{ptr:o,allocated:a}},msync:function(e,t,r,i,n){if(!mt.isFile(e.node.mode))throw new mt.ErrnoError(43);return 2&n||pt.stream_ops.write(e,t,0,i,r,!1),0}}},mt={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,trackingDelegate:{},tracking:{openFlags:{READ:1,WRITE:2}},ErrnoError:null,genericErrors:{},filesystems:null,syncFSRequests:0,lookupPath:function(e,t){if(t=t||{},!(e=ft.resolve(mt.cwd(),e)))return{path:"",node:null};var r={follow_mount:!0,recurse_count:0};for(var i in r)void 0===t[i]&&(t[i]=r[i]);if(t.recurse_count>8)throw new mt.ErrnoError(32);for(var n=ht.normalizeArray(e.split("/").filter((function(e){return!!e})),!1),s=mt.root,o="/",a=0;a<n.length;a++){var l=a===n.length-1;if(l&&t.parent)break;if(s=mt.lookupNode(s,n[a]),o=ht.join2(o,n[a]),mt.isMountpoint(s)&&(!l||l&&t.follow_mount)&&(s=s.mounted.root),!l||t.follow)for(var c=0;mt.isLink(s.mode);){var h=mt.readlink(o);if(o=ft.resolve(ht.dirname(o),h),s=mt.lookupPath(o,{recurse_count:t.recurse_count}).node,c++>40)throw new mt.ErrnoError(32)}}return{path:o,node:s}},getPath:function(e){for(var t;;){if(mt.isRoot(e)){var r=e.mount.mountpoint;return t?"/"!==r[r.length-1]?r+"/"+t:r+t:r}t=t?e.name+"/"+t:e.name,e=e.parent}},hashName:function(e,t){for(var r=0,i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return(e+r>>>0)%mt.nameTable.length},hashAddNode:function(e){var t=mt.hashName(e.parent.id,e.name);e.name_next=mt.nameTable[t],mt.nameTable[t]=e},hashRemoveNode:function(e){var t=mt.hashName(e.parent.id,e.name);if(mt.nameTable[t]===e)mt.nameTable[t]=e.name_next;else for(var r=mt.nameTable[t];r;){if(r.name_next===e){r.name_next=e.name_next;break}r=r.name_next}},lookupNode:function(e,t){var r=mt.mayLookup(e);if(r)throw new mt.ErrnoError(r,e);for(var i=mt.hashName(e.id,t),n=mt.nameTable[i];n;n=n.name_next){var s=n.name;if(n.parent.id===e.id&&s===t)return n}return mt.lookup(e,t)},createNode:function(e,t,r,i){var n=new mt.FSNode(e,t,r,i);return mt.hashAddNode(n),n},destroyNode:function(e){mt.hashRemoveNode(e)},isRoot:function(e){return e===e.parent},isMountpoint:function(e){return!!e.mounted},isFile:function(e){return 32768==(61440&e)},isDir:function(e){return 16384==(61440&e)},isLink:function(e){return 40960==(61440&e)},isChrdev:function(e){return 8192==(61440&e)},isBlkdev:function(e){return 24576==(61440&e)},isFIFO:function(e){return 4096==(61440&e)},isSocket:function(e){return 49152==(49152&e)},flagModes:{r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},modeStringToFlags:function(e){var t=mt.flagModes[e];if(void 0===t)throw new Error("Unknown file open mode: "+e);return t},flagsToPermissionString:function(e){var t=["r","w","rw"][3&e];return 512&e&&(t+="w"),t},nodePermissions:function(e,t){return mt.ignorePermissions||(-1===t.indexOf("r")||292&e.mode)&&(-1===t.indexOf("w")||146&e.mode)&&(-1===t.indexOf("x")||73&e.mode)?0:2},mayLookup:function(e){return mt.nodePermissions(e,"x")||(e.node_ops.lookup?0:2)},mayCreate:function(e,t){try{return mt.lookupNode(e,t),20}catch(e){}return mt.nodePermissions(e,"wx")},mayDelete:function(e,t,r){var i;try{i=mt.lookupNode(e,t)}catch(e){return e.errno}var n=mt.nodePermissions(e,"wx");if(n)return n;if(r){if(!mt.isDir(i.mode))return 54;if(mt.isRoot(i)||mt.getPath(i)===mt.cwd())return 10}else if(mt.isDir(i.mode))return 31;return 0},mayOpen:function(e,t){return e?mt.isLink(e.mode)?32:mt.isDir(e.mode)&&("r"!==mt.flagsToPermissionString(t)||512&t)?31:mt.nodePermissions(e,mt.flagsToPermissionString(t)):44},MAX_OPEN_FDS:4096,nextfd:function(e,t){e=e||0,t=t||mt.MAX_OPEN_FDS;for(var r=e;r<=t;r++)if(!mt.streams[r])return r;throw new mt.ErrnoError(33)},getStream:function(e){return mt.streams[e]},createStream:function(e,t,r){mt.FSStream||(mt.FSStream=function(){},mt.FSStream.prototype={object:{get:function(){return this.node},set:function(e){this.node=e}},isRead:{get:function(){return 1!=(2097155&this.flags)}},isWrite:{get:function(){return 0!=(2097155&this.flags)}},isAppend:{get:function(){return 1024&this.flags}}});var i=new mt.FSStream;for(var n in e)i[n]=e[n];e=i;var s=mt.nextfd(t,r);return e.fd=s,mt.streams[s]=e,e},closeStream:function(e){mt.streams[e]=null},chrdev_stream_ops:{open:function(e){var t=mt.getDevice(e.node.rdev);e.stream_ops=t.stream_ops,e.stream_ops.open&&e.stream_ops.open(e)},llseek:function(){throw new mt.ErrnoError(70)}},major:function(e){return e>>8},minor:function(e){return 255&e},makedev:function(e,t){return e<<8|t},registerDevice:function(e,t){mt.devices[e]={stream_ops:t}},getDevice:function(e){return mt.devices[e]},getMounts:function(e){for(var t=[],r=[e];r.length;){var i=r.pop();t.push(i),r.push.apply(r,i.mounts)}return t},syncfs:function(e,t){"function"==typeof e&&(t=e,e=!1),mt.syncFSRequests++,mt.syncFSRequests>1&&u("warning: "+mt.syncFSRequests+" FS.syncfs operations in flight at once, probably just doing extra work");var r=mt.getMounts(mt.root.mount),i=0;function n(e){return mt.syncFSRequests--,t(e)}function s(e){if(e)return s.errored?void 0:(s.errored=!0,n(e));++i>=r.length&&n(null)}r.forEach((function(t){if(!t.type.syncfs)return s(null);t.type.syncfs(t,e,s)}))},mount:function(e,t,r){var i,n="/"===r,s=!r;if(n&&mt.root)throw new mt.ErrnoError(10);if(!n&&!s){var o=mt.lookupPath(r,{follow_mount:!1});if(r=o.path,i=o.node,mt.isMountpoint(i))throw new mt.ErrnoError(10);if(!mt.isDir(i.mode))throw new mt.ErrnoError(54)}var a={type:e,opts:t,mountpoint:r,mounts:[]},l=e.mount(a);return l.mount=a,a.root=l,n?mt.root=l:i&&(i.mounted=a,i.mount&&i.mount.mounts.push(a)),l},unmount:function(e){var t=mt.lookupPath(e,{follow_mount:!1});if(!mt.isMountpoint(t.node))throw new mt.ErrnoError(28);var r=t.node,i=r.mounted,n=mt.getMounts(i);Object.keys(mt.nameTable).forEach((function(e){for(var t=mt.nameTable[e];t;){var r=t.name_next;-1!==n.indexOf(t.mount)&&mt.destroyNode(t),t=r}})),r.mounted=null;var s=r.mount.mounts.indexOf(i);r.mount.mounts.splice(s,1)},lookup:function(e,t){return e.node_ops.lookup(e,t)},mknod:function(e,t,r){var i=mt.lookupPath(e,{parent:!0}).node,n=ht.basename(e);if(!n||"."===n||".."===n)throw new mt.ErrnoError(28);var s=mt.mayCreate(i,n);if(s)throw new mt.ErrnoError(s);if(!i.node_ops.mknod)throw new mt.ErrnoError(63);return i.node_ops.mknod(i,n,t,r)},create:function(e,t){return t=void 0!==t?t:438,t&=4095,t|=32768,mt.mknod(e,t,0)},mkdir:function(e,t){return t=void 0!==t?t:511,t&=1023,t|=16384,mt.mknod(e,t,0)},mkdirTree:function(e,t){for(var r=e.split("/"),i="",n=0;n<r.length;++n)if(r[n]){i+="/"+r[n];try{mt.mkdir(i,t)}catch(e){if(20!=e.errno)throw e}}},mkdev:function(e,t,r){return void 0===r&&(r=t,t=438),t|=8192,mt.mknod(e,t,r)},symlink:function(e,t){if(!ft.resolve(e))throw new mt.ErrnoError(44);var r=mt.lookupPath(t,{parent:!0}).node;if(!r)throw new mt.ErrnoError(44);var i=ht.basename(t),n=mt.mayCreate(r,i);if(n)throw new mt.ErrnoError(n);if(!r.node_ops.symlink)throw new mt.ErrnoError(63);return r.node_ops.symlink(r,i,e)},rename:function(e,t){var r,i,n=ht.dirname(e),s=ht.dirname(t),o=ht.basename(e),a=ht.basename(t);if(r=mt.lookupPath(e,{parent:!0}).node,i=mt.lookupPath(t,{parent:!0}).node,!r||!i)throw new mt.ErrnoError(44);if(r.mount!==i.mount)throw new mt.ErrnoError(75);var l,c=mt.lookupNode(r,o),h=ft.relative(e,s);if("."!==h.charAt(0))throw new mt.ErrnoError(28);if("."!==(h=ft.relative(t,n)).charAt(0))throw new mt.ErrnoError(55);try{l=mt.lookupNode(i,a)}catch(e){}if(c!==l){var d=mt.isDir(c.mode),p=mt.mayDelete(r,o,d);if(p)throw new mt.ErrnoError(p);if(p=l?mt.mayDelete(i,a,d):mt.mayCreate(i,a))throw new mt.ErrnoError(p);if(!r.node_ops.rename)throw new mt.ErrnoError(63);if(mt.isMountpoint(c)||l&&mt.isMountpoint(l))throw new mt.ErrnoError(10);if(i!==r&&(p=mt.nodePermissions(r,"w")))throw new mt.ErrnoError(p);try{mt.trackingDelegate.willMovePath&&mt.trackingDelegate.willMovePath(e,t)}catch(r){u("FS.trackingDelegate['willMovePath']('"+e+"', '"+t+"') threw an exception: "+r.message)}mt.hashRemoveNode(c);try{r.node_ops.rename(c,i,a)}catch(e){throw e}finally{mt.hashAddNode(c)}try{mt.trackingDelegate.onMovePath&&mt.trackingDelegate.onMovePath(e,t)}catch(r){u("FS.trackingDelegate['onMovePath']('"+e+"', '"+t+"') threw an exception: "+r.message)}}},rmdir:function(e){var t=mt.lookupPath(e,{parent:!0}).node,r=ht.basename(e),i=mt.lookupNode(t,r),n=mt.mayDelete(t,r,!0);if(n)throw new mt.ErrnoError(n);if(!t.node_ops.rmdir)throw new mt.ErrnoError(63);if(mt.isMountpoint(i))throw new mt.ErrnoError(10);try{mt.trackingDelegate.willDeletePath&&mt.trackingDelegate.willDeletePath(e)}catch(t){u("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.rmdir(t,r),mt.destroyNode(i);try{mt.trackingDelegate.onDeletePath&&mt.trackingDelegate.onDeletePath(e)}catch(t){u("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readdir:function(e){var t=mt.lookupPath(e,{follow:!0}).node;if(!t.node_ops.readdir)throw new mt.ErrnoError(54);return t.node_ops.readdir(t)},unlink:function(e){var t=mt.lookupPath(e,{parent:!0}).node,r=ht.basename(e),i=mt.lookupNode(t,r),n=mt.mayDelete(t,r,!1);if(n)throw new mt.ErrnoError(n);if(!t.node_ops.unlink)throw new mt.ErrnoError(63);if(mt.isMountpoint(i))throw new mt.ErrnoError(10);try{mt.trackingDelegate.willDeletePath&&mt.trackingDelegate.willDeletePath(e)}catch(t){u("FS.trackingDelegate['willDeletePath']('"+e+"') threw an exception: "+t.message)}t.node_ops.unlink(t,r),mt.destroyNode(i);try{mt.trackingDelegate.onDeletePath&&mt.trackingDelegate.onDeletePath(e)}catch(t){u("FS.trackingDelegate['onDeletePath']('"+e+"') threw an exception: "+t.message)}},readlink:function(e){var t=mt.lookupPath(e).node;if(!t)throw new mt.ErrnoError(44);if(!t.node_ops.readlink)throw new mt.ErrnoError(28);return ft.resolve(mt.getPath(t.parent),t.node_ops.readlink(t))},stat:function(e,t){var r=mt.lookupPath(e,{follow:!t}).node;if(!r)throw new mt.ErrnoError(44);if(!r.node_ops.getattr)throw new mt.ErrnoError(63);return r.node_ops.getattr(r)},lstat:function(e){return mt.stat(e,!0)},chmod:function(e,t,r){var i;if(!(i="string"==typeof e?mt.lookupPath(e,{follow:!r}).node:e).node_ops.setattr)throw new mt.ErrnoError(63);i.node_ops.setattr(i,{mode:4095&t|-4096&i.mode,timestamp:Date.now()})},lchmod:function(e,t){mt.chmod(e,t,!0)},fchmod:function(e,t){var r=mt.getStream(e);if(!r)throw new mt.ErrnoError(8);mt.chmod(r.node,t)},chown:function(e,t,r,i){var n;if(!(n="string"==typeof e?mt.lookupPath(e,{follow:!i}).node:e).node_ops.setattr)throw new mt.ErrnoError(63);n.node_ops.setattr(n,{timestamp:Date.now()})},lchown:function(e,t,r){mt.chown(e,t,r,!0)},fchown:function(e,t,r){var i=mt.getStream(e);if(!i)throw new mt.ErrnoError(8);mt.chown(i.node,t,r)},truncate:function(e,t){if(t<0)throw new mt.ErrnoError(28);var r;if(!(r="string"==typeof e?mt.lookupPath(e,{follow:!0}).node:e).node_ops.setattr)throw new mt.ErrnoError(63);if(mt.isDir(r.mode))throw new mt.ErrnoError(31);if(!mt.isFile(r.mode))throw new mt.ErrnoError(28);var i=mt.nodePermissions(r,"w");if(i)throw new mt.ErrnoError(i);r.node_ops.setattr(r,{size:t,timestamp:Date.now()})},ftruncate:function(e,t){var r=mt.getStream(e);if(!r)throw new mt.ErrnoError(8);if(0==(2097155&r.flags))throw new mt.ErrnoError(28);mt.truncate(r.node,t)},utime:function(e,t,r){var i=mt.lookupPath(e,{follow:!0}).node;i.node_ops.setattr(i,{timestamp:Math.max(t,r)})},open:function(t,r,i,n,s){if(""===t)throw new mt.ErrnoError(44);var o;if(i=void 0===i?438:i,i=64&(r="string"==typeof r?mt.modeStringToFlags(r):r)?4095&i|32768:0,"object"==Object(d.a)(t))o=t;else{t=ht.normalize(t);try{o=mt.lookupPath(t,{follow:!(131072&r)}).node}catch(e){}}var a=!1;if(64&r)if(o){if(128&r)throw new mt.ErrnoError(20)}else o=mt.mknod(t,i,0),a=!0;if(!o)throw new mt.ErrnoError(44);if(mt.isChrdev(o.mode)&&(r&=-513),65536&r&&!mt.isDir(o.mode))throw new mt.ErrnoError(54);if(!a){var l=mt.mayOpen(o,r);if(l)throw new mt.ErrnoError(l)}512&r&&mt.truncate(o,0),r&=-131713;var c=mt.createStream({node:o,path:mt.getPath(o),flags:r,seekable:!0,position:0,stream_ops:o.stream_ops,ungotten:[],error:!1},n,s);c.stream_ops.open&&c.stream_ops.open(c),!e.logReadFiles||1&r||(mt.readFiles||(mt.readFiles={}),t in mt.readFiles||(mt.readFiles[t]=1,u("FS.trackingDelegate error on read file: "+t)));try{if(mt.trackingDelegate.onOpenFile){var h=0;1!=(2097155&r)&&(h|=mt.tracking.openFlags.READ),0!=(2097155&r)&&(h|=mt.tracking.openFlags.WRITE),mt.trackingDelegate.onOpenFile(t,h)}}catch(e){u("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return c},close:function(e){if(mt.isClosed(e))throw new mt.ErrnoError(8);e.getdents&&(e.getdents=null);try{e.stream_ops.close&&e.stream_ops.close(e)}catch(e){throw e}finally{mt.closeStream(e.fd)}e.fd=null},isClosed:function(e){return null===e.fd},llseek:function(e,t,r){if(mt.isClosed(e))throw new mt.ErrnoError(8);if(!e.seekable||!e.stream_ops.llseek)throw new mt.ErrnoError(70);if(0!=r&&1!=r&&2!=r)throw new mt.ErrnoError(28);return e.position=e.stream_ops.llseek(e,t,r),e.ungotten=[],e.position},read:function(e,t,r,i,n){if(i<0||n<0)throw new mt.ErrnoError(28);if(mt.isClosed(e))throw new mt.ErrnoError(8);if(1==(2097155&e.flags))throw new mt.ErrnoError(8);if(mt.isDir(e.node.mode))throw new mt.ErrnoError(31);if(!e.stream_ops.read)throw new mt.ErrnoError(28);var s=void 0!==n;if(s){if(!e.seekable)throw new mt.ErrnoError(70)}else n=e.position;var o=e.stream_ops.read(e,t,r,i,n);return s||(e.position+=o),o},write:function(e,t,r,i,n,s){if(i<0||n<0)throw new mt.ErrnoError(28);if(mt.isClosed(e))throw new mt.ErrnoError(8);if(0==(2097155&e.flags))throw new mt.ErrnoError(8);if(mt.isDir(e.node.mode))throw new mt.ErrnoError(31);if(!e.stream_ops.write)throw new mt.ErrnoError(28);e.seekable&&1024&e.flags&&mt.llseek(e,0,2);var o=void 0!==n;if(o){if(!e.seekable)throw new mt.ErrnoError(70)}else n=e.position;var a=e.stream_ops.write(e,t,r,i,n,s);o||(e.position+=a);try{e.path&&mt.trackingDelegate.onWriteToFile&&mt.trackingDelegate.onWriteToFile(e.path)}catch(t){u("FS.trackingDelegate['onWriteToFile']('"+e.path+"') threw an exception: "+t.message)}return a},allocate:function(e,t,r){if(mt.isClosed(e))throw new mt.ErrnoError(8);if(t<0||r<=0)throw new mt.ErrnoError(28);if(0==(2097155&e.flags))throw new mt.ErrnoError(8);if(!mt.isFile(e.node.mode)&&!mt.isDir(e.node.mode))throw new mt.ErrnoError(43);if(!e.stream_ops.allocate)throw new mt.ErrnoError(138);e.stream_ops.allocate(e,t,r)},mmap:function(e,t,r,i,n,s){if(0!=(2&n)&&0==(2&s)&&2!=(2097155&e.flags))throw new mt.ErrnoError(2);if(1==(2097155&e.flags))throw new mt.ErrnoError(2);if(!e.stream_ops.mmap)throw new mt.ErrnoError(43);return e.stream_ops.mmap(e,t,r,i,n,s)},msync:function(e,t,r,i,n){return e&&e.stream_ops.msync?e.stream_ops.msync(e,t,r,i,n):0},munmap:function(e){return 0},ioctl:function(e,t,r){if(!e.stream_ops.ioctl)throw new mt.ErrnoError(59);return e.stream_ops.ioctl(e,t,r)},readFile:function(e,t){if((t=t||{}).flags=t.flags||0,t.encoding=t.encoding||"binary","utf8"!==t.encoding&&"binary"!==t.encoding)throw new Error('Invalid encoding type "'+t.encoding+'"');var r,i=mt.open(e,t.flags),n=mt.stat(e).size,s=new Uint8Array(n);return mt.read(i,s,0,n,0),"utf8"===t.encoding?r=m(s,0):"binary"===t.encoding&&(r=s),mt.close(i),r},writeFile:function(e,t,r){(r=r||{}).flags=r.flags||577;var i=mt.open(e,r.flags,r.mode);if("string"==typeof t){var n=new Uint8Array(w(t)+1),s=y(t,n,0,n.length);mt.write(i,n,0,s,void 0,r.canOwn)}else{if(!ArrayBuffer.isView(t))throw new Error("Unsupported data type");mt.write(i,t,0,t.byteLength,void 0,r.canOwn)}mt.close(i)},cwd:function(){return mt.currentPath},chdir:function(e){var t=mt.lookupPath(e,{follow:!0});if(null===t.node)throw new mt.ErrnoError(44);if(!mt.isDir(t.node.mode))throw new mt.ErrnoError(54);var r=mt.nodePermissions(t.node,"x");if(r)throw new mt.ErrnoError(r);mt.currentPath=t.path},createDefaultDirectories:function(){mt.mkdir("/tmp"),mt.mkdir("/home"),mt.mkdir("/home/web_user")},createDefaultDevices:function(){mt.mkdir("/dev"),mt.registerDevice(mt.makedev(1,3),{read:function(){return 0},write:function(e,t,r,i,n){return i}}),mt.mkdev("/dev/null",mt.makedev(1,3)),vt.register(mt.makedev(5,0),vt.default_tty_ops),vt.register(mt.makedev(6,0),vt.default_tty1_ops),mt.mkdev("/dev/tty",mt.makedev(5,0)),mt.mkdev("/dev/tty1",mt.makedev(6,0));var e=function(){if("object"==("undefined"==typeof crypto?"undefined":Object(d.a)(crypto))&&"function"==typeof crypto.getRandomValues){var e=new Uint8Array(1);return function(){return crypto.getRandomValues(e),e[0]}}return function(){W("randomDevice")}}();mt.createDevice("/dev","random",e),mt.createDevice("/dev","urandom",e),mt.mkdir("/dev/shm"),mt.mkdir("/dev/shm/tmp")},createSpecialDirectories:function(){mt.mkdir("/proc");var e=mt.mkdir("/proc/self");mt.mkdir("/proc/self/fd"),mt.mount({mount:function(){var t=mt.createNode(e,"fd",16895,73);return t.node_ops={lookup:function(e,t){var r=+t,i=mt.getStream(r);if(!i)throw new mt.ErrnoError(8);var n={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:function(){return i.path}}};return n.parent=n,n}},t}},{},"/proc/self/fd")},createStandardStreams:function(){e.stdin?mt.createDevice("/dev","stdin",e.stdin):mt.symlink("/dev/tty","/dev/stdin"),e.stdout?mt.createDevice("/dev","stdout",null,e.stdout):mt.symlink("/dev/tty","/dev/stdout"),e.stderr?mt.createDevice("/dev","stderr",null,e.stderr):mt.symlink("/dev/tty1","/dev/stderr"),mt.open("/dev/stdin",0),mt.open("/dev/stdout",1),mt.open("/dev/stderr",1)},ensureErrnoError:function(){mt.ErrnoError||(mt.ErrnoError=function(e,t){this.node=t,this.setErrno=function(e){this.errno=e},this.setErrno(e),this.message="FS error"},mt.ErrnoError.prototype=new Error,mt.ErrnoError.prototype.constructor=mt.ErrnoError,[44].forEach((function(e){mt.genericErrors[e]=new mt.ErrnoError(e),mt.genericErrors[e].stack="<generic error, no stack>"})))},staticInit:function(){mt.ensureErrnoError(),mt.nameTable=new Array(4096),mt.mount(pt,{},"/"),mt.createDefaultDirectories(),mt.createDefaultDevices(),mt.createSpecialDirectories(),mt.filesystems={MEMFS:pt}},init:function(t,r,i){mt.init.initialized=!0,mt.ensureErrnoError(),e.stdin=t||e.stdin,e.stdout=r||e.stdout,e.stderr=i||e.stderr,mt.createStandardStreams()},quit:function(){mt.init.initialized=!1;var t=e._fflush;t&&t(0);for(var r=0;r<mt.streams.length;r++){var i=mt.streams[r];i&&mt.close(i)}},getMode:function(e,t){var r=0;return e&&(r|=365),t&&(r|=146),r},findObject:function(e,t){var r=mt.analyzePath(e,t);return r.exists?r.object:null},analyzePath:function(e,t){try{e=(i=mt.lookupPath(e,{follow:!t})).path}catch(e){}var r={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var i=mt.lookupPath(e,{parent:!0});r.parentExists=!0,r.parentPath=i.path,r.parentObject=i.node,r.name=ht.basename(e),i=mt.lookupPath(e,{follow:!t}),r.exists=!0,r.path=i.path,r.object=i.node,r.name=i.node.name,r.isRoot="/"===i.path}catch(e){r.error=e.errno}return r},createPath:function(e,t,r,i){e="string"==typeof e?e:mt.getPath(e);for(var n=t.split("/").reverse();n.length;){var s=n.pop();if(s){var o=ht.join2(e,s);try{mt.mkdir(o)}catch(e){}e=o}}return o},createFile:function(e,t,r,i,n){var s=ht.join2("string"==typeof e?e:mt.getPath(e),t),o=mt.getMode(i,n);return mt.create(s,o)},createDataFile:function(e,t,r,i,n,s){var o=t?ht.join2("string"==typeof e?e:mt.getPath(e),t):e,a=mt.getMode(i,n),l=mt.create(o,a);if(r){if("string"==typeof r){for(var c=new Array(r.length),h=0,u=r.length;h<u;++h)c[h]=r.charCodeAt(h);r=c}mt.chmod(l,146|a);var d=mt.open(l,577);mt.write(d,r,0,r.length,0,s),mt.close(d),mt.chmod(l,a)}return l},createDevice:function(e,t,r,i){var n=ht.join2("string"==typeof e?e:mt.getPath(e),t),s=mt.getMode(!!r,!!i);mt.createDevice.major||(mt.createDevice.major=64);var o=mt.makedev(mt.createDevice.major++,0);return mt.registerDevice(o,{open:function(e){e.seekable=!1},close:function(e){i&&i.buffer&&i.buffer.length&&i(10)},read:function(e,t,i,n,s){for(var o=0,a=0;a<n;a++){var l;try{l=r()}catch(e){throw new mt.ErrnoError(29)}if(void 0===l&&0===o)throw new mt.ErrnoError(6);if(null==l)break;o++,t[i+a]=l}return o&&(e.node.timestamp=Date.now()),o},write:function(e,t,r,n,s){for(var o=0;o<n;o++)try{i(t[r+o])}catch(e){throw new mt.ErrnoError(29)}return n&&(e.node.timestamp=Date.now()),o}}),mt.mkdev(n,s,o)},forceLoadFile:function(e){if(e.isDevice||e.isFolder||e.link||e.contents)return!0;if("undefined"!=typeof XMLHttpRequest)throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");if(!s)throw new Error("Cannot load without read() or XMLHttpRequest.");try{e.contents=Et(s(e.url),!0),e.usedBytes=e.contents.length}catch(e){throw new mt.ErrnoError(29)}},createLazyFile:function(e,t,r,i,n){function s(){this.lengthKnown=!1,this.chunks=[]}if(s.prototype.get=function(e){if(!(e>this.length-1||e<0)){var t=e%this.chunkSize,r=e/this.chunkSize|0;return this.getter(r)[t]}},s.prototype.setDataGetter=function(e){this.getter=e},s.prototype.cacheLength=function(){var e=new XMLHttpRequest;if(e.open("HEAD",r,!1),e.send(null),!(e.status>=200&&e.status<300||304===e.status))throw new Error("Couldn't load "+r+". Status: "+e.status);var t,i=Number(e.getResponseHeader("Content-length")),n=(t=e.getResponseHeader("Accept-Ranges"))&&"bytes"===t,s=(t=e.getResponseHeader("Content-Encoding"))&&"gzip"===t,o=1048576;n||(o=i);var a=this;a.setDataGetter((function(e){var t=e*o,n=(e+1)*o-1;if(n=Math.min(n,i-1),void 0===a.chunks[e]&&(a.chunks[e]=function(e,t){if(e>t)throw new Error("invalid range ("+e+", "+t+") or no bytes requested!");if(t>i-1)throw new Error("only "+i+" bytes available! programmer error!");var n=new XMLHttpRequest;if(n.open("GET",r,!1),i!==o&&n.setRequestHeader("Range","bytes="+e+"-"+t),"undefined"!=typeof Uint8Array&&(n.responseType="arraybuffer"),n.overrideMimeType&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.send(null),!(n.status>=200&&n.status<300||304===n.status))throw new Error("Couldn't load "+r+". Status: "+n.status);return void 0!==n.response?new Uint8Array(n.response||[]):Et(n.responseText||"",!0)}(t,n)),void 0===a.chunks[e])throw new Error("doXHR failed!");return a.chunks[e]})),!s&&i||(o=i=1,i=this.getter(0).length,o=i,h("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=i,this._chunkSize=o,this.lengthKnown=!0},"undefined"!=typeof XMLHttpRequest)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var o={isDevice:!1,url:r},a=mt.createFile(e,t,o,i,n);o.contents?a.contents=o.contents:o.url&&(a.contents=null,a.url=o.url),Object.defineProperties(a,{usedBytes:{get:function(){return this.contents.length}}});var l={};return Object.keys(a.stream_ops).forEach((function(e){var t=a.stream_ops[e];l[e]=function(){return mt.forceLoadFile(a),t.apply(null,arguments)}})),l.read=function(e,t,r,i,n){mt.forceLoadFile(a);var s=e.node.contents;if(n>=s.length)return 0;var o=Math.min(s.length-n,i);if(s.slice)for(var l=0;l<o;l++)t[r+l]=s[n+l];else for(l=0;l<o;l++)t[r+l]=s.get(n+l);return o},a.stream_ops=l,a},createPreloadedFile:function(t,r,i,n,s,o,a,l,c,h){Browser.init();var u=r?ft.resolve(ht.join2(t,r)):t;function d(i){function d(e){h&&h(),l||mt.createDataFile(t,r,e,n,s,c),o&&o(),Y()}var p=!1;e.preloadPlugins.forEach((function(e){p||e.canHandle(u)&&(e.handle(i,u,d,(function(){a&&a(),Y()})),p=!0)})),p||d(i)}Q(),"string"==typeof i?Browser.asyncLoad(i,(function(e){d(e)}),a):d(i)},indexedDB:function(){return window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB},DB_NAME:function(){return"EM_FS_"+window.location.pathname},DB_VERSION:20,DB_STORE_NAME:"FILE_DATA",saveFilesToDB:function(e,t,r){t=t||function(){},r=r||function(){};var i=mt.indexedDB();try{var n=i.open(mt.DB_NAME(),mt.DB_VERSION)}catch(e){return r(e)}n.onupgradeneeded=function(){h("creating db"),n.result.createObjectStore(mt.DB_STORE_NAME)},n.onsuccess=function(){var i=n.result.transaction([mt.DB_STORE_NAME],"readwrite"),s=i.objectStore(mt.DB_STORE_NAME),o=0,a=0,l=e.length;function c(){0==a?t():r()}e.forEach((function(e){var t=s.put(mt.analyzePath(e).object.contents,e);t.onsuccess=function(){++o+a==l&&c()},t.onerror=function(){a++,o+a==l&&c()}})),i.onerror=r},n.onerror=r},loadFilesFromDB:function(e,t,r){t=t||function(){},r=r||function(){};var i=mt.indexedDB();try{var n=i.open(mt.DB_NAME(),mt.DB_VERSION)}catch(e){return r(e)}n.onupgradeneeded=r,n.onsuccess=function(){var i=n.result;try{var s=i.transaction([mt.DB_STORE_NAME],"readonly")}catch(e){return void r(e)}var o=s.objectStore(mt.DB_STORE_NAME),a=0,l=0,c=e.length;function h(){0==l?t():r()}e.forEach((function(e){var t=o.get(e);t.onsuccess=function(){mt.analyzePath(e).exists&&mt.unlink(e),mt.createDataFile(ht.dirname(e),ht.basename(e),t.result,!0,!0,!0),++a+l==c&&h()},t.onerror=function(){l++,a+l==c&&h()}})),s.onerror=r},n.onerror=r}},gt={mappings:{},DEFAULT_POLLMASK:5,umask:511,calculateAt:function(e,t,r){if("/"===t[0])return t;var i;if(-100===e)i=mt.cwd();else{var n=mt.getStream(e);if(!n)throw new mt.ErrnoError(8);i=n.path}if(0==t.length){if(!r)throw new mt.ErrnoError(44);return i}return ht.join2(i,t)},doStat:function(e,t,r){try{var i=e(t)}catch(e){if(e&&e.node&&ht.normalize(t)!==ht.normalize(mt.getPath(e.node)))return-54;throw e}return D[r>>2]=i.dev,D[r+4>>2]=0,D[r+8>>2]=i.ino,D[r+12>>2]=i.mode,D[r+16>>2]=i.nlink,D[r+20>>2]=i.uid,D[r+24>>2]=i.gid,D[r+28>>2]=i.rdev,D[r+32>>2]=0,q=[i.size>>>0,(Z=i.size,+Math.abs(Z)>=1?Z>0?(0|Math.min(+Math.floor(Z/4294967296),4294967295))>>>0:~~+Math.ceil((Z-+(~~Z>>>0))/4294967296)>>>0:0)],D[r+40>>2]=q[0],D[r+44>>2]=q[1],D[r+48>>2]=4096,D[r+52>>2]=i.blocks,D[r+56>>2]=i.atime.getTime()/1e3|0,D[r+60>>2]=0,D[r+64>>2]=i.mtime.getTime()/1e3|0,D[r+68>>2]=0,D[r+72>>2]=i.ctime.getTime()/1e3|0,D[r+76>>2]=0,q=[i.ino>>>0,(Z=i.ino,+Math.abs(Z)>=1?Z>0?(0|Math.min(+Math.floor(Z/4294967296),4294967295))>>>0:~~+Math.ceil((Z-+(~~Z>>>0))/4294967296)>>>0:0)],D[r+80>>2]=q[0],D[r+84>>2]=q[1],0},doMsync:function(e,t,r,i,n){var s=b.slice(e,e+r);mt.msync(t,s,n,r,i)},doMkdir:function(e,t){return"/"===(e=ht.normalize(e))[e.length-1]&&(e=e.substr(0,e.length-1)),mt.mkdir(e,t,0),0},doMknod:function(e,t,r){switch(61440&t){case 32768:case 8192:case 24576:case 4096:case 49152:break;default:return-28}return mt.mknod(e,t,r),0},doReadlink:function(e,t,r){if(r<=0)return-28;var i=mt.readlink(e),n=Math.min(r,w(i)),s=O[t+n];return A(i,t,r+1),O[t+n]=s,n},doAccess:function(e,t){if(-8&t)return-28;var r;if(!(r=mt.lookupPath(e,{follow:!0}).node))return-44;var i="";return 4&t&&(i+="r"),2&t&&(i+="w"),1&t&&(i+="x"),i&&mt.nodePermissions(r,i)?-2:0},doDup:function(e,t,r){var i=mt.getStream(r);return i&&mt.close(i),mt.open(e,t,0,r,r).fd},doReadv:function(e,t,r,i){for(var n=0,s=0;s<r;s++){var o=D[t+8*s>>2],a=D[t+(8*s+4)>>2],l=mt.read(e,O,o,a,i);if(l<0)return-1;if(n+=l,l<a)break}return n},doWritev:function(e,t,r,i){for(var n=0,s=0;s<r;s++){var o=D[t+8*s>>2],a=D[t+(8*s+4)>>2],l=mt.write(e,O,o,a,i);if(l<0)return-1;n+=l}return n},varargs:void 0,get:function(){return gt.varargs+=4,D[gt.varargs-4>>2]},getStr:function(e){return g(e)},getStreamFromFD:function(e){var t=mt.getStream(e);if(!t)throw new mt.ErrnoError(8);return t},get64:function(e,t){return e}};function yt(e){return e%4==0&&(e%100!=0||e%400==0)}function At(e,t){for(var r=0,i=0;i<=t;r+=e[i++]);return r}var bt=[31,29,31,30,31,30,31,31,30,31,30,31],wt=[31,28,31,30,31,30,31,31,30,31,30,31];function xt(e,t){for(var r=new Date(e.getTime());t>0;){var i=yt(r.getFullYear()),n=r.getMonth(),s=(i?bt:wt)[n];if(!(t>s-r.getDate()))return r.setDate(r.getDate()+t),r;t-=s-r.getDate()+1,r.setDate(1),n<11?r.setMonth(n+1):(r.setMonth(0),r.setFullYear(r.getFullYear()+1))}return r}de=e.InternalError=he(Error,"InternalError"),function(){for(var e=new Array(256),t=0;t<256;++t)e[t]=String.fromCharCode(t);ge=e}(),Ae=e.BindingError=he(Error,"BindingError"),ke.prototype.isAliasOf=function(e){if(!(this instanceof ke))return!1;if(!(e instanceof ke))return!1;for(var t=this.$$.ptrType.registeredClass,r=this.$$.ptr,i=e.$$.ptrType.registeredClass,n=e.$$.ptr;t.baseClass;)r=t.upcast(r),t=t.baseClass;for(;i.baseClass;)n=i.upcast(n),i=i.baseClass;return t===i&&r===n},ke.prototype.clone=function(){if(this.$$.ptr||xe(this),this.$$.preservePointerOnDelete)return this.$$.count.value+=1,this;var e,t=De(Object.create(Object.getPrototypeOf(this),{$$:{value:(e=this.$$,{count:e.count,deleteScheduled:e.deleteScheduled,preservePointerOnDelete:e.preservePointerOnDelete,ptr:e.ptr,ptrType:e.ptrType,smartPtr:e.smartPtr,smartPtrType:e.smartPtrType})}}));return t.$$.count.value+=1,t.$$.deleteScheduled=!1,t},ke.prototype.delete=function(){this.$$.ptr||xe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&be("Object already scheduled for deletion"),Ee(this),Ce(this.$$),this.$$.preservePointerOnDelete||(this.$$.smartPtr=void 0,this.$$.ptr=void 0)},ke.prototype.isDeleted=function(){return!this.$$.ptr},ke.prototype.deleteLater=function(){return this.$$.ptr||xe(this),this.$$.deleteScheduled&&!this.$$.preservePointerOnDelete&&be("Object already scheduled for deletion"),Be.push(this),1===Be.length&&Se&&Se(Te),this.$$.deleteScheduled=!0,this},Ge.prototype.getPointee=function(e){return this.rawGetPointee&&(e=this.rawGetPointee(e)),e},Ge.prototype.destructor=function(e){this.rawDestructor&&this.rawDestructor(e)},Ge.prototype.argPackAdvance=8,Ge.prototype.readValueFromPointer=ae,Ge.prototype.deleteObject=function(e){null!==e&&e.delete()},Ge.prototype.fromWireType=function(e){var t=this.getPointee(e);if(!t)return this.destructor(e),null;var r=function(e,t){return t=function(e,t){for(void 0===t&&be("ptr should not be undefined");e.baseClass;)t=e.upcast(t),e=e.baseClass;return t}(e,t),ze[t]}(this.registeredClass,t);if(void 0!==r){if(0===r.$$.count.value)return r.$$.ptr=t,r.$$.smartPtr=e,r.clone();var i=r.clone();return this.destructor(e),i}function n(){return this.isSmartPointer?Ue(this.registeredClass.instancePrototype,{ptrType:this.pointeeType,ptr:t,smartPtrType:this,smartPtr:e}):Ue(this.registeredClass.instancePrototype,{ptrType:this,ptr:e})}var s,o=this.registeredClass.getActualType(t),a=_e[o];if(!a)return n.call(this);s=this.isConst?a.constPointerType:a.pointerType;var l=Re(t,this.registeredClass,s.registeredClass);return null===l?n.call(this):this.isSmartPointer?Ue(s.registeredClass.instancePrototype,{ptrType:s,ptr:l,smartPtrType:this,smartPtr:e}):Ue(s.registeredClass.instancePrototype,{ptrType:s,ptr:l})},e.getInheritedInstanceCount=function(){return Object.keys(ze).length},e.getLiveInheritedInstances=function(){var e=[];for(var t in ze)ze.hasOwnProperty(t)&&e.push(ze[t]);return e},e.flushPendingDeletes=Te,e.setDelayFunction=function(e){Se=e,Be.length&&Se&&Se(Te)},Qe=e.UnboundTypeError=he(Error,"UnboundTypeError"),e.count_emval_handles=function(){for(var e=0,t=5;t<Ze.length;++t)void 0!==Ze[t]&&++e;return e},e.get_first_emval=function(){for(var e=5;e<Ze.length;++e)if(void 0!==Ze[e])return Ze[e];return null};var Ot=function(e,t,r,i){e||(e=this),this.parent=e,this.mount=e.mount,this.mounted=null,this.id=mt.nextInode++,this.name=t,this.mode=r,this.node_ops={},this.stream_ops={},this.rdev=i};function Et(e,t,r){var i=r>0?r:w(e)+1,n=new Array(i),s=y(e,n,0,n.length);return t&&(n.length=s),n}Object.defineProperties(Ot.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(e){e?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(e){e?this.mode|=146:this.mode&=-147}},isFolder:{get:function(){return mt.isDir(this.mode)}},isDevice:{get:function(){return mt.isChrdev(this.mode)}}}),mt.FSNode=Ot,mt.staticInit();var Ct,Dt={h:function(e){return Bt(e+16)+16},j:function(e,t,r){throw new re(e).init(t,r),e},n:function(e){var t=ne[e];delete ne[e];var r=t.elements,i=r.length,n=r.map((function(e){return e.getterReturnType})).concat(r.map((function(e){return e.setterArgumentType}))),s=t.rawConstructor,o=t.rawDestructor;ve([e],n,(function(e){return r.forEach((function(t,r){var n=e[r],s=t.getter,o=t.getterContext,a=e[r+i],l=t.setter,c=t.setterContext;t.read=function(e){return n.fromWireType(s(o,e))},t.write=function(e,t){var r=[];l(c,e,a.toWireType(r,t)),ie(r)}})),[{name:t.name,fromWireType:function(e){for(var t=new Array(i),n=0;n<i;++n)t[n]=r[n].read(e);return o(e),t},toWireType:function(e,n){if(i!==n.length)throw new TypeError("Incorrect number of tuple elements for "+t.name+": expected="+i+", actual="+n.length);for(var a=s(),l=0;l<i;++l)r[l].write(a,n[l]);return null!==e&&e.push(o,a),a},argPackAdvance:8,readValueFromPointer:ae,destructorFunction:o}]}))},s:function(e){var t=pe[e];delete pe[e];var r=t.rawConstructor,i=t.rawDestructor,n=t.fields;ve([e],n.map((function(e){return e.getterReturnType})).concat(n.map((function(e){return e.setterArgumentType}))),(function(e){var s={};return n.forEach((function(t,r){var i=t.fieldName,o=e[r],a=t.getter,l=t.getterContext,c=e[r+n.length],h=t.setter,u=t.setterContext;s[i]={read:function(e){return o.fromWireType(a(l,e))},write:function(e,t){var r=[];h(u,e,c.toWireType(r,t)),ie(r)}}})),[{name:t.name,fromWireType:function(e){var t={};for(var r in s)t[r]=s[r].read(e);return i(e),t},toWireType:function(e,t){for(var n in s)if(!(n in t))throw new TypeError('Missing field:  "'+n+'"');var o=r();for(n in s)s[n].write(o,t[n]);return null!==e&&e.push(i,o),o},argPackAdvance:8,readValueFromPointer:ae,destructorFunction:i}]}))},F:function(e,t,r,i,n){var s=me(r);we(e,{name:t=ye(t),fromWireType:function(e){return!!e},toWireType:function(e,t){return t?i:n},argPackAdvance:8,readValueFromPointer:function(e){var i;if(1===r)i=O;else if(2===r)i=E;else{if(4!==r)throw new TypeError("Unknown boolean type size: "+t);i=D}return this.fromWireType(i[e>>s])},destructorFunction:null})},g:function(e,t,r,i,n,s,o,a,l,c,h,u,d){h=ye(h),s=Je(n,s),a&&(a=Je(o,a)),c&&(c=Je(l,c)),d=Je(u,d);var p=le(h);Le(p,(function(){Ye("Cannot construct "+h+" due to unbound types",[i])})),ve([e,t,r],i?[i]:[],(function(t){var r,n;t=t[0],n=i?(r=t.registeredClass).instancePrototype:ke.prototype;var o=ce(p,(function(){if(Object.getPrototypeOf(this)!==l)throw new Ae("Use 'new' to construct "+h);if(void 0===u.constructor_body)throw new Ae(h+" has no accessible constructor");var e=u.constructor_body[arguments.length];if(void 0===e)throw new Ae("Tried to invoke ctor of "+h+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(u.constructor_body).toString()+") parameters instead!");return e.apply(this,arguments)})),l=Object.create(n,{constructor:{value:o}});o.prototype=l;var u=new Ne(h,o,l,d,r,s,a,c),f=new Ge(h,u,!0,!1,!1),v=new Ge(h+"*",u,!1,!1,!1),g=new Ge(h+" const*",u,!1,!0,!1);return _e[e]={pointerType:v,constPointerType:g},Ve(p,o),[f,v,g]}))},f:function(e,t,r,i,n,s){p(t>0);var o=We(t,r);n=Je(i,n);var a=[s],l=[];ve([],[e],(function(e){var r="constructor "+(e=e[0]).name;if(void 0===e.registeredClass.constructor_body&&(e.registeredClass.constructor_body=[]),void 0!==e.registeredClass.constructor_body[t-1])throw new Ae("Cannot register multiple constructors with identical number of parameters ("+(t-1)+") for class '"+e.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");return e.registeredClass.constructor_body[t-1]=function(){Ye("Cannot construct "+e.name+" due to unbound types",o)},ve([],o,(function(i){return e.registeredClass.constructor_body[t-1]=function(){arguments.length!==t-1&&be(r+" called with "+arguments.length+" arguments, expected "+(t-1)),l.length=0,a.length=t;for(var e=1;e<t;++e)a[e]=i[e].toWireType(l,arguments[e-1]);var s=n.apply(null,a);return ie(l),i[0].fromWireType(s)},[]})),[]}))},b:function(e,t,r,i,n,s,o,a){var l=We(r,i);t=ye(t),s=Je(n,s),ve([],[e],(function(e){var i=(e=e[0]).name+"."+t;function n(){Ye("Cannot call "+i+" due to unbound types",l)}a&&e.registeredClass.pureVirtualFunctions.push(t);var c=e.registeredClass.instancePrototype,h=c[t];return void 0===h||void 0===h.overloadTable&&h.className!==e.name&&h.argCount===r-2?(n.argCount=r-2,n.className=e.name,c[t]=n):(Me(c,t,i),c[t].overloadTable[r-2]=n),ve([],l,(function(n){var a=Xe(i,n,e,s,o);return void 0===c[t].overloadTable?(a.argCount=r-2,c[t]=a):c[t].overloadTable[r-2]=a,[]})),[]}))},r:function(e,t,r,i,n,s,o,a,l,c){t=ye(t),n=Je(i,n),ve([],[e],(function(e){var i=(e=e[0]).name+"."+t,h={get:function(){Ye("Cannot access "+i+" due to unbound types",[r,o])},enumerable:!0,configurable:!0};return h.set=l?function(){Ye("Cannot access "+i+" due to unbound types",[r,o])}:function(e){be(i+" is a read-only property")},Object.defineProperty(e.registeredClass.instancePrototype,t,h),ve([],l?[r,o]:[r],(function(r){var o=r[0],h={get:function(){var t=Ke(this,e,i+" getter");return o.fromWireType(n(s,t))},enumerable:!0};if(l){l=Je(a,l);var u=r[1];h.set=function(t){var r=Ke(this,e,i+" setter"),n=[];l(c,r,u.toWireType(n,t)),ie(n)}}return Object.defineProperty(e.registeredClass.instancePrototype,t,h),[]})),[]}))},E:function(e,t){we(e,{name:t=ye(t),fromWireType:function(e){var t=Ze[e].value;return et(e),t},toWireType:function(e,t){return tt(t)},argPackAdvance:8,readValueFromPointer:ae,destructorFunction:null})},w:function(e,t,r,i){var n=me(r);function s(){}t=ye(t),s.values={},we(e,{name:t,constructor:s,fromWireType:function(e){return this.constructor.values[e]},toWireType:function(e,t){return t.value},argPackAdvance:8,readValueFromPointer:nt(t,n,i),destructorFunction:null}),Le(t,s)},o:function(e,t,r){var i=it(e,"enum");t=ye(t);var n=i.constructor,s=Object.create(i.constructor.prototype,{value:{value:r},constructor:{value:ce(i.name+"_"+t,(function(){}))}});n.values[r]=s,n[t]=s},v:function(e,t,r){var i=me(r);we(e,{name:t=ye(t),fromWireType:function(e){return e},toWireType:function(e,t){if("number"!=typeof t&&"boolean"!=typeof t)throw new TypeError('Cannot convert "'+at(t)+'" to '+this.name);return t},argPackAdvance:8,readValueFromPointer:ot(t,i),destructorFunction:null})},a:function(e,t,r,i,n,s){var o=We(t,r);e=ye(e),n=Je(i,n),Le(e,(function(){Ye("Cannot call "+e+" due to unbound types",o)}),t-1),ve([],o,(function(r){var i=[r[0],null].concat(r.slice(1));return Ve(e,Xe(e,i,null,n,s),t-1),[]}))},e:function(e,t,r,i,n){t=ye(t),-1===n&&(n=4294967295);var s=me(r),o=function(e){return e};if(0===i){var a=32-8*r;o=function(e){return e<<a>>>a}}var l=-1!=t.indexOf("unsigned");we(e,{name:t,fromWireType:o,toWireType:function(e,r){if("number"!=typeof r&&"boolean"!=typeof r)throw new TypeError('Cannot convert "'+at(r)+'" to '+this.name);if(r<i||r>n)throw new TypeError('Passing a number "'+at(r)+'" from JS side to C/C++ side to an argument of type "'+t+'", which is outside the valid range ['+i+", "+n+"]!");return l?r>>>0:0|r},argPackAdvance:8,readValueFromPointer:st(t,s,0!==i),destructorFunction:null})},d:function(e,t,r){var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][t];function n(e){var t=S,r=t[e>>=2],n=t[e+1];return new i(x,n,r)}we(e,{name:r=ye(r),fromWireType:n,argPackAdvance:8,readValueFromPointer:n},{ignoreDuplicateRegistrations:!0})},u:function(e,t){var r="std::string"===(t=ye(t));we(e,{name:t,fromWireType:function(e){var t,i=S[e>>2];if(r)for(var n=e+4,s=0;s<=i;++s){var o=e+4+s;if(s==i||0==b[o]){var a=g(n,o-n);void 0===t?t=a:(t+=String.fromCharCode(0),t+=a),n=o+1}}else{var l=new Array(i);for(s=0;s<i;++s)l[s]=String.fromCharCode(b[e+4+s]);t=l.join("")}return Tt(e),t},toWireType:function(e,t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var i="string"==typeof t;i||t instanceof Uint8Array||t instanceof Uint8ClampedArray||t instanceof Int8Array||be("Cannot pass non-string to std::string");var n=(r&&i?function(){return w(t)}:function(){return t.length})(),s=Bt(4+n+1);if(S[s>>2]=n,r&&i)A(t,s+4,n+1);else if(i)for(var o=0;o<n;++o){var a=t.charCodeAt(o);a>255&&(Tt(s),be("String has UTF-16 code units that do not fit in 8 bits")),b[s+4+o]=a}else for(o=0;o<n;++o)b[s+4+o]=t[o];return null!==e&&e.push(Tt,s),s},argPackAdvance:8,readValueFromPointer:ae,destructorFunction:function(e){Tt(e)}})},q:function(e,t,r){var i,n,s,o,a;r=ye(r),2===t?(i=_,n=M,o=L,s=function(){return C},a=1):4===t&&(i=N,n=F,o=I,s=function(){return S},a=2),we(e,{name:r,fromWireType:function(e){for(var r,n=S[e>>2],o=s(),l=e+4,c=0;c<=n;++c){var h=e+4+c*t;if(c==n||0==o[h>>a]){var u=i(l,h-l);void 0===r?r=u:(r+=String.fromCharCode(0),r+=u),l=h+t}}return Tt(e),r},toWireType:function(e,i){"string"!=typeof i&&be("Cannot pass non-string to C++ string type "+r);var s=o(i),l=Bt(4+s+t);return S[l>>2]=s>>a,n(i,l+4,s+t),null!==e&&e.push(Tt,l),l},argPackAdvance:8,readValueFromPointer:ae,destructorFunction:function(e){Tt(e)}})},m:function(e,t,r,i,n,s){ne[e]={name:ye(t),rawConstructor:Je(r,i),rawDestructor:Je(n,s),elements:[]}},c:function(e,t,r,i,n,s,o,a,l){ne[e].elements.push({getterReturnType:t,getter:Je(r,i),getterContext:n,setterArgumentType:s,setter:Je(o,a),setterContext:l})},p:function(e,t,r,i,n,s){pe[e]={name:ye(t),rawConstructor:Je(r,i),rawDestructor:Je(n,s),fields:[]}},l:function(e,t,r,i,n,s,o,a,l,c){pe[e].fields.push({fieldName:ye(t),getterReturnType:r,getter:Je(i,n),getterContext:s,setterArgumentType:o,setter:Je(a,l),setterContext:c})},D:function(e,t){we(e,{isVoid:!0,name:t=ye(t),argPackAdvance:0,fromWireType:function(){},toWireType:function(e,t){}})},C:et,B:function(e){e>4&&(Ze[e].refcount+=1)},k:function(e,t){return tt((e=it(e,"_emval_take_value")).readValueFromPointer(t))},t:function(){W()},A:function(e,t,r){b.copyWithin(e,t,t+r)},i:function(e){e>>>=0;var t=b.length,r=2147483648;if(e>r)return!1;for(var i,s=1;s<=4;s*=2){var n=t*(1+.2/s);if(n=Math.min(n,e+100663296),ut(Math.min(r,((i=Math.max(16777216,e,n))%65536>0&&(i+=65536-i%65536),i))))return!0}return!1},K:function(e,t){try{var r=0;return ct().forEach((function(i,n){var s=t+r;D[e+4*n>>2]=s,function(e,t,r){for(var i=0;i<e.length;++i)O[t++>>0]=e.charCodeAt(i);O[t>>0]=0}(i,s),r+=i.length+1})),0}catch(e){return void 0!==mt&&e instanceof mt.ErrnoError||W(e),e.errno}},J:function(e,t){try{var r=ct();D[e>>2]=r.length;var i=0;return r.forEach((function(e){i+=e.length+1})),D[t>>2]=i,0}catch(e){return void 0!==mt&&e instanceof mt.ErrnoError||W(e),e.errno}},I:function(e){try{var t=gt.getStreamFromFD(e);return mt.close(t),0}catch(e){return void 0!==mt&&e instanceof mt.ErrnoError||W(e),e.errno}},H:function(e,t,r,i){try{var n=gt.getStreamFromFD(e),s=gt.doReadv(n,t,r);return D[i>>2]=s,0}catch(e){return void 0!==mt&&e instanceof mt.ErrnoError||W(e),e.errno}},z:function(e,t,r,i,n){try{var s=gt.getStreamFromFD(e),o=4294967296*r+(t>>>0),a=9007199254740992;return o<=-a||o>=a?-61:(mt.llseek(s,o,i),q=[s.position>>>0,(Z=s.position,+Math.abs(Z)>=1?Z>0?(0|Math.min(+Math.floor(Z/4294967296),4294967295))>>>0:~~+Math.ceil((Z-+(~~Z>>>0))/4294967296)>>>0:0)],D[n>>2]=q[0],D[n+4>>2]=q[1],s.getdents&&0===o&&0===i&&(s.getdents=null),0)}catch(e){return void 0!==mt&&e instanceof mt.ErrnoError||W(e),e.errno}},G:function(e,t,r,i){try{var n=gt.getStreamFromFD(e),s=gt.doWritev(n,t,r);return D[i>>2]=s,0}catch(e){return void 0!==mt&&e instanceof mt.ErrnoError||W(e),e.errno}},y:function(e){},x:function(e,t,r,i){return function(e,t,r,i){var n=D[i+40>>2],s={tm_sec:D[i>>2],tm_min:D[i+4>>2],tm_hour:D[i+8>>2],tm_mday:D[i+12>>2],tm_mon:D[i+16>>2],tm_year:D[i+20>>2],tm_wday:D[i+24>>2],tm_yday:D[i+28>>2],tm_isdst:D[i+32>>2],tm_gmtoff:D[i+36>>2],tm_zone:n?g(n):""},o=g(r),a={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var l in a)o=o.replace(new RegExp(l,"g"),a[l]);var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function u(e,t,r){for(var i="number"==typeof e?e.toString():e||"";i.length<t;)i=r[0]+i;return i}function d(e,t){return u(e,t,"0")}function p(e,t){function r(e){return e<0?-1:e>0?1:0}var i;return 0===(i=r(e.getFullYear()-t.getFullYear()))&&0===(i=r(e.getMonth()-t.getMonth()))&&(i=r(e.getDate()-t.getDate())),i}function f(e){switch(e.getDay()){case 0:return new Date(e.getFullYear()-1,11,29);case 1:return e;case 2:return new Date(e.getFullYear(),0,3);case 3:return new Date(e.getFullYear(),0,2);case 4:return new Date(e.getFullYear(),0,1);case 5:return new Date(e.getFullYear()-1,11,31);case 6:return new Date(e.getFullYear()-1,11,30)}}function v(e){var t=xt(new Date(e.tm_year+1900,0,1),e.tm_yday),r=new Date(t.getFullYear(),0,4),i=new Date(t.getFullYear()+1,0,4),n=f(r),s=f(i);return p(n,t)<=0?p(s,t)<=0?t.getFullYear()+1:t.getFullYear():t.getFullYear()-1}var m={"%a":function(e){return c[e.tm_wday].substring(0,3)},"%A":function(e){return c[e.tm_wday]},"%b":function(e){return h[e.tm_mon].substring(0,3)},"%B":function(e){return h[e.tm_mon]},"%C":function(e){return d((e.tm_year+1900)/100|0,2)},"%d":function(e){return d(e.tm_mday,2)},"%e":function(e){return u(e.tm_mday,2," ")},"%g":function(e){return v(e).toString().substring(2)},"%G":function(e){return v(e)},"%H":function(e){return d(e.tm_hour,2)},"%I":function(e){var t=e.tm_hour;return 0==t?t=12:t>12&&(t-=12),d(t,2)},"%j":function(e){return d(e.tm_mday+At(yt(e.tm_year+1900)?bt:wt,e.tm_mon-1),3)},"%m":function(e){return d(e.tm_mon+1,2)},"%M":function(e){return d(e.tm_min,2)},"%n":function(){return"\n"},"%p":function(e){return e.tm_hour>=0&&e.tm_hour<12?"AM":"PM"},"%S":function(e){return d(e.tm_sec,2)},"%t":function(){return"\t"},"%u":function(e){return e.tm_wday||7},"%U":function(e){var t=new Date(e.tm_year+1900,0,1),r=0===t.getDay()?t:xt(t,7-t.getDay()),i=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(p(r,i)<0){var n=At(yt(i.getFullYear())?bt:wt,i.getMonth()-1)-31,s=31-r.getDate()+n+i.getDate();return d(Math.ceil(s/7),2)}return 0===p(r,t)?"01":"00"},"%V":function(e){var t,r=new Date(e.tm_year+1900,0,4),i=new Date(e.tm_year+1901,0,4),n=f(r),s=f(i),o=xt(new Date(e.tm_year+1900,0,1),e.tm_yday);return p(o,n)<0?"53":p(s,o)<=0?"01":(t=n.getFullYear()<e.tm_year+1900?e.tm_yday+32-n.getDate():e.tm_yday+1-n.getDate(),d(Math.ceil(t/7),2))},"%w":function(e){return e.tm_wday},"%W":function(e){var t=new Date(e.tm_year,0,1),r=1===t.getDay()?t:xt(t,0===t.getDay()?1:7-t.getDay()+1),i=new Date(e.tm_year+1900,e.tm_mon,e.tm_mday);if(p(r,i)<0){var n=At(yt(i.getFullYear())?bt:wt,i.getMonth()-1)-31,s=31-r.getDate()+n+i.getDate();return d(Math.ceil(s/7),2)}return 0===p(r,t)?"01":"00"},"%y":function(e){return(e.tm_year+1900).toString().substring(2)},"%Y":function(e){return e.tm_year+1900},"%z":function(e){var t=e.tm_gmtoff,r=t>=0;return t=(t=Math.abs(t)/60)/60*100+t%60,(r?"+":"-")+String("0000"+t).slice(-4)},"%Z":function(e){return e.tm_zone},"%%":function(){return"%"}};for(var l in m)o.indexOf(l)>=0&&(o=o.replace(new RegExp(l,"g"),m[l](s)));var y=Et(o,!1);return y.length>t?0:(j(y,e),y.length-1)}(e,t,r,i)}},St=(function(){var t={a:Dt};function i(t,r){var i=t.exports;e.asm=i,P((c=e.asm.L).buffer),R=e.asm.N,Y()}function n(e){i(e.instance)}function s(e){return(l||"function"!=typeof fetch?Promise.resolve().then((function(){return ee($)})):fetch($,{credentials:"same-origin"}).then((function(e){if(!e.ok)throw"failed to load wasm binary file at '"+$+"'";return e.arrayBuffer()})).catch((function(){return ee($)}))).then((function(e){return WebAssembly.instantiate(e,t)})).then(e,(function(e){u("failed to asynchronously prepare wasm: "+e),W(e)}))}if(Q(),e.instantiateWasm)try{return e.instantiateWasm(t,i)}catch(e){return u("Module.instantiateWasm callback failed with error: "+e),!1}(l||"function"!=typeof WebAssembly.instantiateStreaming||X($)||"function"!=typeof fetch?s(n):fetch($,{credentials:"same-origin"}).then((function(e){return WebAssembly.instantiateStreaming(e,t).then(n,(function(e){return u("wasm streaming compile failed: "+e),u("falling back to ArrayBuffer instantiation"),s(n)}))}))).catch(r)}(),e.___wasm_call_ctors=function(){return(St=e.___wasm_call_ctors=e.asm.M).apply(null,arguments)}),Bt=e._malloc=function(){return(Bt=e._malloc=e.asm.O).apply(null,arguments)},Tt=e._free=function(){return(Tt=e._free=e.asm.P).apply(null,arguments)},kt=e.___getTypeName=function(){return(kt=e.___getTypeName=e.asm.Q).apply(null,arguments)},_t=(e.___embind_register_native_and_builtin_types=function(){return(e.___embind_register_native_and_builtin_types=e.asm.R).apply(null,arguments)},e.stackSave=function(){return(_t=e.stackSave=e.asm.S).apply(null,arguments)}),Mt=e.stackRestore=function(){return(Mt=e.stackRestore=e.asm.T).apply(null,arguments)},tr=e.stackAlloc=function(){return(tr=e.stackAlloc=e.asm.U).apply(null,arguments)};function Lt(r){function i(){Ct||(Ct=!0,e.calledRun=!0,f||(e.noFSInit||mt.init.initialized||mt.init(),vt.init(),te(U),mt.ignorePermissions=!1,te(G),t(e),e.onRuntimeInitialized&&e.onRuntimeInitialized(),function(){if(e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;)t=e.postRun.shift(),V.unshift(t);var t;te(V)}()))}H>0||(function(){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)t=e.preRun.shift(),z.unshift(t);var t;te(z)}(),H>0||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),i()}),1)):i()))}if(e.dynCall_jiji=function(){return(e.dynCall_jiji=e.asm.V).apply(null,arguments)},e.dynCall_viijii=function(){return(e.dynCall_viijii=e.asm.W).apply(null,arguments)},e.dynCall_iiiiiijj=function(){return(e.dynCall_iiiiiijj=e.asm.X).apply(null,arguments)},e.dynCall_iiiiij=function(){return(e.dynCall_iiiiij=e.asm.Y).apply(null,arguments)},e.dynCall_iiiiijj=function(){return(e.dynCall_iiiiijj=e.asm.Z).apply(null,arguments)},e.ccall=function(t,r,i,n,s){var o={string:function(e){var t=0;if(null!=e&&0!==e){var r=1+(e.length<<2);A(e,t=tr(r),r)}return t},array:function(e){var t=tr(e.length);return j(e,t),t}},a=function(t){var r=e["_"+t];return p(r,"Cannot call unknown function "+t+", make sure it is exported"),r}(t),l=[],c=0;if(n)for(var h=0;h<n.length;h++){var u=o[i[h]];u?(0===c&&(c=_t()),l[h]=u(n[h])):l[h]=n[h]}var d=a.apply(null,l);return d=function(e){return"string"===r?g(e):"boolean"===r?Boolean(e):e}(d),0!==c&&Mt(c),d},J=function e(){Ct||Lt(),Ct||(J=e)},e.run=Lt,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return Lt(),e.ready})().then((function(e){return tt=e}),(function(){}));var st=new r.Vector3,ut=new r.BoxGeometry(200,200,200);ut.userData.type="CubeGeometry";var lt,ct,ht=((et=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,s,n=null!==(i=null!==(r=e.geometry)&&void 0!==r?r:null==t?void 0:t.geometry)&&void 0!==i?i:ut;void 0===t?(n.computeBoundingBox(),n.boundingBox.getSize(st),s={width:st.x,height:st.y,depth:st.z,subdivisions:1}):s=t.parameters;var o=Object.assign(Object.assign({},s),e.parameters);return{parameters:Object.assign(Object.assign({},o),{width:Math.abs(o.width),height:Math.abs(o.height),depth:Math.abs(o.depth)}),geometry:n,subdivPointer:null==t?void 0:t.subdivPointer,smoothShading:null==t?void 0:t.smoothShading}}},{key:"build",value:function(e){var t,r,n=e.geometry,o=e.geometry.originalGeometry,l=e.parameters,i=l.width,c=l.height,s=l.depth,h=l.subdivisions,a=n.userData.parameters;if(void 0===a?(n.computeBoundingBox(),n.boundingBox.getSize(st)):st.set(a.width,a.height,a.depth),i!==st.x||c!==st.y||s!==st.z){var d=[i/st.x,c/st.y,s/st.z];n.scale(0===st.x?1:d[0],0===st.y?1:d[1],0===st.z?1:d[2]),null==o||o.scale(0===st.x?1:d[0],0===st.y?1:d[1],0===st.z?1:d[2])}return void 0!==o?(r=n,t=o):t=n,void 0===e.subdivPointer&&(this.allocate(t),console.log("allocated new subdiv instance at: ",this.activeSubdivPtr),null==t||t.dispose(),t=this.buildLevel(!0,e.smoothShading),e.subdivPointer=this.activeSubdivPtr),h>0?(h===(null==a?void 0:a.subdivisions)&&void 0!==o||(e.subdivPointer!==this.activeSubdivPtr&&(this.activeSubdivPtr=e.subdivPointer),null==r||r.dispose(),tt.set_destination_refinement_level(e.subdivPointer,h),r=this.buildLevel(!1,e.smoothShading)),n=r,delete(o=t).userData.parameters):(n=t,null==r||r.dispose(),o=void 0),Object.assign(n,{originalGeometry:o,subdivPointer:this.activeSubdivPtr,userData:{parameters:e.parameters,type:"SubdivGeometry"}})}},{key:"allocate",value:function(e){var t,r,i,n=[],s=[];if("SubdivGeometry"!==e.userData.type){var o=ot(e,2);t=o.attributes.position.array;var l=o.getIndex().array,c=l.length;switch(e.userData.type){case"TorusGeometry":case"CubeGeometry":r=new Array(c/3*2),i=new Array(c/6).fill(4);for(var h=0,d=0;h<c;h+=6)r[d++]=l[h],r[d++]=l[h+1],r[d++]=l[h+4],r[d++]=l[h+5];break;case"SphereGeometry":case"CylinderGeometry":var f,v;"SphereGeometry"===e.userData.type?(v=e.parameters.heightSegments,f=e.parameters.widthSegments):(v=e.parameters.heightSegments+2,f=e.parameters.radialSegments),r=new Array((c-6*f)/6*4+6*f),i=new Array(2*f+(v-2)*f*v);var m=0,A=0,w=0;if("SphereGeometry"===e.userData.type){for(;A<3*f;)r[A++]=l[m++],r[A++]=l[m++],r[A++]=l[m++],i[w++]=3;for(;A<3*f+4*(v-2)*f;m+=6)r[A++]=l[m],r[A++]=l[m+1],r[A++]=l[m+4],r[A++]=l[m+5],i[w++]=4}else for(;A<4*(v-2)*f;m+=6)r[A++]=l[m],r[A++]=l[m+1],r[A++]=l[m+4],r[A++]=l[m+5],i[w++]=4;for(;A<r.length;)r[A++]=l[m++],r[A++]=l[m++],r[A++]=l[m++],i[w++]=3;break;default:r=l,i=new Array(c/3).fill(3)}}else{console.log("sending existing SubdivGeometry back to WASM");var x=e.getAttribute("faceMap");e.deleteAttribute("faceMap");var O=ot(e,2);e.setAttribute("faceMap",x),t=O.attributes.position.array,r=[];var E=x.array;i=new Array(E[E.length-1]+1).fill(3);for(var C=O.getIndex().array,D=0,S=E.length;D<S;){var B,T;E[D]===E[D+1]?(i[E[D]]++,(B=r).push.apply(B,Object(y.a)(new Set(C.slice(3*D,3*D+6)))),D+=2):((T=r).push.apply(T,Object(y.a)(C.slice(3*D,3*D+3))),D++)}}console.log("wasm allocate:",i.length,"triangles");var k=t.length,a=r.length,_=i.length,M=t.length+n.length+s.length,L=r.length+i.length,u=M*Float32Array.BYTES_PER_ELEMENT+L*Uint32Array.BYTES_PER_ELEMENT;console.log("Total WASM memory size (in bytes):",u);var N=M*Float32Array.BYTES_PER_ELEMENT,p=tt._malloc(u);console.log("after malloc wasmPointer");var F=new Float32Array(tt.HEAPF32.buffer,p,M),I=new Uint32Array(tt.HEAPU32.buffer,p+N,L),g=at(Float32Array,t,n,s),j=at(Uint32Array,r,i);F.set(g,0),I.set(j,0),console.log("before wasm.alloc_subdivision_surface"),this.activeSubdivPtr=tt.alloc_subdivision_surface(p,k,p+N,a,p+N+r.length*Uint32Array.BYTES_PER_ELEMENT,_),console.log("allocate subdivPointer",this.activeSubdivPtr),console.log("after wasm.alloc_subdivision_surface"),tt._free(p)}},{key:"buildLevel",value:function(e,t,i){var n=tt.get_mesh_data(this.activeSubdivPtr,e?tt.Level.CONTROL:tt.Level.REFINED,null!=t?t:!e),s=tt.HEAPU32.subarray(n>>2,8+(n>>2)),o=s.subarray(4,8),a=0,l=tt.HEAPU32[s[a]>>2],c=tt.HEAPF32.subarray(l>>2,(l>>2)+o[a]);a++;var h=tt.HEAPU32[s[a]>>2],u=tt.HEAPF32.subarray(h>>2,(h>>2)+o[a]);a++;var d=tt.HEAPU32[s[a]>>2],p=tt.HEAPU32.subarray(d>>2,(d>>2)+o[a]);a++;var f=tt.HEAPU32[s[a]>>2],v=tt.HEAPU32.subarray(f>>2,(f>>2)+o[a]);if(a++,void 0===i){var m=new r.BufferGeometry;if(e&&m.setAttribute("faceMap",new r.BufferAttribute(p.slice(),1)),m.setIndex(new r.Uint32BufferAttribute(v,1)),m.setAttribute("position",new r.Float32BufferAttribute(c,3)),m.setAttribute("normal",new r.Float32BufferAttribute(u,3)),e){var y=new Float32Array(u.length/3*4).fill(0);m.setAttribute("color",new r.BufferAttribute(y,4))}return tt.free_mesh_data(n),m.userData.type="SubdivGeometry",m}i.getAttribute("position").copyArray(c),i.getAttribute("normal").copyArray(u),i.attributes.position.needsUpdate=!0,i.attributes.normal.needsUpdate=!0,tt.free_mesh_data(n)}},{key:"buildControlCageWireframe",value:function(e,t){var i=tt.get_wireframe_data_for_base_level(this.activeSubdivPtr),n=tt.HEAPU32.subarray(i>>2,4+(i>>2)),s=n.subarray(2,4),o=0,a=tt.HEAPU32[n[o]>>2],l=tt.HEAPF32.subarray(a>>2,(a>>2)+s[o]);o++;var c=tt.HEAPU32[n[o]>>2],h=tt.HEAPU32.subarray(c>>2,(c>>2)+s[o]);if(void 0===e){var d=new r.BufferGeometry;d.setAttribute("position",new r.Float32BufferAttribute(l,3));for(var f=new Float32Array(l.length),v=0,m=l.length;v<m;)f[v++]=t.r,f[v++]=t.g,f[v++]=t.b;return d.setAttribute("color",new r.BufferAttribute(f,3)),d.setIndex(new r.Uint32BufferAttribute(h,1)),tt.free_wireframe_data_for_base_level(i),d}e.getAttribute("position").copyArray(l),e.attributes.position.needsUpdate=!0,tt.free_wireframe_data_for_base_level(i)}},{key:"clone",value:function(e,t,r){this.activeSubdivPtr=tt.copy_subdivision_surface(t),tt.set_destination_refinement_level(this.activeSubdivPtr,e.subdivisions);var n,s,i=this.buildLevel(!0,r);return e.subdivisions>0?(n=this.buildLevel(!1,r),delete(s=i).userData.parameters):(n=i,s=void 0),Object.assign(n,{originalGeometry:s,subdivPointer:this.activeSubdivPtr,userData:{parameters:e,type:"SubdivGeometry"}})}}]),e}()).checkpoints=[],et.checkpointCurrentIndex=-1,et.maxCheckpoints=30,et),ft=(new r.Sphere,new r.Matrix4,new r.Ray,new r.Vector3,new r.Vector3,new r.Vector3,new r.Vector3,{ConeGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:32,heightSegments:32,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadiusTop:0,cornerRadiusBottom:0,cornerSegments:8},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t,n=e.parameters,o=n.width,i=n.depth,l=n.height,c=n.radialSegments,a=n.heightSegments,h=n.openEnded,d=n.thetaStart,f=n.thetaLength,u=n.cornerRadiusTop,v=n.cornerRadiusBottom,p=n.cornerSegments;return(t=u>0||v>0||f<360?new s(0,o/2,l,c,a,h,d,f*Math.PI/180,u,v,p,0,!0):new r.ConeBufferGeometry(o/2,l,c,a,h)).scale(1,1,i/o),Object.assign(t,{userData:Object.assign(Object.assign({},e),{type:"ConeGeometry"})})}}]),e}(),CubeGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,widthSegments:1,heightSegments:1,depthSegments:1,cornerRadius:0,cornerSegments:8},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var u,t=e.parameters,n=t.width,i=t.height,o=t.depth,s=t.widthSegments,l=t.heightSegments,c=t.depthSegments,h=t.cornerRadius,d=t.cornerSegments;return u=0==h?new r.BoxBufferGeometry(n,i,o,s,l,c):new a(n,i,o,s,l,c,h,d),Object.assign(u,{userData:Object.assign(Object.assign({},e),{type:"CubeGeometry"})})}}]),e}(),CylinderGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s,o,a=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:64,heightSegments:1,openEnded:!1,thetaStart:0,thetaLength:360,cornerRadius:0,cornerSegments:8,hollow:0},e.parameters),l=a.width/2,c=null!==(i=a.radiusTop)&&void 0!==i?i:l,h=null!==(n=a.radiusBottom)&&void 0!==n?n:l;return c===h?(c=l,h=l):c>h?h=h*l/(c=l):(c=c*l/h,h=l),{parameters:Object.assign(a,{width:Math.abs(a.width),height:Math.abs(null!==(s=a.height)&&void 0!==s?s:a.width),depth:Math.abs(null!==(o=a.depth)&&void 0!==o?o:a.width),radiusTop:c,radiusBottom:h})}}},{key:"build",value:function(e){var g,t=e.parameters,n=t.width,i=t.depth,o=t.height,l=t.radialSegments,a=t.heightSegments,c=t.openEnded,h=t.thetaStart,d=t.thetaLength,u=t.radiusTop,f=t.radiusBottom,p=t.cornerRadius,v=t.cornerSegments,m=t.hollow;return(g=p||m?new s(u,f,o,l,a,c,h,d*Math.PI/180,p,p,v,m):new r.CylinderBufferGeometry(u,f,o,l,a,c,h,d*Math.PI/180)).scale(1,1,i/n),Object.assign(g,{userData:Object.assign(Object.assign({},e),{type:"CylinderGeometry"})})}}]),e}(),DodecahedronGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,detail:0},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t=e.parameters,n=t.width,i=t.height,o=t.depth,s=t.detail,l=new r.DodecahedronBufferGeometry(.5*n,s);return l.scale(1,i/n,o/n),Object.assign(l,{userData:Object.assign(Object.assign({},e),{type:"DodecahedronGeometry"})})}}]),e}(),EllipseGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,spikes:128,angle:360,innerRadius:0,extrudeDepth:0,extrudeBevelSize:0,extrudeBevelSegments:1,surfaceMaxCount:1e3},e.parameters);return{shape:new re,parameters:Object.assign(n,{width:Math.abs(n.width),height:Math.abs(null!==(i=n.height)&&void 0!==i?i:n.width)})}}},{key:"build",value:function(e){var t=e.parameters,r=t.width,n=t.height,i=t.spikes,o=t.angle,s=t.innerRadius,l=t.extrudeDepth,a=t.extrudeBevelSize,c=t.extrudeBevelSegments,h=t.surfaceMaxCount,d=e.shape,u=function(e,t,r,i,n,s){if(i>=De)return n>30||n%4==0?(function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=.5522847498,a=t*o,l=r*o;e.addPoint(Te(n-t,s,n-t,s-l,n-t,s+l)),e.addPoint(Te(n,s+r,n-a,s+r,n+a,s+r)),e.addPoint(Te(n+t,s,n+t,s+l,n+t,s-l)),e.addPoint(Te(n,s-r,n+a,s-r,n-a,s-r)),i>0&&_e(e,t,r,i)}(e,t,r,s),Math.round(n/4)):Se(e,i,n,t,r,s);var o={x:0,y:r},a=i+.5*Math.PI,l={x:Math.cos(a)*t,y:Math.sin(a)*r},c=function(e){var t=e.px,r=e.py,n=e.cx,i=e.cy,o=e.rx,s=e.ry,l=e.largeArcFlag,a=e.sweepFlag,c=[];if(0===o||0===s)return[];var h=(t-n)/2,d=(r-i)/2;if(0===h&&0===d)return[];o=Math.abs(o),s=Math.abs(s);var u=Math.pow(h,2)/Math.pow(o,2)+Math.pow(d,2)/Math.pow(s,2);u>1&&(o*=Math.sqrt(u),s*=Math.sqrt(u));var f=function(e,t,r,i,n,s,o,a,l,c){var h=Math.pow(n,2),u=Math.pow(s,2),d=Math.pow(o,2),p=Math.pow(a,2),f=h*u-h*p-u*d;f<0&&(f=0),f/=h*p+u*d;var v=(f=Math.sqrt(f)*(l===c?-1:1))*n/s*a,g=f*-s/n*o,m=v+(e+r)/2,y=g+(t+i)/2,A=(o-v)/n,w=(a-g)/s,x=(-o-v)/n,b=(-a-g)/s,O=oe(1,0,A,w),E=oe(A,w,x,b);return!c&&E>0&&(E-=ne),c&&E<0&&(E+=ne),{centerx:m,centery:y,ang1:O,ang2:E}}(t,r,n,i,o,s,h,d,l,a),p=f.ang1,v=f.ang2,m=f.centerx,g=f.centery,y=Math.abs(v)/(ne/4);Math.abs(1-y)<1e-7&&(y=1);var A=Math.max(Math.ceil(y),1);v/=A;for(var w=0;w<A;w++)c.push(ae(p,v)),p+=v;return c.map((function(e){var t=ie(e[0],o,s,m,g),r=t.x,n=t.y,l=ie(e[1],o,s,m,g),i=l.x,c=l.y,h=ie(e[2],o,s,m,g);return{x1:r,y1:n,x2:i,y2:c,x:h.x,y:h.y}}))}({px:o.x,py:o.y,cx:l.x,cy:l.y,rx:t,ry:r,largeArcFlag:i>Math.PI,sweepFlag:!0});return n>30||n%c.length==0?function(e,t,r,i,n,s,o,a){var l=Math.round(n/i.length);e.addPoint(Be(t,r));for(var c=0,h=i.length;c<h;c++){var d=i[c],f=e.points[c],v=Be(d.x,d.y);f.controls[1].position.set(d.x1,d.y1),v.controls[0].position.set(d.x2,d.y2),e.addPoint(v)}return a>0?ke(e,s,o,a):e.addPoint(Be(0,0)),l}(e,o.x,o.y,c,n,t,r,s):Se(e,i,n,t,r,s)}(d,.5*r,.5*n,o*Math.PI/180,i,s);d.isClosed=!0,d.update();var f=Ce.create({shape:d,parameters:{subdivisions:u,surfaceMaxCount:h,extrudeDepth:l,extrudeBevelSize:a,extrudeBevelSegments:c}});return Object.assign(f,{userData:Object.assign(Object.assign({},e),{type:"EllipseGeometry"})})}}]),e}(),HelixGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,revolutions:2,segments:40,pathRadius:10,pathType:0,pathSegments:30,cornerRadius:30,cornerSegments:4},e.parameters),o=Math.abs(s.width),a=Math.abs(null!==(i=s.height)&&void 0!==i?i:o),l=Math.abs(null!==(n=s.depth)&&void 0!==n?n:o),c=Math.abs(Math.min(o,l))/2;return{parameters:Object.assign(s,{width:o,height:a,depth:l,radius:c,segments:Math.round(s.segments),pathSegments:Math.round(s.pathSegments),cornerSegments:Math.round(s.cornerSegments)})}}},{key:"build",value:function(e){var t=e.parameters,r=t.width,n=t.height,i=t.depth,o=t.radius,s=t.revolutions,l=t.segments,a=t.pathRadius,c=t.pathType,h=t.pathSegments,d=t.cornerRadius,u=t.cornerSegments,f=new Le(!1,r,n,i,o,s,l,a,c,h,d,u);return Object.assign(f,{userData:Object.assign(Object.assign({},e),{type:"HelixGeometry"})})}}]),e}(),IcosahedronGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,detail:0},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t=e.parameters,n=t.width,i=t.height,o=t.depth,s=t.detail,l=new r.IcosahedronBufferGeometry(.5*n,s);return l.scale(1,i/n,o/n),Object.assign(l,{userData:Object.assign(Object.assign({},e),{type:"IcosahedronGeometry"})})}}]),e}(),LatheGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,segments:64,verticalSegments:64,points:[{x:0,y:-50,id:0},{x:50,y:-50,id:1},{x:50,y:50,id:2},{x:0,y:50,id:3}]},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t=e.parameters,n=t.points,i=t.segments,o=t.verticalSegments,s=new r.Shape;s.moveTo(n[0].x,n[0].y),s.bezierCurveTo(n[1].x,n[1].y,n[2].x,n[2].y,n[3].x,n[3].y);var l=new r.LatheBufferGeometry(s.extractPoints(o).shape,i);return l.rotateZ(Math.PI),Object.assign(l,{userData:Object.assign(Object.assign({},e),{type:"LatheGeometry"})})}}]),e}(),NonParametricGeometry:Xe,PolygonGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeDepth:0,extrudeBevelSize:0,extrudeBevelSegments:3},e.parameters);return{shape:new re,parameters:Object.assign(s,{surfaceMaxCount:(null!==(i=s.surfaceMaxCount)&&void 0!==i?i:s.cornerRadius>0)?1e3:100,width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){for(var t=e.parameters,r=t.width,n=t.height,i=t.spikes,o=t.cornerRadius,s=t.extrudeDepth,l=t.extrudeBevelSize,a=t.extrudeBevelSegments,c=t.surfaceMaxCount,h=e.shape,d=.5*r,u=.5*n,f=2*Math.PI/i,v=0;v<i;v++){var m=f*v,y=0+Math.sin(m)*d,A=0+Math.cos(m)*u;h.addPoint(h.createPoint(y,A))}h.isClosed=!0;for(var w=0,x=h.points.length;w<x;w++)h.points[w].roundness=o;h.roundness=o,h.update();var p=Ce.create({shape:h,parameters:{surfaceMaxCount:c,roundness:o,extrudeDepth:s,extrudeBevelSize:l,extrudeBevelSegments:a}});return Object.assign(p,{userData:Object.assign(Object.assign({},e),{type:"PolygonGeometry"})})}}]),e}(),PyramidGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:4,heightSegments:1,cornerRadius:0,cornerSegments:8,openEnded:!1},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t=e.parameters,r=t.width,n=t.height,i=t.depth,o=t.radialSegments,s=t.heightSegments,l=t.openEnded,a=t.cornerRadius,c=t.cornerSegments,h=new nt(.5*r,n,o,s,l,a,c);return h.scale(1,1,i/r),Object.assign(h,{userData:Object.assign(Object.assign({},e),{type:"PyramidGeometry"})})}}]),e}(),RectangleGeometry:it,SphereGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,widthSegments:64,heightSegments:64,phiStart:0,phiLength:2*Math.PI,thetaStart:0,thetaLength:Math.PI},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t=e.parameters,n=t.width,o=void 0===n?100:n,l=t.height,i=void 0===l?o:l,c=t.depth,h=void 0===c?o:c,d=t.widthSegments,s=void 0===d?64:d,f=t.heightSegments,v=void 0===f?64:f,a=t.phiStart,m=t.phiLength,y=t.thetaStart,A=t.thetaLength,u=new r.SphereBufferGeometry(.5*o,s,v,a,m,y,A);return u.scale(1,i/o,h/o),Object.assign(u,{userData:Object.assign(Object.assign({},e),{type:"SphereGeometry"})})}}]),e}(),StarGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,innerRadiusPercent:38.19,spikes:5,cornerRadius:0,angle:360,extrudeDepth:0,extrudeBevelSize:0,extrudeBevelSegments:1},e.parameters);return{shape:new re,parameters:Object.assign(s,{surfaceMaxCount:(null!==(i=s.surfaceMaxCount)&&void 0!==i?i:s.cornerRadius>0)?1e3:100,width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width)})}}},{key:"build",value:function(e){var t=e.parameters,r=t.width,n=t.height,i=t.innerRadiusPercent,o=t.spikes,s=t.cornerRadius,l=t.angle,a=t.extrudeDepth,c=t.extrudeBevelSize,h=t.extrudeBevelSegments,d=t.surfaceMaxCount,u=e.shape,f=.5*r,p=.5*n,v=l*Math.PI/360/o,m=Math.PI/2*3*-1,g=f*i/100,y=p*i/100;if(3==o&&50==i){v=2*Math.PI/o;for(var A=0;A<o;A++){var w=v*A,x=0+Math.sin(w)*f,O=0+Math.cos(w)*p;u.addPoint(u.createPoint(x,O))}}else for(var E=0;E<o;E++){var C=0+Math.cos(m)*f,D=0+Math.sin(m)*p;u.addPoint(u.createPoint(C,D)),m+=v,C=0+Math.cos(m)*g,D=0+Math.sin(m)*y,u.addPoint(u.createPoint(C,D)),m+=v}u.isClosed=!0;for(var S=0,B=u.points.length;S<B;S++)u.points[S].roundness=s;u.roundness=s,u.update();var T=Ce.create({shape:u,parameters:{surfaceMaxCount:d,roundness:s,extrudeDepth:a,extrudeBevelSize:c,extrudeBevelSegments:h}});return Object.assign(T,{userData:Object.assign(Object.assign({},e),{type:"StarGeometry"})})}}]),e}(),TextFrameGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:0)})}}},{key:"build",value:function(e){var t=e.parameters,n=t.width,i=t.height,o=new r.PlaneBufferGeometry(n,i);return Object.assign(o,{userData:Object.assign(Object.assign({},e),{type:"TextFrameGeometry"})})}}]),e}(),TorusGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,radialSegments:64,tubularSegments:64,arc:2*Math.PI,cornerRadius:30,cornerSegments:8},e.parameters),o=Math.abs(s.width),a=Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),l=Math.abs(null!==(n=s.depth)&&void 0!==n?n:.25*s.width);return{parameters:Object.assign(s,{width:o,height:a,depth:l})}}},{key:"build",value:function(e){var t=e.parameters,r=t.width,n=t.height,i=t.depth,o=t.radialSegments,s=t.tubularSegments,l=function(e,t,r,i,n,s,o,a,l,c,h){var d;return r=(d=[r,t])[1],o=(t=d[0])/2,1==(n/=2*Math.PI)&&(c=0),new Le(!0,e,t,r,i,n,s,o,0,l,c,h)}(r,n,i,.5*r,t.arc,s,0,0,o,t.cornerRadius,t.cornerSegments);return l.scale(1,n/r,1),Object.assign(l,{userData:Object.assign(Object.assign({},e),{type:"TorusGeometry"})})}}]),e}(),TorusKnotGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:1,tube:50,tubularSegments:64,radialSegments:32,p:2,q:3},e.parameters);return{parameters:Object.assign(s,{width:Math.abs(s.width),height:Math.abs(null!==(i=s.height)&&void 0!==i?i:s.width),depth:Math.abs(null!==(n=s.depth)&&void 0!==n?n:1)})}}},{key:"build",value:function(e){var t=e.parameters,n=t.width,i=t.tube,o=t.tubularSegments,s=t.radialSegments,l=t.p,a=t.q,c=.5*n-i,h=new r.TorusKnotBufferGeometry(c,i,o,s,l,a);return Object.assign(h,{userData:Object.assign(Object.assign({},e),{type:"TorusKnotGeometry"})})}}]),e}(),TriangleGeometry:function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"create",value:function(e){return this.build(this.normalizeInputs(e))}},{key:"normalizeInputs",value:function(e,t){var r,i,n,s=Object.assign({},null!==(r=null==t?void 0:t.parameters)&&void 0!==r?r:{width:100,depth:0,spikes:5,cornerRadius:0,extrudeDepth:0,extrudeBevelSize:0,extrudeBevelSegments:1,isRect:!1},e.parameters);return{shape:new re,parameters:Object.assign(s,{surfaceMaxCount:(null!==(i=s.surfaceMaxCount)&&void 0!==i?i:s.cornerRadius>0)?1e3:100,width:Math.abs(s.width),height:Math.abs(null!==(n=s.height)&&void 0!==n?n:s.width*(s.isRect?1:Math.sqrt(3)/2))})}}},{key:"build",value:function(e){var t=e.parameters,r=t.width,n=void 0===r?100:r,o=t.height,i=t.cornerRadius,l=t.extrudeDepth,s=t.extrudeBevelSize,c=t.extrudeBevelSegments,a=t.isRect,h=t.surfaceMaxCount,d=e.shape,f=.5*n,u=.5*o;a?(d.addPoint(d.createPoint(-f,u)),d.addPoint(d.createPoint(f,-u)),d.addPoint(d.createPoint(-f,-u))):(d.addPoint(d.createPoint(0,u)),d.addPoint(d.createPoint(f,-u)),d.addPoint(d.createPoint(-f,-u))),d.isClosed=!0;for(var v=0,m=d.points.length;v<m;v++)d.points[v].roundness=i;d.roundness=i,d.update();var y=Ce.create({shape:d,parameters:{surfaceMaxCount:h,roundness:i,extrudeDepth:l,extrudeBevelSize:s,extrudeBevelSegments:c}});return Object.assign(y,{userData:Object.assign(Object.assign({},e),{type:"TriangleGeometry"})})}}]),e}(),VectorGeometry:Ce,SubdivGeometry:ht}),vt=function(e){return ft[e.type].create(e)},pt=function(e){return"isEntity"in e},mt=function(e){return"isAbstractMesh"in e},gt=function(e){return"objectHelper"in e},yt=new r.Box3,At=new r.Vector3,bt=new r.Vector3,wt=new r.Matrix4,rt=function(e,t,i,n){var s;if(mt(e)){var o=e.geometry.userData.parameters,l=e.geometry.getAttribute("position");!function(e,t){for(var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.count,n=1/0,s=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0,h=r;h<i;h++){var d=t.getX(h),f=t.getY(h),v=t.getZ(h);d<n&&(n=d),f<s&&(s=f),v<o&&(o=v),d>a&&(a=d),f>l&&(l=f),v>c&&(c=v)}e.min.set(n,s,o),e.max.set(a,l,c)}(yt,l,e.geometry.drawRange.start,e.geometry.drawRange.count<1/0?e.geometry.drawRange.count:l.count),yt.getCenter(At),e.forceComputeSize?yt.getSize(bt).multiplyScalar(.5):bt.set(o.width,o.height,null!==(s=o.depth)&&void 0!==s?s:0).multiplyScalar(.5)}else if(gt(e)&&!0===n){var c=e.geometryHelper.getAttribute("position");yt.setFromArray(c.array),yt.getCenter(At),yt.getSize(bt).multiplyScalar(.5)}else At.setScalar(0),bt.setScalar(0);wt.copy(t).multiply(e.matrixWorld),0===bt.x&&0===bt.y&&0===bt.z?i.push(new r.Vector3(At.x,At.y,At.z).applyMatrix4(wt)):i.push(new r.Vector3(-bt.x,bt.y,bt.z).add(At).applyMatrix4(wt),new r.Vector3(-bt.x,-bt.y,bt.z).add(At).applyMatrix4(wt),new r.Vector3(bt.x,-bt.y,bt.z).add(At).applyMatrix4(wt),new r.Vector3(bt.x,bt.y,bt.z).add(At).applyMatrix4(wt),new r.Vector3(-bt.x,bt.y,-bt.z).add(At).applyMatrix4(wt),new r.Vector3(-bt.x,-bt.y,-bt.z).add(At).applyMatrix4(wt),new r.Vector3(bt.x,-bt.y,-bt.z).add(At).applyMatrix4(wt),new r.Vector3(bt.x,bt.y,-bt.z).add(At).applyMatrix4(wt))},xt=function(e){Object(x.a)(n,e);var t=S(n);function n(e,o){var l;return Object(A.a)(this,n),(l=t.call(this,e,o)).transform=new r.Matrix4,l.vertices=[],l.faces=[],l.edges=[],l.centerEdges=[],l}return Object(w.a)(n,[{key:"setFromObjectSize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.updateWorldMatrix(!1,!1),this.makeEmpty(),this.transform=e.matrixWorld;var i=(new r.Matrix4).copy(e.matrixWorld).invert();return this.expandByObjectSize(e,i,t)}},{key:"expandByObjectSize",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=[];return!0===r?e.traverseEntity((function(r){return rt(r,t,i,"enableHelper"in e&&e.enableHelper)})):rt(e,t,i,"enableHelper"in e&&e.enableHelper),this.setFromPoints(i)}},{key:"getCenter",value:function(e){return(e=Object(v.a)(Object(E.a)(n.prototype),"getCenter",this).call(this,e)).applyMatrix4(this.transform),e}},{key:"getPositionToCenter",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"getCenter",this).call(this,e)}},{key:"computeVertices",value:function(){this.getSize(bt).multiplyScalar(.5),this.getCenter(At),wt.copy(this.transform).setPosition(At),this.vertices=[new r.Vector3(-bt.x,bt.y,bt.z).applyMatrix4(wt),new r.Vector3(-bt.x,-bt.y,bt.z).applyMatrix4(wt),new r.Vector3(bt.x,-bt.y,bt.z).applyMatrix4(wt),new r.Vector3(bt.x,bt.y,bt.z).applyMatrix4(wt),new r.Vector3(-bt.x,bt.y,-bt.z).applyMatrix4(wt),new r.Vector3(-bt.x,-bt.y,-bt.z).applyMatrix4(wt),new r.Vector3(bt.x,-bt.y,-bt.z).applyMatrix4(wt),new r.Vector3(bt.x,bt.y,-bt.z).applyMatrix4(wt)]}},{key:"computeEdges",value:function(){this.vertices.length>0&&this.computeVertices(),this.edges=[new r.Line3(this.vertices[0],this.vertices[3]),new r.Line3(this.vertices[1],this.vertices[2]),new r.Line3(this.vertices[5],this.vertices[6]),new r.Line3(this.vertices[4],this.vertices[7]),new r.Line3(this.vertices[0],this.vertices[1]),new r.Line3(this.vertices[3],this.vertices[2]),new r.Line3(this.vertices[7],this.vertices[6]),new r.Line3(this.vertices[4],this.vertices[5]),new r.Line3(this.vertices[0],this.vertices[4]),new r.Line3(this.vertices[1],this.vertices[5]),new r.Line3(this.vertices[2],this.vertices[6]),new r.Line3(this.vertices[3],this.vertices[7])],this.centerEdges=this.edges.map((function(e){return e.getCenter(new r.Vector3)}))}},{key:"computeFaces",value:function(){this.vertices.length>0&&this.computeVertices(),this.faces=[(new r.Vector3).copy(this.vertices[0]).sub(this.vertices[2]).multiplyScalar(.5).add(this.vertices[2]),(new r.Vector3).copy(this.vertices[7]).sub(this.vertices[5]).multiplyScalar(.5).add(this.vertices[5]),(new r.Vector3).copy(this.vertices[4]).sub(this.vertices[1]).multiplyScalar(.5).add(this.vertices[1]),(new r.Vector3).copy(this.vertices[3]).sub(this.vertices[6]).multiplyScalar(.5).add(this.vertices[6]),(new r.Vector3).copy(this.vertices[4]).sub(this.vertices[3]).multiplyScalar(.5).add(this.vertices[3]),(new r.Vector3).copy(this.vertices[1]).sub(this.vertices[6]).multiplyScalar(.5).add(this.vertices[6])]}}]),n}(r.Box3);!function(e){e.POSITION="position",e.LIGHTING="light",e.COLOR="color",e.GRADIENT="gradient",e.NORMAL="normal",e.DEPTH="depth",e.TEXTURE="texture",e.NOISE="noise",e.FRESNEL="fresnel",e.POINTS="points",e.MATCAP="matcap",e.LINES="lines",e.DISPLACE="displace"}(lt||(lt={})),function(e){e.POSITION="position",e.LIGHTING="light",e.COLOR="color"}(ct||(ct={}));var Ot=function(){function e(t,r,n){if(Object(A.a)(this,e),this.next=void 0,this.uniforms={},this.textures={},this.defines={},this.backLayer=void 0,this.isBack=!1,this.id=t,r){for(var o in this.type=r.type,r)"type"!==o&&"calpha"!==o&&(this.uniforms["f".concat(this.id,"_").concat(o)]=r[o]);for(var l in n)this.defines[l]=n[l]}}return Object(w.a)(e,[{key:"copy",value:function(e){for(var t in this.id=e.id,this.type=e.type,this.defines=Object.assign({},e.defines),e.uniforms)this.uniforms[t]?this.uniforms[t].copy(e.uniforms[t]):this.uniforms[t]=e.uniforms[t].clone();return this}},{key:"clone",value:function(){return new e(this.id).copy(this)}},{key:"fromJSON",value:function(e,t){for(var r in this.id=e.id,this.defines=Object.assign({},e.defines),e.uniforms)this.uniforms[r]=t.getNode(e.uniforms[r]);return this}},{key:"toJSON",value:function(e){var t={};for(var r in this.uniforms)t[r]=this.uniforms[r].toJSON(e).uuid;return{id:this.id,type:this.type,defines:JSON.parse(JSON.stringify(this.defines)),uniforms:t,next:null==this.next?void 0:this.next.toJSON(e)}}},{key:"copyUniforms",value:function(e){for(var t in this.uniforms){var r=this.getName(t);void 0!==r&&this.uniforms[t].copy(e.uniforms["f".concat(e.id,"_").concat(r)])}return this}},{key:"hasValueByKey",value:function(e){return void 0!==this.uniforms[e]}},{key:"hasValue",value:function(e){return this.hasValueByKey("f".concat(this.id,"_").concat(e))}},{key:"setValue",value:function(e,t){var r="f".concat(this.id,"_").concat(e);this.hasValueByKey(r)&&void 0!==t&&(this.uniforms[r].value=t)}},{key:"getValue",value:function(e){var t="f".concat(this.id,"_").concat(e);if(this.hasValueByKey(t))return this.uniforms[t].value}},{key:"getValues",value:function(){var e={type:this.type};for(var t in this.uniforms){var r=this.getName(t);if(void 0!==r){var n=this.uniforms["f".concat(this.id,"_").concat(r)].value;void 0!==n&&(e[r]=n.clone?n.clone():n)}}return e}},{key:"getName",value:function(e){var t=/f\d+_(.*)/.exec(e);if(t&&t.length>1)return t[1];console.log("Layer.getName: error ".concat(e))}},{key:"getNames",value:function(){var e=[];for(var t in this.uniforms){var r=this.getName(t);r&&e.push(r)}return e}},{key:"isEqual",value:function(e){for(var t in e.uniforms){var n=e.getName(t);if(!n)return!1;var o=this.getValue(n),l=e.uniforms[t].value;if(l.value instanceof r.Texture){if(o.image!==l.image)return!1}else if(Array.isArray(l)){for(var c=o,h=0,d=c.length;h<d;++h)if(c[h]!==l[h])return!1}else{var f=o;if(f.equals){if(!f.equals(l))return!1}else if(o!==l)return!1}}return!0}},{key:"dispose",value:function(){}}]),e}(),Et=function(e,t){var r=e.id,i=e.type;return new Ot(r,{type:i}).fromJSON(e,t)};function Ct(e){var t=e instanceof Ot?e.type:e;return"texture"===t||"displace_map"===t||"matcap"===t}var Dt=function(){function e(t){Object(A.a)(this,e),this.hashProperties=void 0,this.isNode=!0,this.shortcuts={},this.uuid=r.MathUtils.generateUUID(),this.type=t,this.name="",this.userData={}}return Object(w.a)(e,[{key:"analyze",value:function(e,t){t=null!=t?t:{},e.analyzing=!0,this.build(e.addFlow(t.slot,t.cache,t.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1}},{key:"analyzeAndFlow",value:function(e,t,r){return r=null!=r?r:{},this.analyze(e,r),this.flow(e,t,r)}},{key:"flow",value:function(e,t,r){r=null!=r?r:{},e.addFlow(r.slot,r.cache,r.context);var i={result:this.build(e,t),code:e.clearNodeCode(),extra:e.context.extra};return e.removeFlow(),i}},{key:"build",value:function(e,t,r){t=null!=t?t:this.getType(e,t);var i=e.getNodeData(null!=r?r:this);return e.analyzing&&this.appendDepsNode(e,i,t),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,t,r)}},{key:"updateFrame",value:function(e){}},{key:"generateReadonly",value:function(e,t,r,i,n,s){return""}},{key:"generate",value:function(e,t,r,i,n){return""}},{key:"parse",value:function(e,t,r,i){}},{key:"appendDepsNode",value:function(e,t,r){t.deps=(t.deps||0)+1;var i=e.getTypeLength(r);(i>(t.outputMax||0)||this.getType(e,r))&&(t.outputMax=i,t.output=r)}},{key:"setName",value:function(e){this.name=e}},{key:"getName",value:function(){return this.name}},{key:"getType",value:function(e,t){return"sampler2D"===t||"samplerCube"===t?t:this.type}},{key:"getJSONNode",value:function(e){if((null==e?void 0:e.materials)&&void 0!==(null==e?void 0:e.materials[this.uuid]))return e.materials[this.uuid]}},{key:"getHash",value:function(){var t,r,n="{";for(t in this)(r=this[t])instanceof e&&(n+='"'+t+'":'+r.getHash()+",");if(this.hashProperties)for(var o=0;o<this.hashProperties.length;o++)r=this[t=this.hashProperties[o]],n+='"'+t+'":"'+String(r)+'",';return n+='"id":"'+this.uuid+'"}'}},{key:"copy",value:function(e){return this.name=e.name,e.type&&(this.type=e.type),e.frameId&&(this.frameId=e.frameId),e.hashProperties&&(this.hashProperties=e.hashProperties.map((function(e){return e}))),this.userData=JSON.parse(JSON.stringify(e.userData)),this.shortcuts=JSON.parse(JSON.stringify(e.shortcuts)),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"createJSONNode",value:function(e){var t=void 0===e||"string"==typeof e;if("string"!=typeof this.type)throw new Error("Node does not allow serialization.");var r={};return r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),!t&&e&&(e.nodes[this.uuid]=r),r}},{key:"toJSON",value:function(e){var t;return null!==(t=this.getJSONNode(e))&&void 0!==t?t:this.createJSONNode(e)}},{key:"fromJSON",value:function(e,t){return this.uuid=e.uuid,this.type=e.type,e.name&&(this.name=e.name),e.userData&&(this.userData=e.userData),this}}]),e}(),St=function(e){Object(x.a)(n,e);var t=S(n);function n(e,r){var o;return Object(A.a)(this,n),(o=t.call(this,e)).scope="",r=null!=r?r:{},o.shared=void 0===r.shared||r.shared,o.unique=void 0!==r.unique&&r.unique,o}return Object(w.a)(n,[{key:"build",value:function(e,t,i,o){if(t=null!=t?t:this.getType(e),this.getShared(e,t)){var l=this.getUnique(e,t);l&&void 0===this.uuid&&(this.uuid=r.MathUtils.generateUUID()),i=e.getUUID(null!=i?i:this.getUUID(),!l);var c=e.getNodeData(i),h=c.output||this.getType(e);if(e.analyzing)return(c.deps||0)>0||this.getLabel()?(this.appendDepsNode(e,c,t),this.generate(e,t,i)):Object(v.a)(Object(E.a)(n.prototype),"build",this).call(this,e,t,i);if(l)return c.name=c.name||Object(v.a)(Object(E.a)(n.prototype),"build",this).call(this,e,t,i),c.name;if(!this.getLabel()&&(!this.getShared(e,h)||e.context.ignoreCache||1===c.deps))return Object(v.a)(Object(E.a)(n.prototype),"build",this).call(this,e,t,i);i=this.getUUID(!1);var d=this.getTemp(e,i);if(d)return e.format(d,h,t);d=Object(v.a)(Object(E.a)(n.prototype),"generate",this).call(this,e,t,i,c.output,o);var f=this.generate(e,h,i);return e.addNodeCode(d+" = "+f+";"),e.format(d,h,t)}return Object(v.a)(Object(E.a)(n.prototype),"build",this).call(this,e,t,i)}},{key:"getShared",value:function(e,t){return"sampler2D"!==t&&"samplerCube"!==t&&this.shared}},{key:"getUnique",value:function(e,t){return this.unique}},{key:"setLabel",value:function(e){return this.label=e,this}},{key:"getLabel",value:function(){return this.label}},{key:"getUUID",value:function(e){var t=this.uuid;return"string"==typeof this.scope&&(t=this.scope+"-"+t),t}},{key:"getTemp",value:function(e,t){t=t||this.uuid;var r=e.getVars()[t];return r?r.name:void 0}},{key:"generate",value:function(e,t,r,i,n){return this.getShared(e,t)||console.error("TempNode is not shared"),r=null!=r?r:this.uuid,e.getTempVar(r,null!=i?i:this.getType(e),n,this.getLabel()).name}}]),n}(Dt),Bt=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n){var o;return Object(A.a)(this,r),(n=null!=n?n:{}).shared=void 0!==n.shared&&n.shared,(o=t.call(this,e,n)).readonly=!1,o}return Object(w.a)(r,[{key:"setReadonly",value:function(e){return this.readonly=e,this.hashProperties=this.readonly?["value"]:void 0,this}},{key:"getReadonly",value:function(){return this.readonly}},{key:"createJSONNode",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"createJSONNode",this).call(this,e);return!0===this.readonly&&(t.readonly=this.readonly),t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),void 0!==e.readonly&&this.setReadonly(e.readonly),this}},{key:"generate",value:function(e,t,r,i,n,s){r=e.getUUID(null!=r?r:this.getUUID()),i=null!=i?i:this.getType(e);var o=e.getNodeData(r);return this.getReadonly()&&void 0!==this.generateReadonly?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(o.vertex.name,i,t)):(o.fragment||(o.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(o.fragment.name,i,t))}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.readonly=e.readonly,this}}]),r}(St),dt={elements:["x","y","z","w"],addShortcuts:function(){function e(e,t,r){return r?{get:function(){return this[e][t][r]},set:function(i){this[e][t][r]=i}}:{get:function(){return this[e][t]},set:function(r){this[e][t]=r}}}return function(t,r,i){for(var n={},o=0;o<i.length;++o){var l=i[o].split("."),c=l[0],h=l[1];n[c]=e(r,c,h)}Object.defineProperties(t,n)}}()},Tt=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return Object(A.a)(this,n),(e=t.call(this,"c")).nodeType="Color",e.value=o instanceof r.Color?o:new r.Color(o||0,l,i),e}return Object(w.a)(n,[{key:"generate",value:function(e,t,r,i,n,s){r=e.getUUID(null!=r?r:this.getUUID()),i=null!=i?i:this.getType(e);var o=e.getNodeData(r),a=this.getReadonly()&&void 0!==this.generateReadonly;if(this.alpha){var l=this.alpha.build(e,"f");e.addFragmentNodeCode("accumAlpha += ( 1.0 - accumAlpha ) * ".concat(l,";"))}return a?this.generateReadonly(e,t,r,i,n,s):e.isShader("vertex")?(o.vertex||(o.vertex=e.createVertexUniform(i,this,n,s,this.getLabel())),e.format(o.vertex.name,i,t)):(o.fragment||(o.fragment=e.createFragmentUniform(i,this,n,s,this.getLabel())),e.format(o.fragment.name,i,t))}},{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format("vec3("+this.value.r+", "+this.value.g+", "+this.value.b+")",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.value.copy(e.value),e.alpha?this.alpha?this.alpha.copy(e.alpha):this.alpha=e.alpha.clone():this.alpha=void 0,this}},{key:"toJSON",value:function(e){var t,r=this.getJSONNode(e);return r||((r=this.createJSONNode(e)).r=this.value.r,r.g=this.value.g,r.b=this.value.b,r.value=this.value.getHex(),r.alpha=null===(t=this.alpha)||void 0===t?void 0:t.toJSON(e),!0===this.readonly&&(r.readonly=!0)),r.nodeType=this.nodeType,this.alpha&&(r.alpha=this.alpha.uuid),r}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=new r.Color(e.value)),e.alpha&&(this.alpha=t.getNode(e.alpha)),this}}]),n}(Bt);dt.addShortcuts(Tt.prototype,"value",["r","g","b"]);var kt=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"f")).nodeType="Float",n.value=null!=e?e:0,n}return Object(w.a)(r,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format(this.value+(this.value%1?"":".0"),i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value=e.value,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.getReadonly()&&(t.readonly=!0)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=e.value),this}}]),r}(Bt),_t=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"i")).nodeType="Int",n.value=Math.floor(null!=e?e:0),n}return Object(w.a)(r,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format(this.value.toString(),i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value=e.value,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.getReadonly()&&(t.readonly=!0)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=e.value),this}}]),r}(Bt),Mt=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"b")).nodeType="Bool",n.value=null!=e&&e,n}return Object(w.a)(r,[{key:"generateReadonly",value:function(e,t,r,i){return e.format(this.value?"true":"false",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value=e.value,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value,!0===this.getReadonly()&&(t.readonly=!0)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=e.value),this}}]),r}(Bt),Lt=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,n),(e=t.call(this,"v2")).nodeType="Vector2",e.value=o instanceof r.Vector2?o:new r.Vector2(o,l),e}return Object(w.a)(n,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format("vec2("+this.value.x+", "+this.value.y+")",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.value.copy(e.value),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.value.x,t.y=this.value.y,!0===this.getReadonly()&&(t.readonly=!0)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.x&&(this.value.x=e.x),e.y&&(this.value.y=e.y),this}}]),n}(Bt);dt.addShortcuts(Lt.prototype,"value",["x","y"]);var Nt=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return Object(A.a)(this,n),(e=t.call(this,"v3")).nodeType="Vector3",e.value=o instanceof r.Vector3?o:new r.Vector3(o,l,i),e}return Object(w.a)(n,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format("vec3("+this.value.x+", "+this.value.y+", "+this.value.z+")",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.value.copy(e.value),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.value.x,t.y=this.value.y,t.z=this.value.z,!0===this.getReadonly()&&(t.readonly=!0)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.x&&(this.value.x=e.x),e.y&&(this.value.y=e.y),e.z&&(this.value.z=e.z),this}}]),n}(Bt);dt.addShortcuts(Nt.prototype,"value",["x","y","z"]);var Ft=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,l=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,n),(e=t.call(this,"v4[]")).nodeType="Vector4Array",e.size=o,e.value=Array.isArray(l)?l:l instanceof r.Vector4?new Array(o).fill(l):new Array(o).fill(new r.Vector4(0)),e}return Object(w.a)(n,[{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.value=e.value.map((function(e){return e.clone()})),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.map((function(e){return{x:e.x,y:e.y,z:e.z,w:e.w}}))),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=e.value.map((function(e){return new r.Vector4(e.x,e.y,e.z,e.w)})),this.size=this.value.length),this}}]),n}(Bt),It=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,"f[]")).nodeType="FloatArray",e.size=n,e.value=Array.isArray(o)?o:"number"==typeof o?new Array(n).fill(o):new Array(n).fill(0),e}return Object(w.a)(r,[{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.size=e.size,this.value=Object(y.a)(e.value),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).size=this.size,t.value=Object(y.a)(this.value)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=Object(y.a)(e.value)),e.size?this.size=e.size:e.value&&(this.size=this.value.length),this}}]),r}(Bt),jt=new(function(){function e(){Object(A.a)(this,e),this.nodes={},this.keywords={}}return Object(w.a)(e,[{key:"add",value:function(e){this.nodes[e.name]=e}},{key:"addKeyword",value:function(e,t,r){r=void 0===r||r,this.keywords[e]={callback:t,cache:r}}},{key:"remove",value:function(e){delete this.nodes[e.name]}},{key:"removeKeyword",value:function(e){delete this.keywords[e]}},{key:"get",value:function(e){return this.nodes[e]}},{key:"getKeyword",value:function(e,t){return this.keywords[e].callback(t)}},{key:"getKeywordData",value:function(e){return this.keywords[e]}},{key:"contains",value:function(e){return void 0!==this.nodes[e]}},{key:"containsKeyword",value:function(e){return void 0!==this.keywords[e]}}]),e}()),Pt=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"v2",{shared:!1})).nodeType="UV",n.index=null!=e?e:0,n}return Object(w.a)(r,[{key:"generate",value:function(e,t){e.requires.uv[this.index]=!0;var r=this.index>0?this.index+1:"",i=e.isShader("vertex")?"uv"+r:"vUv"+r;return e.format(i,this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.index=e.index,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).index=this.index),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.index&&(this.index=e.index),this}}]),r}(St);jt.addKeyword("uv",(function(){return new Pt})),jt.addKeyword("uv2",(function(){return new Pt(1)}));var Rt=/^\s*([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,zt=/[a-z_0-9]+/gi,Ut=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o,i,l){var c;return Object(A.a)(this,r),(c=t.call(this,l)).src="",c.nodeType="Function",c.useKeywords=!0,c.includes=[],c.extensions={},c.keywords={},c.isMethod=void 0===l,c.isInterface=!1,c.parse(e,n,o,i),c}return Object(w.a)(r,[{key:"getShared",value:function(e,t){return!this.isMethod}},{key:"getType",value:function(e){return e.getTypeByFormat(this.type)}},{key:"getInputByName",value:function(e){if(this.inputs)for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]}},{key:"getIncludeByName",value:function(e){if(this.includes)for(var t=this.includes.length;t--;)if(this.includes[t].name===e)return this.includes[t]}},{key:"generate",value:function(e,t,r,i,n){var s,o=0,a=this.src;if(this.includes)for(var l=0;l<this.includes.length;l++)e.include(this.includes[l],this);for(var c in this.extensions)e.extensions[c]=!0;for(var h=[];s=zt.exec(this.src);)h.push(s);for(var d=0;d<h.length;d++){var f=h[d],v=f[0],m=!this.isMethod||!this.getInputByName(v),y=v;if(this.keywords[v]||this.useKeywords&&m&&jt.containsKeyword(v)){var A=this.keywords[v];if(!A){var w=jt.getKeywordData(v);w.cache&&(A=e.keywords[v]),A=A||jt.getKeyword(v,e),w.cache&&(e.keywords[v]=A)}y=A.build(e)}v!==y&&(a=a.substring(0,f.index+o)+y+a.substring(f.index+v.length+o),o+=y.length-v.length),void 0===this.getIncludeByName(y)&&jt.contains(y)&&e.include(jt.get(y))}return"source"===t?a:this.isMethod?(this.isInterface||e.include(this,void 0,a),this.name):e.format("( "+a+" )",this.getType(e),t)}},{key:"parse",value:function(e,t,r,i){if(this.src=e||"",this.includes=null!=t?t:[],this.extensions=null!=r?r:{},this.keywords=null!=i?i:{},this.isMethod){var n=Rt.exec(this.src);if(this.inputs=[],n&&4==n.length){this.type=n[1],this.name=n[2];var o=n[3].match(zt);if(o)for(var l=0;l<o.length;){var c=void 0,h=o[l++];"in"===h||"out"===h||"inout"===h?c=o[l++]:(c=h,h="");var d=o[l++];this.inputs.push({name:d,type:c,qualifier:h})}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.isMethod=e.isMethod,this.useKeywords=e.useKeywords,void 0!==e.type&&(this.type=e.type),this.parse(e.src,e.includes,e.extensions,e.keywords),this}},{key:"toJSON",value:function(e){var t,r=this.getJSONNode(e);if(!r){(r=this.createJSONNode(e)).src=this.src,r.isMethod=this.isMethod,r.useKeywords=this.useKeywords,this.isMethod||(r.type=this.type),r.extensions=JSON.parse(JSON.stringify(this.extensions));var n={};for(var o in this.keywords)n[o]=this.keywords[o].toJSON(e).uuid;if(r.keywords=n,null===(t=this.includes)||void 0===t?void 0:t.length){for(var l=[],c=0;c<this.includes.length;c++)l.push(this.includes[c].toJSON(e).uuid);r.includes=l}r.isMethod=this.isMethod,r.inputs=this.inputs}return r.nodeType=this.nodeType,r}},{key:"fromJSON",value:function(e,t){if(Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),void 0!==e.inputs&&(this.inputs=e.inputs),void 0!==e.isMethod&&(this.isMethod=e.isMethod),e.src&&(this.src=e.src),e.isMethod&&(this.isMethod=e.isMethod),e.useKeywords&&(this.useKeywords=e.useKeywords),e.type&&(this.type=e.type),e.extensions&&(this.extensions=e.extensions),e.keywords&&t)for(var n in this.keywords={},e.keywords)this.keywords[n]=t.getNode(e.keywords[n]);return e.includes&&t&&(this.includes=e.includes.map((function(e){return t.getNode(e)}))),this}}]),r}(St),Gt=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i,Vt=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this)).src="",e.useDefine=!1,e.nodeType="Const",e.parse(n||r.PI,void 0,void 0,void 0,o),e}return Object(w.a)(r,[{key:"getType",value:function(e){return e.getTypeByFormat(this.type)}},{key:"parse",value:function(e,t,r,i,n){this.src=e||"";var s,o,a="",l=Gt.exec(e);this.useDefine=null!=n?n:"#"===this.src.charAt(0),l&&l.length>1?(o=l[1],s=l[2],a=l[3]):(s=this.src,o="f"),this.name=s,this.type=o,this.value=a}},{key:"build",value:function(e,t){if("source"===t){if(this.value)return this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";";if(this.useDefine)return this.src}return e.include(this),e.format(this.name,this.getType(e),t)}},{key:"generate",value:function(e,t,r,i,n){return e.format(this.name,this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.parse(e.src,void 0,void 0,void 0,e.useDefine),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src,t.useDefine=this.useDefine,t.value=this.value,t.name=this.name),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.src&&(this.src=e.src),e.value&&(this.value=e.value),e.name&&(this.name=e.name),void 0!==e.useDefine&&(this.useDefine=e.useDefine),this}}]),r}(St);Vt.PI="PI",Vt.PI2="PI2",Vt.RECIPROCAL_PI="RECIPROCAL_PI",Vt.RECIPROCAL_PI2="RECIPROCAL_PI2",Vt.LOG2="LOG2",Vt.EPSILON="EPSILON";var Ht=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0;return Object(A.a)(this,r),(e=t.call(this,n,c,i,l,o)).nodeType="Expression",e}return r}(Ut),Jt=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,n),(e=t.call(this,"v4")).nodeType="ColorSpace",e.factor=new Dt,e.input=r,e.method=null!=o?o:n.LINEAR_TO_LINEAR,e.hashProperties=["method"],e}return Object(w.a)(n,[{key:"generate",value:function(e,t){var r=this.input.build(e,"v4"),i=this.getType(e),o=n.Nodes[this.method],s=e.include(o);if(s===n.LINEAR_TO_LINEAR)return e.format(r,i,t);if(2===o.inputs.length){var l=this.factor.build(e,"f");return e.format(s+"( "+r+", "+l+" )",i,t)}return e.format(s+"( "+r+" )",i,t)}},{key:"fromEncoding",value:function(e){var t=n.getEncodingComponents(e);this.method="LinearTo"+t[0],this.factor=t[1]}},{key:"fromDecoding",value:function(e){var t=n.getEncodingComponents(e);this.method=t[0]+"ToLinear",this.factor=t[1]}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.input.copy(e.input),this.method=e.method,this.factor.copy(e.factor),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).input=this.input.toJSON(e).uuid,t.factor=this.factor.toJSON(e).uuid,t.method=this.method),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.input&&(this.input=t.getNode(e.input)),e.factor&&(this.factor=t.getNode(e.factor)),e.method&&(this.method=e.method),this}}],[{key:"getEncodingComponents",value:function(e){switch(e){case r.LinearEncoding:return["Linear"];case r.sRGBEncoding:return["sRGB"];case r.RGBEEncoding:return["RGBE"];case r.RGBM7Encoding:return["RGBM",new kt(7).setReadonly(!0)];case r.RGBM16Encoding:return["RGBM",new kt(16).setReadonly(!0)];case r.RGBDEncoding:return["RGBD",new kt(256).setReadonly(!0)];case r.GammaEncoding:return["Gamma",new Ht("float( GAMMA_FACTOR )","f")];default:return[]}}}]),n}(St);Jt.Nodes={LinearToLinear:new Ut(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),GammaToLinear:new Ut(["vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );","}"].join("\n")),LinearToGamma:new Ut(["vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );","}"].join("\n")),sRGBToLinear:new Ut(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),LinearTosRGB:new Ut(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n")),RGBEToLinear:new Ut(["vec4 RGBEToLinear( in vec4 value ) {","\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );","}"].join("\n")),LinearToRGBE:new Ut(["vec4 LinearToRGBE( in vec4 value ) {","\tfloat maxComponent = max( max( value.r, value.g ), value.b );","\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );","\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );","}"].join("\n")),RGBMToLinear:new Ut(["vec3 RGBMToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.xyz * value.w * maxRange, 1.0 );","}"].join("\n")),LinearToRGBM:new Ut(["vec3 LinearToRGBM( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );","\tM            = ceil( M * 255.0 ) / 255.0;","\treturn vec4( value.rgb / ( M * maxRange ), M );","}"].join("\n")),RGBDToLinear:new Ut(["vec3 RGBDToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );","}"].join("\n")),LinearToRGBD:new Ut(["vec3 LinearToRGBD( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat D      = max( maxRange / maxRGB, 1.0 );","\tD            = clamp( floor( D ) / 255.0, 0.0, 1.0 );","\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );","}"].join("\n")),cLogLuvM:new Vt("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );"),LinearToLogLuv:new Ut(["vec4 LinearToLogLuv( in vec4 value ) {","\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;","\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));","\tvec4 vResult;","\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;","\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;","\tvResult.w = fract(Le);","\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;","\treturn vResult;","}"].join("\n"),[new Vt("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );")]),cLogLuvInverseM:new Vt("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );"),LogLuvToLinear:new Ut(["vec4 LogLuvToLinear( in vec4 value ) {","\tfloat Le = value.z * 255.0 + value.w;","\tvec3 Xp_Y_XYZp;","\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);","\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;","\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;","\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;","\treturn vec4( max(vRGB, 0.0), 1.0 );","}"].join("\n"),[new Vt("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );")])},Jt.LINEAR_TO_LINEAR="LinearToLinear",Jt.GAMMA_TO_LINEAR="GammaToLinear",Jt.LINEAR_TO_GAMMA="LinearToGamma",Jt.SRGB_TO_LINEAR="sRGBToLinear",Jt.LINEAR_TO_SRGB="LinearTosRGB",Jt.RGBE_TO_LINEAR="RGBEToLinear",Jt.LINEAR_TO_RGBE="LinearToRGBE",Jt.RGBM_TO_LINEAR="RGBMToLinear",Jt.LINEAR_TO_RGBM="LinearToRGBM",Jt.RGBD_TO_LINEAR="RGBDToLinear",Jt.LINEAR_TO_RGBD="LinearToRGBD",Jt.LINEAR_TO_LOG_LUV="LinearToLogLuv",Jt.LOG_LUV_TO_LINEAR="LogLuvToLinear";var Qt,Yt=function(e){Object(x.a)(r,e);var t=S(r);function r(){return Object(A.a)(this,r),t.apply(this,arguments)}return Object(w.a)(r,[{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e),n=void 0===e||"string"==typeof e;if(void 0!==this.image&&!n){var o=this.image;if(Array.isArray(o)){e.images[o.uuid].url=[];for(var l=0;l<o.length;l++)e.images[o.uuid].url[l]=Wt(o[l])}else e.images[o.uuid].url=Wt(o)}return t}}]),r}(r.Texture);function Wt(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?function(e){if(/^data:/i.test(e.src))return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Qt&&(Qt=document.createElement("canvas")),Qt.width=e.width,Qt.height=e.height;var r=Qt.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Qt}return/\.jpe?g$/i.test(e.src)?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}(e):(console.warn("THREE.Texture: Unable to serialize Texture."),"")}var Xt=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Yt,o=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return Object(A.a)(this,r),(e=t.call(this,"v4",{shared:!0})).nodeType="Texture",e.value=n,e.uv=null!=o?o:new Pt,e.bias=l,e.project=void 0!==i&&i,e}return Object(w.a)(r,[{key:"getTexture",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"generate",this).call(this,e,t,this.value.uuid,"t")}},{key:"generate",value:function(e,t){var r;if("sampler2D"===t)return this.getTexture(e,t);var s,n,i=this.getTexture(e,t),o=this.uv.build(e,this.project?"v4":"v2"),a=this.bias?this.bias.build(e,"f"):void 0;void 0===a&&e.context.bias&&(a=e.context.bias.setTexture(this).build(e,"f")),s=this.project?"texture2DProj":a?"tex2DBias":"tex2D",n=a?s+"( "+i+", "+o+", "+a+" )":s+"( "+i+", "+o+" )";var l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=null!==(r=this.colorSpace)&&void 0!==r?r:new Jt(new Ht("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(e,c),e.removeContext(),e.format(n,c,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value.copy(e.value),this.uv.copy(e.uv),e.bias?this.bias?this.bias.copy(e.bias):this.bias=e.bias.clone():this.bias=void 0,e.colorSpace?this.colorSpace?this.colorSpace.copy(e.colorSpace):this.colorSpace=e.colorSpace.clone():this.colorSpace=void 0,this.project=e.project,this.value.updateMatrix(),this.value.needsUpdate=!0,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value.toJSON(e).uuid),t.uv=this.uv.toJSON(e).uuid,t.project=this.project,this.bias&&(t.bias=this.bias.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),this.project=e.project,e.value&&(this.value=t.getTexture(e.value),this.value.updateMatrix()),e.uv&&(this.uv=t.getNode(e.uv)),e.bias&&(this.bias=t.getNode(e.bias)),this}}]),r}(Bt),Kt=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o;return Object(A.a)(this,n),(o=t.call(this,"m3")).nodeType="Matrix3",o.value=null!=e?e:new r.Matrix3,o}return Object(w.a)(n,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format("mat3("+this.value.elements.join(", ")+")",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.elements=e.elements,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.elements&&(this.elements=e.elements),this}},{key:"elements",get:function(){return this.value.elements},set:function(e){this.value.fromArray(e)}}]),n}(Bt),qt=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="CustomTexture",e.texture=n,e.crop=o,e.mat=new Kt(e.texture.value.matrix),e.alpha=l,e.mode=i,e.calpha="g".concat(e.uuid.toString().replace(/-/g,""),"_calpha"),e}return Object(w.a)(r,[{key:"generate",value:function(e,t){e.addFragmentVariable(this.calpha,"float"),e.require("uv"),e.requires.uv=[!0];var n=e.include(r.Nodes.texture),i=[];return i.push(this.texture.getTexture(e,"t")),i.push(this.crop.build(e,"f")),i.push(this.mat.build(e,"mat3")),i.push(this.alpha.build(e,"f")),i.push(this.mode.build(e,"i")),i.push(this.calpha),e.format(n+"("+i.join(",")+")",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture.toJSON(e).uuid,t.crop=this.crop.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid,t.mode=this.mode.toJSON(e).uuid,t.calpha=this.calpha),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.texture&&(this.texture=t.getNode(e.texture),this.texture.value.updateMatrix(),this.mat=new Kt(this.texture.value.matrix)),e.crop&&(this.crop=t.getNode(e.crop)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.mode&&(this.mode=t.getNode(e.mode)),e.calpha&&(this.calpha=e.calpha),this}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.texture.copy(e.texture),this.crop.copy(e.crop),this.alpha.copy(e.alpha),this.mode.copy(e.mode),this}}]),r}(St);qt.Nodes={texture:new Ut("vec3 customTexture(sampler2D tex, float crop, mat3 mat, float alpha, int mode, out float calpha) {\n\t\t\t\tvec2 uvs = ( mat * vec3( vUv * 2. - 1., 1. ) / 2. + 0.5 ).xy;\n\t\t\t\tvec4 tmp = texture2D( tex, uvs );\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tfloat lalpha = alpha * tmp.a;\n\t\t\t\tif ( crop > 0.5 ) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\tlalpha = 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\t\t\t\treturn col;\n\t\t\t}")};var Zt=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Dt,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Dt,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="Fresnel",e.color=n,e.bias=o,e.scale=l,e.intensity=i,e.factor=c,e.alpha=s,e.mode=h,e.calpha="g".concat(e.uuid.toString().replace(/-/g,""),"_calpha"),e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.require("vWorldViewDir"),e.require("vWorldNormal"),e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");var n=e.include(r.Nodes.fresnel),o=[];return o.push(this.color.build(e,"c")),o.push(this.bias.build(e,"f")),o.push(this.scale.build(e,"f")),o.push(this.intensity.build(e,"f")),o.push(this.factor.build(e,"f")),o.push(this.alpha.build(e,"f")),o.push(this.mode.build(e,"i")),o.push(this.calpha),e.format(n+"("+o.join(",")+")",this.getType(e),t)}return console.warn("FresnelNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).color=this.color.toJSON(e).uuid,t.bias=this.bias.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid,t.intensity=this.intensity.toJSON(e).uuid,t.factor=this.factor.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid,t.mode=this.mode.toJSON(e).uuid,t.calpha=this.calpha),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.color&&(this.color=t.getNode(e.color)),e.bias&&(this.bias=t.getNode(e.bias)),e.scale&&(this.scale=t.getNode(e.scale)),e.intensity&&(this.intensity=t.getNode(e.intensity)),e.factor&&(this.factor=t.getNode(e.factor)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.mode&&(this.mode=t.getNode(e.mode)),e.calpha&&(this.calpha=e.calpha),this}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.bias.copy(e.bias),this.scale.copy(e.scale),this.intensity.copy(e.intensity),this.factor.copy(e.factor),this.alpha.copy(e.alpha),this.mode.copy(e.mode),this.calpha=e.calpha,this}}]),r}(St);Zt.Nodes={fresnel:new Ut("vec3 fresnel(vec3 color, float bias, float scale, float intensity, float factor, float alpha, int mode, out float calpha) {\n\t\t\t\tfloat fresnel = bias + scale * pow( abs( factor + dot( normalize( vWorldViewDir ), normalize( vWorldNormal ) ) ), intensity );\n\n\t\t\t\tfloat lalpha = clamp( fresnel, 0.0, 1.0 ) * alpha;\n\t\t\t\tcalpha = lalpha / clamp(lalpha + accumAlpha, 0.001, 1.0);\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * lalpha;\n\t\t\t\treturn color;\n\t\t\t}")};var $t=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="CustomNormal",e.cnormal=n,e.alpha=o,e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.isShader("fragment")){var n=e.include(r.Nodes.customNormal),o=[];return o.push(this.cnormal.build(e,"v3")),o.push("normal"),o.push(this.alpha.build(e,"f")),e.format(n+"("+o.join(",")+")",this.getType(e),t)}return console.warn("CustomNormalNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).cnormal=this.cnormal.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.cnormal&&(this.cnormal=t.getNode(e.cnormal)),e.alpha&&(this.alpha=t.getNode(e.alpha)),this}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.cnormal.copy(e.cnormal),this.alpha.copy(e.alpha),this}}]),r}(St);$t.Nodes={customNormal:new Ut("vec3 customNormal(vec3 cnormal, vec3 norm, float alpha) {\n\t\t\t\tvec3 normal = packNormalToRGB( norm ).rgb;\n\t\t\t\tnormal *= step( vec3(0.5), cnormal );\n\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn normal;\n\t\t\t}")};var er,rr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Dt,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Dt,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Dt,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:new Dt,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="Gradient",e.glType=n,e.num=o,e.smooth=l,e.colors=i,e.steps=c,e.offset=s,e.morph=h,e.angle=a,e.alpha=d,e.calpha="g".concat(e.uuid.toString().replace(/-/g,""),"_calpha"),e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.isShader("fragment")){e.define("GRAD_MAX",10),e.require("uv"),e.requires.uv=[!0],e.addFragmentVariable(this.calpha,"float");var n=e.include(r.Nodes.gradient),o=[];return o.push(this.glType.build(e,"i")),o.push(this.num.build(e,"i")),o.push(this.smooth.build(e,"b")),o.push(this.colors.build(e,"v4[]")),o.push(this.steps.build(e,"f[]")),o.push(this.offset.build(e,"v2")),o.push(this.morph.build(e,"v2")),o.push(this.angle.build(e,"f")),o.push(this.alpha.build(e,"f")),o.push(this.calpha),e.format(n+"("+o.join(",")+")",this.getType(e),t)}return console.warn("GradientNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).glType=this.glType.toJSON(e).uuid,t.num=this.num.toJSON(e).uuid,t.smooth=this.smooth.toJSON(e).uuid,t.colors=this.colors.toJSON(e).uuid,t.steps=this.steps.toJSON(e).uuid,t.offset=this.offset.toJSON(e).uuid,t.morph=this.morph.toJSON(e).uuid,t.angle=this.angle.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid,t.calpha=this.calpha),t.nodeType=this.nodeType,t}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.glType.copy(e.glType),this.num.copy(e.num),this.smooth.copy(e.smooth),this.colors.copy(e.colors),this.steps.copy(e.steps),this.offset.copy(e.offset),this.morph.copy(e.morph),this.angle.copy(e.angle),this.alpha.copy(e.alpha),this.calpha=e.calpha,this}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.calpha&&(this.calpha=e.calpha),e.glType&&(this.glType=t.getNode(e.glType)),e.num&&(this.num=t.getNode(e.num)),e.smooth&&(this.smooth=t.getNode(e.smooth)),e.colors&&(this.colors=t.getNode(e.colors)),e.steps&&(this.steps=t.getNode(e.steps)),e.offset&&(this.offset=t.getNode(e.offset)),e.morph&&(this.morph=t.getNode(e.morph)),e.angle&&(this.angle=t.getNode(e.angle)),e.alpha&&(this.alpha=t.getNode(e.alpha)),this}}]),r}(St);rr.Nodes={gradient:new Ut("vec3 gradient(int glType, int num, bool smoothed, vec4 colors[GRAD_MAX], float steps[GRAD_MAX], vec2 offset, vec2 morph, float angle, float alpha, out float calpha) {\n\t\t\t\tvec4 color = colors[0];\n\t\t\t\tvec2 m = morph / vUv.xy;\n\t\t\t\tvec2 rot = vec2( 0.5 + m.x, m.y );\n\t\t\t\tvec2 dt = vec2(\n\t\t\t\t\tcos( angle ) * rot.x - sin( angle ) * rot.y,\n\t\t\t\t\tsin( angle ) * rot.x + cos( angle ) * rot.y\n\t\t\t\t);\n\t\t\t\tvec2 pt = ( vUv - 0.5 + offset ) / 2.0 + dt / 2.0;\n\t\t\t\tfloat t = dot( pt, dt ) / dot( dt, dt );\n\t\t\t\tif ( glType == 1 ) {\n\t\t\t\t\tt = distance (\n\t\t\t\t\t\t( vUv + morph ) * 3.0,\n\t\t\t\t\t\t( vUv + offset ) + 1.0\n\t\t\t\t\t) + angle;\n\t\t\t\t} else if ( glType == 2 ) {\n\t\t\t\t\tfloat polar = atan(\n\t\t\t\t\t\tvUv.x + morph.x - 0.5 + offset.x,\n\t\t\t\t\t\tvUv.y + morph.y - 0.5 + offset.y\n\t\t\t\t\t) * -1.0;\n\t\t\t\t\tt = fract( ( angle / PI / -2.0 ) + 0.5 * ( polar / PI ) );\n\t\t\t\t}\n\t\t\t\tfloat p;\n\t\t\t\tfor ( int i = 1; i < GRAD_MAX; i++ ) {\n\t\t\t\t\tif ( i < num ) {\n\t\t\t\t\t\tp = clamp( ( t - steps[i-1] ) / ( steps[i] - steps[i-1] ), 0.0, 1.0 );\n\t\t\t\t\t\tcolor = mix( color, colors[i],\n\t\t\t\t\t\t\t\t\t( smoothed ) ? smoothstep( 0.0, 1.0, p ) : p\n\t\t\t\t\t\t\t\t   );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfloat lalpha = alpha * color.a;\n\t\t\t\tcalpha =  lalpha / clamp( lalpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * lalpha;\n\n\t\t\t\treturn color.xyz;\n\t\t\t}")},function(e){e.SIMPLEX="simplex3d",e.SIMPLEX_FRACTAL="simplex3dFractal",e.ASHIMA="simplexAshima",e.FBM="fbm",e.PERLIN="perlin"}(er||(er={}));var nr,ir,ar=function(){var e=new Ut("vec3 random3(vec3 c) {\n\t\t\tfloat j = 4096.0*sin(dot(c,vec3(17.0, 59.4, 15.0)));\n\t\t\tvec3 r;\n\t\t\tr.z = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.x = fract(512.0*j);\n\t\t\tj *= .125;\n\t\t\tr.y = fract(512.0*j);\n\t\t\treturn r-0.5;\n\t\t}"),t=new Ut("float simplex3d(vec3 p) {\n\t\t\t vec3 s = floor(p + dot(p, vec3(F3)));\n\t\t\t vec3 x = p - s + dot(s, vec3(G3));\n\t\t\t \n\t\t\t vec3 e = step(vec3(0.0), x - x.yzx);\n\t\t\t vec3 i1 = e*(1.0 - e.zxy);\n\t\t\t vec3 i2 = 1.0 - e.zxy*(1.0 - e);\n\t\t\t\t\n\t\t\t vec3 x1 = x - i1 + G3;\n\t\t\t vec3 x2 = x - i2 + 2.0*G3;\n\t\t\t vec3 x3 = x - 1.0 + 3.0*G3;\n\t\t\t \n\t\t\t vec4 w, d;\n\t\t\t \n\t\t\t w.x = dot(x, x);\n\t\t\t w.y = dot(x1, x1);\n\t\t\t w.z = dot(x2, x2);\n\t\t\t w.w = dot(x3, x3);\n\t\t\t \n\t\t\t w = max(0.6 - w, 0.0);\n\t\t\t \n\t\t\t d.x = dot(random3(s), x);\n\t\t\t d.y = dot(random3(s + i1), x1);\n\t\t\t d.z = dot(random3(s + i2), x2);\n\t\t\t d.w = dot(random3(s + 1.0), x3);\n\t\t\t \n\t\t\t w *= w;\n\t\t\t w *= w;\n\t\t\t d *= w;\n\t\t\t \n\t\t\t return dot(d, vec4(52.0));\n\t\t}",[e]);t.keywords.F3=new Vt("float F3 0.3333333"),t.keywords.G3=new Vt("float G3 0.1666667");var r=new Ut("float simplex3dFractal(vec3 m) {\n\t\t\tmat3 rot1 = mat3(-0.37, 0.36, 0.85,-0.14,-0.93, 0.34,0.92, 0.01,0.4);\n\t\t\tmat3 rot2 = mat3(-0.55,-0.39, 0.74, 0.33,-0.91,-0.24,0.77, 0.12,0.63);\n\t\t\tmat3 rot3 = mat3(-0.71, 0.52,-0.47,-0.08,-0.72,-0.68,-0.7,-0.45,0.56);\n\t\t\treturn 0.5333333 * simplex3d(m * rot1)\n\t\t\t\t + 0.2666667 * simplex3d(2.0 * m * rot2)\n\t\t\t\t + 0.1333333 * simplex3d(4.0 * m * rot3)\n\t\t\t\t + 0.0666667 * simplex3d(8.0 * m);\n\t\t}",[t]),i=new Ut("vec4 permute(vec4 x){return mod(((x*34.0)+1.0)*x, 289.0);}"),n=new Ut("vec4 taylorInvSqrt(vec4 r){return 1.79284291400159 - 0.85373472095314 * r;}"),s=new Ut("float simplexAshima(vec3 v) {\n\t\t  const vec2  C = vec2(1.0/6.0, 1.0/3.0) ;\n\t\t  const vec4  D = vec4(0.0, 0.5, 1.0, 2.0);\n\t\t  vec3 i  = floor(v + dot(v, C.yyy) );\n\t\t  vec3 x0 =   v - i + dot(i, C.xxx) ;\n\t\t  vec3 g = step(x0.yzx, x0.xyz);\n\t\t  vec3 l = 1.0 - g;\n\t\t  vec3 i1 = min( g.xyz, l.zxy );\n\t\t  vec3 i2 = max( g.xyz, l.zxy );\n\t\t  vec3 x1 = x0 - i1 + 1.0 * C.xxx;\n\t\t  vec3 x2 = x0 - i2 + 2.0 * C.xxx;\n\t\t  vec3 x3 = x0 - 1. + 3.0 * C.xxx;\n\t\t  i = mod(i, 289.0 ); \n\t\t  vec4 p = permute( permute( permute( \n\t\t\t\t\t i.z + vec4(0.0, i1.z, i2.z, 1.0 ))\n\t\t\t\t   + i.y + vec4(0.0, i1.y, i2.y, 1.0 )) \n\t\t\t\t   + i.x + vec4(0.0, i1.x, i2.x, 1.0 ));\n\t\t  float n_ = 1.0/7.0; // N=7\n\t\t  vec3  ns = n_ * D.wyz - D.xzx;\n\t\t  vec4 j = p - 49.0 * floor(p * ns.z *ns.z);  //  mod(p,N*N)\n\t\t  vec4 x_ = floor(j * ns.z);\n\t\t  vec4 y_ = floor(j - 7.0 * x_ );    // mod(j,N)\n\t\t  vec4 x = x_ *ns.x + ns.yyyy;\n\t\t  vec4 y = y_ *ns.x + ns.yyyy;\n\t\t  vec4 h = 1.0 - abs(x) - abs(y);\n\t\t  vec4 b0 = vec4( x.xy, y.xy );\n\t\t  vec4 b1 = vec4( x.zw, y.zw );\n\t\t  vec4 s0 = floor(b0)*2.0 + 1.0;\n\t\t  vec4 s1 = floor(b1)*2.0 + 1.0;\n\t\t  vec4 sh = -step(h, vec4(0.0));\n\t\t  vec4 a0 = b0.xzyw + s0.xzyw*sh.xxyy ;\n\t\t  vec4 a1 = b1.xzyw + s1.xzyw*sh.zzww ;\n\t\t  vec3 p0 = vec3(a0.xy,h.x);\n\t\t  vec3 p1 = vec3(a0.zw,h.y);\n\t\t  vec3 p2 = vec3(a1.xy,h.z);\n\t\t  vec3 p3 = vec3(a1.zw,h.w);\n\t\t  vec4 norm = taylorInvSqrt(vec4(dot(p0,p0), dot(p1,p1), dot(p2, p2), dot(p3,p3)));\n\t\t  p0 *= norm.x;\n\t\t  p1 *= norm.y;\n\t\t  p2 *= norm.z;\n\t\t  p3 *= norm.w;\n\t\t  vec4 m = max(0.6 - vec4(dot(x0,x0), dot(x1,x1), dot(x2,x2), dot(x3,x3)), 0.0);\n\t\t  m = m * m;\n\t\t  return 42.0 * dot( m*m, vec4( dot(p0,x0), dot(p1,x1), \n\t\t\t\t\t\t\t\t\t\tdot(p2,x2), dot(p3,x3) ) );\n\t\t}",[i,n]),o=new Ut("vec4 mod289(vec4 x){return x - floor(x * (1.0 / 289.0)) * 289.0;}"),a=new Ut("vec4 perm(vec4 x){return mod289(((x * 34.0) + 1.0) * x);}",[o]),l=new Ut("float noise(vec3 p){\n\t\t\tvec3 a = floor(p);\n\t\t\tvec3 d = p - a;\n\t\t\td = d * d * (3.0 - 2.0 * d);\n\t\t\tvec4 b = a.xxyy + vec4(0.0, 1.0, 0.0, 1.0);\n\t\t\tvec4 k1 = perm(b.xyxy);\n\t\t\tvec4 k2 = perm(k1.xyxy + b.zzww);\n\t\t\tvec4 c = k2 + a.zzzz;\n\t\t\tvec4 k3 = perm(c);\n\t\t\tvec4 k4 = perm(c + 1.0);\n\t\t\tvec4 o1 = fract(k3 * (1.0 / 41.0));\n\t\t\tvec4 o2 = fract(k4 * (1.0 / 41.0));\n\t\t\tvec4 o3 = o2 * d.z + o1 * (1.0 - d.z);\n\t\t\tvec2 o4 = o3.yw * d.x + o3.xz * (1.0 - d.x);\n\t\t\treturn o4.y * d.y + o4.x * (1.0 - d.y);\n\t\t}",[a]),c=new Ut("float fbm(vec3 x) {\n\t\t\tfloat v = 0.0;\n\t\t\tfloat a = 0.5;\n\t\t\tvec3 shift = vec3(100);\n\t\t\tfor (int i = 0; i < NUM_OCTAVES; ++i) {\n\t\t\t\tv += a * noise(x);\n\t\t\t\tx = x * 2.0 + shift;\n\t\t\t\ta *= 0.5;\n\t\t\t}\n\t\t\treturn v;\n\t\t}",[l]);c.keywords.NUM_OCTAVES=new Vt("int NUM_OCTAVES 5");var h=new Ut("vec3 fade(vec3 t) {return t*t*t*(t*(t*6.0-15.0)+10.0);}");return{simplex:t,simplexFractal:r,simplexAshima:s,fbm:c,perlin:new Ut("float perlin(vec3 P){\n\t\t  vec3 Pi0 = floor(P);\n\t\t  vec3 Pi1 = Pi0 + vec3(1.0);\n\t\t  Pi0 = mod(Pi0, 289.0);\n\t\t  Pi1 = mod(Pi1, 289.0);\n\t\t  vec3 Pf0 = fract(P);\n\t\t  vec3 Pf1 = Pf0 - vec3(1.0);\n\t\t  vec4 ix = vec4(Pi0.x, Pi1.x, Pi0.x, Pi1.x);\n\t\t  vec4 iy = vec4(Pi0.yy, Pi1.yy);\n\t\t  vec4 iz0 = Pi0.zzzz;\n\t\t  vec4 iz1 = Pi1.zzzz;\n\t\t  vec4 ixy = permute(permute(ix) + iy);\n\t\t  vec4 ixy0 = permute(ixy + iz0);\n\t\t  vec4 ixy1 = permute(ixy + iz1);\n\t\t  vec4 gx0 = ixy0 / 7.0;\n\t\t  vec4 gy0 = fract(floor(gx0) / 7.0) - 0.5;\n\t\t  gx0 = fract(gx0);\n\t\t  vec4 gz0 = vec4(0.5) - abs(gx0) - abs(gy0);\n\t\t  vec4 sz0 = step(gz0, vec4(0.0));\n\t\t  gx0 -= sz0 * (step(0.0, gx0) - 0.5);\n\t\t  gy0 -= sz0 * (step(0.0, gy0) - 0.5);\n\t\t  vec4 gx1 = ixy1 / 7.0;\n\t\t  vec4 gy1 = fract(floor(gx1) / 7.0) - 0.5;\n\t\t  gx1 = fract(gx1);\n\t\t  vec4 gz1 = vec4(0.5) - abs(gx1) - abs(gy1);\n\t\t  vec4 sz1 = step(gz1, vec4(0.0));\n\t\t  gx1 -= sz1 * (step(0.0, gx1) - 0.5);\n\t\t  gy1 -= sz1 * (step(0.0, gy1) - 0.5);\n\t\t  vec3 g000 = vec3(gx0.x,gy0.x,gz0.x);\n\t\t  vec3 g100 = vec3(gx0.y,gy0.y,gz0.y);\n\t\t  vec3 g010 = vec3(gx0.z,gy0.z,gz0.z);\n\t\t  vec3 g110 = vec3(gx0.w,gy0.w,gz0.w);\n\t\t  vec3 g001 = vec3(gx1.x,gy1.x,gz1.x);\n\t\t  vec3 g101 = vec3(gx1.y,gy1.y,gz1.y);\n\t\t  vec3 g011 = vec3(gx1.z,gy1.z,gz1.z);\n\t\t  vec3 g111 = vec3(gx1.w,gy1.w,gz1.w);\n\t\t  vec4 norm0 = taylorInvSqrt(vec4(dot(g000, g000), dot(g010, g010), dot(g100, g100), dot(g110, g110)));\n\t\t  g000 *= norm0.x;\n\t\t  g010 *= norm0.y;\n\t\t  g100 *= norm0.z;\n\t\t  g110 *= norm0.w;\n\t\t  vec4 norm1 = taylorInvSqrt(vec4(dot(g001, g001), dot(g011, g011), dot(g101, g101), dot(g111, g111)));\n\t\t  g001 *= norm1.x;\n\t\t  g011 *= norm1.y;\n\t\t  g101 *= norm1.z;\n\t\t  g111 *= norm1.w;\n\t\t  float n000 = dot(g000, Pf0);\n\t\t  float n100 = dot(g100, vec3(Pf1.x, Pf0.yz));\n\t\t  float n010 = dot(g010, vec3(Pf0.x, Pf1.y, Pf0.z));\n\t\t  float n110 = dot(g110, vec3(Pf1.xy, Pf0.z));\n\t\t  float n001 = dot(g001, vec3(Pf0.xy, Pf1.z));\n\t\t  float n101 = dot(g101, vec3(Pf1.x, Pf0.y, Pf1.z));\n\t\t  float n011 = dot(g011, vec3(Pf0.x, Pf1.yz));\n\t\t  float n111 = dot(g111, Pf1);\n\t\t  vec3 fade_xyz = fade(Pf0);\n\t\t  vec4 n_z = mix(vec4(n000, n100, n010, n110), vec4(n001, n101, n011, n111), fade_xyz.z);\n\t\t  vec2 n_yz = mix(n_z.xy, n_z.zw, fade_xyz.y);\n\t\t  float n_xyz = mix(n_yz.x, n_yz.y, fade_xyz.x); \n\t\t  return 2.2 * n_xyz;\n\t\t}",[i,n,h])}}();!function(e){e.NOISE="noise",e.MAP="map"}(nr||(nr={}));var or=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Dt,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="VertexDisplacement",e.displacementTypeIndex=n,e.intensity=o,e.movementOrTexture=l,Object.values(nr)[e.displacementTypeIndex.value]===nr.MAP&&(e.mat=new Kt(e.movementOrTexture.value.matrix)),e.cropOrOffset=i,e.scale=c,e.noiseFunctionIndex=s,e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.isShader("vertex")){var n;e.define("USE_LAYER_DISPLACE");var o=[];switch(o.push("displaced_position"),o.push("displaced_normal"),Object.values(nr)[this.displacementTypeIndex.value]){case nr.MAP:n=e.include(r.Nodes.map),o.push(this.movementOrTexture.getTexture(e,"t")),o.push("uv"),o.push(this.cropOrOffset.build(e,"f")),o.push(this.mat.build(e,"mat3"));break;case nr.NOISE:var l=Object.values(er)[this.noiseFunctionIndex.value],c=new Ut("vec3 orthogonal(vec3 v) {\n\t\t\t\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t\t\t\t}"),h=new Ut("vec3 distorted(vec3 p, vec3 n, float scale, float intensity, vec3 offset, float neighbour_offset, float movement) {\n\t\t\t\t\t\t\treturn p + n * ".concat(l,"((p + offset) * scale * 0.001 + neighbour_offset + (movement * 0.1)) * intensity;\n\t\t\t\t\t\t}"),[ar.simplex,ar.simplexFractal,ar.simplexAshima,ar.fbm,ar.perlin]),d=new Ut("vec3 vertexDisplacementNoise(vec3 position, vec3 normal, float scale, vec3 offset, float movement, float intensity, out vec3 displaced_normal) {\n\t\t\t\t\t\t\tvec3 displaced_position = distorted(position, normal, scale, intensity, offset, neighbor_offset, movement);\n\t\t\t\t\t\t\tvec3 tangent1 = orthogonal(normal);\n\t\t\t\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\t\t\t\tvec3 distorted1 = distorted(nearby1, normal, scale, intensity, offset, neighbor_offset, movement);\n\t\t\t\t\t\t\tvec3 distorted2 = distorted(nearby2, normal, scale, intensity, offset, neighbor_offset, movement);\n\t\t\t\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\t\t\t\treturn displaced_position;\n\t\t\t\t\t\t}",[h,c]);n=e.include(d),o.push(this.scale.build(e,"f")),o.push(this.cropOrOffset.build(e,"v3")),o.push(this.movementOrTexture.build(e,"f"))}return o.push(this.intensity.build(e,"f")),o.push("displaced_normal"),e.format(n+"("+o.join(",")+")",this.getType(e),t)}return console.warn("VertexDisplacementNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).intensity=this.intensity.toJSON(e).uuid,t.scale=this.scale.toJSON(e).uuid,t.movementOrTexture=this.movementOrTexture.toJSON(e).uuid,t.cropOrOffset=this.cropOrOffset.toJSON(e).uuid),t.displacementTypeIndex=this.displacementTypeIndex,t.noiseFunctionIndex=this.noiseFunctionIndex,t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),this.displacementTypeIndex=e.displacementTypeIndex,this.noiseFunctionIndex=e.noiseFunctionIndex,e.cropOrOffset&&(this.cropOrOffset=t.getNode(e.cropOrOffset)),e.intensity&&(this.intensity=t.getNode(e.intensity)),e.movementOrTexture&&(1===e.displacementTypeIndex.value?(this.movementOrTexture=t.getNode(e.movementOrTexture),this.movementOrTexture.value.updateMatrix(),this.mat=new Kt(this.movementOrTexture.value.matrix)):0===e.displacementTypeIndex.value&&(this.movementOrTexture=t.getNode(e.movementOrTexture))),e.scale&&(this.scale=t.getNode(e.scale)),this}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.noiseFunctionIndex=e.noiseFunctionIndex,this.scale.copy(e.scale),this.cropOrOffset.copy(e.cropOrOffset),this.intensity.copy(e.intensity),this.movementOrTexture.copy(e.movementOrTexture),this}}]),r}(St);or.Nodes=function(){var e=new Ut("vec3 orthogonal(vec3 v) {\n\t\t\t\treturn normalize(abs(v.x) > abs(v.z) ? vec3(-v.y, v.x, 0.0) : vec3(0.0, -v.z, v.y));\n\t\t\t}"),t=new Ut("float displacementMapTexture(sampler2D tex, float crop, vec2 uv, mat3 mat, vec2 offset) {\n\t\t\t\tvec2 uvs = (mat * vec3(uv * 2.0 - 1.0, 1.0) / 2.0 + 0.5).xy + offset;\n\t\t\t\tvec4 tmp = texture2D(tex, uvs);\n\t\t\t\tvec3 col = tmp.rgb;\n\t\t\t\tif (crop > 0.5) {\n\t\t\t\t\tif ( uvs.x < 0.0 || uvs.x > 1.0 || uvs.y < 0.0 || uvs.y > 1.0 )  {\n\t\t\t\t\t\treturn 0.0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn col.r;\n\t\t\t}");return{map:new Ut("vec3 vertexDisplacementMap(vec3 position, vec3 normal, sampler2D tex, vec2 uv, float crop, mat3 mat, float intensity, out vec3 displaced_normal) {\n\t\t\t\tvec3 displaced_position = position + normal * displacementMapTexture(tex, crop, uv, mat, vec2(0.0)) * intensity;\n\t\t\t\tvec3 tangent1 = normalize(orthogonal(normal));\n\t\t\t\tvec3 tangent2 = normalize(cross(normal, tangent1));\n\t\t\t\tvec3 nearby1 = position + tangent1 * 0.1;\n\t\t\t\tvec3 nearby2 = position + tangent2 * 0.1;\n\t\t\t\tvec3 distorted1 = nearby1 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tvec3 distorted2 = nearby2 + normal * displacementMapTexture(tex, crop, uv, mat, vec2(neighbor_offset)) * intensity;\n\t\t\t\tdisplaced_normal = normalize(cross(distorted1 - displaced_position, distorted2 - displaced_position));\n\t\t\t\treturn displaced_position;\n\t\t\t}",[e,t])}}();var sr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Dt,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Dt,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Dt,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:new Dt,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:new Dt,f=arguments.length>9&&void 0!==arguments[9]?arguments[9]:new Dt,v=arguments.length>10&&void 0!==arguments[10]?arguments[10]:new Dt,u=arguments.length>11&&void 0!==arguments[11]?arguments[11]:new Dt,m=arguments.length>12&&void 0!==arguments[12]?arguments[12]:new Dt,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:new Dt,y=arguments.length>14&&void 0!==arguments[14]?arguments[14]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="Noise",e.scale=n,e.move=o,e.fA=l,e.fB=i,e.distortion=c,e.colorA=s,e.colorB=h,e.colorC=a,e.colorD=d,e.intA=f,e.intB=v,e.intC=u,e.intD=m,e.alpha=p,e.noiseFunctionIndex=y,e}return Object(w.a)(r,[{key:"generate",value:function(e,t,r,i,n){e.require("uv"),e.requires.uv=[!0];var s=Object.values(er)[this.noiseFunctionIndex.value],o=new Ut("vec3 customNoise(float scale, float move, vec2 fA, vec2 fB, vec2 distortion, vec3 colorA, vec3 colorB, vec3 colorC, vec3 colorD, float intA, float intB, float intC, float intD, float alpha) {\n\t\t\t\tvec3 st = normalize(position) * scale;\n\t\t\t\tvec3 q = vec3(".concat(s,"(st),\n\t\t\t\t\t\t\t  ").concat(s,"(st + vec3(1.0)),\n\t\t\t\t\t\t\t  ").concat(s,"(st + vec3(1.0)));\n\t\t\t\tvec3 r = vec3(").concat(s,"(st + vec3(distortion, 1.0) * q + vec3(fA, 1.0) + move),\n\t\t\t\t\t\t\t  ").concat(s,"(st + vec3(distortion, 1.0) * q + vec3(fB, 1.0) + move), \n\t\t\t\t\t\t\t  ").concat(s,"(st * q));\n\t\t\t\tfloat f = ").concat(s,"(st + r);\n\t\t\t\tvec3 color;\n\t\t\t\tcolor = mix(colorA * intA, colorB * intB, clamp((f * f) * 4.0, 0.0, 1.0));\n\t\t\t\tcolor = mix(color, colorC * intC, clamp(length(q), 0.0, 1.0));\n\t\t\t\tcolor = mix(color, colorD * intD, clamp(length(r.x), 0.0, 1.0));\n\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\treturn clamp(color, 0.0, 1.0);\n\t\t\t}"),[ar.simplex,ar.simplexFractal,ar.simplexAshima,ar.fbm,ar.perlin]),a=e.include(o),l=[];return l.push(this.scale.build(e,"f")),l.push(this.move.build(e,"f")),l.push(this.fA.build(e,"v2")),l.push(this.fB.build(e,"v2")),l.push(this.distortion.build(e,"v2")),l.push(this.colorA.build(e,"c")),l.push(this.colorB.build(e,"c")),l.push(this.colorC.build(e,"c")),l.push(this.colorD.build(e,"c")),l.push(this.intA.build(e,"f")),l.push(this.intB.build(e,"f")),l.push(this.intC.build(e,"f")),l.push(this.intD.build(e,"f")),l.push(this.alpha.build(e,"f")),e.format(a+"("+l.join(",")+")",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scale=this.scale.toJSON(e).uuid,t.move=this.move.toJSON(e).uuid,t.fA=this.fA.toJSON(e).uuid,t.fB=this.fB.toJSON(e).uuid,t.distortion=this.distortion.toJSON(e).uuid,t.colorA=this.colorA.toJSON(e).uuid,t.colorB=this.colorB.toJSON(e).uuid,t.colorC=this.colorC.toJSON(e).uuid,t.colorD=this.colorD.toJSON(e).uuid,t.intA=this.intA.toJSON(e).uuid,t.intB=this.intB.toJSON(e).uuid,t.intC=this.intC.toJSON(e).uuid,t.intD=this.intD.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid),t.noiseFunction=this.noiseFunctionIndex,t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.scale&&(this.scale=t.getNode(e.scale)),e.move&&(this.move=t.getNode(e.move)),e.fA&&(this.fA=t.getNode(e.fA)),e.fB&&(this.fB=t.getNode(e.fB)),e.distortion&&(this.distortion=t.getNode(e.distortion)),e.colorA&&(this.colorA=t.getNode(e.colorA)),e.colorB&&(this.colorB=t.getNode(e.colorB)),e.colorC&&(this.colorC=t.getNode(e.colorC)),e.colorD&&(this.colorD=t.getNode(e.colorD)),e.intA&&(this.intA=t.getNode(e.intA)),e.intB&&(this.intB=t.getNode(e.intB)),e.intC&&(this.intC=t.getNode(e.intC)),e.intD&&(this.intD=t.getNode(e.intD)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.noiseFunctionIndex&&(this.noiseFunctionIndex=t.getNode(e.noiseFunctionIndex)),this}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.scale.copy(e.scale),this.move.copy(e.move),this.fA.copy(e.fA),this.fB.copy(e.fB),this.distortion.copy(e.distortion),this.colorA.copy(e.colorA),this.colorB.copy(e.colorB),this.colorC.copy(e.colorC),this.colorD.copy(e.colorD),this.intA.copy(e.intA),this.intB.copy(e.intB),this.intC.copy(e.intC),this.intD.copy(e.intD),this.alpha.copy(e.alpha),this.noiseFunctionIndex.copy(e.noiseFunctionIndex),this}}]),r}(St);sr.numOctaves=5,function(e){e.ADD="+",e.SUB="-",e.MUL="*",e.DIV="/"}(ir||(ir={}));var ur=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.ADD;return Object(A.a)(this,r),(e=t.call(this)).nodeType="Operator",e.a=n,e.b=o,e.op=l,e}return Object(w.a)(r,[{key:"getType",value:function(e){var t=this.a.getType(e),r=this.b.getType(e);return e.isTypeMatrix(t)?"v4":e.getTypeLength(r)>e.getTypeLength(t)?r:t}},{key:"generate",value:function(e,t){var r=this.getType(e);this.type=r;var i=this.a.build(e,r),n=this.b.build(e,r);return e.format("( "+i+" "+this.op+" "+n+" )",r,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.a.copy(e.a),this.b.copy(e.b),this.op=e.op,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.a&&(this.a=t.getNode(e.a)),e.b&&(this.b=t.getNode(e.b)),e.op&&(this.op=e.op),this}}]),r}(St);ur.ADD=ir.ADD,ur.SUB=ir.SUB,ur.MUL=ir.MUL,ur.DIV=ir.DIV;var lr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="Blend",e.a=n,e.b=o,e.alpha=l,e.mode=i,e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.isShader("fragment")){var r=[];return r.push(this.a.build(e,"c")),r.push(this.b.build(e,"c")),r.push(this.alpha.build(e,"f")),r.push(this.mode.build(e,"i")),e.format("spe_blend("+r.join(",")+")",this.getType(e),t)}return console.warn("BlendNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.a.copy(e.a),this.b.copy(e.b),this.alpha.copy(e.alpha),this.mode.copy(e.mode),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid,t.mode=this.mode.toJSON(e).uuid),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.a&&(this.a=t.getNode(e.a)),e.b&&(this.b=t.getNode(e.b)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.mode&&(this.mode=t.getNode(e.mode)),this}}]),r}(St),cr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Dt,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new Dt,h=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="Depth",e.near=n,e.far=o,e.isVector=l,e.origin=i,e.colorA=c,e.colorB=s,e.alpha=h,e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.isShader("fragment")){e.require("worldPosition");var n=e.include(r.Nodes.sdepth),o=[];return o.push(this.near.build(e,"f")),o.push(this.far.build(e,"f")),o.push(this.isVector.build(e,"f")),o.push(this.origin.build(e,"v3")),o.push(this.colorA.build(e,"v3")),o.push(this.colorB.build(e,"v3")),o.push(this.alpha.build(e,"f")),e.format(n+"("+o.join(",")+")",this.getType(e),t)}return console.warn("DepthNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).near=this.near.toJSON(e).uuid,t.far=this.far.toJSON(e).uuid,t.isVector=this.isVector.toJSON(e).uuid,t.origin=this.origin.toJSON(e).uuid,t.colorA=this.colorA.toJSON(e).uuid,t.colorB=this.colorB.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.near&&(this.near=t.getNode(e.near)),e.far&&(this.far=t.getNode(e.far)),e.isVector&&(this.isVector=t.getNode(e.isVector)),e.origin&&(this.origin=t.getNode(e.origin)),e.colorA&&(this.colorA=t.getNode(e.colorA)),e.colorB&&(this.colorB=t.getNode(e.colorB)),e.alpha&&(this.alpha=t.getNode(e.alpha)),this}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.near.copy(e.near),this.far.copy(e.far),this.isVector.copy(e.isVector),this.origin.copy(e.origin),this.colorA.copy(e.colorA),this.colorB.copy(e.colorB),this.alpha.copy(e.alpha),this}}]),r}(St);cr.Nodes={sdepth:new Ut("vec3 sdepth(float near, float far, float isVector, vec3 origin, vec3 colorA, vec3 colorB, float alpha) {\n\t\t\t\tvec3 base = ( isVector > 0.5 ) ?  origin : cameraPosition;\n\t\t\t\tfloat dist = length( vWPosition - base );\n\t\t\t\tfloat dep = ( dist - near ) / ( far - near );\n\t\t\t\tvec3 depth =  mix( colorB, colorA, 1.0 - clamp( dep, 0., 1. ) );\n\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n\n\t\t\t\treturn depth;\n\t\t\t}")};var dr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Xt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v3")).nodeType="Matcap",e.color=n,e.texture=o,e.alpha=l,e.mode=i,e.calpha="g".concat(e.uuid.toString().replace(/-/g,""),"_calpha"),e}return Object(w.a)(r,[{key:"generate",value:function(e,t){if(e.isShader("fragment")){e.addFragmentVariable(this.calpha,"float");var n=e.include(r.Nodes.matcap);e.require("normal"),e.requires.normal=!0;var o=[];return o.push(this.color.build(e,"v3")),o.push(this.texture.getTexture(e,"t")),o.push("normal"),o.push(this.alpha.build(e,"f")),o.push(this.mode.build(e,"i")),o.push(this.calpha),e.format(n+"("+o.join(",")+")",this.getType(e),t)}return console.warn("MatcapNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.texture.copy(e.texture),this.color.copy(e.color),this.alpha.copy(e.alpha),this.mode.copy(e.mode),this.calpha=e.calpha,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).texture=this.texture.toJSON(e).uuid,t.color=this.color.toJSON(e).uuid,t.alpha=this.alpha.toJSON(e).uuid,t.mode=this.mode.toJSON(e).uuid,t.calpha=this.calpha),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.calpha&&(this.calpha=e.calpha),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.texture&&(this.texture=t.getNode(e.texture)),e.color&&(this.color=t.getNode(e.color)),e.mode&&(this.mode=t.getNode(e.mode)),this}}]),r}(St);dr.Nodes={matcap:new Ut("vec3 matcap(vec3 color, sampler2D matcapTex, vec3 normal, float alpha, int mode, out float calpha) {\n                vec3 viewDir = normalize( vViewPosition );\n                vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n                vec3 y = cross( viewDir, x );\n                vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; // 0.495 to remove artifacts caused by undersized matcap disks\n                vec4 matcapColor = texture2D( matcapTex, uv );\n                // matcapColor = matcapTexelToLinear( matcapColor );\n                matcapColor.rgb *= color;\n                \n                calpha =  alpha / clamp( alpha + accumAlpha, 0.00001, 1.0 );\n\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * alpha;\n                \n                return matcapColor.rgb;\n            }\n            ")};var fr=function(){function e(t){Object(A.a)(this,e),this.id=2,this.layerCount=2,this.uuid=r.MathUtils.generateUUID(),this.needsUpdate=!1,this._material=t,this._layerNodes=[];var n=this._createLayer({id:0,type:lt.COLOR});this._material.color=n.color,void 0===this._material.alpha&&(this._material.alpha=new kt(1));var i=new kt(1),o=new _t(0);"shadingAlpha"in this._material&&"shadingBlend"in this._material&&(this._material.shadingAlpha=i,this._material.shadingBlend=o),this._layerNodes.push({id:0,type:ct.COLOR,color:n.color,alpha:n.alpha,mode:n.mode}),this._layerNodes.push({id:1,type:ct.LIGHTING,alpha:i,mode:o}),this.head=n.layer,this.head.next=new Ot(1,{type:lt.LIGHTING,alpha:i,mode:o})}return Object(w.a)(e,[{key:"material",get:function(){return this._material},set:function(e){this._material=e;for(var t=new kt(1),r=new _t(0),i=this.head;void 0!==i;){if(i.type===lt.LIGHTING){i.uniforms["f".concat(i.id,"_alpha")]=t,i.uniforms["f".concat(i.id,"_mode")]=r;break}i=i.next}"shadingAlpha"in this._material&&"shadingBlend"in this._material&&(this._material.shadingAlpha=t,this._material.shadingBlend=r),this.blendColors(),this.blendAfterColors(),this.blendPositions()}},{key:"addLayer",value:function(e){var t;if(e.id=null!==(t=e.id)&&void 0!==t?t:++this.id,this.layerCount++,e.type===lt.LIGHTING){var n=this.createLightLayer(e);return this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),n}var i=this._createLayer(e),o=i.layer;if(void 0===this.head)this.head=o;else{for(var l=this.head;null!=l.next;)l=l.next;l.next=o}return i.color&&this._layerNodes.push({id:o.id,type:ct.COLOR,color:i.color,alpha:i.alpha,mode:i.mode}),i.position&&this._layerNodes.push({id:o.id,type:ct.POSITION,position:i.position}),this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),o}},{key:"addLayerBeforeAt",value:function(e,t){var i,n=this.head;e.id=null!==(i=e.id)&&void 0!==i?i:++this.id,this.layerCount++;var s=this._createLayer(e),o=s.layer;o.next=t;var a=0;if(n===t)this.head=o,s.color&&this._layerNodes.splice(0,0,{id:o.id,type:ct.COLOR,color:s.color,alpha:s.alpha,mode:s.mode}),s.position&&this._layerNodes.splice(0,0,{id:o.id,type:ct.POSITION,position:s.position});else{for(a=1;(null==n?void 0:n.next)!==t;)n=null==n?void 0:n.next,a++;n.next=o,s.color&&this._layerNodes.splice(a,0,{id:o.id,type:ct.COLOR,color:s.color,alpha:s.alpha,mode:s.mode}),s.position&&this._layerNodes.splice(a,0,{id:o.id,type:ct.POSITION,position:s.position})}return this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),o}},{key:"addLayerAt",value:function(e,t){var i;t.id=null!==(i=t.id)&&void 0!==i?i:++this.id,this.layerCount++;var n=this._createLayer(t),s=n.layer;if(n.color&&this._layerNodes.splice(e,0,{id:s.id,type:ct.COLOR,color:n.color,alpha:n.alpha,mode:n.mode}),n.position&&this._layerNodes.splice(e,0,{id:s.id,type:ct.POSITION,position:n.position}),0==e)s.next=this.head,this.head=s;else{for(var o=this.head,l=this.head.next,c=0;c<e-1;c++)o=l,l=l.next;s.next=l,o.next=s}return this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),s}},{key:"removeLayer",value:function(e){var t,i=this.head,n=0;if((null==i?void 0:i.id)==e)this.head=i.next;else for(n=1,t=i,i=null==i?void 0:i.next;null!=i;){if(i.id==e){t.next=i.next;break}n++,t=i,i=i.next}return this.cleanupChangedLayer(i),this.blendColors(),this.blendAfterColors(),this.blendPositions(),this.uuid=r.MathUtils.generateUUID(),this.layerCount--,n}},{key:"changeLayer",value:function(e,t){var i,n,s=this.head;if((null==s?void 0:s.id)==e){var o=this._createLayer(Object.assign({id:e},t));(n=o.layer).next=s.next,this.head=n,o.color&&(this._layerNodes[0]={id:n.id,type:ct.COLOR,color:o.color,alpha:o.alpha,mode:o.mode}),o.position&&(this._layerNodes[0]={id:n.id,type:ct.POSITION,position:o.position}),n.uniforms["f".concat(e,"_mode")].value=s.uniforms["f".concat(e,"_mode")].value,n.uniforms["f".concat(e,"_alpha")].value=s.uniforms["f".concat(e,"_alpha")].value}else{i=s,s=s.next;for(var l=1;null!=s;){if(s.id==e){var c=this._createLayer(Object.assign({id:e},t));n=c.layer,i.next=n,n.next=s.next,c.color&&(this._layerNodes[l]={id:n.id,type:ct.COLOR,color:c.color,alpha:c.alpha,mode:c.mode}),c.position&&(this._layerNodes[l]={id:n.id,type:ct.POSITION,position:c.position}),n.uniforms["f".concat(e,"_mode")].value=s.uniforms["f".concat(e,"_mode")].value,n.uniforms["f".concat(e,"_alpha")].value=s.uniforms["f".concat(e,"_alpha")].value;break}i=s,s=s.next,l++}}return this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors(),this.blendPositions(),n}},{key:"getLayer",value:function(e){for(var t=this.head;null!=t&&t.id!=e;)t=t.next;return t}},{key:"getLayers",value:function(){for(var e=[],t=this.head;null!=t;)e.push(t),t=t.next;return e}},{key:"getLayerPosition",value:function(e){for(var t=this.head,r=0;void 0!==t&&t.id!=e;)r++,t=t.next;return r}},{key:"getDefines",value:function(){}},{key:"getBeforeProgram",value:function(){}},{key:"getLightingProgram",value:function(){}},{key:"getAfterProgram",value:function(){}},{key:"getVarPrograms",value:function(){}},{key:"getUniforms",value:function(){}},{key:"moveLayer",value:function(e,t){var i,n,s=this.head;if(0==e)i=this.head,this.head=i.next;else{for(var o=0;o<e;o++)n=s,s=s.next;n.next=s.next,i=s}if(s=this.head,n=void 0,0==t)i.next=this.head,this.head=i;else{for(var l=0;l<t-1;l++)s=s.next;i.next=null==s?void 0:s.next,s.next=i}var c=this._layerNodes.splice(e,1)[0];this._layerNodes.splice(t,0,c),this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors()}},{key:"updateLayerUniform",value:function(){this.uuid=r.MathUtils.generateUUID(),this.blendColors(),this.blendAfterColors()}},{key:"copy",value:function(e){this.needsUpdate=!1,this.layerCount=e.layerCount,this._layerNodes=[],this.layerCount=0,this.head=void 0,this.rebuildLayerNodes(this.head,e.head);for(var t=e.head,r=this.head;null!=t.next;)this.rebuildLayerNodes(r,t.next),r=r.next,t=t.next;return this.id=e.id,this.uuid=e.uuid,this.blendColors(),this.blendAfterColors(),this.blendPositions(),this}},{key:"createLightLayer",value:function(e){var t=new kt(e.alpha),r=new _t(e.mode);this._material.shadingAlpha=t,this._material.shadingBlend=r,this._layerNodes.push({id:e.id,type:ct.LIGHTING,alpha:t,mode:r});var i=new Ot(e.id,{type:lt.LIGHTING,alpha:t,mode:r});if(void 0===this.head)this.head=i;else{for(var n=this.head;null!=n.next;)n=n.next;n.next=i}return i}},{key:"rebuildLayerNodes",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(t.type===lt.LIGHTING){var n=r?t.uniforms["f".concat(t.id,"_alpha")]:new kt(t.uniforms["f".concat(t.id,"_alpha")].value),o=r?t.uniforms["f".concat(t.id,"_mode")]:new _t(t.uniforms["f".concat(t.id,"_mode")].value);this._material.shadingAlpha=n,this._material.shadingBlend=o,this._layerNodes.push({id:t.id,type:ct.LIGHTING,alpha:n,mode:o}),void 0===this.head?this.head=new Ot(t.id,{type:lt.LIGHTING,alpha:n,mode:o}):e&&(e.next=new Ot(t.id,{type:lt.LIGHTING,alpha:n,mode:o}))}else{var l={type:t.type,id:t.id};for(var c in t.uniforms){var h=t.getName(c);if(h){var d="f".concat(t.id,"_").concat(h);if(Array.isArray(t.uniforms[d].value))l[h]=t.uniforms[d].value.map((function(e){return e.clone&&!r?e.clone():e}));else{var f=t.uniforms[d].value;f&&(l[h]=f.clone&&!r?f.clone():f)}}}this.addLayer(l)}}},{key:"clone",value:function(){return new e(this._material).copy(this)}},{key:"toJSON",value:function(e){return{id:this.id,uuid:this.uuid,head:this.head.toJSON(e)}}},{key:"fromJSON",value:function(e,t,r){for(var i=new Ot(e.head.id,{type:e.head.type}).fromJSON(e.head,t),n=e.head.next,s=i;null!=n;)s.next=new Ot(n.id,{type:n.type}).fromJSON(n,t),n=n.next,s=s.next;this._layerNodes=[],this.head=void 0,this.rebuildLayerNodes(this.head,i,!0);var o=i;for(s=this.head;null!=o.next;)this.rebuildLayerNodes(s,o.next,!0),s=s.next,o=o.next;return this._material=r,this.id=e.id,this.uuid=e.uuid,this.blendColors(),this.blendAfterColors(),this.blendPositions(),this}},{key:"dispose",value:function(){var e=this.head;for(this._layerNodes=[],this.layerCount=0;void 0!==e;)!0===e.hasOwnProperty("dispose")&&e.dispose(),e=e.next;this.head=void 0}},{key:"_createLayer",value:function(e){var t,i,n,s,o,a,l,c,h,u,d,p,f,v,g,m,y,A,w,x,b,O,E,C,D,S,B,T,k,_,M,L,N,F,I,j,P,R,z,U,G,V,H,J,Q,Y,W,X,K,q,Z,$,ee,te,re,ne,ie,ae,oe,se,ue,le,ce,he,de,fe,ve=e.type;switch(ve){case lt.COLOR:var pe=new Tt(null!==(t=e.color)&&void 0!==t?t:5855577),me=new kt(null!==(i=e.alpha)&&void 0!==i?i:1),ge=new Ht("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");ge.keywords.alpha=me;var ye=new _t(null!==(n=e.mode)&&void 0!==n?n:0);return pe.alpha=me,{layer:new Ot(e.id,{type:ve,color:pe,alpha:me,calpha:ge,mode:ye}),color:pe,alpha:ge,mode:ye};case lt.TEXTURE:var Ae=null!==(s=e.texture)&&void 0!==s?s:new Yt,be=Ae.matrix;e.mat&&be.copy(e.mat),Ae.needsUpdate=!0;var we=new kt(null!==(o=e.crop)&&void 0!==o?o:0),xe=new kt(null!==(a=e.alpha)&&void 0!==a?a:1),Oe=new _t(null!==(l=e.mode)&&void 0!==l?l:0),Ee=new Xt(Ae),Ce=new qt(Ee,we,xe,Oe),De=new Ht(Ce.calpha,"f");return{layer:new Ot(e.id,{type:ve,texture:Ee,crop:we,mat:Ce.mat,alpha:xe,calpha:De,mode:Oe}),color:Ce,alpha:De,mode:Oe};case lt.MATCAP:var Se=new Tt(null!==(c=e.color)&&void 0!==c?c:16777215),Be=null!==(h=e.texture)&&void 0!==h?h:new Yt;Be.needsUpdate=!0;var Te=new kt(null!==(u=e.alpha)&&void 0!==u?u:1),ke=new Xt(Be),_e=new _t(null!==(d=e.mode)&&void 0!==d?d:0),Me=new dr(Se,ke,Te,_e),Le=new Ht(Me.calpha,"f");return{layer:new Ot(e.id,{type:ve,texture:ke,color:Se,alpha:Te,calpha:Le,mode:_e}),color:Me,alpha:Le,mode:_e};case lt.FRESNEL:var Ne=new Tt(null!==(p=e.color)&&void 0!==p?p:16777215),Fe=new kt(null!==(f=e.bias)&&void 0!==f?f:.1),Ie=new kt(null!==(v=e.scale)&&void 0!==v?v:1),je=new kt(null!==(g=e.intensity)&&void 0!==g?g:2),Pe=new kt(null!==(m=e.factor)&&void 0!==m?m:1),Re=new kt(null!==(y=e.alpha)&&void 0!==y?y:1),ze=new _t(null!==(A=e.mode)&&void 0!==A?A:0),Ue=new Zt(Ne,Fe,Ie,je,Pe,Re,ze),Ge=new Ht(Ue.calpha,"f");return{layer:new Ot(e.id,{type:ve,color:Ne,bias:Fe,scale:Ie,intensity:je,factor:Pe,alpha:Re,calpha:Ge,mode:ze}),color:Ue,alpha:Ge,mode:ze};case lt.DEPTH:var Ve=new kt(null!==(w=e.near)&&void 0!==w?w:700),He=new kt(null!==(x=e.far)&&void 0!==x?x:1e3),Je=new kt(null!==(b=e.isVector)&&void 0!==b?b:0),Qe=new Nt(null!==(O=e.origin)&&void 0!==O?O:new r.Vector3),Ye=new Tt(null!==(E=e.colorA)&&void 0!==E?E:new r.Color),We=new Tt(null!==(C=e.colorB)&&void 0!==C?C:new r.Color(0,0,0)),Xe=new kt(null!==(D=e.alpha)&&void 0!==D?D:1),Ke=new _t(null!==(S=e.mode)&&void 0!==S?S:0),qe=new Ht("alpha / clamp(alpha + accumAlpha, 0.001, 1.0 )","f");qe.keywords.alpha=Xe;var Ze=new cr(Ve,He,Je,Qe,Ye,We,Xe);return{layer:new Ot(e.id,{type:ve,near:Ve,far:He,isVector:Je,origin:Qe,colorA:Ye,colorB:We,alpha:Xe,calpha:qe,mode:Ke}),color:Ze,alpha:qe,mode:Ke};case lt.NOISE:var $e=new kt(null!==(B=e.scale)&&void 0!==B?B:2),et=new kt(null!==(T=e.move)&&void 0!==T?T:1),tt=new Lt(null!==(k=e.fA)&&void 0!==k?k:new r.Vector2(1.7,9.2)),nt=new Lt(null!==(_=e.fB)&&void 0!==_?_:new r.Vector2(8.3,2.8)),it=new Lt(null!==(M=e.distortion)&&void 0!==M?M:new r.Vector2(1,1)),at=new Tt(null!==(L=e.colorA)&&void 0!==L?L:new r.Color(.4,.4,.4)),ot=new Tt(null!==(N=e.colorB)&&void 0!==N?N:new r.Color(.4,.4,.4)),st=new Tt(null!==(F=e.colorC)&&void 0!==F?F:new r.Color(1,1,1)),ut=new Tt(null!==(I=e.colorD)&&void 0!==I?I:new r.Color(1,1,1)),ct=new kt(null!==(j=e.intA)&&void 0!==j?j:1),ht=new kt(null!==(P=e.intB)&&void 0!==P?P:1),ft=new kt(null!==(R=e.intC)&&void 0!==R?R:1),vt=new kt(null!==(z=e.intD)&&void 0!==z?z:1),pt=new kt(null!==(U=e.alpha)&&void 0!==U?U:1),mt=new _t(null!==(G=e.mode)&&void 0!==G?G:0),gt=new _t(null!==(V=e.noiseType)&&void 0!==V?V:0),yt=new Ht("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");yt.keywords.alpha=pt;var At=new sr($e,et,tt,nt,it,at,ot,st,ut,ct,ht,ft,vt,pt,gt);return{layer:new Ot(e.id,{type:ve,scale:$e,move:et,fA:tt,fB:nt,distortion:it,colorA:at,colorB:ot,colorC:st,colorD:ut,intA:ct,intB:ht,intC:ft,intD:vt,alpha:pt,calpha:yt,mode:mt,noiseType:gt}),color:At,alpha:yt,mode:mt};case lt.NORMAL:var bt=new Nt(null!==(H=e.cnormal)&&void 0!==H?H:new r.Vector3(1,1,1)),wt=new kt(null!==(J=e.alpha)&&void 0!==J?J:1),xt=new _t(null!==(Q=e.mode)&&void 0!==Q?Q:0),Et=new $t(bt,wt),Ct=new Ht("alpha / clamp(alpha + accumAlpha, 0.00001, 1.0 )","f");return Ct.keywords.alpha=wt,{layer:new Ot(e.id,{type:ve,cnormal:bt,alpha:wt,calpha:Ct,mode:xt}),color:Et,alpha:Ct,mode:xt};case lt.GRADIENT:var Dt,St,Bt=new _t(null!==(Y=e.gl_type)&&void 0!==Y?Y:0),jt=new _t(null!==(W=e.num)&&void 0!==W?W:2),Pt=new Mt(null!==(X=e.smooth)&&void 0!==X&&X);e.colors?Dt=new Ft(e.colors.length,e.colors):(Dt=new Ft(10,new r.Vector4(0,0,0,1))).value[1]=new r.Vector4(1,1,1,1),e.steps?St=new It(e.steps.length,e.steps):(St=new It(10,1)).value[0]=0;var Rt=new Lt(null!==(K=e.offset)&&void 0!==K?K:new r.Vector2(0,0)),zt=new Lt(null!==(q=e.morph)&&void 0!==q?q:new r.Vector2(0,0)),Ut=new kt(null!==(Z=e.angle)&&void 0!==Z?Z:0),Gt=new kt(null!==($=e.alpha)&&void 0!==$?$:1),Vt=new _t(null!==(ee=e.mode)&&void 0!==ee?ee:0),Jt=new rr(Bt,jt,Pt,Dt,St,Rt,zt,Ut,Gt),Qt=new Ht(Jt.calpha,"f");return{layer:new Ot(e.id,{type:ve,gl_type:Bt,num:jt,smooth:Pt,colors:Dt,steps:St,offset:Rt,morph:zt,angle:Ut,alpha:Gt,calpha:Qt,mode:Vt}),color:Jt,alpha:Qt,mode:Vt};case lt.DISPLACE:var Wt=new _t(null!==(te=e.displacementType)&&void 0!==te?te:0);if(0===Wt.value){var Kt=new Nt(null!==(re=e.offset)&&void 0!==re?re:new r.Vector3(0,0,0)),er=new kt(null!==(ne=e.scale)&&void 0!==ne?ne:10),nr=new kt(null!==(ie=e.intensity)&&void 0!==ie?ie:8),ir=new kt(null!==(ae=e.movement)&&void 0!==ae?ae:1),ar=new kt(null!==(oe=e.alpha)&&void 0!==oe?oe:1),ur=new _t(null!==(se=e.mode)&&void 0!==se?se:0),lr=new _t(null!==(ue=e.noiseType)&&void 0!==ue?ue:0),fr=new or(Wt,nr,ir,Kt,er,lr);return{layer:new Ot(e.id,{displacementType:Wt,type:ve,offset:Kt,scale:er,intensity:nr,movement:ir,alpha:ar,mode:ur,noiseType:lr}),position:fr}}if(1===Wt.value){var vr=null!==(le=e.texture)&&void 0!==le?le:new Yt,pr=vr.matrix;e.mat&&pr.copy(e.mat),vr.needsUpdate=!0;var mr=new kt(null!==(ce=e.intensity)&&void 0!==ce?ce:8),gr=new Xt(vr),yr=new kt(null!==(he=e.crop)&&void 0!==he?he:0),Ar=new kt(null!==(de=e.alpha)&&void 0!==de?de:1),wr=new _t(null!==(fe=e.mode)&&void 0!==fe?fe:0),xr=new or(Wt,mr,gr,yr);return{layer:new Ot(e.id,{displacementType:Wt,type:ve,intensity:mr,texture:gr,crop:yr,mat:xr.mat,alpha:Ar,mode:wr}),position:xr}}return{}}return{}}},{key:"blendColors",value:function(){var e=this._layerNodes.findIndex((function(e){return e.type===ct.COLOR})),t=this._layerNodes.findIndex((function(e){return e.type===ct.LIGHTING}));if(-1!==e&&e<t){for(var r=this._layerNodes[e].color,n=e+1;n<t;++n){var o=this._layerNodes[n];o.type===ct.COLOR&&(r=new lr(r,o.color,o.alpha,o.mode))}this._material.color=r}else this._material.color=void 0}},{key:"blendAfterColors",value:function(){var e=new Ht("outgoingLight","f"),t=this._layerNodes.findIndex((function(e){return e.type===ct.LIGHTING}));if(this._layerNodes.length>t+1){for(var r=t+1;r<this._layerNodes.length;++r){var n=this._layerNodes[r];n.type===ct.COLOR&&(e=new lr(e,n.color,n.alpha,n.mode))}"afterColor"in this._material&&(this._material.afterColor=e)}else"afterColor"in this._material&&(this._material.afterColor=void 0)}},{key:"blendPositions",value:function(){var e=this._layerNodes.filter((function(e){return e.type===ct.POSITION}));if(e.length>0){for(var t=e[0].position,r=1;r<e.length;++r)e[r]&&(t=new ur(t,e[r].position,ur.ADD),t=new ur(t,new kt(.5).setReadonly(!0),ur.MUL));this._material.position=t}else this._material.position=void 0}},{key:"cleanupChangedLayer",value:function(e){switch(this._layerNodes=this._layerNodes.filter((function(t){return t.id!==e.id})),e.type){case lt.DISPLACE:this.blendPositions();break;default:this.blendColors(),this.blendAfterColors()}}}]),e}();function vr(e,t,r,i){return new(r||(r=Promise))((function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,a)}l((i=i.apply(e,t||[])).next())}))}var pr=function(){function e(t){Object(A.a)(this,e),t=null!=t?t:{},this.name=t.name,this.type=t.type,this.node=t.node,this.size=t.size,this.needsUpdate=t.needsUpdate}return Object(w.a)(e,[{key:"value",get:function(){return this.node.value},set:function(e){this.node.value=e}}]),e}(),mr=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,l=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,c=arguments.length>3?arguments[3]:void 0;return Object(A.a)(this,n),(e=t.call(this,"v4")).nodeType="Vector4",e.value=o instanceof r.Vector4?o:new r.Vector4(o,l,i,c),e}return Object(w.a)(n,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format("vec4("+this.value.x+", "+this.value.y+", "+this.value.z+", "+this.value.w+")",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.value.copy(e.value),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).x=this.value.x,t.y=this.value.y,t.z=this.value.z,t.w=this.value.w,!0===this.getReadonly()&&(t.readonly=!0)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.x&&(this.value.x=e.x),e.y&&(this.value.y=e.y),e.z&&(this.value.z=e.z),e.w&&(this.value.w=e.w),void 0!==e.readonly&&(this.readonly=e.readonly),this}}]),n}(Bt);dt.addShortcuts(mr.prototype,"value",["x","y","z","w"]);var gr,yr=new RegExp("^structs*([a-z_0-9]+)s*{s*((.|\n)*?)}","gim"),Ar=new RegExp("s*(w*?)s*(w*?)(=|;)","gim"),tr=function(e){Object(x.a)(tr,e);var t=S(tr);function tr(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return Object(A.a)(this,tr),(e=t.call(this)).inputs=[],e.src="",e.nodeType="Struct",e.parse(r),e}return Object(w.a)(tr,[{key:"getType",value:function(e){return e.getTypeByFormat(this.name)}},{key:"getInputByName",value:function(e){for(var t=this.inputs.length;t--;)if(this.inputs[t].name===e)return this.inputs[t]}},{key:"generate",value:function(e,t,r,i,n){return"source"===t?this.src+";":e.format("( "+this.src+" )",this.getType(e),t)}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.src=e,this.inputs=[];var t=yr.exec(e);if(t){for(var r,n=t[2];r=Ar.exec(n);)this.inputs.push({type:r[1],name:r[2]});this.name=t[1]}else this.name="";this.type=this.name}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).src=this.src),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(tr.prototype),"fromJSON",this).call(this,e,t),e.src&&(this.src=e.src,this.parse(this.src)),this}}]),tr}(St),wr=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n){var o;return Object(A.a)(this,r),(o=t.call(this)).inputs=[],o.nodeType="FunctionCall",o.value=e,o.inputs=null!=n?n:[],o}return Object(w.a)(r,[{key:"getFunction",value:function(){return this.value}},{key:"getType",value:function(e){return this.value.getType(e)}},{key:"generate",value:function(e,t,r,i,n){i=this.getType(e);var s=this.value,o=s.build(e,t)+"( ",a=[];if(s.inputs){for(var l=0;l<s.inputs.length;l++){var c=s.inputs[l],h=this.inputs[l]||this.inputs[c.name];a.push(h.build(e,e.getTypeByFormat(c.type)))}o+=a.join(", ")+" )"}return e.format(o,i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value.copy(e.value),this.inputs=e.inputs.map((function(e){return e.clone()})),this}},{key:"toJSON",value:function(e){var t,r=this.getJSONNode(e);if(!r){var n=this.value;if((r=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,null===(t=n.inputs)||void 0===t?void 0:t.length){r.inputs={};for(var o=0;o<n.inputs.length;o++){var l=n.inputs[o],c=this.inputs[o];r.inputs[l.name]=c.toJSON(e).uuid}}}return r}}]),r}(St);!function(e){e.RAD="radians",e.DEG="degrees",e.EXP="exp",e.EXP2="exp2",e.LOG="log",e.LOG2="log2",e.SQRT="sqrt",e.INV_SQRT="inversesqrt",e.FLOOR="floor",e.CEIL="ceil",e.NORMALIZE="normalize",e.FRACT="fract",e.SATURATE="saturate",e.SIN="sin",e.COS="cos",e.TAN="tan",e.ASIN="asin",e.ACOS="acos",e.ARCTAN="atan",e.ABS="abs",e.SIGN="sign",e.LENGTH="length",e.NEGATE="negate",e.INVERT="invert",e.MIN="min",e.MAX="max",e.MOD="mod",e.STEP="step",e.REFLECT="reflect",e.DISTANCE="distance",e.DOT="dot",e.CROSS="cross",e.POW="pow",e.MIX="mix",e.CLAMP="clamp",e.REFRACT="refract",e.SMOOTHSTEP="smoothstep",e.FACEFORWARD="faceforward"}(gr||(gr={}));var xr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.ABS,l=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0;return Object(A.a)(this,r),(e=t.call(this)).nodeType="Math",e.a=n,"string"!=typeof o?e.b=o:i=o,"string"!=typeof l?e.c=l:i=l,e.method=i,e.hashProperties=["method"],e}return Object(w.a)(r,[{key:"getNumInputs",value:function(e){switch(this.method){case r.MIX:case r.CLAMP:case r.REFRACT:case r.SMOOTHSTEP:case r.FACEFORWARD:return 3;case r.MIN:case r.MAX:case r.MOD:case r.STEP:case r.REFLECT:case r.DISTANCE:case r.DOT:case r.CROSS:case r.POW:return 2;default:return 1}}},{key:"getInputType",value:function(e){var t=e.getTypeLength(this.a.getType(e)),r=this.b?e.getTypeLength(this.b.getType(e)):0,i=this.c?e.getTypeLength(this.c.getType(e)):0;return t>r&&t>i?this.a.getType(e):r>i?this.b.getType(e):this.c.getType(e)}},{key:"getType",value:function(e){switch(this.method){case r.LENGTH:case r.DISTANCE:case r.DOT:return"f";case r.CROSS:return"v3"}return this.getInputType(e)}},{key:"generate",value:function(e,t){var n,i,o,s=this.a?e.getTypeLength(this.a.getType(e)):0,l=this.b?e.getTypeLength(this.b.getType(e)):0,a=this.c?e.getTypeLength(this.c.getType(e)):0,c=this.getInputType(e),h=this.getType(e);switch(this.type=h,this.method){case r.NEGATE:return e.format("( -"+this.a.build(e,c)+" )",c,t);case r.INVERT:return e.format("( 1.0 - "+this.a.build(e,c)+" )",c,t);case r.CROSS:n=this.a.build(e,"v3"),i=this.b.build(e,"v3");break;case r.STEP:n=this.a.build(e,1===s?"f":c),i=this.b.build(e,c);break;case r.MIN:case r.MAX:case r.MOD:n=this.a.build(e,c),i=this.b.build(e,1===l?"f":c);break;case r.REFRACT:n=this.a.build(e,c),i=this.b.build(e,c),o=this.c.build(e,"f");break;case r.MIX:n=this.a.build(e,c),i=this.b.build(e,c),o=this.c.build(e,1===a?"f":c);break;default:n=this.a.build(e,c),this.b&&(i=this.b.build(e,c)),this.c&&(o=this.c.build(e,c))}var d=[];d.push(n),i&&d.push(i),o&&d.push(o);var u=this.getNumInputs(e);if(d.length!==u)throw Error('Arguments not match used in "'.concat(this.method,'". Require ').concat(u,", currently ").concat(d.length,"."));return e.format(this.method+"( "+d.join(", ")+" )",h,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.a.copy(e.a),this.b=e.b instanceof Dt?e.b.clone():e.b,this.c=e.c instanceof Dt?e.c.clone():e.c,this.method=e.method,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,this.b&&(t.b=this.b.toJSON(e).uuid),this.c&&(t.c=this.c.toJSON(e).uuid),t.method=this.method),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.a&&(this.a=t.getNode(e.a)),e.b&&(this.b=t.getNode(e.b)),e.c&&(this.c=t.getNode(e.c)),e.method&&(this.method=e.method),this}}]),r}(St);xr.RAD=gr.RAD,xr.DEG=gr.DEG,xr.EXP=gr.EXP,xr.EXP2=gr.EXP2,xr.LOG=gr.LOG,xr.LOG2=gr.LOG2,xr.SQRT=gr.SQRT,xr.INV_SQRT=gr.INV_SQRT,xr.FLOOR=gr.FLOOR,xr.CEIL=gr.CEIL,xr.NORMALIZE=gr.NORMALIZE,xr.FRACT=gr.FRACT,xr.SATURATE=gr.SATURATE,xr.SIN=gr.SIN,xr.COS=gr.COS,xr.TAN=gr.TAN,xr.ASIN=gr.ASIN,xr.ACOS=gr.ACOS,xr.ARCTAN=gr.ARCTAN,xr.ABS=gr.ABS,xr.SIGN=gr.SIGN,xr.LENGTH=gr.LENGTH,xr.NEGATE=gr.NEGATE,xr.INVERT=gr.INVERT,xr.MIN=gr.MIN,xr.MAX=gr.MAX,xr.MOD=gr.MOD,xr.STEP=gr.STEP,xr.REFLECT=gr.REFLECT,xr.DISTANCE=gr.DISTANCE,xr.DOT=gr.DOT,xr.CROSS=gr.CROSS,xr.POW=gr.POW,xr.MIX=gr.MIX,xr.CLAMP=gr.CLAMP,xr.REFRACT=gr.REFRACT,xr.SMOOTHSTEP=gr.SMOOTHSTEP,xr.FACEFORWARD=gr.FACEFORWARD;var Or=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v4")).nodeType="TextureCubeUV",e.value=n,e.uv=o,e.bias=l,e}return Object(w.a)(r,[{key:"bilinearCubeUV",value:function(e,t,n,i){var o,s,l,a,c=new wr(r.Nodes.bilinearCubeUV,[t,n,i]);this.colorSpaceTL=null!==(o=this.colorSpaceTL)&&void 0!==o?o:new Jt(new Ht("","v4")),this.colorSpaceTL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(c.build(e)+".tl"),this.colorSpaceTR=null!==(s=this.colorSpaceTR)&&void 0!==s?s:new Jt(new Ht("","v4")),this.colorSpaceTR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(c.build(e)+".tr"),this.colorSpaceBL=null!==(l=this.colorSpaceBL)&&void 0!==l?l:new Jt(new Ht("","v4")),this.colorSpaceBL.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(c.build(e)+".bl"),this.colorSpaceBR=null!==(a=this.colorSpaceBR)&&void 0!==a?a:new Jt(new Ht("","v4")),this.colorSpaceBR.fromDecoding(e.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(c.build(e)+".br");var h={include:e.isShader("vertex"),ignoreCache:!0};e.addContext(h),this.colorSpaceTLExp=new Ht(this.colorSpaceTL.build(e,"v4"),"v4"),this.colorSpaceTRExp=new Ht(this.colorSpaceTR.build(e,"v4"),"v4"),this.colorSpaceBLExp=new Ht(this.colorSpaceBL.build(e,"v4"),"v4"),this.colorSpaceBRExp=new Ht(this.colorSpaceBR.build(e,"v4"),"v4"),e.removeContext();var d=new Ht("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return d.keywords.cubeUV_TL=this.colorSpaceTLExp,d.keywords.cubeUV_TR=this.colorSpaceTRExp,d.keywords.cubeUV_BL=this.colorSpaceBLExp,d.keywords.cubeUV_BR=this.colorSpaceBRExp,d.keywords.cubeUV=c,d}},{key:"generate",value:function(e,t){if(e.isShader("fragment")){var n=this.uv,o=this.bias||e.context.roughness,l=new wr(r.Nodes.roughnessToMip,[o]),c=new xr(l,r.Nodes.m0,r.Nodes.cubeUV_maxMipLevel,xr.CLAMP),h=new xr(c,xr.FLOOR),d=new xr(c,xr.FRACT),f=this.bilinearCubeUV(e,this.value,n,h),v=this.bilinearCubeUV(e,this.value,n,new ur(h,new kt(1).setReadonly(!0),ur.ADD)),m=new xr(f,v,d,xr.MIX);return e.format(m.build(e),"v4",t)}return console.warn("TextureCubeUVNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.uv.copy(e.uv),this.bias.copy(e.bias),this.value.copy(e.value),e.colorSpaceTL?this.colorSpaceTL?this.colorSpaceTL.copy(e.colorSpaceTL):this.colorSpaceTL=e.colorSpaceTL.clone():this.colorSpaceTL=void 0,e.colorSpaceTR?this.colorSpaceTR?this.colorSpaceTR.copy(e.colorSpaceTR):this.colorSpaceTR=e.colorSpaceTR.clone():this.colorSpaceTR=void 0,e.colorSpaceBL?this.colorSpaceBL?this.colorSpaceBL.copy(e.colorSpaceBL):this.colorSpaceBL=e.colorSpaceBL.clone():this.colorSpaceBL=void 0,e.colorSpaceBR?this.colorSpaceBR?this.colorSpaceBR.copy(e.colorSpaceBR):this.colorSpaceBR=e.colorSpaceBR.clone():this.colorSpaceBR=void 0,e.colorSpaceTLExp?this.colorSpaceTLExp?this.colorSpaceTLExp.copy(e.colorSpaceTLExp):this.colorSpaceTLExp=e.colorSpaceTLExp.clone():this.colorSpaceTLExp=void 0,e.colorSpaceTRExp?this.colorSpaceTRExp?this.colorSpaceTRExp.copy(e.colorSpaceTRExp):this.colorSpaceTRExp=e.colorSpaceTRExp.clone():this.colorSpaceTRExp=void 0,e.colorSpaceBLExp?this.colorSpaceBLExp?this.colorSpaceBLExp.copy(e.colorSpaceBLExp):this.colorSpaceBLExp=e.colorSpaceBLExp.clone():this.colorSpaceBLExp=void 0,e.colorSpaceBRExp?this.colorSpaceBRExp?this.colorSpaceBRExp.copy(e.colorSpaceBRExp):this.colorSpaceBRExp=e.colorSpaceBRExp.clone():this.colorSpaceBRExp=void 0,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,t.uv=this.uv.toJSON(e).uuid,t.bias=this.bias.toJSON(e).uuid,this.colorSpaceTL&&this.colorSpaceTL.toJSON(e).uuid,this.colorSpaceTR&&this.colorSpaceTR.toJSON(e).uuid,this.colorSpaceBL&&this.colorSpaceBL.toJSON(e).uuid,this.colorSpaceBR&&this.colorSpaceBR.toJSON(e).uuid,this.colorSpaceTLExp&&this.colorSpaceTLExp.toJSON(e).uuid,this.colorSpaceTRExp&&this.colorSpaceTRExp.toJSON(e).uuid,this.colorSpaceBLExp&&this.colorSpaceBLExp.toJSON(e).uuid,this.colorSpaceBRExp&&this.colorSpaceBRExp.toJSON(e).uuid),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=t.getNode(e.value)),e.uv&&(this.uv=t.getNode(e.uv)),e.bias&&(this.bias=t.getNode(e.bias)),e.colorSpaceTL&&(this.colorSpaceTL=t.getNode(e.colorSpaceTL)),e.colorSpaceTR&&(this.colorSpaceTR=t.getNode(e.colorSpaceTR)),e.colorSpaceBL&&(this.colorSpaceBL=t.getNode(e.colorSpaceBL)),e.colorSpaceBR&&(this.colorSpaceBR=t.getNode(e.colorSpaceBR)),e.colorSpaceTLExp&&(this.colorSpaceTLExp=t.getNode(e.colorSpaceTLExp)),e.colorSpaceTRExp&&(this.colorSpaceTRExp=t.getNode(e.colorSpaceTRExp)),e.colorSpaceBLExp&&(this.colorSpaceBLExp=t.getNode(e.colorSpaceBLExp)),e.colorSpaceBRExp&&(this.colorSpaceBRExp=t.getNode(e.colorSpaceBRExp)),this}}]),r}(St);Or.Nodes=function(){var e=new tr("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),t=new Vt("float cubeUV_maxMipLevel 8.0",!0),r=new Vt("float cubeUV_minMipLevel 4.0",!0),i=new Vt("float cubeUV_maxTileSize 256.0",!0),n=new Vt("float cubeUV_minTileSize 16.0",!0),s=new Ut("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");s.useKeywords=!1;var o=new Ut("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x); // pos x\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(-direction.x, -direction.z) / abs(direction.y); // pos y\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z); // pos z\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x); // neg x\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = vec2(-direction.x, direction.z) / abs(direction.y); // neg y\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(direction.x, direction.y) / abs(direction.z); // neg z\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");o.useKeywords=!1;var a=new Ut("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[e,s,o,t,r,i,n]);a.useKeywords=!1;var l=new Vt("float r0 1.0",!0),c=new Vt("float v0 0.339",!0),h=new Vt("float m0 -2.0",!0),u=new Vt("float r1 0.8",!0),d=new Vt("float v1 0.276",!0),p=new Vt("float m1 -1.0",!0),f=new Vt("float r4 0.4",!0),v=new Vt("float v4 0.046",!0),g=new Vt("float m4 2.0",!0),m=new Vt("float r5 0.305",!0),y=new Vt("float v5 0.016",!0),A=new Vt("float m5 3.0",!0),w=new Vt("float r6 0.21",!0),x=new Vt("float v6 0.0038",!0),b=new Vt("float m6 4.0",!0);return{bilinearCubeUV:a,roughnessToMip:new Ut("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[l,c,h,u,d,p,f,v,g,m,y,A,w,x,b]),m0:h,cubeUV_maxMipLevel:t}}();var Er=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"v3")).nodeType="Normal",n.scope=null!=e?e:r.VIEW,n}return Object(w.a)(r,[{key:"getShared",value:function(){return this.scope===r.WORLD}},{key:"build",value:function(e,t,n,i){var o=e.context[this.scope+"Normal"];return o?o.build(e,t,n,i):Object(v.a)(Object(E.a)(r.prototype),"build",this).call(this,e,t,n)}},{key:"generate",value:function(e,t,n,i,o){var s;switch(this.scope){case r.VIEW:s=e.isShader("vertex")?"transformedNormal":"geometryNormal";break;case r.LOCAL:e.isShader("vertex")?s="objectNormal":(e.requires.normal=!0,s="vObjectNormal");break;case r.WORLD:e.isShader("vertex")?s="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(e.requires.worldNormal=!0,s="vWNormal")}return e.format(s,this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.scope=e.scope,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.scope&&(this.scope=e.scope),this}}]),r}(St);Er.LOCAL="local",Er.WORLD="world",Er.VIEW="view",Er.NORMAL="normal",jt.addKeyword("viewNormal",(function(){return new Er(Er.VIEW)})),jt.addKeyword("localNormal",(function(){return new Er(Er.NORMAL)})),jt.addKeyword("worldNormal",(function(){return new Er(Er.WORLD)}));var Cr=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"v3")).nodeType="Position",n.scope=null!=e?e:r.LOCAL,n}return Object(w.a)(r,[{key:"getType",value:function(){switch(this.scope){case r.PROJECTION:return"v4"}return this.type}},{key:"getShader",value:function(){switch(this.scope){case r.LOCAL:case r.WORLD:return!1}return!0}},{key:"generate",value:function(e,t,n,i,o){var s;switch(this.scope){case r.LOCAL:e.isShader("vertex")?s="transformed":(e.requires.position=!0,s="vPosition");break;case r.WORLD:if(e.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";e.requires.worldPosition=!0,s="vWPosition";break;case r.VIEW:s=e.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case r.PROJECTION:s=e.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return e.format(s,this.getType(),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.scope=e.scope,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.scope&&(this.scope=e.scope),this}}]),r}(St);Cr.LOCAL="local",Cr.WORLD="world",Cr.VIEW="view",Cr.PROJECTION="projection",jt.addKeyword("position",(function(){return new Cr})),jt.addKeyword("worldPosition",(function(){return new Cr(Cr.WORLD)})),jt.addKeyword("viewPosition",(function(){return new Cr(Cr.VIEW)}));var Dr=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this,"v3")).nodeType="Reflect",n.scope=null!=e?e:r.CUBE,n}return Object(w.a)(r,[{key:"getUnique",value:function(e){return!e.context.viewNormal}},{key:"getType",value:function(){switch(this.scope){case r.SPHERE:return"v2"}return this.type}},{key:"generate",value:function(e,t){var n=this.getUnique(e);if(e.isShader("fragment")){var o;switch(this.scope){case r.VECTOR:var l=new Er(Er.VIEW),c=e.context.roughness,h=l.build(e,"v3"),d=new Cr(Cr.VIEW).build(e,"v3"),f=c?c.build(e,"f"):void 0,v="reflect( -normalize( ".concat(d," ), ").concat(h," )");f&&(v="normalize( mix( ".concat(v,", ").concat(h,", ").concat(f," * ").concat(f," ) )"));var m="inverseTransformDirection( ".concat(v,", viewMatrix )");n?(e.addNodeCode("vec3 reflectVec = ".concat(m,";")),o="reflectVec"):o=m;break;case r.CUBE:var y=new r(r.VECTOR).build(e,"v3"),A="vec3( -"+y+".x, "+y+".yz )";n?(e.addNodeCode("vec3 reflectCubeVec = ".concat(A,";")),o="reflectCubeVec"):o=A;break;case r.SPHERE:var w="normalize( ( viewMatrix * vec4( "+new r(r.VECTOR).build(e,"v3")+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5";n?(e.addNodeCode("vec2 reflectSphereVec = ".concat(w,";")),o="reflectSphereVec"):o=w}return e.format(o,this.getType(),t)}return console.warn("ReflectNode is not compatible with "+e.shader+" shader."),e.format("vec3( 0.0 )",this.type,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.scope=e.scope,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).scope=this.scope),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.scope&&(this.scope=e.scope),this}}]),r}(St);Dr.CUBE="cube",Dr.SPHERE="sphere",Dr.VECTOR="vector";var Sr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xt,o=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0;return Object(A.a)(this,r),(e=t.call(this,"v4")).nodeType="TextureCube",e.value=n,e.radianceNode=new Or(e.value,null!=o?o:new Dr(Dr.VECTOR),l),e.irradianceNode=new Or(e.value,new Er(Er.WORLD),new kt(1).setReadonly(!0)),e}return Object(w.a)(r,[{key:"generate",value:function(e,t){return e.isShader("fragment")?(e.require("irradiance"),e.context.bias&&e.context.bias.setTexture(this.value),("irradiance"===e.slot?this.irradianceNode:this.radianceNode).build(e,t)):(console.warn("TextureCubeNode is not compatible with "+e.shader+" shader."),e.format("vec4( 0.0 )",this.getType(e),t))}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value.copy(e.value),this.radianceNode.copy(e.radianceNode),this.irradianceNode.copy(e.irradianceNode),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid,this.radianceNode&&(t.radianceNode=this.radianceNode.toJSON(e).uuid),this.irradianceNode&&(t.irradianceNode=this.irradianceNode.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=t.getNode(e.value)),e.radianceNode&&(this.radianceNode=t.getNode(e.radianceNode)),e.irradianceNode&&(this.irradianceNode=t.getNode(e.irradianceNode)),this}}]),r}(St),hr=function(e){Object(x.a)(hr,e);var t=S(hr);function hr(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.CubeTexture,o=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0;return Object(A.a)(this,hr),(e=t.call(this,"v4",{shared:!0})).nodeType="CubeTexture",e.value=n,e.uv=null!=o?o:new Dr,e.bias=i,e}return Object(w.a)(hr,[{key:"getTexture",value:function(e,t){return Object(v.a)(Object(E.a)(hr.prototype),"generate",this).call(this,e,t,this.value.uuid,"tc")}},{key:"generate",value:function(e,t){var r,i;if("samplerCube"===t)return this.getTexture(e,t);var n,o=this.getTexture(e,t),s=null===(r=this.uv)||void 0===r?void 0:r.build(e,"v3"),a=this.bias?this.bias.build(e,"f"):void 0;void 0===a&&e.context.bias&&(a=e.context.bias.setTexture(this).build(e,"f")),n=a?"texCubeBias( "+o+", "+s+", "+a+" )":"texCube( "+o+", "+s+" )";var l={include:e.isShader("vertex"),ignoreCache:!0},c=this.getType(e);return e.addContext(l),this.colorSpace=null!==(i=this.colorSpace)&&void 0!==i?i:new Jt(new Ht("",c)),this.colorSpace.fromDecoding(e.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(n),n=this.colorSpace.build(e,c),e.removeContext(),e.format(n,c,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(hr.prototype),"copy",this).call(this,e),this.value.copy(e.value),e.uv?this.uv?this.uv.copy(e.uv):this.uv=e.uv.clone():this.uv=void 0,e.bias?this.bias?this.bias.copy(e.bias):this.bias=e.bias.clone():this.bias=void 0,this}},{key:"toJSON",value:function(e){var t,r=this.getJSONNode(e);return r||(r=this.createJSONNode(e),this.value&&(r.value=this.value.uuid),r.uv=null===(t=this.uv)||void 0===t?void 0:t.toJSON(e).uuid,this.bias&&(r.bias=this.bias.toJSON(e).uuid)),r.nodeType=this.nodeType,r}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(hr.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=t.getTexture(e.value)),e.uv&&(this.uv=t.getNode(e.uv)),e.bias&&(this.bias=t.getNode(e.bias)),this}}]),hr}(Bt),Br=dt.elements,Tr=["float","vec2","vec3","vec4"],kr={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b","float[]":"f[]","vec4[]":"v4[]"},_r={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4","f[]":"float[]","v4[]":"vec4[]"},Mr=function(){function e(){Object(A.a)(this,e),this.includes={consts:{},functions:{},structs:{}},this.cache="",this.slot="",this.shader="",this.context={},this.getIncludesCode=function(){function e(e,t){return e.deps.length-t.deps.length}return function(t,r){var i=this.getIncludes(t,r);if(!i)return"";var n="";i=i.sort(e);for(var o=0;o<i.length;o++)i[o].src&&(n+=i[o].src+"\n");return n}}(),this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.fragmentVariables={},this.requires={uv:[],color:[],lights:!1,fog:!1,transparent:!1,irradiance:!1,position:!1,worldPosition:!1,normal:!1,worldNormal:!1,vWorldViewDir:!1,vWorldNormal:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","\n\t\t\t// NOTE: Include Spline's blending modes. This could be part of BlendNode\n\t\t\t#define SPE_BLENDING_NORMAL 0\n\t\t\t#define SPE_BLENDING_MULTIPLY 1\n\t\t\t#define SPE_BLENDING_SCREEN 2\n\t\t\t#define SPE_BLENDING_OVERLAY 3\n\n\t\t\tvec3 spe_normalBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_multiplyBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\treturn mix( a, a * b, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_screenBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = 1.0 - ( 1.0 - a ) * ( 1.0 - b );\n\t\t\t\treturn mix( a, tmp, alpha );\n\t\t\t}\n\n\t\t\tvec3 spe_overlayBlend( vec3 a, vec3 b, float alpha ) {\n\t\t\t\tvec3 tmp = mix( 1. - 2. * (1. - a) * (1. - b), 2. * a * b, step( a, vec3(.5) ) );\n\t\t\t\treturn clamp( mix( a, tmp, alpha ), 0.0, 1.0 );\n\t\t\t}\n\n\t\t\tvec3 spe_blend( vec3 a, vec3 b, float alpha, int mode ) {\n\t\t\t\tif ( mode == SPE_BLENDING_NORMAL ) return spe_normalBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_MULTIPLY ) return spe_multiplyBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_SCREEN ) return spe_screenBlend( a, b, alpha );\n\t\t\t\telse if ( mode == SPE_BLENDING_OVERLAY ) return spe_overlayBlend( a, b, alpha );\n\t\t\t\treturn vec3( 1.0 );\n\t\t\t}\n\t\t\t","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:["float neighbor_offset = 0.0001;",""].join("\n"),fragment:["float accumAlpha = 0.0;","void accumulateAlpha(float alpha) {\n\t\t\t\t\taccumAlpha += (1.0 - accumAlpha) * alpha;\n\t\t\t\t}",""].join("\n")},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},arrayUniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.updaters=[],this.nodes=[],this.analyzing=!1}return Object(w.a)(e,[{key:"build",value:function(e,t){this.buildShader("vertex",e),this.buildShader("fragment",t);for(var r=0;r<this.requires.uv.length;r++)if(this.requires.uv[r]){var n=r>0?r+1:"";this.addVaryCode("varying vec2 vUv"+n+";"),r>0&&this.addVertexParsCode("attribute vec2 uv"+n+";"),this.addVertexFinalCode("vUv"+n+" = uv"+n+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this.requires.vWorldViewDir&&(this.addVaryCode("varying vec3 vWorldViewDir;"),this.addVertexFinalCode("vWorldViewDir = isPerspectiveMatrix( projectionMatrix ) ?  ( (modelMatrix * vec4(position, 1.0)).xyz - cameraPosition ) : vec3( -viewMatrix[0][2], -viewMatrix[1][2], -viewMatrix[2][2] );")),this.requires.vWorldNormal&&(this.addVaryCode("varying vec3 vWorldNormal;"),this.addVertexFinalCode("vWorldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );")),this}},{key:"buildShader",value:function(e,t){this.resultCode[e]=t.build(this.setShader(e),"v4")}},{key:"setMaterial",value:function(e,t){return this.material=e,this.renderer=t,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this}},{key:"addFlow",value:function(e,t,r){return this.addSlot(e).addCache(t).addContext(r)}},{key:"removeFlow",value:function(){return this.removeSlot().removeCache().removeContext()}},{key:"addCache",value:function(e){return this.cache=null!=e?e:"",this.caches.push(this.cache),this}},{key:"removeCache",value:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this}},{key:"addContext",value:function(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this}},{key:"removeContext",value:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this}},{key:"addSlot",value:function(e){return this.slot=e||"",this.slots.push(this.slot),this}},{key:"removeSlot",value:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this}},{key:"addFragmentVariable",value:function(e,t){void 0===this.fragmentVariables[e]&&(this.addFragmentCode("".concat(t," ").concat(e,";")),this.fragmentVariables[e]="")}},{key:"addVertexCode",value:function(e){this.addCode(e,"vertex")}},{key:"addFragmentCode",value:function(e){this.addCode(e,"fragment")}},{key:"addCode",value:function(e,t){this.code[null!=t?t:this.shader]+=e+"\n"}},{key:"addVertexNodeCode",value:function(e){this.addNodeCode(e,"vertex")}},{key:"addFragmentNodeCode",value:function(e){this.addNodeCode(e,"fragment")}},{key:"addNodeCode",value:function(e,t){this.nodeCode[null!=t?t:this.shader]+=e+"\n"}},{key:"clearNodeCode",value:function(e){e=null!=e?e:this.shader;var t=this.nodeCode[e];return this.nodeCode[e]="",t}},{key:"clearVertexNodeCode",value:function(){return this.clearNodeCode("vertex")}},{key:"clearFragmentNodeCode",value:function(){return this.clearNodeCode("fragment")}},{key:"addVertexFinalCode",value:function(e){this.addFinalCode(e,"vertex")}},{key:"addFragmentFinalCode",value:function(e){this.addFinalCode(e,"fragment")}},{key:"addFinalCode",value:function(e,t){this.finalCode[null!=t?t:this.shader]+=e+"\n"}},{key:"addVertexParsCode",value:function(e){this.addParsCode(e,"vertex")}},{key:"addFragmentParsCode",value:function(e){this.addParsCode(e,"fragment")}},{key:"addParsCode",value:function(e,t){this.parsCode[null!=t?t:this.shader]+=e+"\n"}},{key:"addVaryCode",value:function(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)}},{key:"isCache",value:function(e){return-1!==this.caches.indexOf(e)}},{key:"isSlot",value:function(e){return-1!==this.slots.indexOf(e)}},{key:"define",value:function(e,t){this.defines[e]=void 0===t?1:t}},{key:"require",value:function(e){this.requires[e]=!0}},{key:"isDefined",value:function(e){return void 0!==this.defines[e]}},{key:"getVar",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"varying",n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"V",s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",o=this.getVars(i),a=o[e];if(!a){var l=o.length;a={name:r||"node"+n+l+(s?"_"+s:""),type:t},o.push(a),o[e]=a}return a}},{key:"getTempVar",value:function(e,t,r,i){return this.getVar(e,t,r,this.shader,"T",i)}},{key:"getAttribute",value:function(e,t){if(!this.attributes[e]){var r=this.getVar(e,t);this.addVertexParsCode("attribute "+t+" "+e+";"),this.addVertexFinalCode(r.name+" = "+e+";"),this.attributes[e]={varying:r,name:e,type:t}}return this.attributes[e]}},{key:"getCode",value:function(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getVarListCode(this.inputs.arrayUniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")}},{key:"getVarListCode",value:function(e,t){t=null!=t?t:"";for(var r="",n=0,o=e.length;n<o;++n){var l=e[n],c=l.type,h=l.name,d=l.size,f=this.getFormatByType(c);if(void 0===f)throw new Error("Node pars "+f+" not found.");f.includes("[]")?r+=t+" "+f.substring(0,f.length-2)+" "+h+"[".concat(d,"];\n"):r+=t+" "+f+" "+h+";\n"}return r}},{key:"getVars",value:function(e){return this.inputs.vars[null!=e?e:this.shader]}},{key:"getNodeData",value:function(e){var t=e instanceof Dt?e.uuid:e;return this.nodeData[t]=this.nodeData[t]||{}}},{key:"createUniform",value:function(e,t,r,i,n,s){if(t.includes("[]")){var o=this.inputs.arrayUniforms,l=o.list.length,c=new pr({type:t,size:r.size,name:i||"nodeUA"+l+(s?"_"+s:""),node:r,needsUpdate:n});return o.list.push(c),o[e].push(c),o[e][c.name]=c,this.uniforms[c.name]=c,c}var h=this.inputs.uniforms,d=h.list.length,f=new pr({type:t,name:i||"nodeU"+d+(s?"_"+s:""),node:r,needsUpdate:n});return h.list.push(f),h[e].push(f),h[e][f.name]=f,this.uniforms[f.name]=f,f}},{key:"createVertexUniform",value:function(e,t,r,i,n){return this.createUniform("vertex",e,t,r,i,n)}},{key:"createFragmentUniform",value:function(e,t,r,i,n){return this.createUniform("fragment",e,t,r,i,n)}},{key:"include",value:function(e,t,r){var i,n;if(e="string"==typeof e?jt.get(e):e,!1===this.context.include)return e.name;e instanceof Ut?n=this.includes.functions:e instanceof Vt?n=this.includes.consts:e instanceof tr&&(n=this.includes.structs);var s=n[this.shader]=n[this.shader]||[];if(e){var o=s[e.name];if(o||(o=s[e.name]={node:e,deps:[]},s.push(o),o.src=e.build(this,"source")),e instanceof Ut&&t&&s[t.name]&&-1==s[t.name].deps.indexOf(e)&&(s[t.name].deps.push(e),null===(i=e.includes)||void 0===i?void 0:i.length)){var l=0;do{this.include(e.includes[l++],t)}while(l<e.includes.length)}return r&&(o.src=r),e.name}throw new Error("Include not found.")}},{key:"colorToVectorProperties",value:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")}},{key:"colorToVector",value:function(e){return e.replace(/c/g,"v3")}},{key:"getIncludes",value:function(e,t){return this.includes[e][t||this.shader]}},{key:"getConstructorFromLength",value:function(e){return Tr[e-1]}},{key:"isTypeMatrix",value:function(e){return/^m/.test(e)}},{key:"getTypeLength",value:function(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))}},{key:"getTypeFromLength",value:function(e){return 1===e?"f":"v"+e}},{key:"findNode",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(var n=0;n<arguments.length;n++){var o=t[n];if(null==o?void 0:o.isNode)return o}}},{key:"resolve",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var o=0;o<arguments.length;o++){var l=t[o];if(void 0!==l){if(l.isNode)return l;if(l.isTexture)switch(l.mapping){case r.CubeReflectionMapping:case r.CubeRefractionMapping:return new hr(l);case r.CubeUVReflectionMapping:case r.CubeUVRefractionMapping:return new Sr(new Xt(l));default:return new Xt(l)}else{if(l.isVector2)return new Lt(l);if(l.isVector3)return new Nt(l);if(l.isVector4)return new mr(l)}}}}},{key:"format",value:function(e,t,r){switch(this.colorToVector(r+" <- "+t)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e}},{key:"getTypeByFormat",value:function(e){return kr[e]||e}},{key:"getFormatByType",value:function(e){return _r[e]||e}},{key:"getUUID",value:function(e,t){return(t=void 0===t||t)&&this.cache&&(e=this.cache+"-"+e),e}},{key:"getElementByIndex",value:function(e){return Br[e]}},{key:"getIndexByElement",value:function(e){return Br.indexOf(e)}},{key:"isShader",value:function(e){return this.shader===e}},{key:"setShader",value:function(e){return this.shader=e,this}},{key:"mergeDefines",value:function(e){for(var t in e)this.defines[t]=e[t];return this.defines}},{key:"mergeUniform",value:function(e){for(var t in e)this.uniforms[t]=e[t];return this.uniforms}},{key:"getTextureEncodingFromMap",value:function(e){var t;return e?e.isTexture&&(t=e.encoding):t=r.LinearEncoding,t===r.LinearEncoding&&this.context.gamma&&(t=r.GammaEncoding),t}}]),e}(),Lr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt;return Object(A.a)(this,r),(e=t.call(this,"v4")).nodeType="Raw",e.value=n,e}return Object(w.a)(r,[{key:"generate",value:function(e){var t=this.value.analyzeAndFlow(e,this.type),r=t.code+"\n";return e.isShader("vertex")?r+="gl_Position = "+t.result+";":r+="gl_FragColor = "+t.result+";",r}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value.copy(e.value),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).value=this.value.toJSON(e).uuid),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=t.getNode(e.value)),this}}]),r}(Dt),Nr=function(e){Object(x.a)(n,e);var t=S(n);function n(e,r,o){var l;return Object(A.a)(this,n),(l=t.call(this,o)).isNodeMaterial=!0,l.type="NodeMaterial",l.wireframeLinecap="",l.wireframeLinejoin="",l.userData={type:"",category:"",nodeType:""},l.fog=!0,l.vertex=null!=e?e:new Lr(new Cr(Cr.PROJECTION)),l.fragment=null!=r?r:new Lr(new Tt(5855577)),l.updaters=[],l.isDetached=!0,l.onBeforeCompile=l._onBeforeCompile,l}return Object(w.a)(n,[{key:"getDefines",value:function(){return this.defines}},{key:"getUniforms",value:function(){return this.uniforms}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"_onBeforeCompile",value:function(e,t){this.build({renderer:t}),e.defines=this.defines,e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.extensionDerivatives=!0===this.extensions.derivatives,e.extensionFragDepth=!0===this.extensions.fragDepth,e.extensionDrawBuffers=!0===this.extensions.drawBuffers,e.extensionShaderTextureLOD=!0===this.extensions.shaderTextureLOD}},{key:"_getLayerStack",value:function(e){var t=this,r=new fr(this);return e&&vr(t,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==e.image){t.next=5;break}return t.next=3,new Promise((function(e){return requestAnimationFrame(e)}));case 3:t.next=0;break;case 5:r.addLayerAt(1,{type:lt.TEXTURE,texture:e}),this.dispose();case 6:case"end":return t.stop()}}),t,this)}))),r}},{key:"clampUniformsForPreview",value:function(){if(this.userData.layers){var e,t=C(this.userData.layers.getLayers());try{for(t.s();!(e=t.n()).done;){var r=e.value;r.type!=lt.DISPLACE_MAP&&r.type!=lt.DISPLACE_NOISE||(r.uniforms["".concat(r.id,"_intensity")]=(n=r.uniforms["".concat(r.id,"_intensity")],-150,150,Math.min(Math.max(n,-150),150)))}}catch(e){t.e(e)}finally{t.f()}}var n}},{key:"customProgramCacheKey",value:function(){return this.getHash()}},{key:"updateFrame",value:function(e){for(var t=0;t<this.updaters.length;++t)e.updateNode(this.updaters[t])}},{key:"build",value:function(e){var t,i=null!==(t=(e=null!=e?e:{}).builder)&&void 0!==t?t:new Mr;return i.setMaterial(this,e.renderer),i.build(this.vertex,this.fragment),this.vertexShader=i.getCode("vertex"),this.fragmentShader=i.getCode("fragment"),this.defines=i.defines,this.uniforms=i.uniforms,this.extensions=i.extensions,this.updaters=i.updaters,this.fog=i.requires.fog,this.lights=i.requires.lights,this.transparent=i.requires.transparent||this.blending>r.NormalBlending,this}},{key:"getHash",value:function(){var e="{";return e+='"vertex":'+this.vertex.getHash()+",",e+='"fragment":'+this.fragment.getHash(),e+="}"}},{key:"copy",value:function(e){var t=this.uuid;for(var r in e)this[r]=e[r];return this.uuid=t,void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this}},{key:"toJSON",value:function(e){var t=this.userData.layers;this.userData.layers=void 0;var r=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e);return r.type="ShaderMaterial",r.userData={type:this.userData.type,category:this.userData.category,nodeType:this.type,layers:t.toJSON(e)},r.vertex=this.vertex.toJSON(e).uuid,r.fragment=this.fragment.toJSON(e).uuid,delete r.vertexShader,delete r.fragmentShader,delete r.color,delete r.shininess,delete r.specular,delete r.roughness,delete r.metalness,delete r.uniforms,e&&!e.materials[this.uuid]&&(e.materials[this.uuid]=r),this.userData.layers=t,r}},{key:"fromJSON",value:function(e,t){var i;this.defines=null!==(i=e.defines)&&void 0!==i?i:{},this.depthFunc=e.depthFunc,this.depthWrite=e.depthWrite,this.side=void 0!==e.side?e.side:r.FrontSide,this.transparent=e.transparent,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.wireframe=e.wireframe,this.userData.layers.fromJSON(e.userData.layers,t,this)}}]),n}(r.ShaderMaterial);Object.defineProperties(Nr.prototype,{properties:{get:function(){return this.fragment.properties}},needsUpdate:{set:function(e){!0===e&&this.version++,this.needsCompile=e},get:function(){return this.needsCompile}}});var Fr=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,"basic")).nodeType="Basic",e.color=new Tt(5855577),e}return Object(w.a)(n,[{key:"generate",value:function(e){var t;if(e.isShader("vertex")){var n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(r.UniformsUtils.merge([r.UniformsLib.fog])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED"," varying vec3 vNormal;","#endif","#include <fog_pars_vertex>"].join("\n"));var o=["#include <beginnormal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#ifndef FLAT_SHADED"," vNormal = normalize( transformedNormal );","#endif","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","\tvNormal = transformedNormal;","#endif"),o.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>"),t=o.join("\n")}else{void 0===this.color&&(this.color=new Tt(5855577)),this.color.analyze(e,{slot:"color"}),this.alpha&&this.alpha.analyze(e),this.mask&&this.mask.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"});var l=this.color.flow(e,"c",{slot:"color"}),c=this.alpha?this.alpha.flow(e,"f"):void 0,h=this.mask?this.mask.flow(e,"b"):void 0,d=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0;e.requires.transparent=void 0!==c,e.addParsCode(["#include <fog_pars_fragment>","varying vec3 vViewPosition;","#ifndef FLAT_SHADED"," varying vec3 vNormal;","#endif"].join("\n"));var f=["#include <normal_fragment_begin>",l.code];h&&f.push(h.code,"if ( ! "+h.result+" ) discard;"),c&&f.push(c.code,"#ifdef ALPHATEST"," if ( "+c.result+" <= ALPHATEST ) discard;","#endif"),d?f.push(d.code,"vec3 outgoingLight = ".concat(l.result,";"),"vec3 finalColor = spe_blend(outgoingLight, ".concat(d.result,", 1.0, SPE_BLENDING_NORMAL);")):f.push("vec3 finalColor = ".concat(l.result,";")),c?f.push("gl_FragColor = vec4( finalColor, accumAlpha * ".concat(c.result," );")):f.push("gl_FragColor = vec4("+l.result+", 1.0 );"),f.push("#include <fog_fragment>"),t=f.join("\n")}return t}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),e.color&&(this.color=e.color.clone()),e.position&&(this.position=e.position.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.mask&&(this.mask=e.mask.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.color&&(t.color=this.color.toJSON(e).uuid),this.position&&(t.position=this.position.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.afterColor&&(t.afterColor=this.afterColor.toJSON(e).uuid),this.shadingAlpha&&(t.shadingAlpha=this.shadingAlpha.toJSON(e).uuid),this.shadingBlend&&(t.shadingBlend=this.shadingBlend.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.position&&(this.position=t.getNode(e.position)),e.color&&(this.color=t.getNode(e.color)),e.mask&&(this.mask=t.getNode(e.mask)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.afterColor&&(this.afterColor=t.getNode(e.afterColor)),e.shadingAlpha&&(this.shadingAlpha=t.getNode(e.shadingAlpha)),e.shadingBlend&&(this.shadingBlend=t.getNode(e.shadingBlend)),this}}]),n}(Dt),Ir=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fr,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,n,n,o)).type="BasicNodeMaterial",e}return r}(Nr);dt.addShortcuts(Ir.prototype,"fragment",["color","alpha","afterColor","shadingAlpha","shadingBlend","mask","position"]);var jr=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o){var l;return Object(A.a)(this,r),(l=t.call(this,n,e)).userData.type="BasicMaterial",l.userData.category="Basic",l.userData.layers=null!=o?o:l._getLayerStack(null==e?void 0:e.map),l}return Object(w.a)(r,[{key:"layersList",get:function(){return this.userData.layers},set:function(e){this.userData.layers=e}},{key:"equals",value:function(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}},{key:"copy",value:function(e){if(void 0!==e.userData.layers&&e.userData.layers instanceof fr){var t=e.userData.layers,n=e.fragment;Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);var o=n.clone();this.fragment=o,this.vertex=o;var l=t.clone();this.userData.layers=l,l.material=this}else Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);return this}},{key:"dispose",value:function(){Object(v.a)(Object(E.a)(r.prototype),"dispose",this).call(this)}}],[{key:"fromJSON",value:function(e,t,n){var o=new r(void 0,n.getNode(t.vertex));return o.fromJSON(t,n),o}},{key:"fromMaterial",value:function(e){var t=new r(e.map?{map:e.map}:{}),n=t.fragment;return n.color.value.copy(e.color),n.alpha.value=e.opacity,t}}]),r}(Ir),Pr=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,"phong")).nodeType="Phong",e.color=new Tt(5855577),e.specular=new Tt(1118481),e.shininess=new kt(30),e.shadingAlpha=new kt(1),e.shadingBlend=new _t(0),e}return Object(w.a)(n,[{key:"build",value:function(e){var t;if(e.define("PHONG"),e.requires.lights=!0,e.isShader("vertex")){var n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(r.UniformsUtils.merge([r.UniformsLib.fog,r.UniformsLib.lights])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),t=o.join("\n")}else{this.mask&&this.mask.analyze(e),void 0===this.color&&(this.color=new Tt(5855577)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&this.environment.analyze(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(e);var l=this.mask?this.mask.flow(e,"b"):void 0,c=this.color.flow(e,"c",{slot:"color"}),h=this.specular.flow(e,"c"),d=this.shininess.flow(e,"f"),f=this.shadingAlpha.flow(e,"f"),v=this.shadingBlend.flow(e,"i"),m=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,y=this.alpha?this.alpha.flow(e,"f"):void 0,A=this.normal?this.normal.flow(e,"v3"):void 0,w=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,x=this.ao?this.ao.flow(e,"f"):void 0,O=this.ambient?this.ambient.flow(e,"c"):void 0,E=this.shadow?this.shadow.flow(e,"c"):void 0,C=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0,D=this.environment?this.environment.flow(e,"c",{slot:"environment"}):void 0,S=this.environmentAlpha&&this.environment?this.environmentAlpha.flow(e,"f"):void 0;e.requires.transparent=void 0!==y,e.addParsCode(["#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));var B=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;"];l&&B.push(l.code,"if ( ! "+l.result+" ) discard;"),B.push(c.code,"\tvec3 diffuseColor = "+c.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",h.code,"\tvec3 specular = "+h.result+";",d.code,"\tfloat shininess = max( 0.0001, "+d.result+" );","\tfloat specularStrength = 1.0;"),y&&B.push(y.code,"#ifdef ALPHATEST","if ( "+y.result+" <= ALPHATEST ) discard;","#endif"),A&&B.push(A.code,"normal = "+A.result+";"),B.push("material.diffuseColor = "+(w?"vec3( 1.0 )":"diffuseColor")+";"),B.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),w&&(B.push(w.code,"reflectedLight.directDiffuse = "+w.result+";"),B.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),x&&B.push(x.code,"reflectedLight.indirectDiffuse *= "+x.result+";"),O&&B.push(O.code,"reflectedLight.indirectDiffuse += "+O.result+";"),E&&B.push(E.code,"reflectedLight.directDiffuse *= "+E.result+";","reflectedLight.directSpecular += "+E.result+";"),C&&B.push(C.code,"reflectedLight.directDiffuse += "+C.result+";"),B.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),D&&(B.push(D.code),S?B.push(S.code,"outgoingLight = mix( outgoingLight, "+D.result+", "+S.result+" );"):B.push("outgoingLight = "+D.result+";")),B.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(f.result," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(f.result,", ").concat(v.result," );\n\t\t\t\t}\n\t\t\t\t")),m&&B.push(m.code,"outgoingLight = spe_blend(outgoingLight, ".concat(m.result,", 1.0, SPE_BLENDING_NORMAL);")),y?B.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(y.result," );")):B.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),B.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>"),t=B.join("\n")}return t}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),e.color&&(this.color=e.color.clone()),this.specular=e.specular.clone(),this.shininess=e.shininess.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.mask&&(this.mask=e.mask.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.normal&&(this.normal=e.normal.clone()),e.light&&(this.light=e.light.clone()),e.shadow&&(this.shadow=e.shadow.clone()),e.ao&&(this.ao=e.ao.clone()),e.emissive&&(this.emissive=e.emissive.clone()),e.ambient&&(this.ambient=e.ambient.clone()),e.environment&&(this.environment=e.environment.clone()),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),this.color&&(t.color=this.color.toJSON(e).uuid),t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,t.shadingAlpha=this.shadingAlpha.toJSON(e).uuid,t.shadingBlend=this.shadingBlend.toJSON(e).uuid,this.afterColor&&(t.afterColor=this.afterColor.toJSON(e).uuid),this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.position&&(this.position=t.getNode(e.position)),e.color&&(this.color=t.getNode(e.color)),e.specular&&(this.specular=t.getNode(e.specular)),e.shininess&&(this.shininess=t.getNode(e.shininess)),e.mask&&(this.mask=t.getNode(e.mask)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.normal&&(this.normal=t.getNode(e.normal)),e.light&&(this.light=t.getNode(e.light)),e.ao&&(this.ao=t.getNode(e.ao)),e.ambient&&(this.ambient=t.getNode(e.ambient)),e.shadow&&(this.shadow=t.getNode(e.shadow)),e.emissive&&(this.emissive=t.getNode(e.emissive)),e.environment&&(this.environment=t.getNode(e.environment)),e.environmentAlpha&&(this.environmentAlpha=t.getNode(e.environmentAlpha)),e.shadingAlpha&&(this.shadingAlpha=t.getNode(e.shadingAlpha)),e.shadingBlend&&(this.shadingBlend=t.getNode(e.shadingBlend)),e.afterColor&&(this.afterColor=t.getNode(e.afterColor)),this}}]),n}(Dt),br=function(e){Object(x.a)(br,e);var t=S(br);function br(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pr,n=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,br),(e=t.call(this,r,r,n)).type="PhongNodeMaterial",e}return br}(Nr);dt.addShortcuts(br.prototype,"fragment",["color","afterColor","alpha","shadingAlpha","shadingBlend","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]);var Rr=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o){var l;return Object(A.a)(this,r),(l=t.call(this,n,e)).userData.type="PhongMaterial",l.userData.category="Phong",l.userData.layers=null!=o?o:l._getLayerStack(null==e?void 0:e.map),l}return Object(w.a)(r,[{key:"layersList",get:function(){return this.userData.layers},set:function(e){this.userData.layers=e}},{key:"equals",value:function(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}},{key:"copy",value:function(e){if(void 0!==e.userData.layers&&e.userData.layers instanceof fr){var t=e.userData.layers,n=e.fragment;Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);var o=n.clone();this.fragment=o,this.vertex=o;var l=t.clone();this.userData.layers=l,l.material=this,o.shadingAlpha.value=n.shadingAlpha.value,o.shadingBlend.value=n.shadingBlend.value}else Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);return this}},{key:"dispose",value:function(){Object(v.a)(Object(E.a)(r.prototype),"dispose",this).call(this)}}],[{key:"fromJSON",value:function(e,t,n){var o=new r(void 0,n.getNode(t.vertex));return o.fromJSON(t,n),o}},{key:"fromMaterial",value:function(e){var t=new r(e.map?{map:e.map}:{}),n=t.fragment;return n.color.value.copy(e.color),n.alpha.value=e.opacity,t}}]),r}(br),zr=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,"lambert")).nodeType="Lambert",e.color=new Tt(5855577),e.emissive=new Tt(0),e.emissiveIntensity=new kt(1),e.shadingAlpha=new kt(1),e.shadingBlend=new _t(0),e}return Object(w.a)(n,[{key:"build",value:function(e){var t;if(e.define("LAMBERT"),e.requires.lights=!0,e.isShader("vertex")){var n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(r.UniformsUtils.merge([r.UniformsLib.fog,r.UniformsLib.lights])),e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <color_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\n\t\t\t\t\tvec3 diffuse = vec3( 1.0 );\n\t\t\t\t\tGeometricContext geometry;\n\t\t\t\t\tgeometry.position = mvPosition.xyz;\n\t\t\t\t\tgeometry.normal = normalize( transformedNormal );\n\t\t\t\t\tgeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\t\t\t\t\tGeometricContext backGeometry;\n\t\t\t\t\tbackGeometry.position = geometry.position;\n\t\t\t\t\tbackGeometry.normal = -geometry.normal;\n\t\t\t\t\tbackGeometry.viewDir = geometry.viewDir;\n\t\t\t\t\tvLightFront = vec3( 0.0 );\n\t\t\t\t\tvIndirectFront = vec3( 0.0 );\n\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\tvLightBack = vec3( 0.0 );\n\t\t\t\t\t\tvIndirectBack = vec3( 0.0 );\n\t\t\t\t\t#endif\n\t\t\t\t\tIncidentLight directLight;\n\t\t\t\t\tfloat dotNL;\n\t\t\t\t\tvec3 directLightColor_Diffuse;\n\t\t\t\t\t#if NUM_POINT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_SPOT_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_DIR_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\t\t\t\t\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\t\t\t\t\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\t\t\t\t\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t\t#if NUM_HEMI_LIGHTS > 0\n\t\t\t\t\t\t#pragma unroll_loop_start\n\t\t\t\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\t\t\t\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t\t\t\t\t\t#ifdef DOUBLE_SIDED\n\t\t\t\t\t\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t\t\t\t\t\t#endif\n\t\t\t\t\t\t}\n\t\t\t\t\t\t#pragma unroll_loop_end\n\t\t\t\t\t#endif\n\t\t\t\t","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),t=o.join("\n")}else{this.mask&&this.mask.analyze(e),void 0===this.color&&(this.color=new Tt(5855577)),this.color.analyze(e,{slot:"color"}),this.emissive.analyze(e,{slot:"emissive"}),this.emissiveIntensity.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.environment&&this.environment.analyze(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(e);var l=this.mask?this.mask.flow(e,"b"):void 0,c=this.color.flow(e,"c",{slot:"color"}),h=this.emissive.flow(e,"c",{slot:"emissive"}),d=this.emissiveIntensity.flow(e,"f",{slot:"emissive"}),f=this.shadingAlpha.flow(e,"f"),v=this.shadingBlend.flow(e,"i"),m=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,y=this.alpha?this.alpha.flow(e,"f"):void 0,A=this.normal?this.normal.flow(e,"v3"):void 0;this.environment&&this.environment.flow(e,"c",{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.flow(e,"f"),e.requires.transparent=void 0!==y,e.addParsCode(["varying vec3 vViewPosition;","varying vec3 vLightFront;","varying vec3 vIndirectFront;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#ifdef DOUBLE_SIDED","\tvarying vec3 vLightBack;","\tvarying vec3 vIndirectBack;","#endif","#include <bsdfs>","#include <lights_pars_begin>","#include <fog_pars_fragment>","#include <shadowmap_pars_fragment>","#include <shadowmask_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>"].join("\n"));var w=["#include <normal_fragment_begin>","#include <clipping_planes_fragment>"];l&&w.push(l.code,"if ( ! "+l.result+" ) discard;"),w.push(c.code,"vec3 diffuseColor = "+c.result+";","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>"),y&&w.push(y.code,"#ifdef ALPHATEST","if ( "+y.result+" <= ALPHATEST ) discard;","#endif"),A&&w.push(A.code,"normal = "+A.result+";"),w.push("#ifdef DOUBLE_SIDED","\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;","#else","\treflectedLight.indirectDiffuse += vIndirectFront;","#endif","#include <lightmap_fragment>","reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor );","#ifdef DOUBLE_SIDED","\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;","#else","\treflectedLight.directDiffuse = vLightFront;","#endif","reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor ) * getShadowMask();"),h&&w.push(h.code,"reflectedLight.directDiffuse += "+h.result+" * "+d.result+";"),w.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;"),w.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(f.result," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(f.result,", ").concat(v.result," );\n\t\t\t\t}\n\t\t\t\t")),m&&w.push(m.code,"outgoingLight = spe_blend(outgoingLight, ".concat(m.result,", 1.0, SPE_BLENDING_NORMAL);")),y?w.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(y.result," );")):w.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),w.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),t=w.join("\n")}return t}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),e.color&&(this.color=e.color.clone()),this.emissiveIntensity=e.emissiveIntensity.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.mask&&(this.mask=e.mask.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.normal&&(this.normal=e.normal.clone()),e.light&&(this.light=e.light.clone()),e.shadow&&(this.shadow=e.shadow.clone()),e.ao&&(this.ao=e.ao.clone()),e.emissive&&(this.emissive=e.emissive.clone()),e.ambient&&(this.ambient=e.ambient.clone()),e.environment&&(this.environment=e.environment.clone()),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),this.color&&(t.color=this.color.toJSON(e).uuid),t.emissiveIntensity=this.emissiveIntensity.toJSON(e).uuid,t.shadingAlpha=this.shadingAlpha.toJSON(e).uuid,t.shadingBlend=this.shadingBlend.toJSON(e).uuid,this.afterColor&&(t.afterColor=this.afterColor.toJSON(e).uuid),this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.position&&(this.position=t.getNode(e.position)),e.color&&(this.color=t.getNode(e.color)),e.shadingAlpha&&(this.shadingAlpha=t.getNode(e.shadingAlpha)),e.shadingBlend&&(this.shadingBlend=t.getNode(e.shadingBlend)),e.afterColor&&(this.afterColor=t.getNode(e.afterColor)),e.emissiveIntensity&&(this.emissiveIntensity=t.getNode(e.emissiveIntensity)),e.mask&&(this.mask=t.getNode(e.mask)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.normal&&(this.normal=t.getNode(e.normal)),e.light&&(this.light=t.getNode(e.light)),e.ao&&(this.ao=t.getNode(e.ao)),e.ambient&&(this.ambient=t.getNode(e.ambient)),e.shadow&&(this.shadow=t.getNode(e.shadow)),e.emissive&&(this.emissive=t.getNode(e.emissive)),e.environment&&(this.environment=t.getNode(e.environment)),e.environmentAlpha&&(this.environmentAlpha=t.getNode(e.environmentAlpha)),this}}]),n}(Dt),Ur=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new zr,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,n,n,o)).type="LambertNodeMaterial",e}return r}(Nr);dt.addShortcuts(Ur.prototype,"fragment",["color","afterColor","alpha","shadingAlpha","shadingBlend","normal","emissive","emissiveIntensity","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]);var Gr=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o){var l;return Object(A.a)(this,r),(l=t.call(this,n,e)).userData.type="LambertMaterial",l.userData.category="Lambert",l.userData.layers=null!=o?o:l._getLayerStack(null==e?void 0:e.map),l}return Object(w.a)(r,[{key:"layersList",get:function(){return this.userData.layers},set:function(e){this.userData.layers=e}},{key:"equals",value:function(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}},{key:"copy",value:function(e){if(void 0!==e.userData.layers&&e.userData.layers instanceof fr){var t=e.userData.layers,n=e.fragment;Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);var o=n.clone();this.fragment=o,this.vertex=o;var l=t.clone();this.userData.layers=l,l.material=this,o.shadingAlpha.value=n.shadingAlpha.value,o.shadingBlend.value=n.shadingBlend.value}else Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);return this}},{key:"dispose",value:function(){Object(v.a)(Object(E.a)(r.prototype),"dispose",this).call(this)}}],[{key:"fromJSON",value:function(e,t,n){var o=new r(void 0,n.getNode(t.vertex));return o.fromJSON(t,n),o}}]),r}(Ur),Vr=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,"toon")).nodeType="Toon",e.color=new Tt(5855577),e.specular=new Tt(1118481),e.shininess=new kt(30),e.shadingAlpha=new kt(1),e.shadingBlend=new _t(0),e}return Object(w.a)(n,[{key:"build",value:function(e){var t;if(e.define("TOON"),e.requires.lights=!0,e.isShader("vertex")){var n=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(r.UniformsUtils.merge([r.UniformsLib.fog,r.UniformsLib.lights])),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var o=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#ifdef USE_LAYER_DISPLACE\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","\n\t\t\t\t#ifndef USE_LAYER_DISPLACE\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif\n\t\t\t\t"];n&&o.push(n.code,n.result?"displaced_position = "+n.result+";":""),o.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),o.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),t=o.join("\n")}else{this.mask&&this.mask.analyze(e),void 0===this.color&&(this.color=new Tt(5855577)),this.color.analyze(e,{slot:"color"}),this.specular.analyze(e),this.shininess.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&this.environment.analyze(e,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(e);var l=this.mask?this.mask.flow(e,"b"):void 0,c=this.color.flow(e,"c",{slot:"color"}),h=this.specular.flow(e,"c"),d=this.shininess.flow(e,"f"),f=this.shadingAlpha.flow(e,"f"),v=this.shadingBlend.flow(e,"i"),m=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,y=this.alpha?this.alpha.flow(e,"f"):void 0,A=this.normal?this.normal.flow(e,"v3"):void 0,w=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,x=this.ao?this.ao.flow(e,"f"):void 0,O=this.ambient?this.ambient.flow(e,"c"):void 0,E=this.shadow?this.shadow.flow(e,"c"):void 0,C=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0,D=this.environment?this.environment.flow(e,"c",{slot:"environment"}):void 0,S=this.environmentAlpha&&this.environment?this.environmentAlpha.flow(e,"f"):void 0;e.requires.transparent=void 0!==y,e.addParsCode(["#include <gradientmap_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","\n\t\t\t\t\tvarying vec3 vViewPosition;\n\t\t\t\t\t#ifndef FLAT_SHADED\n\t\t\t\t\t\tvarying vec3 vNormal;\n\t\t\t\t\t#endif\n\t\t\t\t\tstruct ToonMaterial {\n\t\t\t\t\t\tvec3\tdiffuseColor;\n\t\t\t\t\t\tvec3\tspecularColor;\n\t\t\t\t\t\tfloat\tspecularShininess;\n\t\t\t\t\t\tfloat\tspecularStrength;\n\t\t\t\t\t};\n\t\t\t\t\tvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t\t\t\t\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\t\t\t\t\tirradiance *= PI;\n\t\t\t\t\t\t#endif\n\t\t\t\t\t\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t\t\t\t\t\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\t\t\t\t\t}\n\t\t\t\t\tvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\t\t\t\t\t\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t\t\t\t\t}\n\t\t\t\t\t#define RE_Direct\t\t\t\tRE_Direct_Toon\n\t\t\t\t\t#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\t\t\t\t\t#define Material_LightProbeLOD( material )\t(0)\n\t\t\t\t\t","#include <shadowmap_pars_fragment>","#include <bumpmap_pars_fragment>","#include <normalmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));var B=["#include <normal_fragment_begin>","\tToonMaterial material;"];l&&B.push(l.code,"if ( ! "+l.result+" ) discard;"),B.push(c.code,"\tvec3 diffuseColor = "+c.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",h.code,"\tvec3 specular = "+h.result+";",d.code,"\tfloat shininess = max( 0.0001, "+d.result+" );","\tfloat specularStrength = 1.0;"),y&&B.push(y.code,"#ifdef ALPHATEST","if ( "+y.result+" <= ALPHATEST ) discard;","#endif"),A&&B.push(A.code,"normal = "+A.result+";"),B.push("material.diffuseColor = "+(w?"vec3( 1.0 )":"diffuseColor")+";"),B.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),w&&(B.push(w.code,"reflectedLight.directDiffuse = "+w.result+";"),B.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),x&&B.push(x.code,"reflectedLight.indirectDiffuse *= "+x.result+";"),O&&B.push(O.code,"reflectedLight.indirectDiffuse += "+O.result+";"),E&&B.push(E.code,"reflectedLight.directDiffuse *= "+E.result+";","reflectedLight.directSpecular += "+E.result+";"),C&&B.push(C.code,"reflectedLight.directDiffuse += "+C.result+";"),B.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),D&&(B.push(D.code),S?B.push(S.code,"outgoingLight = mix( outgoingLight, "+D.result+", "+S.result+" );"):B.push("outgoingLight = "+D.result+";")),B.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(f.result," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(f.result,", ").concat(v.result," );\n\t\t\t\t}\n\t\t\t\t")),m&&B.push(m.code,"outgoingLight = spe_blend(outgoingLight, ".concat(m.result,", 1.0, SPE_BLENDING_NORMAL);")),y?B.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(y.result," );")):B.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),B.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>"),t=B.join("\n")}return t}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),e.color&&(this.color=e.color.clone()),this.specular=e.specular.clone(),this.shininess=e.shininess.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.mask&&(this.mask=e.mask.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.normal&&(this.normal=e.normal.clone()),e.light&&(this.light=e.light.clone()),e.shadow&&(this.shadow=e.shadow.clone()),e.ao&&(this.ao=e.ao.clone()),e.emissive&&(this.emissive=e.emissive.clone()),e.ambient&&(this.ambient=e.ambient.clone()),e.environment&&(this.environment=e.environment.clone()),e.environmentAlpha&&(this.environmentAlpha=e.environmentAlpha.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),this.color&&(t.color=this.color.toJSON(e).uuid),t.specular=this.specular.toJSON(e).uuid,t.shininess=this.shininess.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.environmentAlpha&&(t.environmentAlpha=this.environmentAlpha.toJSON(e).uuid),this.shadingAlpha&&(t.shadingAlpha=this.shadingAlpha.toJSON(e).uuid),this.shadingBlend&&(t.shadingBlend=this.shadingBlend.toJSON(e).uuid),this.afterColor&&(t.afterColor=this.afterColor.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.position&&(this.position=t.getNode(e.position)),e.color&&(this.color=t.getNode(e.color)),e.specular&&(this.specular=t.getNode(e.specular)),e.shininess&&(this.shininess=t.getNode(e.shininess)),e.mask&&(this.mask=t.getNode(e.mask)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.normal&&(this.normal=t.getNode(e.normal)),e.light&&(this.light=t.getNode(e.light)),e.ao&&(this.ao=t.getNode(e.ao)),e.ambient&&(this.ambient=t.getNode(e.ambient)),e.shadow&&(this.shadow=t.getNode(e.shadow)),e.emissive&&(this.emissive=t.getNode(e.emissive)),e.environment&&(this.environment=t.getNode(e.environment)),e.environmentAlpha&&(this.environmentAlpha=t.getNode(e.environmentAlpha)),e.shadingAlpha&&(this.shadingAlpha=t.getNode(e.shadingAlpha)),e.shadingBlend&&(this.shadingBlend=t.getNode(e.shadingBlend)),e.afterColor&&(this.afterColor=t.getNode(e.afterColor)),this}}]),n}(Dt),Hr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Vr,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,n,n,o)).type="ToonNodeMaterial",e}return r}(Nr);dt.addShortcuts(Hr.prototype,"fragment",["color","afterColor","alpha","shadingAlpha","shadingBlend","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]);var Jr=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o){var l;return Object(A.a)(this,r),(l=t.call(this,n,e)).userData.type="ToonMaterial",l.userData.category="Toon",l.userData.layers=null!=o?o:l._getLayerStack(null==e?void 0:e.map),l}return Object(w.a)(r,[{key:"layersList",get:function(){return this.userData.layers},set:function(e){this.userData.layers=e}},{key:"equals",value:function(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}},{key:"copy",value:function(e){if(void 0!==e.userData.layers&&e.userData.layers instanceof fr){var t=e.userData.layers,n=e.fragment;Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);var o=n.clone();this.fragment=o,this.vertex=o;var l=t.clone();this.userData.layers=l,l.material=this,o.shadingAlpha.value=n.shadingAlpha.value,o.shadingBlend.value=n.shadingBlend.value}else Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);return this}},{key:"dispose",value:function(){Object(v.a)(Object(E.a)(r.prototype),"dispose",this).call(this)}}],[{key:"fromJSON",value:function(e,t,n){var o=new r(void 0,n.getNode(t.vertex));return o.fromJSON(t,n),o}}]),r}(Hr),Qr=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n;return Object(A.a)(this,r),(n=t.call(this)).nodeType="MaxMIPLevel",n.texture=e,n.maxMIPLevel=0,n}return Object(w.a)(r,[{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.texture&&(t.texture=this.texture.toJSON(e).uuid),t.maxMIPLevel=this.maxMIPLevel),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.texture&&(this.texture=t.getNode(e.texture)),void 0!==e.maxMIPLevel&&(this.maxMIPLevel=e.maxMIPLevel),this}}]),r}(kt);Object.defineProperties(Qr.prototype,{value:{get:function(){if(0===this.maxMIPLevel){var e=this.texture.value.image;Array.isArray(e)&&(e=e[0]),this.maxMIPLevel=void 0!==e?Math.log(Math.max(e.width,e.height))*Math.LOG2E:0}return this.maxMIPLevel},set:function(){}}});var Yr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,"f")).nodeType="SpecularMIPLevel",e.roughness=n,e.texture=o,e}return Object(w.a)(r,[{key:"setTexture",value:function(e){return this.texture=e,this}},{key:"generate",value:function(e,t){var n;if(e.isShader("fragment")){this.maxMIPLevel=null!==(n=this.maxMIPLevel)&&void 0!==n?n:new Qr,this.maxMIPLevel.texture=this.texture;var o=e.include(r.Nodes.getSpecularMIPLevel);return e.format(o+"( "+this.roughness.build(e,"f")+", "+this.maxMIPLevel.build(e,"f")+" )",this.type,t)}return console.warn("SpecularMIPLevelNode is not compatible with "+e.shader+" shader."),e.format("0.0",this.type,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.roughness=e.roughness,e.texture?this.texture?this.texture.copy(e.texture):this.texture=e.texture.clone():this.texture=void 0,e.maxMIPLevel?this.maxMIPLevel?this.maxMIPLevel.copy(e.maxMIPLevel):this.maxMIPLevel=e.maxMIPLevel.clone():this.maxMIPLevel=void 0,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.texture&&(t.texture=this.texture.toJSON(e).uuid),this.roughness&&(t.roughness=this.roughness.toJSON(e).uuid),this.maxMIPLevel&&(t.maxMIPLevel=this.maxMIPLevel.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.roughness&&(this.roughness=t.getNode(e.roughness)),e.texture&&(this.texture=t.getNode(e.texture)),e.maxMIPLevel&&(this.maxMIPLevel=t.getNode(e.maxMIPLevel)),this}}]),r}(St);Yr.Nodes={getSpecularMIPLevel:new Ut(["float getSpecularMIPLevel( const in float roughness, const in float maxMIPLevelScalar ) {","\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );","\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n"))};var Wr=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,"standard")).nodeType="Standard",e.color=new Tt(5855577),e.roughness=new kt(.3),e.metalness=new kt(0),e.reflectivity=new kt(.5),e.shadingAlpha=new kt(1),e.shadingBlend=new _t(0),e}return Object(w.a)(n,[{key:"build",value:function(e){var t,i,n,s,o,a,l,c;e.define("STANDARD");var h=null!==(i=null!==(t=this.clearcoat)&&void 0!==t?t:this.clearcoatRoughness)&&void 0!==i?i:this.clearcoatNormal;if(h&&e.define("CLEARCOAT"),e.requires.lights=!0,e.extensions.derivatives=!0,e.extensions.shaderTextureLOD=!0,e.isShader("vertex")){var d=this.position?this.position.analyzeAndFlow(e,"v3",{cache:"position"}):void 0;e.mergeUniform(r.UniformsUtils.merge([r.UniformsLib.fog,r.UniformsLib.lights])),r.UniformsLib.LTC_1&&(e.uniforms.ltc_1={value:void 0},e.uniforms.ltc_2={value:void 0}),e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var f=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <defaultnormal_vertex>\n\t\t\t\t#endif\n\n\t\t\t\tvec3 displaced_position = position;\n\t\t\t\tvec3 displaced_normal = normal;\n\n\t\t\t\t#if defined( USE_LAYER_DISPLACE )\n\t\t\t\t\tvec3 transformed;\n\t\t\t\t\tvec3 transformedNormal;\n\t\t\t\t#endif\n\t\t\t\t","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","\n\t\t\t\t#if !defined( USE_LAYER_DISPLACE )\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t#endif /* !USE_LAYER_DISPLACE */\n\t\t\t\t"];d&&f.push(d.code,d.result?"displaced_position = "+d.result+";":""),f.push("transformed = displaced_position;","transformedNormal = normalMatrix * displaced_normal;","#ifndef FLAT_SHADED","    vNormal = transformedNormal;","#endif"),f.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),c=f.join("\n")}else{var v=new Ht("material.specularRoughness","f"),m=new Ht("material.clearcoatRoughness","f"),y={roughness:v,bias:new Yr(v),viewNormal:new Ht("normal","v3"),worldNormal:new Ht("inverseTransformDirection( geometry.normal, viewMatrix )","v3"),gamma:!0},A={gamma:!0},w={roughness:m,bias:new Yr(m),viewNormal:new Ht("clearcoatNormal","v3"),worldNormal:new Ht("inverseTransformDirection( geometry.clearcoatNormal, viewMatrix )","v3"),gamma:!0};this.mask&&this.mask.analyze(e),void 0===this.color&&(this.color=new Tt(5855577)),this.color.analyze(e,{slot:"color",context:A}),this.roughness.analyze(e),this.metalness.analyze(e),this.shadingAlpha.analyze(e),this.shadingBlend.analyze(e),this.afterColor&&this.afterColor.analyze(e,{slot:"afterColor"}),this.alpha&&this.alpha.analyze(e),this.normal&&this.normal.analyze(e),this.clearcoat&&this.clearcoat.analyze(e),this.clearcoatRoughness&&this.clearcoatRoughness.analyze(e),this.clearcoatNormal&&this.clearcoatNormal.analyze(e),this.reflectivity&&this.reflectivity.analyze(e),this.light&&this.light.analyze(e,{cache:"light"}),this.ao&&this.ao.analyze(e),this.ambient&&this.ambient.analyze(e),this.shadow&&this.shadow.analyze(e),this.emissive&&this.emissive.analyze(e,{slot:"emissive"}),this.environment&&(this.environment.analyze(e,{cache:"radiance",context:y,slot:"radiance"}),e.requires.irradiance&&this.environment.analyze(e,{cache:"irradiance",context:y,slot:"irradiance"})),this.sheen&&this.sheen.analyze(e);var x,O=this.mask?this.mask.flow(e,"b"):void 0,E=this.color.flow(e,"c",{slot:"color",context:A}),C=this.roughness.flow(e,"f"),D=this.metalness.flow(e,"f"),S=this.shadingAlpha.flow(e,"f"),B=this.shadingBlend.flow(e,"i"),T=this.afterColor?this.afterColor.flow(e,"c",{slot:"afterColor"}):void 0,k=this.alpha?this.alpha.flow(e,"f"):void 0,_=this.normal?this.normal.flow(e,"v3"):void 0,M=this.clearcoat?this.clearcoat.flow(e,"f"):void 0,L=this.clearcoatRoughness?this.clearcoatRoughness.flow(e,"f"):void 0,N=this.clearcoatNormal?this.clearcoatNormal.flow(e,"v3"):void 0,F=this.reflectivity?this.reflectivity.flow(e,"f"):void 0,I=this.light?this.light.flow(e,"v3",{cache:"light"}):void 0,j=this.ao?this.ao.flow(e,"f"):void 0,P=this.ambient?this.ambient.flow(e,"c"):void 0,R=this.shadow?this.shadow.flow(e,"c"):void 0,z=this.emissive?this.emissive.flow(e,"c",{slot:"emissive"}):void 0;this.environment&&(x={radiance:this.environment.flow(e,"c",{cache:"radiance",context:y,slot:"radiance"})},e.requires.irradiance&&(x.irradiance=this.environment.flow(e,"c",{cache:"irradiance",context:y,slot:"irradiance"})));var U=h&&x?null===(n=this.environment)||void 0===n?void 0:n.flow(e,"c",{cache:"clearcoat",context:w,slot:"environment"}):void 0,G=this.sheen?this.sheen.flow(e,"c"):void 0;e.requires.transparent=void 0!==k,e.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n"));var V=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\t#include <clearcoat_normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"];O&&V.push(O.code,"if ( ! "+O.result+" ) discard;"),V.push(E.code,"\tvec3 diffuseColor = "+E.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",C.code,"\tfloat roughnessFactor = "+C.result+";",D.code,"\tfloat metalnessFactor = "+D.result+";"),k&&V.push(k.code,"#ifdef ALPHATEST","\tif ( "+k.result+" <= ALPHATEST ) discard;","#endif"),_&&V.push(_.code,"normal = "+_.result+";"),N&&V.push(N.code,"clearcoatNormal = "+N.result+";"),V.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),V.push("material.diffuseColor = "+(I?"vec3( 1.0 )":"diffuseColor * ( 1.0 - metalnessFactor )")+";","material.specularRoughness = max( roughnessFactor, 0.0525 );","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"),M?V.push(M.code,"material.clearcoat = saturate( "+M.result+" );"):h&&V.push("material.clearcoat = 0.0;"),L?V.push(L.code,"material.clearcoatRoughness = max( "+L.result+", 0.0525 );","material.clearcoatRoughness += geometryRoughness;","material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );"):h&&V.push("material.clearcoatRoughness = 0.0;"),G&&V.push("material.sheenColor = "+G.result+";"),F?V.push(F.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+F.result+" ) ), diffuseColor, metalnessFactor );"):V.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),V.push("#include <lights_fragment_begin>"),I&&(V.push(I.code,"reflectedLight.directDiffuse = "+I.result+";"),V.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),j&&V.push(j.code,"reflectedLight.indirectDiffuse *= "+j.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+j.result+", material.specularRoughness );"),P&&V.push(P.code,"reflectedLight.indirectDiffuse += "+P.result+";"),R&&V.push(R.code,"reflectedLight.directDiffuse *= "+R.result+";","reflectedLight.directSpecular *= "+R.result+";"),z&&V.push(z.code,"reflectedLight.directDiffuse += "+z.result+";"),x&&(V.push(null===(s=x.radiance)||void 0===s?void 0:s.code),e.requires.irradiance&&V.push(null===(o=x.irradiance)||void 0===o?void 0:o.code),U&&V.push(U.code,"clearcoatRadiance += "+U.result+";"),V.push("radiance += "+(null===(a=x.radiance)||void 0===a?void 0:a.result)+";"),e.requires.irradiance&&V.push("iblIrradiance += PI * "+(null===(l=x.irradiance)||void 0===l?void 0:l.result)+";")),V.push("#include <lights_fragment_end>"),V.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),V.push("\n\t\t\t\tif (outgoingLight != diffuseColor) {\n\t\t\t\t\tfloat lightAccu = clamp( length( reflectedLight.directSpecular + reflectedLight.indirectSpecular ), 0.0, 1.0 );\n\t\t\t\t\taccumAlpha += ( 1.0 - accumAlpha ) * ".concat(S.result," * lightAccu;\n\t\t\t\t\toutgoingLight = spe_blend( diffuseColor, outgoingLight, ").concat(S.result,", ").concat(B.result," );\n\t\t\t\t}\n\t\t\t\t")),T&&V.push(T.code,"outgoingLight = spe_blend(outgoingLight, ".concat(T.result,", 1.0, SPE_BLENDING_NORMAL);")),k?V.push("gl_FragColor = vec4( outgoingLight, accumAlpha * ".concat(k.result," );")):V.push("gl_FragColor = vec4( outgoingLight, 1.0 );"),V.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),c=V.join("\n")}return c}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),e.color&&(this.color=e.color.clone()),this.roughness=e.roughness.clone(),this.metalness=e.metalness.clone(),e.position&&(this.position=e.position.clone()),e.afterColor&&(this.afterColor=e.afterColor.clone()),e.mask&&(this.mask=e.mask.clone()),e.alpha&&(this.alpha=e.alpha.clone()),e.normal&&(this.normal=e.normal.clone()),e.clearcoat&&(this.clearcoat=e.clearcoat.clone()),e.clearcoatRoughness&&(this.clearcoatRoughness=e.clearcoatRoughness.clone()),e.clearcoatNormal&&(this.clearcoatNormal=e.clearcoatNormal.clone()),e.reflectivity&&(this.reflectivity=e.reflectivity.clone()),e.light&&(this.light=e.light.clone()),e.shadow&&(this.shadow=e.shadow.clone()),e.ao&&(this.ao=e.ao.clone()),e.emissive&&(this.emissive=e.emissive.clone()),e.ambient&&(this.ambient=e.ambient.clone()),e.environment&&(this.environment=e.environment.clone()),e.sheen&&(this.sheen=e.sheen.clone()),e.shadingAlpha&&(this.shadingAlpha=e.shadingAlpha.clone()),e.shadingBlend&&(this.shadingBlend=e.shadingBlend.clone()),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.position&&(t.position=this.position.toJSON(e).uuid),this.color&&(t.color=this.color.toJSON(e).uuid),t.roughness=this.roughness.toJSON(e).uuid,t.metalness=this.metalness.toJSON(e).uuid,this.mask&&(t.mask=this.mask.toJSON(e).uuid),this.alpha&&(t.alpha=this.alpha.toJSON(e).uuid),this.normal&&(t.normal=this.normal.toJSON(e).uuid),this.clearcoat&&(t.clearcoat=this.clearcoat.toJSON(e).uuid),this.clearcoatRoughness&&(t.clearcoatRoughness=this.clearcoatRoughness.toJSON(e).uuid),this.clearcoatNormal&&(t.clearcoatNormal=this.clearcoatNormal.toJSON(e).uuid),this.reflectivity&&(t.reflectivity=this.reflectivity.toJSON(e).uuid),this.light&&(t.light=this.light.toJSON(e).uuid),this.ao&&(t.ao=this.ao.toJSON(e).uuid),this.ambient&&(t.ambient=this.ambient.toJSON(e).uuid),this.shadow&&(t.shadow=this.shadow.toJSON(e).uuid),this.emissive&&(t.emissive=this.emissive.toJSON(e).uuid),this.environment&&(t.environment=this.environment.toJSON(e).uuid),this.sheen&&(t.sheen=this.sheen.toJSON(e).uuid),this.shadingAlpha&&(t.shadingAlpha=this.shadingAlpha.toJSON(e).uuid),this.shadingBlend&&(t.shadingBlend=this.shadingBlend.toJSON(e).uuid),this.afterColor&&(t.afterColor=this.afterColor.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.position&&(this.position=t.getNode(e.position)),e.color&&(this.color=t.getNode(e.color)),e.roughness&&(this.roughness=t.getNode(e.roughness)),e.metalness&&(this.metalness=t.getNode(e.metalness)),e.mask&&(this.mask=t.getNode(e.mask)),e.alpha&&(this.alpha=t.getNode(e.alpha)),e.normal&&(this.normal=t.getNode(e.normal)),e.clearcoat&&(this.clearcoat=t.getNode(e.clearcoat)),e.clearcoatRoughness&&(this.clearcoatRoughness=t.getNode(e.clearcoatRoughness)),e.clearcoatNormal&&(this.clearcoatNormal=t.getNode(e.clearcoatNormal)),e.reflectivity&&(this.reflectivity=t.getNode(e.reflectivity)),e.light&&(this.light=t.getNode(e.light)),e.ao&&(this.ao=t.getNode(e.ao)),e.ambient&&(this.ambient=t.getNode(e.ambient)),e.shadow&&(this.shadow=t.getNode(e.shadow)),e.emissive&&(this.emissive=t.getNode(e.emissive)),e.environment&&(this.environment=t.getNode(e.environment)),e.sheen&&(this.sheen=t.getNode(e.sheen)),e.shadingAlpha&&(this.shadingAlpha=t.getNode(e.shadingAlpha)),e.shadingBlend&&(this.shadingBlend=t.getNode(e.shadingBlend)),e.afterColor&&(this.afterColor=t.getNode(e.afterColor)),this}}]),n}(Dt),Xr=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Wr,o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,n,n,o)).type="StandardNodeMaterial",e}return r}(Nr);dt.addShortcuts(Xr.prototype,"fragment",["color","afterColor","alpha","shadingAlpha","shadingBlend","roughness","metalness","reflectivity","clearcoat","clearcoatRoughness","clearcoatNormal","normal","emissive","fresnel","ambient","light","shadow","ao","environment","mask","position","sheen"]);var Kr,qr,Zr={BasicMaterial:jr,PhongMaterial:Rr,LambertMaterial:Gr,ToonMaterial:Jr,PhysicalMaterial:function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o){var l;return Object(A.a)(this,r),(l=t.call(this,n,e)).userData.type="PhysicalMaterial",l.userData.category="Physical",l.userData.layers=null!=o?o:l._getLayerStack(null==e?void 0:e.map),l}return Object(w.a)(r,[{key:"layersList",get:function(){return this.userData.layers},set:function(e){this.userData.layers=e}},{key:"equals",value:function(e){return this.userData.type===e.userData.type&&this.userData.layers.uuid==e.userData.layers.uuid}},{key:"copy",value:function(e){if(void 0!==e.userData.layers&&e.userData.layers instanceof fr){var t=e.userData.layers,n=e.fragment;Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);var o=n.clone();this.fragment=o,this.vertex=o;var l=t.clone();this.userData.layers=l,l.material=this,o.shadingAlpha.value=n.shadingAlpha.value,o.shadingBlend.value=n.shadingBlend.value}else Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e);return this}},{key:"dispose",value:function(){Object(v.a)(Object(E.a)(r.prototype),"dispose",this).call(this)}}],[{key:"fromJSON",value:function(e,t,n){var o=new r(void 0,n.getNode(t.vertex));return o.fromJSON(t,n),o}}]),r}(Xr)},$r=new Set;!function(e){e[e.LINEAR=0]="LINEAR",e[e.EASE=1]="EASE",e[e.EASE_IN=2]="EASE_IN",e[e.EASE_OUT=3]="EASE_OUT",e[e.EASE_IN_OUT=4]="EASE_IN_OUT",e[e.CUBIC=5]="CUBIC",e[e.SPRING=6]="SPRING"}(Kr||(Kr={}));var en=function(){function e(){Object(A.a)(this,e),this.easing=Kr.EASE_IN_OUT,this.duration=1e3,this.delay=0,this.cubicControls=[.5,.05,.1,.3],this.springParameters={mass:1,stiffness:80,damping:10,velocity:0},this.repeat=!1,this.cycle=!1,this.rewind=!1}return Object(w.a)(e,[{key:"sp_mass",get:function(){return this.springParameters.mass},set:function(e){this.springParameters.mass=e}},{key:"sp_stiffness",get:function(){return this.springParameters.stiffness},set:function(e){this.springParameters.stiffness=e}},{key:"sp_damping",get:function(){return this.springParameters.damping},set:function(e){this.springParameters.damping=e}},{key:"sp_velocity",get:function(){return this.springParameters.velocity},set:function(e){this.springParameters.velocity=e}},{key:"copy",value:function(e){return this.easing=e.easing,this.duration=e.duration,this.delay=e.delay,this.cubicControls=Object(y.a)(e.cubicControls),this.springParameters=Object.assign({},e.springParameters),this.repeat=e.repeat,this.cycle=e.cycle,this.rewind=e.rewind,this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"toJSON",value:function(){var e={easing:this.easing,duration:this.duration,delay:this.delay,cubicControls:this.cubicControls,springParameters:Object.assign({},this.springParameters)};return!0===this.repeat&&(e.repeat=!0),!0===this.cycle&&(e.cycle=!0),!0===this.rewind&&(e.rewind=!0),void 0!==this.object&&(e.object=this.object.uuid),void 0!==this.state&&(e.state=this.state.uuid),e}},{key:"fromJSON",value:function(e,t,r){return this.easing=e.easing,this.duration=e.duration,this.delay=e.delay,this.cubicControls=Object(y.a)(e.cubicControls),this.springParameters.mass=e.springParameters.mass,this.springParameters.stiffness=e.springParameters.stiffness,this.springParameters.damping=e.springParameters.damping,this.springParameters.velocity=e.springParameters.velocity,void 0!==e.repeat&&(this.repeat=e.repeat),void 0!==e.cycle&&(this.cycle=e.cycle),void 0!==e.rewind&&(this.rewind=e.rewind),void 0!==e.object&&(this.object=t[e.object]),void 0!==e.state&&(this.state=r[e.state]),this}}]),e}();!function(e){e[e.MOUSE_DOWN=0]="MOUSE_DOWN",e[e.MOUSE_UP=1]="MOUSE_UP",e[e.MOUSE_HOVER=2]="MOUSE_HOVER",e[e.MOUSE_ENTER=3]="MOUSE_ENTER",e[e.MOUSE_LEAVE=4]="MOUSE_LEAVE",e[e.KEY_DOWN=5]="KEY_DOWN",e[e.KEY_UP=6]="KEY_UP",e[e.START=7]="START",e[e.OPEN_LINK=8]="OPEN_LINK",e[e.LOOK_AT=9]="LOOK_AT",e[e.FOLLOW=10]="FOLLOW"}(qr||(qr={}));var tn=function(){function e(t,r){Object(A.a)(this,e),this.targets=[],this.ui={isCollapsed:!1},this._type=t,this.key=r}return Object(w.a)(e,[{key:"type",get:function(){return this._type},set:function(e){this._type=e,e===qr.LOOK_AT?this.distance=1e3:this.distance=void 0,e!==qr.KEY_DOWN&&e!==qr.KEY_UP&&(this.key=void 0)}},{key:"newTarget",value:function(e){var t=new en;if(t.object=e,void 0!==e){var r=e.interaction.states;r.length>0&&(t.state=r[r.length-1])}return this.targets.push(t),$r.add(t),t}},{key:"addTarget",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.targets.splice(t,0,e),$r.add(e)}},{key:"removeTarget",value:function(e){$r.delete(this.targets[e]),this.targets.splice(e,1)}},{key:"dispatchReverse",value:function(){for(var e=0,t=this.targets.length;e<t;++e){var r=this.targets[e];void 0!==r.state&&void 0!==r.object&&r.object.interaction.reverse(r)}}},{key:"dispatch",value:function(){if(void 0===this.url||this._type!==qr.OPEN_LINK&&this._type!==qr.MOUSE_DOWN&&this._type!==qr.MOUSE_UP&&this._type!==qr.KEY_DOWN&&this._type!==qr.KEY_UP)for(var e=0,t=this.targets.length;e<t;++e){var r=this.targets[e];void 0!==r.state&&void 0!==r.object&&r.object.interaction.play(r)}else["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document?window.location.assign(this.url):window.open(this.url,"_blank")}},{key:"copy",value:function(e){return this._type=e.type,this.key=e.key,this.url=e.url,this.distance=e.distance,this.ui.isCollapsed=e.ui.isCollapsed,this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"toJSON",value:function(){var e={type:this._type,key:this.key,ui:{isCollapsed:this.ui.isCollapsed}};if(void 0!==this.url&&(e.url=this.url),void 0!==this.distance&&(e.distance=this.distance),this.targets.length>0){e.targets=[];for(var t=0,r=this.targets.length;t<r;++t)e.targets.push(this.targets[t].toJSON())}return e}},{key:"fromJSON",value:function(e,t,r){if(this._type=e.type,this.key=e.key,this.targets=[],this.ui={isCollapsed:e.ui.isCollapsed},this.url=e.url,void 0!==e.distance&&(this.distance=e.distance),void 0!==e.targets)for(var n=0,o=e.targets.length;n<o;++n)this.addTarget((new en).fromJSON(e.targets[n],t,r),n);return this}}]),e}(),rn=function(){function e(){Object(A.a)(this,e),this.uuid=r.MathUtils.generateUUID(),this.name="",this.position=new r.Vector3,this.rotation=new r.Euler,this.scale=new r.Vector3,this.hiddenMatrix=new r.Matrix4}return Object(w.a)(e,[{key:"update",value:function(e){this.updateMatrix(e),"geometry"in e&&this.updateGeometry(e),"material"in e&&this.updateMaterial(e),"CombinedCamera"===e.objectType&&this.updateCamera(e)}},{key:"updateCamera",value:function(e){this.camera={zoomPersp:e.perspCamera.zoom,zoomOrtho:e.orthoCamera.zoom}}},{key:"updateMatrix",value:function(e){this.position.copy(e.position),this.rotation.copy(e.rotation),this.scale.copy(e.scale),"hiddenMatrix"in e&&this.hiddenMatrix.copy(e.hiddenMatrix)}},{key:"updateGeometry",value:function(e){if("geometry"in e){var t=e.geometry.userData.parameters,r=t.width,n=t.height,o=t.depth;this.geometry={width:r,height:n,depth:o}}}},{key:"updateMaterial",value:function(e){if("material"in e)if(e.material instanceof Array){this.material=[];for(var t=0,r=e.material.length;t<r;++t){for(var n=[],o=e.material[t].layersList.head;o;)n.push(o.clone()),o=o.next;this.material.push({layersList:n})}}else{for(var l=[],c=e.material.layersList.head;c;)l.push(c.clone()),c=c.next;this.material={layersList:l}}}},{key:"execute",value:function(e){if(e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale),"hiddenMatrix"in e&&e.hiddenMatrix.copy(this.hiddenMatrix),"geometry"in e&&void 0!==this.geometry){var t=e.geometry.userData.parameters,r=this.geometry;r.width===t.width&&r.height===t.height&&r.depth===t.depth||e.updateGeometry({parameters:{width:r.width,height:r.height,depth:r.depth}})}if("material"in e){var n=e.material;if(n instanceof Array)for(var o=this.material,l=0,c=o.length;l<c;++l){for(var h=n[l].layersList.head,d=o[l].layersList,f=0;h;)h.copy(d[f++]),h=h.next;n[l].dispose()}else{if(n.userData.isAsset)return;for(var v=0,m=n.layersList.head,y=this.material.layersList;m;)m.copyUniforms(y[v++]),m=m.next;n.dispose()}}this.camera&&"CombinedCamera"===e.objectType&&(e.zoom="OrthographicCamera"===e.cameraType?this.camera.zoomOrtho:this.camera.zoomPersp,e.updateProjectionMatrix())}},{key:"copy",value:function(e){if(this.name=e.name,this.position.copy(e.position),this.rotation.copy(e.rotation),this.scale.copy(e.scale),this.hiddenMatrix.copy(e.hiddenMatrix),void 0!==e.geometry&&(this.geometry={width:e.geometry.width,height:e.geometry.height,depth:e.geometry.depth}),void 0!==e.material)if(e.material instanceof Array){this.material=[];for(var t=0,r=e.material.length;t<r;++t)this.material.push({layersList:e.material[t].layersList.map((function(e){return e.clone()}))})}else this.material={layersList:e.material.layersList.map((function(e){return e.clone()}))};return void 0!==e.camera&&(this.camera={zoomPersp:e.camera.zoomPersp,zoomOrtho:e.camera.zoomOrtho}),this}},{key:"clone",value:function(){return(new e).copy(this)}},{key:"toJSON",value:function(e){var t={uuid:this.uuid,name:this.name,position:this.position.toArray(),rotation:this.rotation.toArray(),scale:this.scale.toArray(),hiddenMatrix:this.hiddenMatrix.toArray()};if(void 0!==this.geometry&&(t.geometry={width:this.geometry.width,height:this.geometry.height,depth:this.geometry.depth}),void 0!==this.material)if(this.material instanceof Array){t.material=[];for(var r=0,n=this.material.length;r<n;++r)t.material.push({layersList:this.material[r].layersList.map((function(t){return t.toJSON(e)}))})}else t.material={layersList:this.material.layersList.map((function(t){return t.toJSON(e)}))};return void 0!==this.camera&&(t.camera={zoomPersp:this.camera.zoomPersp,zoomOrtho:this.camera.zoomOrtho}),t}},{key:"fromJSON",value:function(e,t){if(this.uuid=e.uuid,this.name=e.name,this.position.fromArray(e.position),this.rotation.fromArray(e.rotation),this.scale.fromArray(e.scale),this.hiddenMatrix.fromArray(e.hiddenMatrix),void 0!==e.geometry&&(this.geometry={width:e.geometry.width,height:e.geometry.height,depth:e.geometry.depth}),void 0!==e.material)if(e.material instanceof Array){this.material=[];for(var r=0,n=e.material.length;r<n;++r)this.material.push({layersList:e.material[r].layersList.map((function(e){return Et(e,t)}))})}else this.material={layersList:e.material.layersList.map((function(e){return Et(e,t)}))};return void 0!==e.camera&&(this.camera={zoomPersp:e.camera.zoomPersp,zoomOrtho:e.camera.zoomOrtho}),this}}]),e}(),nn={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0,rewind:!0},an={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},on=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective","matrix","matrix3d"],sn={CSS:{},springs:{}};function un(e,t,r){return Math.min(Math.max(e,t),r)}function ln(e,t){return e.indexOf(t)>-1}function cn(e,t){return e.apply(null,t)}var hn={arr:function(e){return Array.isArray(e)},obj:function(e){return ln(Object.prototype.toString.call(e),"Object")},pth:function(e){return hn.obj(e)&&e.hasOwnProperty("totalLength")},svg:function(e){return e instanceof SVGElement},inp:function(e){return e instanceof HTMLInputElement},dom:function(e){return!("isNode"in e)&&(e.nodeType||hn.svg(e))},str:function(e){return"string"==typeof e},fnc:function(e){return"function"==typeof e},und:function(e){return void 0===e},hex:function(e){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(e)},rgb:function(e){return/^rgb/.test(e)},hsl:function(e){return/^hsl/.test(e)},col:function(e){return hn.hex(e)||hn.rgb(e)||hn.hsl(e)},key:function(e){return!nn.hasOwnProperty(e)&&!an.hasOwnProperty(e)&&"targets"!==e&&"keyframes"!==e}};function dn(e){var t=/\(([^)]+)\)/.exec(e);return t?t[1].split(",").map((function(e){return parseFloat(e)})):[]}function fn(e,t){var r=dn(e),i=un(hn.und(r[0])?1:r[0],.1,100),n=un(hn.und(r[1])?100:r[1],.1,100),s=un(hn.und(r[2])?10:r[2],.1,100),o=un(hn.und(r[3])?0:r[3],.1,100),a=Math.sqrt(n/i),l=s/(2*Math.sqrt(n*i)),c=l<1?a*Math.sqrt(1-l*l):0,h=l<1?(l*a-o)/c:-o+a;function u(e){var r=t?t*e/1e3:e;return r=l<1?Math.exp(-r*l*a)*(1*Math.cos(c*r)+h*Math.sin(c*r)):(1+h*r)*Math.exp(-r*a),0===e||1===e?e:1-r}return t?u:function(){var t=sn.springs[e];if(t)return t;for(var r=1/6,i=0,n=0;;)if(1===u(i+=r)){if(++n>=16)break}else n=0;var s=i*r*1e3;return sn.springs[e]=s,s}}function vn(e){return void 0===e&&(e=10),function(t){return Math.ceil(un(t,1e-6,1)*e)*(1/e)}}var pn,mn,gn=function(){var e=.1;function t(e,t){return 1-3*t+3*e}function r(e,t){return 3*t-6*e}function i(e){return 3*e}function n(e,n,s){return((t(n,s)*e+r(n,s))*e+i(n))*e}function s(e,n,s){return 3*t(n,s)*e*e+2*r(n,s)*e+i(n)}return function(t,r,i,o){if(0<=t&&t<=1&&0<=i&&i<=1){var a=new Float32Array(11);if(t!==r||i!==o)for(var l=0;l<11;++l)a[l]=n(l*e,t,i);return function(e){return t===r&&i===o||0===e||1===e?e:n(c(e),r,o)}}function c(r){for(var o=0,l=1;10!==l&&a[l]<=r;++l)o+=e;--l;var c=o+(r-a[l])/(a[l+1]-a[l])*e,h=s(c,t,i);return h>=.001?function(e,t,r,i){for(var o=0;o<4;++o){var a=s(t,r,i);if(0===a)return t;t-=(n(t,r,i)-e)/a}return t}(r,c,t,i):0===h?c:function(e,t,r,i,s){var o,a,l=0;do{(o=n(a=t+(r-t)/2,i,s)-e)>0?r=a:t=a}while(Math.abs(o)>1e-7&&++l<10);return a}(r,o,o+e,t,i)}}}(),yn=(pn={linear:function(){return function(e){return e}}},mn={Sine:function(){return function(e){return 1-Math.cos(e*Math.PI/2)}},Circ:function(){return function(e){return 1-Math.sqrt(1-e*e)}},Back:function(){return function(e){return e*e*(3*e-2)}},Bounce:function(){return function(e){for(var t,r=4;e<((t=Math.pow(2,--r))-1)/11;);return 1/Math.pow(4,3-r)-7.5625*Math.pow((3*t-2)/22-e,2)}},Elastic:function(e,t){void 0===e&&(e=1),void 0===t&&(t=.5);var r=un(e,1,10),i=un(t,.1,2);return function(e){return 0===e||1===e?e:-r*Math.pow(2,10*(e-1))*Math.sin((e-1-i/(2*Math.PI)*Math.asin(1/r))*(2*Math.PI)/i)}}},["Quad","Cubic","Quart","Quint","Expo"].forEach((function(e,t){mn[e]=function(){return function(e){return Math.pow(e,t+2)}}})),Object.keys(mn).forEach((function(e){var t=mn[e];pn["easeIn"+e]=t,pn["easeOut"+e]=function(e,r){return function(i){return 1-t(e,r)(1-i)}},pn["easeInOut"+e]=function(e,r){return function(i){return i<.5?t(e,r)(2*i)/2:1-t(e,r)(-2*i+2)/2}}})),pn);function An(e,t){if(hn.fnc(e))return e;var r=e.split("(")[0],i=yn[r],n=dn(e);switch(r){case"spring":return fn(e,t);case"cubicBezier":return cn(gn,n);case"steps":return cn(vn,n);default:return cn(i,n)}}function bn(e){try{return document.querySelectorAll(e)}catch(e){return}}function wn(e,t){for(var r=e.length,i=arguments.length>=2?arguments[1]:void 0,n=[],s=0;s<r;s++)if(s in e){var o=e[s];t.call(i,o,s,e)&&n.push(o)}return n}function xn(e){return e.reduce((function(e,t){return e.concat(hn.arr(t)?xn(t):t)}),[])}function On(e){return hn.arr(e)?e:(hn.str(e)&&(e=bn(e)||e),e instanceof NodeList||e instanceof HTMLCollection?[].slice.call(e):[e])}function li(e,t){return e.some((function(e){return e===t}))}function En(e){var t={};for(var r in e)t[r]=e[r];return t}function Cn(e,t){var r=En(e);for(var i in e)r[i]=t.hasOwnProperty(i)?t[i]:e[i];return r}function Dn(e,t){var r=En(e);for(var i in t)r[i]=hn.und(e[i])?t[i]:e[i];return r}function Sn(e){var t=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(e);if(t)return t[1]}function Bn(e,t){return hn.fnc(e)?e(t.target,t.id,t.total):e}function Tn(e,t){return e.getAttribute(t)}function kn(e,t,r){if(li([r,"deg","rad","turn"],Sn(t)))return t;var i=sn.CSS[t+r];if(!hn.und(i))return i;var n=document.createElement(e.tagName),s=e.parentNode&&e.parentNode!==document?e.parentNode:document.body;s.appendChild(n),n.style.position="absolute",n.style.width=100+r;var o=100/n.offsetWidth;s.removeChild(n);var a=o*parseFloat(t);return sn.CSS[t+r]=a,a}function _n(e,t,r){if(t in e.style){var i=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),n=e.style[t]||getComputedStyle(e).getPropertyValue(i)||"0";return r?kn(e,n,r):n}}function Mn(e,t){return hn.dom(e)&&!hn.inp(e)&&(Tn(e,t)||hn.svg(e)&&e[t])?"attribute":hn.dom(e)&&li(on,t)?"transform":hn.dom(e)&&"transform"!==t&&_n(e,t)?"css":null!=e[t]?"object":void 0}function Ln(e){if(hn.dom(e)){for(var t,r=e.style.transform||"",i=/(\w+)\(([^)]*)\)/g,n=new Map;t=i.exec(r);)n.set(t[1],t[2]);return n}}function Nn(e,t,r,i){switch(Mn(e,t)){case"transform":return function(e,t,r,i){var n=ln(t,"scale")?1:0+function(e){return ln(e,"translate")||"perspective"===e?"px":ln(e,"rotate")||ln(e,"skew")?"deg":void 0}(t),s=Ln(e).get(t)||n;return r&&(r.transforms.list.set(t,s),r.transforms.last=t),i?kn(e,s,i):s}(e,t,i,r);case"css":return _n(e,t,r);case"attribute":return Tn(e,t);default:return e[t]||0}}function Fn(e,t){var r=/^(\*=|\+=|-=)/.exec(e);if(!r)return e;var i=Sn(e)||0,n=parseFloat(t),s=parseFloat(e.replace(r[0],""));switch(r[0][0]){case"+":return n+s+i;case"-":return n-s+i;case"*":return n*s+i}}function In(e,t){if(hn.col(e))return function(e){return hn.rgb(e)?(r=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(t=e))?"rgba("+r[1]+",1)":t:hn.hex(e)?function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,r,i){return t+t+r+r+i+i})),r=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return"rgba("+parseInt(r[1],16)+","+parseInt(r[2],16)+","+parseInt(r[3],16)+",1)"}(e):hn.hsl(e)?function(e){var t,r,i,n=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(e)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(e),s=parseInt(n[1],10)/360,o=parseInt(n[2],10)/100,a=parseInt(n[3],10)/100,l=n[4]||1;function c(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}if(0==o)t=r=i=a;else{var h=a<.5?a*(1+o):a+o-a*o,u=2*a-h;t=c(u,h,s+1/3),r=c(u,h,s),i=c(u,h,s-1/3)}return"rgba("+255*t+","+255*r+","+255*i+","+l+")"}(e):void 0;var t,r}(e);if(/\s/g.test(e))return e;var r=Sn(e),i=r?e.substr(0,e.length-r.length):e;return t?i+t:i}function jn(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function Pn(e){for(var t,r=e.points,i=0,n=0;n<r.numberOfItems;n++){var s=r.getItem(n);n>0&&(i+=jn(t,s)),t=s}return i}function Rn(e){if(e.getTotalLength)return e.getTotalLength();switch(e.tagName.toLowerCase()){case"circle":return function(e){return 2*Math.PI*Tn(e,"r")}(e);case"rect":return function(e){return 2*Tn(e,"width")+2*Tn(e,"height")}(e);case"line":return function(e){return jn({x:Tn(e,"x1"),y:Tn(e,"y1")},{x:Tn(e,"x2"),y:Tn(e,"y2")})}(e);case"polyline":return Pn(e);case"polygon":return function(e){var t=e.points;return Pn(e)+jn(t.getItem(t.numberOfItems-1),t.getItem(0))}(e)}}function zn(e,t){var r=t||{},i=r.el||function(e){for(var t=e.parentNode;hn.svg(t)&&hn.svg(t.parentNode);)t=t.parentNode;return t}(e),n=i.getBoundingClientRect(),s=Tn(i,"viewBox"),o=n.width,a=n.height,l=r.viewBox||(s?s.split(" "):[0,0,o,a]);return{el:i,viewBox:l,x:l[0]/1,y:l[1]/1,w:o/l[2],h:a/l[3]}}function Un(e,t){function r(r){void 0===r&&(r=0);var i=t+r>=1?t+r:0;return e.el.getPointAtLength(i)}var i=zn(e.el,e.svg),n=r(),s=r(-1),o=r(1);switch(e.property){case"x":return(n.x-i.x)*i.w;case"y":return(n.y-i.y)*i.h;case"angle":return 180*Math.atan2(o.y-s.y,o.x-s.x)/Math.PI}}function Gn(e,t){var r=/[+-]?\d*\.?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/g,i=In(hn.pth(e)?e.totalLength:e,t)+"";return{original:i,numbers:i.match(r)?i.match(r).map(Number):[0],strings:hn.str(e)||t?i.split(r):[]}}function Vn(e){return wn(e?xn(hn.arr(e)?e.map(On):On(e)):[],(function(e,t,r){return r.indexOf(e)===t}))}function Hn(e){var t=Vn(e);return t.map((function(e,r){return{target:e,id:r,total:t.length,transforms:{list:Ln(e)}}}))}function Jn(e,t){var r=En(t);if(/^spring/.test(r.easing)&&(r.duration=fn(r.easing)),hn.arr(e)){var i=e.length;2!==i||hn.obj(e[0])?hn.fnc(t.duration)||(r.duration=t.duration/i):e={value:e}}var n=hn.arr(e)?e:[e];return n.map((function(e,r){var i=hn.obj(e)&&!hn.pth(e)?e:{value:e};return hn.und(i.delay)&&(i.delay=r?0:t.delay),hn.und(i.endDelay)&&(i.endDelay=r===n.length-1?t.endDelay:0),i})).map((function(e){return Dn(e,r)}))}var Qn={css:function(e,t,r){return e.style[t]=r},attribute:function(e,t,r){return e.setAttribute(t,r)},object:function(e,t,r){return e[t]=r},transform:function(e,t,r,i,n){if(i.list.set(t,r),t===i.last||n){var s="";i.list.forEach((function(e,t){s+=t+"("+e+") "})),e.style.transform=s}}};function Yn(e,t){Hn(e).forEach((function(e){for(var r in t){var i=Bn(t[r],e),n=e.target,s=Sn(i),o=Nn(n,r,s,e),a=Fn(In(i,s||Sn(o)),o),l=Mn(n,r);Qn[l](n,r,a,e.transforms,!0)}}))}function Wn(e,t){return wn(xn(e.map((function(e){return t.map((function(t){return function(e,t){var r=Mn(e.target,t.name);if(r){var i=function(e,t){var r;return e.tweens.map((function(i){var n=function(e,t){var r={};for(var i in e){var n=Bn(e[i],t);hn.arr(n)&&1===(n=n.map((function(e){return Bn(e,t)}))).length&&(n=n[0]),r[i]=n}return r.duration=parseFloat(r.duration),r.delay=parseFloat(r.delay),r}(i,t),s=n.value,o=hn.arr(s)?s[1]:s,a=Sn(o),l=Nn(t.target,e.name,a,t),c=r?r.to.original:l,h=hn.arr(s)?s[0]:c,u=Sn(h)||Sn(l),d=a||u;return hn.und(o)&&(o=c),n.from=Gn(h,d),n.to=Gn(Fn(o,h),d),n.start=r?r.end:0,n.end=n.start+n.delay+n.duration+n.endDelay,n.easing=An(n.easing,n.duration),n.isPath=hn.pth(s),n.isColor=hn.col(n.from.original),n.isColor&&(n.round=1),r=n,n}))}(t,e),n=i[i.length-1];return{type:r,property:t.name,animatable:e,tweens:i,duration:n.end,delay:i[0].delay,endDelay:n.endDelay}}}(e,t)}))}))),(function(e){return!hn.und(e)}))}function Xn(e,t){var r=e.length,i=function(e){return e.timelineOffset?e.timelineOffset:0},n={};return n.duration=r?Math.max.apply(Math,e.map((function(e){return i(e)+e.duration}))):t.duration,n.delay=r?Math.min.apply(Math,e.map((function(e){return i(e)+e.delay}))):t.delay,n.endDelay=r?n.duration-Math.max.apply(Math,e.map((function(e){return i(e)+e.duration-e.endDelay}))):t.endDelay,n}var Kn,qn=0,Zn=[],$n=[],ei=function(){function e(){Kn=requestAnimationFrame(t)}function t(t){var r=Zn.length;if(r){for(var i=0;i<r;){var n=Zn[i];if(n.paused){var s=Zn.indexOf(n);s>-1&&(Zn.splice(s,1),r=Zn.length)}else n.tick(t);i++}e()}else Kn=cancelAnimationFrame(Kn)}return e}();function ti(e){void 0===e&&(e={});var t,r=0,i=0,n=0,s=0,o=null;function a(e){var t=window.Promise&&new Promise((function(e){return o=e}));return e.finished=t,t}var l=function(e){var t=Cn(nn,e),r=Cn(an,e),i=function(e,t){var r=[],i=t.keyframes;for(var n in i&&(t=Dn(function(e){for(var t=wn(xn(e.map((function(e){return Object.keys(e)}))),(function(e){return hn.key(e)})).reduce((function(e,t){return e.indexOf(t)<0&&e.push(t),e}),[]),r={},i=function(n){var o=t[n];r[o]=e.map((function(e){var t={};for(var r in e)hn.key(r)?r==o&&(t.value=e[r]):t[r]=e[r];return t}))},n=0;n<t.length;n++)i(n);return r}(i),t)),t)hn.key(n)&&r.push({name:n,tweens:Jn(t[n],e)});return r}(r,e),n=Hn(e.targets),s=Wn(n,i),o=Xn(s,r),a=qn;return qn++,Dn(t,{id:a,children:[],animatables:n,animations:s,duration:o.duration,delay:o.delay,endDelay:o.endDelay})}(e);function c(){var e=l.direction;"alternate"!==e&&(l.direction="normal"!==e?"normal":"reverse"),l.reversed=!l.reversed,t.forEach((function(e){return e.reversed=l.reversed}))}function h(e){return l.reversed?l.duration-e:e}function u(){r=0,i=h(l.currentTime)*(1/ti.speed)}function d(e,t){t&&t.seek(e-t.timelineOffset)}function p(e){var t=0,r=l.animations,i=r.length;for(!0===l.reversePlayback&&!1===l.rewind&&(e=l.duration-e);t<i;){var n=r[t],s=n.animatable,o=n.tweens,a=o.length-1,c=o[a];a&&(c=wn(o,(function(t){return e<t.end}))[0]||c);for(var h=un(e-c.start-c.delay,0,c.duration)/c.duration,u=isNaN(h)?1:c.easing(h),d=c.to.strings,p=c.round,f=[],v=c.to.numbers.length,g=void 0,m=0;m<v;m++){var y=void 0;if(!0===l.reversePlayback&&!1===l.rewind)var A=c.to.numbers[m],w=c.from.numbers[m]||0;else w=c.to.numbers[m],A=c.from.numbers[m]||0;y=c.isPath?Un(c.value,u*w):A+u*(w-A),p&&(c.isColor&&m>2||(y=Math.round(y*p)/p)),f.push(y)}var x=d.length;if(x){g=d[0];for(var b=0;b<x;b++){d[b];var O=d[b+1],E=f[b];isNaN(E)||(g+=O?E+O:E+" ")}}else g=f[0];Qn[n.type](s.target,n.property,g,s.transforms),n.currentValue=g,t++}}function f(e){l[e]&&!l.passThrough&&l[e](l)}function v(e){var u=l.duration,v=l.delay,g=u-l.endDelay,m=h(e);l.progress=un(m/u*100,0,100),l.reversePlayback=m<l.currentTime,t&&function(e){if(l.reversePlayback)for(var r=s;r--;)d(e,t[r]);else for(var i=0;i<s;i++)d(e,t[i])}(m),!l.began&&l.currentTime>0&&(l.began=!0,f("begin")),!l.loopBegan&&l.currentTime>0&&(l.loopBegan=!0,f("loopBegin")),m<=v&&0!==l.currentTime&&p(0),(m>=g&&l.currentTime!==u||!u)&&p(u),m>v&&m<g?(l.changeBegan||(l.changeBegan=!0,l.changeCompleted=!1,f("changeBegin")),f("change"),p(m)):l.changeBegan&&(l.changeCompleted=!0,l.changeBegan=!1,f("changeComplete")),l.currentTime=un(m,0,u),l.began&&f("update"),e>=u&&(i=0,l.remaining&&!0!==l.remaining&&l.remaining--,l.remaining?(r=n,f("loopComplete"),l.loopBegan=!1,"alternate"===l.direction&&c()):(l.paused=!0,l.completed||(l.completed=!0,f("loopComplete"),f("complete"),!l.passThrough&&"Promise"in window&&(o(),a(l)))))}return a(l),l.reset=function(){var e=l.direction;l.passThrough=!1,l.currentTime=0,l.progress=0,l.paused=!0,l.began=!1,l.loopBegan=!1,l.changeBegan=!1,l.completed=!1,l.changeCompleted=!1,l.reversePlayback=!1,l.reversed="reverse"===e,l.remaining=l.loop,t=l.children;for(var r=s=t.length;r--;)l.children[r].reset();(l.reversed&&!0!==l.loop||"alternate"===e&&1===l.loop)&&l.remaining++,p(l.reversed?l.duration:0)},l.set=function(e,t){return Yn(e,t),l},l.tick=function(e){n=e,r||(r=n),v((n+(i-r))*ti.speed)},l.seek=function(e){v(h(e))},l.pause=function(){l.paused=!0,u()},l.play=function(){l.paused&&(l.completed&&l.reset(),l.paused=!1,Zn.push(l),u(),Kn||ei())},l.reverse=function(){c(),l.completed=!l.reversed,u()},l.restart=function(){l.reset(),l.play()},l.reset(),l.autoplay&&l.play(),l}function ri(e,t){for(var r=t.length;r--;)li(e,t[r].animatable.target)&&t.splice(r,1)}"undefined"!=typeof document&&document.addEventListener("visibilitychange",(function(){document.hidden?(Zn.forEach((function(e){return e.pause()})),$n=Zn.slice(0),ti.running=Zn=[]):$n.forEach((function(e){return e.play()}))})),ti.version="3.2.0",ti.speed=1,ti.running=Zn,ti.remove=function(e){for(var t=Vn(e),r=Zn.length;r--;){var i=Zn[r],n=i.animations,s=i.children;ri(t,n);for(var o=s.length;o--;){var a=s[o],l=a.animations;ri(t,l),l.length||a.children.length||s.splice(o,1)}n.length||s.length||i.pause()}},ti.get=Nn,ti.set=Yn,ti.convertPx=kn,ti.path=function(e,t){var r=hn.str(e)?bn(e)[0]:e,i=t||100;return function(e){return{property:e,el:r,svg:zn(r),totalLength:Rn(r)*(i/100)}}},ti.setDashoffset=function(e){var t=Rn(e);return e.setAttribute("stroke-dasharray",t),t},ti.stagger=function(e,t){void 0===t&&(t={});var r=t.direction||"normal",i=t.easing?An(t.easing):null,n=t.grid,s=t.axis,o=t.from||0,a="first"===o,l="center"===o,c="last"===o,h=hn.arr(e),u=h?parseFloat(e[0]):parseFloat(e),d=h?parseFloat(e[1]):0,p=Sn(h?e[1]:e)||0,f=t.start||0+(h?u:0),v=[],g=0;return function(e,t,m){if(a&&(o=0),l&&(o=(m-1)/2),c&&(o=m-1),!v.length){for(var y=0;y<m;y++){if(n){var A=l?(n[0]-1)/2:o%n[0],w=l?(n[1]-1)/2:Math.floor(o/n[0]),x=A-y%n[0],b=w-Math.floor(y/n[0]),O=Math.sqrt(x*x+b*b);"x"===s&&(O=-x),"y"===s&&(O=-b),v.push(O)}else v.push(Math.abs(o-y));g=Math.max.apply(Math,v)}i&&(v=v.map((function(e){return i(e/g)*g}))),"reverse"===r&&(v=v.map((function(e){return s?e<0?-1*e:-e:Math.abs(g-e)})))}return f+(h?(d-u)/g:u)*(Math.round(100*v[t])/100)+p}},ti.timeline=function(e){void 0===e&&(e={});var t=ti(e);return t.duration=0,t.add=function(r,i){var n=Zn.indexOf(t),s=t.children;function o(e){e.passThrough=!0}n>-1&&Zn.splice(n,1);for(var a=0;a<s.length;a++)o(s[a]);var l=Dn(r,Cn(an,e));l.targets=l.targets||e.targets;var c=t.duration;l.autoplay=!1,l.direction=t.direction,l.timelineOffset=hn.und(i)?c:Fn(i,c),o(t),l.rewind=t.rewind,t.seek(l.timelineOffset);var h=ti(l);o(h),s.push(h);var u=Xn(s,e);return t.delay=u.delay,t.endDelay=u.endDelay,t.duration=u.duration,t.seek(0),t.reset(),t.autoplay&&t.play(),t},t},ti.easing=An,ti.penner=yn,ti.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e};var ni=function(){function e(t){Object(A.a)(this,e),this.i=t}return Object(w.a)(e,[{key:"updateObject",value:function(){void 0!==this.i.selectedState&&this.i.states[this.i.selectedState].updateMatrix(this.i.object)}},{key:"updateCamera",value:function(){void 0!==this.i.selectedState&&"CombinedCamera"===this.i.object.objectType&&(this.i.states[this.i.selectedState].updateMatrix(this.i.object),this.i.states[this.i.selectedState].updateCamera(this.i.object))}},{key:"updateGeometry",value:function(){void 0!==this.i.selectedState&&!1!==mt(this.i.object)&&(this.i.states[this.i.selectedState].updateMatrix(this.i.object),this.i.states[this.i.selectedState].updateGeometry(this.i.object))}},{key:"updateSceneGraph",value:function(e,t){var i=new r.Matrix4,n=new r.Matrix4;e.updateWorldMatrix(!0,!1),n.copy(e.matrixWorld).invert();for(var o=0,l=this.i.states.length;o<l;++o){var c=this.i.states[o];i.copy(n),null!==this.i.object.parent&&(this.i.object.parent.updateWorldMatrix(!0,!1),i.multiply(this.i.object.parent.matrixWorld)),c.hiddenMatrix.premultiply(i)}}},{key:"updateMaterialLayer",value:function(e){if(void 0!==this.i.selectedState&&!1!==mt(this.i.object)){var t=this.i.object.selectedMaterial,r=this.i.states[this.i.selectedState],i=(void 0!==t?r.material[t]:r.material).layersList.find((function(t){return t.id===e.id}));null==i||i.copy(e)}}},{key:"pushMaterialLayer",value:function(e){if(0!==this.i.states.length&&!1!==mt(this.i.object)){var t=this.i.object;if(t.material instanceof Array){var r=t.selectedMaterial;if(void 0!==r)for(var n=0,o=this.i.states.length;n<o;++n){var l=e.clone();this.i.selectedState!==n&&(l.uniforms["f".concat(l.id,"_alpha")].value=0),this.i.states[n].material[r].layersList.push(l)}}else for(var c=0,h=this.i.states.length;c<h;++c){var d=e.clone();this.i.selectedState!==c&&(d.uniforms["f".concat(d.id,"_alpha")].value=0),this.i.states[c].material.layersList.push(d)}}}},{key:"popMaterialLayer",value:function(){if(0!==this.i.states.length&&!1!==mt(this.i.object)){var e=this.i.object;if(e.material instanceof Array){var t=e.selectedMaterial;if(void 0!==t)for(var r=0,n=this.i.states.length;r<n;++r)this.i.states[r].material[t].layersList.pop()}else for(var o=0,l=this.i.states.length;o<l;++o)this.i.states[o].material.layersList.pop()}}},{key:"removeMaterialLayer",value:function(e){if(0===this.i.states.length||!1===mt(this.i.object))return null;var t=this.i.object,r=[];if(t.material instanceof Array)for(var n=0,o=this.i.states.length;n<o;++n){var l=t.selectedMaterial;if(void 0!==l){var c=this.i.states[n].material[l];r.push({layer:c.layersList[e]}),c.layersList.splice(e,1)}}else for(var h=0,d=this.i.states.length;h<d;++h){var f=this.i.states[h].material;r.push({layer:f.layersList[e]}),f.layersList.splice(e,1)}return{states:r,pos:e}}},{key:"restoreMaterialLayerRemoved",value:function(e){if(0!==this.i.states.length&&!1!==mt(this.i.object)){var t=this.i.object;if(t.material instanceof Array)for(var r=0,n=this.i.states.length;r<n;++r){var o=t.selectedMaterial;void 0!==o&&this.i.states[r].material[o].layersList.splice(e.pos,0,e.states[r].layer)}else for(var l=0,c=this.i.states.length;l<c;++l)this.i.states[l].material.layersList.splice(e.pos,0,e.states[l].layer)}}},{key:"changeMaterialLayer",value:function(e){if(0===this.i.states.length||!1===mt(this.i.object))return null;var t=this.i.object,r=[],i=0;if(t.material instanceof Array){var n=t.selectedMaterial;if(void 0!==n){for(var o=this.i.states[Number(this.i.selectedState)].material[n].layersList,l=0,c=o.length;l<c;++l)if(o[l].id===e.id){i=l;break}for(var h=0,d=this.i.states.length;h<d;++h){var f=this.i.states[h].material[n].layersList[i],v=e.clone();this.i.selectedState!==h&&(v.uniforms["f".concat(v.id,"_alpha")].value=Number(f.uniforms["f".concat(f.id,"_alpha")].value)),this.i.states[h].material[n].layersList[i]=v,r.push({layer:f})}}}else{for(var m=this.i.states[Number(this.i.selectedState)].material.layersList,y=0,A=m.length;y<A;++y)if(m[y].id===e.id){i=y;break}for(var w=0,x=this.i.states.length;w<x;++w){var O=this.i.states[w].material.layersList[i],E=e.clone();this.i.selectedState!==w&&(E.uniforms["f".concat(E.id,"_alpha")].value=Number(O.uniforms["f".concat(O.id,"_alpha")].value)),this.i.states[w].material.layersList[i]=E,r.push({layer:O})}}return{states:r,pos:i}}},{key:"restoreMaterialLayerChanged",value:function(e){if(0!==this.i.states.length&&!1!==mt(this.i.object)){var t=this.i.object;if(t.material instanceof Array){var r=t.selectedMaterial;if(void 0!==r)for(var n=0,o=this.i.states.length;n<o;++n)this.i.states[n].material[r].layersList[e.pos]=e.states[n].layer}else for(var l=0,c=this.i.states.length;l<c;++l)this.i.states[l].material.layersList[e.pos]=e.states[l].layer}}},{key:"moveMaterialLayer",value:function(e,t){if(0!==this.i.states.length&&!1!==mt(this.i.object)){var r=this.i.object;if(r.material instanceof Array){var n=r.selectedMaterial;if(void 0!==n)for(var o=0,l=this.i.states.length;o<l;++o){var c=this.i.states[o].material[n].layersList,h=c[e];c[e]=c[t],c[t]=h}}else for(var d=0,f=this.i.states.length;d<f;++d){var v=this.i.states[d].material.layersList,m=v[e];v[e]=v[t],v[t]=m}}}},{key:"restoreMaterialLayerMoved",value:function(e,t){this.moveMaterialLayer(e,t)}},{key:"setMaterialLayers",value:function(e){var t=this.i.object,r=[];if(t.material instanceof Array){var n=t.selectedMaterial;if(void 0!==n)for(var o=0,l=this.i.states.length;o<l;++o){var c=this.i.states[o].material[n];r.push({layersList:c.layersList});var h=e.head;for(c.layersList=[];void 0!==h;)c.layersList.push(h.clone()),h=h.next}}else for(var d=0,f=this.i.states.length;d<f;++d){var v=this.i.states[d].material;r.push({layersList:v.layersList});var m=e.head;for(v.layersList=[];void 0!==m;)v.layersList.push(m.clone()),m=m.next}return{states:r}}},{key:"restoreMaterialLayersSet",value:function(e){var t=this.i.object;if(t.material instanceof Array){var r=t.selectedMaterial;if(void 0!==r)for(var n=0,o=this.i.states.length;n<o;++n)this.i.states[n].material[r].layersList=e.states[n].layersList}else for(var l=0,c=this.i.states.length;l<c;++l)this.i.states[l].material.layersList=e.states[l].layersList}}]),e}(),ii=function(){function e(){Object(A.a)(this,e),this.encoderPath="",this.encoderConfig={},this.encoderPending=null}var t;return Object(w.a)(e,[{key:"setEncoderPath",value:function(e){return this.encoderPath=e,this}},{key:"setEncoderConfig",value:function(e){return this.encoderConfig=e,this}},{key:"_loadLibrary",value:function(e,t){var i=new r.FileLoader;return i.setPath(this.encoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((function(t,r){i.load(e,t,void 0,r)}))}},{key:"_loadScript",value:function(e){var t=this;return new Promise((function(r,n){var i=document.createElement("script");i.onload=r,i.onerror=n,i.src=t.encoderPath+e,document.head.appendChild(i)}))}},{key:"preload",value:function(){var e=this;return this._initEncoder().then((function(){return e}))}},{key:"_initEncoder",value:function(){var e=this;if(this.encoderPending)return this.encoderPending;var t="object"!=("undefined"==typeof WebAssembly?"undefined":Object(d.a)(WebAssembly))||"js"===this.encoderConfig.type,r=[];return t?r.push(this._loadScript("draco_encoder.js")):(r.push(this._loadScript("draco_encoder_wrapper.js")),r.push(this._loadLibrary("draco_encoder.wasm","arraybuffer"))),this.encoderPending=Promise.all(r).then((function(r){t||(e.encoderConfig.wasmBinary=r[1])})),this.encoderPending}},{key:"parse",value:(t=Object(h.a)(regeneratorRuntime.mark((function t(r){var n,o,i,l,s,c,a,h,d,f,v,m,y,A,w,x,O,E,C,D,u,S,B,T=arguments;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=T.length>1&&void 0!==T[1]?T[1]:{decodeSpeed:5,encodeSpeed:5,encoderMethod:e.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1},!0!==r.isBufferGeometry){t.next=3;break}throw new Error("DRACOExporter: The first parameter of parse() is now an instance of Mesh or Points.");case 3:return t.next=5,this._initEncoder();case 5:if(void 0!==DracoEncoderModule){t.next=7;break}throw new Error("THREE.DRACOExporter: required the draco_encoder to work.");case 7:return o=r.geometry,t.next=10,DracoEncoderModule(this.encoderConfig);case 10:if(i=t.sent,l=new i.Encoder,a={},!0===o.isBufferGeometry){t.next=15;break}throw new Error("THREE.DRACOExporter.parse(geometry, options): geometry is not a THREE.BufferGeometry instance.");case 15:if(!0!==r.isMesh){t.next=26;break}if(s=new i.MeshBuilder,c=new i.Mesh,h=o.getAttribute("position"),a.POSITION=s.AddFloatAttributeToMesh(c,i.POSITION,h.count,h.itemSize,h.array),null!==(d=o.getIndex()))s.AddFacesToMesh(c,d.count/3,d.array);else{for(f=new(h.count>65535?Uint32Array:Uint16Array)(h.count),v=0;v<f.length;v++)f[v]=v;s.AddFacesToMesh(c,h.count,f)}!0===n.exportNormals&&void 0!==(m=o.getAttribute("normal"))&&(a.NORMAL=s.AddFloatAttributeToMesh(c,i.NORMAL,m.count,m.itemSize,m.array)),!0===n.exportUvs&&void 0!==(y=o.getAttribute("uv"))&&(a.TEXCOORD_0=s.AddFloatAttributeToMesh(c,i.TEX_COORD,y.count,y.itemSize,y.array)),!0===n.exportColor&&void 0!==(A=o.getAttribute("color"))&&(a.COLOR_0=s.AddFloatAttributeToMesh(c,i.COLOR,A.count,A.itemSize,A.array)),t.next=31;break;case 26:if(!0===r.isPoints){t.next=28;break}throw new Error("DRACOExporter: Unsupported object type: "+r.type);case 28:s=new i.PointCloudBuilder,c=new i.PointCloud,w=o.getAttribute("position"),s.AddFloatAttribute(c,i.POSITION,w.count,w.itemSize,w.array),!0===n.exportColor&&void 0!==(x=o.getAttribute("color"))&&s.AddFloatAttribute(c,i.COLOR,x.count,x.itemSize,x.array);case 31:if(O=new i.DracoInt8Array,E=void 0!==n.encodeSpeed?n.encodeSpeed:5,C=void 0!==n.decodeSpeed?n.decodeSpeed:5,l.SetSpeedOptions(E,C),void 0!==n.encoderMethod&&l.SetEncodingMethod(n.encoderMethod),void 0!==n.quantization)for(D=0;D<5;D++)void 0!==n.quantization[D]&&l.SetAttributeQuantization(D,n.quantization[D]);if(u=!0===r.isMesh?l.EncodeMeshToDracoBuffer(c,O):l.EncodePointCloudToDracoBuffer(c,!0,O),i.destroy(c),0!==u){t.next=35;break}throw new Error("THREE.DRACOExporter: Draco encoding failed.");case 35:for(S=new Int8Array(new ArrayBuffer(u)),B=0;B<u;B++)S[B]=O.GetValue(B);return t.abrupt("return",(i.destroy(O),i.destroy(l),i.destroy(s),{buffer:S,attributeIDs:a}));case 38:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})}]),e}();ii.MESH_EDGEBREAKER_ENCODING=1,ii.MESH_SEQUENTIAL_ENCODING=0,ii.POINT_CLOUD=0,ii.TRIANGULAR_MESH=1,ii.INVALID=-1,ii.POSITION=0,ii.NORMAL=1,ii.COLOR=2,ii.TEX_COORD=3,ii.GENERIC=4;var ai=function(){function e(){Object(A.a)(this,e),this.dracoExporter=null,this.pluginCallbacks=[],this.register((function(e){return new mi(e)})),this.register((function(e){return new gi(e)})),this.register((function(e){return new yi(e)}))}return Object(w.a)(e,[{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"setDRACOExporter",value:function(e){return this.dracoExporter=e,this}},{key:"parse",value:function(e,t,r){for(var i=new pi,n=[],o=0,l=this.pluginCallbacks.length;o<l;o++)n.push(this.pluginCallbacks[o](i));r&&r.draco&&(i.dracoExporter=this.dracoExporter),i.setPlugins(n),i.write(e,t,r)}}]),e}(),oi=5121,si=5123,ui={};ui[r.NearestFilter]=9728,ui[r.NearestMipmapNearestFilter]=9984,ui[r.NearestMipmapLinearFilter]=9986,ui[r.LinearFilter]=9729,ui[r.LinearMipmapNearestFilter]=9985,ui[r.LinearMipmapLinearFilter]=9987,ui[r.ClampToEdgeWrapping]=33071,ui[r.RepeatWrapping]=10497,ui[r.MirroredRepeatWrapping]=33648;var ci={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function hi(e,t){return e.length===t.length&&e.every((function(e,r){return e===t[r]}))}function di(e){return 4*Math.ceil(e/4)}function fi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=di(e.byteLength);if(r!==e.byteLength){var n=new Uint8Array(r);if(n.set(new Uint8Array(e)),0!==t)for(var o=e.byteLength;o<r;o++)n[o]=t;return n.buffer}return e}var vi=null,pi=function(){function e(){Object(A.a)(this,e),this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}var t,n,o,l,c,d;return Object(w.a)(e,[{key:"setPlugins",value:function(e){this.plugins=e}},{key:"write",value:(d=Object(h.a)(regeneratorRuntime.mark((function e(t,r,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.options=Object.assign({},{binary:!1,draco:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},n),this.options.animations.length>0&&(this.options.trs=!0),e.next=4,this.processInput(t);case 4:i=this,Promise.all(this.pending).then((function(){var e=i.buffers,t=i.json,n=i.options,s=i.extensionsUsed,o=new Blob(e,{type:"application/octet-stream"}),a=Object.keys(s);if(a.length>0&&(t.extensionsUsed=a),t.buffers&&t.buffers.length>0&&(t.buffers[0].byteLength=o.size),!0===n.binary){var l=new window.FileReader;l.readAsArrayBuffer(o),l.onloadend=function(){var i=fi(l.result),e=new DataView(new ArrayBuffer(8));e.setUint32(0,i.byteLength,!0),e.setUint32(4,5130562,!0);var s=fi(function(e){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(e).buffer;for(var t=new Uint8Array(new ArrayBuffer(e.length)),r=0,n=e.length;r<n;r++){var o=e.charCodeAt(r);t[r]=o>255?32:o}return t.buffer}(JSON.stringify(t)),32),n=new DataView(new ArrayBuffer(8));n.setUint32(0,s.byteLength,!0),n.setUint32(4,1313821514,!0);var a=new ArrayBuffer(12),o=new DataView(a);o.setUint32(0,1179937895,!0),o.setUint32(4,2,!0);var c=12+n.byteLength+s.byteLength+e.byteLength+i.byteLength;o.setUint32(8,c,!0);var h=new Blob([a,n,s,e,i],{type:"application/octet-stream"}),u=new window.FileReader;u.readAsArrayBuffer(h),u.onloadend=function(){r(u.result)}}}else if(t.buffers&&t.buffers.length>0){var c=new window.FileReader;c.readAsDataURL(o),c.onloadend=function(){var i=c.result;t.buffers[0].uri=i,r(t)}}else r(t)}));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return d.apply(this,arguments)})},{key:"serializeUserData",value:function(e,t){if(0!==Object.keys(e.userData).length){var r=this.options,i=this.extensionsUsed;try{var n=JSON.parse(JSON.stringify(e.userData));if(r.includeCustomExtensions&&n.gltfExtensions){for(var o in void 0===t.extensions&&(t.extensions={}),n.gltfExtensions)t.extensions[o]=n.gltfExtensions[o],i[o]=!0;delete n.gltfExtensions}Object.keys(n).length>0&&(t.extras=n)}catch(t){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+t.message)}}}},{key:"getUID",value:function(e){return this.uids.has(e)||this.uids.set(e,this.uid++),this.uids.get(e)}},{key:"isNormalizedNormalAttribute",value:function(e){if(this.cache.attributesNormalized.has(e))return!1;for(var t=new r.Vector3,n=0,o=e.count;n<o;n++)if(Math.abs(t.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}},{key:"createNormalizedNormalAttribute",value:function(e){var t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);for(var i=e.clone(),n=new r.Vector3,o=0,l=i.count;o<l;o++)n.fromBufferAttribute(i,o),0===n.x&&0===n.y&&0===n.z?n.setX(1):n.normalize(),i.setXYZ(o,n.x,n.y,n.z);return t.attributesNormalized.set(e,i),i}},{key:"applyTextureTransform",value:function(e,t){var r=!1,i={};0===t.offset.x&&0===t.offset.y||(i.offset=t.offset.toArray(),r=!0),0!==t.rotation&&(i.rotation=t.rotation,r=!0),1===t.repeat.x&&1===t.repeat.y||(i.scale=t.repeat.toArray(),r=!0),r&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=i,this.extensionsUsed.KHR_texture_transform=!0)}},{key:"processBuffer",value:function(e){var t=this.json,r=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),r.push(e),0}},{key:"processBufferView",value:function(e,t,r,i,n){var o,s=this.json;s.bufferViews||(s.bufferViews=[]),o=t===oi?1:t===si?2:4;for(var a=di(i*e.itemSize*o),l=new DataView(new ArrayBuffer(a)),c=0,h=r;h<r+i;h++)for(var d=0;d<e.itemSize;d++){var f=void 0;e.itemSize>4?f=e.array[h*e.itemSize+d]:0===d?f=e.getX(h):1===d?f=e.getY(h):2===d?f=e.getZ(h):3===d&&(f=e.getW(h)),5126===t?l.setFloat32(c,f,!0):5125===t?l.setUint32(c,f,!0):t===si?l.setUint16(c,f,!0):t===oi&&l.setUint8(c,f),c+=o}var v={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:a};return void 0!==n&&(v.target=n),34962===n&&(v.byteStride=e.itemSize*o),this.byteOffset+=a,s.bufferViews.push(v),{id:s.bufferViews.length-1,byteLength:0}}},{key:"processBufferViewImage",value:function(e){var t=this,r=t.json;return r.bufferViews||(r.bufferViews=[]),new Promise((function(i){var n=new window.FileReader;n.readAsArrayBuffer(e),n.onloadend=function(){var e=fi(n.result),s={buffer:t.processBuffer(e),byteOffset:t.byteOffset,byteLength:e.byteLength};t.byteOffset+=e.byteLength,i(r.bufferViews.push(s)-1)}}))}},{key:"processAccessor",value:function(e,t,r,i){var n,o=this.options,s=this.json;if(e.array.constructor===Float32Array)n=5126;else if(e.array.constructor===Uint32Array)n=5125;else if(e.array.constructor===Uint16Array)n=si;else{if(e.array.constructor!==Uint8Array)throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");n=oi}if(void 0===r&&(r=0),void 0===i&&(i=e.count),o.truncateDrawRange&&void 0!==t&&null===t.index){var l=r+i,c=t.drawRange.count===1/0?e.count:t.drawRange.start+t.drawRange.count;r=Math.max(r,t.drawRange.start),(i=Math.min(l,c)-r)<0&&(i=0)}if(0===i)return null;var a=function(e,t,r){for(var i={min:new Array(e.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(e.itemSize).fill(Number.NEGATIVE_INFINITY)},n=t;n<t+r;n++)for(var o=0;o<e.itemSize;o++){var l=void 0;e.itemSize>4?l=e.array[n*e.itemSize+o]:0===o?l=e.getX(n):1===o?l=e.getY(n):2===o?l=e.getZ(n):3===o&&(l=e.getW(n)),i.min[o]=Math.min(i.min[o],l),i.max[o]=Math.max(i.max[o],l)}return i}(e,r,i),h={componentType:n,count:i,max:a.max,min:a.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[e.itemSize]};if(!this.options.draco){var d;void 0!==t&&(d=e===t.index?34963:34962);var f=this.processBufferView(e,n,r,i,d);h.bufferView=f.id,h.byteOffset=f.byteOffset}return!0===e.normalized&&(h.normalized=!0),s.accessors||(s.accessors=[]),s.accessors.push(h)-1}},{key:"processImage",value:function(e,t,i){var n=this,s=n.cache,o=n.json,a=n.options,l=n.pending;s.images.has(e)||s.images.set(e,{});var c=s.images.get(e),h=t===r.RGBAFormat?"image/png":"image/jpeg",u=h+":flipY/"+i.toString();if(void 0!==c[u])return c[u];o.images||(o.images=[]);var d={mimeType:h};if(a.embedImages){var f=vi=vi||document.createElement("canvas");f.width=Math.min(e.width,a.maxTextureSize),f.height=Math.min(e.height,a.maxTextureSize);var v=f.getContext("2d");if(!0===i&&(v.translate(0,f.height),v.scale(1,-1)),"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap)v.drawImage(e,0,0,f.width,f.height);else{t!==r.RGBAFormat&&t!==r.RGBFormat&&console.error("GLTFExporter: Only RGB and RGBA formats are supported."),(e.width>a.maxTextureSize||e.height>a.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);var m=new Uint8ClampedArray(e.height*e.width*4);if(t===r.RGBAFormat)for(var y=0;y<m.length;y+=4)m[y+0]=e.data[y+0],m[y+1]=e.data[y+1],m[y+2]=e.data[y+2],m[y+3]=e.data[y+3];else for(var A=0,w=0;A<m.length;A+=4,w+=3)m[A+0]=e.data[w+0],m[A+1]=e.data[w+1],m[A+2]=e.data[w+2],m[A+3]=255;v.putImageData(new ImageData(m,e.width,e.height),0,0)}!0===a.binary?l.push(new Promise((function(e){f.toBlob((function(t){n.processBufferViewImage(t).then((function(t){d.bufferView=t,e()}))}),h)}))):d.uri=f.toDataURL(h)}else d.uri=e.src;var p=o.images.push(d)-1;return c[u]=p,p}},{key:"processSampler",value:function(e){var t=this.json;t.samplers||(t.samplers=[]);var r={magFilter:ui[e.magFilter],minFilter:ui[e.minFilter],wrapS:ui[e.wrapS],wrapT:ui[e.wrapT]};return t.samplers.push(r)-1}},{key:"processTexture",value:function(e){var t=this.cache,r=this.json;if(t.textures.has(e))return t.textures.get(e);r.textures||(r.textures=[]);var i={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY)};e.name&&(i.name=e.name),this._invokeAll((function(t){t.writeTexture&&t.writeTexture(e,i)}));var n=r.textures.push(i)-1;return t.textures.set(e,n),n}},{key:"processMaterial",value:function(e){var t=this.cache,i=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;i.materials||(i.materials=[]);var n={pbrMetallicRoughness:{}};!0!==e.isMeshStandardMaterial&&!0!==e.isMeshBasicMaterial&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var s=e.color.toArray().concat([e.opacity]);if(hi(s,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=s),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=.5,n.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap)if(e.metalnessMap===e.roughnessMap){var o={index:this.processTexture(e.metalnessMap)};this.applyTextureTransform(o,e.metalnessMap),n.pbrMetallicRoughness.metallicRoughnessTexture=o}else console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(e.map){var l={index:this.processTexture(e.map)};this.applyTextureTransform(l,e.map),n.pbrMetallicRoughness.baseColorTexture=l}if(e.emissive){var c=e.emissive.clone().multiplyScalar(e.emissiveIntensity),h=Math.max(c.r,c.g,c.b);if(h>1&&(c.multiplyScalar(1/h),console.warn("THREE.GLTFExporter: Some emissive components exceed 1; emissive has been limited")),h>0&&(n.emissiveFactor=c.toArray()),e.emissiveMap){var d={index:this.processTexture(e.emissiveMap)};this.applyTextureTransform(d,e.emissiveMap),n.emissiveTexture=d}}if(e.normalMap){var f={index:this.processTexture(e.normalMap)};e.normalScale&&-1!==e.normalScale.x&&(e.normalScale.x!==e.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),f.scale=e.normalScale.x),this.applyTextureTransform(f,e.normalMap),n.normalTexture=f}if(e.aoMap){var v={index:this.processTexture(e.aoMap),texCoord:1};1!==e.aoMapIntensity&&(v.strength=e.aoMapIntensity),this.applyTextureTransform(v,e.aoMap),n.occlusionTexture=v}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===r.DoubleSide&&(n.doubleSided=!0),""!==e.name&&(n.name=e.name),this.serializeUserData(e,n),this._invokeAll((function(t){t.writeMaterial&&t.writeMaterial(e,n)}));var m=i.materials.push(n)-1;return t.materials.set(e,m),m}},{key:"processMesh",value:(c=Object(h.a)(regeneratorRuntime.mark((function e(t){var n,i,o,l,c,s,h,a,d,f,v,u,m,p,y,A,w,x,O,E,C,D,S,B,T,k,_,M,L,N,F,I,j,P,g,R,z,U,G,V,H,J,Q,Y;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.cache,i=this.json,o=[t.geometry.uuid],Array.isArray(t.material))for(l=0,c=t.material.length;l<c;l++)o.push(t.material[l].uuid);else o.push(t.material.uuid);if(s=o.join(":"),!n.meshes.has(s)){e.next=5;break}return e.abrupt("return",n.meshes.get(s));case 5:if(h=t.geometry,a=t.isLineSegments?1:t.isLineLoop?2:t.isLine?3:t.isPoints?0:t.material.wireframe?1:4,!0===h.isBufferGeometry){e.next=8;break}throw new Error("THREE.GLTFExporter: Geometry is not of type THREE.BufferGeometry.");case 8:d={},f={},v=[],u=[],m={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},void 0===(p=h.getAttribute("normal"))||this.isNormalizedNormalAttribute(p)||(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),h.setAttribute("normal",this.createNormalizedNormalAttribute(p))),y=null,e.t0=regeneratorRuntime.keys(h.attributes);case 12:if((e.t1=e.t0()).done){e.next=28;break}if("morph"!==(A=e.t1.value).substr(0,5)){e.next=16;break}return e.abrupt("continue",12);case 16:if(w=h.attributes[A],A=m[A]||A.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(A)||(A="_"+A),!n.attributes.has(this.getUID(w))){e.next=21;break}return f[A]=n.attributes.get(this.getUID(w)),e.abrupt("continue",12);case 21:y=null,x=w.array,"JOINTS_0"!==A||x instanceof Uint16Array||x instanceof Uint8Array||(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),y=new r.BufferAttribute(new Uint16Array(x),w.itemSize,w.normalized)),null!==(O=this.processAccessor(y||w,h))&&(f[A]=O,n.attributes.set(this.getUID(w),O)),e.next=12;break;case 28:if(void 0!==p&&h.setAttribute("normal",p),0!==Object.keys(f).length){e.next=30;break}return e.abrupt("return",null);case 30:if(!(void 0!==t.morphTargetInfluences&&t.morphTargetInfluences.length>0)){e.next=57;break}if(E=[],C=[],D={},void 0!==t.morphTargetDictionary)for(S in t.morphTargetDictionary)D[t.morphTargetDictionary[S]]=S;B=0;case 34:if(!(B<t.morphTargetInfluences.length)){e.next=56;break}T={},k=!1,e.t2=regeneratorRuntime.keys(h.morphAttributes);case 38:if((e.t3=e.t2()).done){e.next=52;break}if("position"===(_=e.t3.value)||"normal"===_){e.next=43;break}return k||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),k=!0),e.abrupt("continue",38);case 43:if(M=h.morphAttributes[_][B],L=_.toUpperCase(),N=h.attributes[_],!n.attributes.has(this.getUID(M))){e.next=47;break}return T[L]=n.attributes.get(this.getUID(M)),e.abrupt("continue",38);case 47:if(F=M.clone(),!h.morphTargetsRelative)for(I=0,j=M.count;I<j;I++)F.setXYZ(I,M.getX(I)-N.getX(I),M.getY(I)-N.getY(I),M.getZ(I)-N.getZ(I));T[L]=this.processAccessor(F,h),n.attributes.set(this.getUID(N),T[L]),e.next=38;break;case 52:u.push(T),E.push(t.morphTargetInfluences[B]),void 0!==t.morphTargetDictionary&&C.push(D[B]);case 53:++B,e.next=34;break;case 56:d.weights=E,C.length>0&&(d.extras={},d.extras.targetNames=C);case 57:if(!(P=Array.isArray(t.material))||0!==h.groups.length){e.next=60;break}return e.abrupt("return",null);case 60:for(g=P?t.material:[t.material],R=P?h.groups:[{materialIndex:0,start:void 0,count:void 0}],z=0,U=R.length;z<U;z++)G={mode:a,attributes:f},this.serializeUserData(h,G),u.length>0&&(G.targets=u),null!==h.index&&(V=this.getUID(h.index),void 0===R[z].start&&void 0===R[z].count||(V+=":"+R[z].start+":"+R[z].count),n.attributes.has(V)?G.indices=n.attributes.get(V):(G.indices=this.processAccessor(h.index,h,R[z].start,R[z].count),n.attributes.set(V,G.indices)),null===G.indices&&delete G.indices),null!==(H=this.processMaterial(g[R[z].materialIndex]))&&(G.material=H),v.push(G);if(d.primitives=v,!this.options.draco){e.next=69;break}return e.next=65,this.dracoExporter.parse(t);case 65:J=e.sent,this.processBuffer(J.buffer),Q={buffer:0,byteOffset:this.byteOffset,byteLength:J.buffer.length},this.byteOffset+=Q.byteLength,i.bufferViews||(i.bufferViews=[]),i.bufferViews.push(Q),v.forEach((function(e){e.extensions||(e.extensions={}),e.extensions.KHR_draco_mesh_compression={bufferView:i.bufferViews.length-1,attributes:J.attributeIDs}})),i.extensionsRequired||(i.extensionsRequired=[]),i.extensionsRequired.includes("KHR_draco_mesh_compression")||i.extensionsRequired.push("KHR_draco_mesh_compression"),this.extensionsUsed.KHR_draco_mesh_compression=!0;case 69:return i.meshes||(i.meshes=[]),this._invokeAll((function(e){e.writeMesh&&e.writeMesh(t,d)})),Y=i.meshes.push(d)-1,e.abrupt("return",(n.meshes.set(s,Y),Y));case 72:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"processCamera",value:function(e){var t=this.json;t.cameras||(t.cameras=[]);var i=e.isOrthographicCamera,n={type:i?"orthographic":"perspective"};return i?n.orthographic={xmag:2*e.right,ymag:2*e.top,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:r.MathUtils.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},""!==e.name&&(n.name=e.type),t.cameras.push(n)-1}},{key:"processAnimation",value:function(e,t){var i=this.json,n=this.nodeMap;i.animations||(i.animations=[]);for(var s=(e=ai.Utils.mergeMorphTargetTracks(e.clone(),t)).tracks,o=[],a=[],l=0;l<s.length;++l){var c=s[l],h=r.PropertyBinding.parseTrackName(c.name),d=r.PropertyBinding.findNode(t,h.nodeName),f=ci[h.propertyName];if("bones"===h.objectName&&(d=!0===d.isSkinnedMesh?d.skeleton.getBoneByName(h.objectIndex):void 0),!d||!f)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',c.name),null;var v=void 0,m=c.values.length/c.times.length;f===ci.morphTargetInfluences&&(m/=d.morphTargetInfluences.length),!0===c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?(v="CUBICSPLINE",m/=3):v=c.getInterpolation()===r.InterpolateDiscrete?"STEP":"LINEAR",a.push({input:this.processAccessor(new r.BufferAttribute(c.times,1)),output:this.processAccessor(new r.BufferAttribute(c.values,m)),interpolation:v}),o.push({sampler:a.length-1,target:{node:n.get(d),path:f}})}return i.animations.push({name:e.name||"clip_"+i.animations.length,samplers:a,channels:o}),i.animations.length-1}},{key:"processSkin",value:function(e){var t=this.json,i=this.nodeMap,n=t.nodes[i.get(e)],s=e.skeleton;if(void 0===s)return null;var o=e.skeleton.bones[0];if(void 0===o)return null;for(var a=[],l=new Float32Array(16*s.bones.length),c=new r.Matrix4,h=0;h<s.bones.length;++h)a.push(i.get(s.bones[h])),c.copy(s.boneInverses[h]),c.multiply(e.bindMatrix).toArray(l,16*h);return void 0===t.skins&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new r.BufferAttribute(l,16)),joints:a,skeleton:i.get(o)}),n.skin=t.skins.length-1}},{key:"processNode",value:(l=Object(h.a)(regeneratorRuntime.mark((function e(t){var r,n,i,o,l,c,h,d,f,v,m,y,A,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.json,n=this.options,i=this.nodeMap,r.nodes||(r.nodes=[]),o={},n.trs?(l=t.quaternion.toArray(),c=t.position.toArray(),h=t.scale.toArray(),hi(l,[0,0,0,1])||(o.rotation=l),hi(c,[0,0,0])||(o.translation=c),hi(h,[1,1,1])||(o.scale=h)):(t.matrixAutoUpdate&&t.updateMatrix(),!1===hi(t.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])&&(o.matrix=t.matrix.elements)),""!==t.name&&(o.name=String(t.name)),this.serializeUserData(t,o),!(t.isMesh||t.isLine||t.isPoints)){e.next=11;break}return e.next=7,this.processMesh(t);case 7:null!==(d=e.sent)&&(o.mesh=d),e.next=12;break;case 11:t.isCamera&&(o.camera=this.processCamera(t));case 12:if(t.isSkinnedMesh&&this.skins.push(t),!(t.children.length>0)){e.next=26;break}f=[],v=0,m=t.children.length;case 15:if(!(v<m)){e.next=25;break}if(!(y=t.children[v]).visible&&!1!==n.onlyVisible){e.next=22;break}return e.next=20,this.processNode(y);case 20:null!==(A=e.sent)&&f.push(A);case 22:v++,e.next=15;break;case 25:f.length>0&&(o.children=f);case 26:return this._invokeAll((function(e){e.writeNode&&e.writeNode(t,o)})),s=r.nodes.push(o)-1,e.abrupt("return",(i.set(t,s),s));case 29:case"end":return e.stop()}}),e,this)}))),function(e){return l.apply(this,arguments)})},{key:"processScene",value:(o=Object(h.a)(regeneratorRuntime.mark((function e(t){var r,n,i,o,l,c,h,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.json,n=this.options,r.scenes||(r.scenes=[],r.scene=0),i={},""!==t.name&&(i.name=t.name),r.scenes.push(i),o=[],l=0,c=t.children.length;case 6:if(!(l<c)){e.next=16;break}if(!(h=t.children[l]).visible&&!1!==n.onlyVisible){e.next=13;break}return e.next=11,this.processNode(h);case 11:null!==(d=e.sent)&&o.push(d);case 13:l++,e.next=6;break;case 16:o.length>0&&(i.nodes=o),this.serializeUserData(t,i);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"processObjects",value:(n=Object(h.a)(regeneratorRuntime.mark((function e(t){var n,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for((n=new r.Scene).name="AuxScene",o=0;o<t.length;o++)n.children.push(t[o]);return e.next=5,this.processScene(n);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"processInput",value:(t=Object(h.a)(regeneratorRuntime.mark((function e(t){var n,i,o,l,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.options,t=t instanceof Array?t:[t],this._invokeAll((function(e){e.beforeParse&&e.beforeParse(t)})),i=[],o=0;case 4:if(!(o<t.length)){e.next=14;break}if(!(t[o]instanceof r.Scene)){e.next=10;break}return e.next=8,this.processScene(t[o]);case 8:e.next=11;break;case 10:i.push(t[o]);case 11:o++,e.next=4;break;case 14:if(e.t0=i.length>0,!e.t0){e.next=18;break}return e.next=18,this.processObjects(i);case 18:for(l=0;l<this.skins.length;++l)this.processSkin(this.skins[l]);for(c=0;c<n.animations.length;++c)this.processAnimation(n.animations[c],t[0]);this._invokeAll((function(e){e.afterParse&&e.afterParse(t)}));case 21:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_invokeAll",value:function(e){for(var t=0,r=this.plugins.length;t<r;t++)e(this.plugins[t])}}]),e}(),mi=function(){function e(t){Object(A.a)(this,e),this.writer=t,this.name="KHR_lights_punctual"}return Object(w.a)(e,[{key:"writeNode",value:function(e,t){if(e.isLight)if(e.isDirectionalLight||e.isPointLight||e.isSpotLight){var r=this.writer,i=r.json,n=r.extensionsUsed,s={};e.name&&(s.name=e.name),s.color=e.color.toArray(),s.intensity=e.intensity,e.isDirectionalLight?s.type="directional":e.isPointLight?(s.type="point",e.distance>0&&(s.range=e.distance)):e.isSpotLight&&(s.type="spot",e.distance>0&&(s.range=e.distance),s.spot={},s.spot.innerConeAngle=(e.penumbra-1)*e.angle*-1,s.spot.outerConeAngle=e.angle),void 0!==e.decay&&2!==e.decay&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),!e.target||e.target.parent===e&&0===e.target.position.x&&0===e.target.position.y&&-1===e.target.position.z||console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),n[this.name]||(i.extensions=i.extensions||{},i.extensions[this.name]={lights:[]},n[this.name]=!0);var o=i.extensions[this.name].lights;o.push(s),t.extensions=t.extensions||{},t.extensions[this.name]={light:o.length-1}}else console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e)}}]),e}(),gi=function(){function e(t){Object(A.a)(this,e),this.writer=t,this.name="KHR_materials_unlit"}return Object(w.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isMeshBasicMaterial){var r=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},r[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}}]),e}(),yi=function(){function e(t){Object(A.a)(this,e),this.writer=t,this.name="KHR_materials_pbrSpecularGlossiness"}return Object(w.a)(e,[{key:"writeMaterial",value:function(e,t){if(e.isGLTFSpecularGlossinessMaterial){var r=this.writer,i=r.extensionsUsed,n={};t.pbrMetallicRoughness.baseColorFactor&&(n.diffuseFactor=t.pbrMetallicRoughness.baseColorFactor);var s=[1,1,1];if(e.specular.toArray(s,0),n.specularFactor=s,n.glossinessFactor=e.glossiness,t.pbrMetallicRoughness.baseColorTexture&&(n.diffuseTexture=t.pbrMetallicRoughness.baseColorTexture),e.specularMap){var o={index:r.processTexture(e.specularMap)};r.applyTextureTransform(o,e.specularMap),n.specularGlossinessTexture=o}t.extensions=t.extensions||{},t.extensions[this.name]=n,i[this.name]=!0}}}]),e}();ai.Utils={insertKeyframe:function(e,t){var a,r=.001,i=e.getValueSize(),n=new e.TimeBufferType(e.times.length+1),s=new e.ValueBufferType(e.values.length+i),o=e.createInterpolant(new e.ValueBufferType(i));if(0===e.times.length){n[0]=t;for(var l=0;l<i;l++)s[l]=0;a=0}else if(t<e.times[0]){if(Math.abs(e.times[0]-t)<r)return 0;n[0]=t,n.set(e.times,1),s.set(o.evaluate(t),0),s.set(e.values,i),a=0}else if(t>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-t)<r)return e.times.length-1;n[n.length-1]=t,n.set(e.times,0),s.set(e.values,0),s.set(o.evaluate(t),e.values.length),a=n.length-1}else for(var c=0;c<e.times.length;c++){if(Math.abs(e.times[c]-t)<r)return c;if(e.times[c]<t&&e.times[c+1]>t){n.set(e.times.slice(0,c+1),0),n[c+1]=t,n.set(e.times.slice(c+1),c+2),s.set(e.values.slice(0,(c+1)*i),0),s.set(o.evaluate(t),(c+1)*i),s.set(e.values.slice((c+1)*i),(c+2)*i),a=c+1;break}}return e.times=n,e.values=s,a},mergeMorphTargetTracks:function(e,t){for(var i=[],n={},s=e.tracks,o=0;o<s.length;++o){var l=s[o],a=r.PropertyBinding.parseTrackName(l.name),c=r.PropertyBinding.findNode(t,a.nodeName);if("morphTargetInfluences"===a.propertyName&&void 0!==a.propertyIndex){if(l.createInterpolant!==l.InterpolantFactoryMethodDiscrete&&l.createInterpolant!==l.InterpolantFactoryMethodLinear){if(l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(l=l.clone()).setInterpolation(r.InterpolateLinear)}var h=c.morphTargetInfluences.length,d=c.morphTargetDictionary[a.propertyIndex];if(void 0===d)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);var u=void 0;if(void 0!==n[c.uuid]){var f=l.createInterpolant(new l.ValueBufferType(1));u=n[c.uuid];for(var v=0;v<u.times.length;v++)u.values[v*h+d]=f.evaluate(u.times[v]);for(var m=0;m<l.times.length;m++){var y=this.insertKeyframe(u,l.times[m]);u.values[y*h+d]=l.values[m]}}else{for(var A=new((u=l.clone()).ValueBufferType)(h*u.times.length),w=0;w<u.times.length;w++)A[w*h+d]=u.values[w];u.name=(a.nodeName||"")+".morphTargetInfluences",u.values=A,n[c.uuid]=u,i.push(u)}}else i.push(l)}return e.tracks=i,e}};function Ai(e,t,r){return void 0===e[t.uuid]&&(e[t.uuid]=t.toJSON(r)),t.uuid}var bi=new ai,wi=new ii;function xi(e){var t=[];for(var r in e){var n=e[r];delete n.metadata,t.push(n)}return t}wi.setEncoderPath("/_libraries/"),bi.setDRACOExporter(wi);var Oi=function(){function e(t){var n=this;Object(A.a)(this,e),this.object=t,this.uuid=r.MathUtils.generateUUID(),this.states=[],this.events=[],this._interpolateMaterialBetweenValues=function(e,t,r){for(var o,s,l,a,c,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t.getNames(),h=0,d=i.length;h<d;++h){var f=i[h],v="f".concat(t.id,"_").concat(f),m="f".concat(r.id,"_").concat(f),u=t.uniforms[v],y=r.uniforms[m];void 0!==u.value&&("mode"!==f&&"boolean"!=typeof u.value?"number"!=typeof u.value?"isVector2"in u.value?!1===u.value.equals(y.value)&&(null===(s=n._animation)||void 0===s||s.add({targets:u,x:y.value.x,y:y.value.y},0)):"isVector3"in u.value?!1===u.value.equals(y.value)&&(null===(l=n._animation)||void 0===l||l.add({targets:u,x:y.value.x,y:y.value.y,z:y.value.z},0)):"isColor"in u.value&&!1===u.value.equals(y.value)&&(null===(a=n._animation)||void 0===a||a.add({targets:u.value,r:y.value.r,g:y.value.g,b:y.value.b},0)):u.value!==y.value&&(null===(o=n._animation)||void 0===o||o.add({targets:u,value:Number(y.value)},0)):u.value!==y.value&&(u.value=y.value))}if(t.backLayer){var A="f".concat(t.backLayer.id,"_alpha"),w=t.backLayer.uniforms[A];null===(c=n._animation)||void 0===c||c.add({targets:w,value:0},0)}},this._interpolateMaterialBetweenLayers=function(e,t,r){var i,o,s,l=e.layersList;if(void 0===t.backLayer){var c=r.getValues();c.alpha=0,t.backLayer=l.addLayerBeforeAt(c,t),t.backLayer.isBack=!0,e.dispose()}var a="f".concat(t.id,"_alpha"),h="f".concat(null===(i=t.backLayer)||void 0===i?void 0:i.id,"_alpha"),d=t.uniforms[a],f=null===(o=t.backLayer)||void 0===o?void 0:o.uniforms[h];null===(s=n._animation)||void 0===s||s.add({targets:d,value:0},0).add({targets:f,value:r.uniforms["f".concat(r.id,"_alpha")].value},0)},this._interpolateMaterialTexture=function(e,t,r){var i,o="f".concat(t.id,"_texture"),s=t.uniforms[o].value,l=r.uniforms["f".concat(r.id,"_texture")].value,a=t.uniforms["f".concat(t.id,"_crop")],c=r.uniforms["f".concat(r.id,"_crop")];a&&c&&a.value!==c.value&&(a.value=Number(c.value)),s.wrapS===l.wrapS&&s.wrapT===l.wrapT||(s.wrapS=l.wrapS,s.wrapT=l.wrapT,s.needsUpdate=!0);var h=s.matrix,d=l.matrix;if(!1===h.equals(d)){var f={repeatX:s.repeat.x,repeatY:s.repeat.y,offsetX:s.offset.x,offsetY:s.offset.y};null===(i=n._animation)||void 0===i||i.add({targets:f,repeatX:l.repeat.x,repeatY:l.repeat.y,offsetX:l.offset.x,offsetY:l.offset.y,update:function(){s.repeat.set(f.repeatX,f.repeatY),s.offset.set(f.offsetX,f.offsetY),s.updateMatrix(),s.needsUpdate=!0}},0)}var u=["alpha","mode"];"displace_map"===t.type&&u.push("intensity"),n._interpolateMaterialBetweenValues(e,t,r,u)},this._interpolateMaterialGradient=function(e,t,r){var i,o=t.uniforms["f".concat(t.id,"_num")],s=r.uniforms["f".concat(r.id,"_num")],l="f".concat(t.id,"_steps"),a="f".concat(r.id,"_steps"),c=t.uniforms[l],h=r.uniforms[a],d="f".concat(t.id,"_colors"),u="f".concat(r.id,"_colors"),f=t.uniforms[d],p=r.uniforms[u];if(o.value<=s.value){for(var v=f.value[o.value-1],m=Number(o.value);m<s.value;++m)c.value[m]=1,f.value[m].copy(v);o.value!==s.value&&(o.value=Number(s.value));for(var y=function(e){var t=f.value[e],r=p.value[e];if(c.value[e]!==h.value[e]||!t.equals(r)){var o={value:c.value[e]};null===(i=n._animation)||void 0===i||i.add({targets:[o,t],value:h.value[e],x:r.x,y:r.y,z:r.z,w:r.w,update:function(){c.value[e]=o.value}},0)}},A=0;A<s.value;++A)y(A)}else!function(){for(var e=[],t=function(t){var r=f.value[t],i=p.value[t];if(c.value[t]!==h.value[t]||!r.equals(i)){var o={value:c.value[t]};e.push(new Promise((function(e){var s;null===(s=n._animation)||void 0===s||s.add({targets:[o,r],value:h.value[t],x:i.x,y:i.y,z:i.z,w:i.w,update:function(){c.value[t]=o.value},complete:function(){e(t)}},0)})))}},r=0;r<s.value;++r)t(r);for(var l=p.value[s.value-1],d=function(t){var i=f.value[t];c.value[t]===h.value[t]&&i.equals(l)||e.push(new Promise((function(e){var r,s={value:c.value[t]};null===(r=n._animation)||void 0===r||r.add({targets:[s,i],value:1,x:l.x,y:l.y,z:l.z,w:l.w,update:function(){c.value[t]=s.value},complete:function(){e(t)}},0)})))},v=Number(s.value);v<o.value;++v)d(v);Promise.all(e).then((function(){o.value=Number(s.value)}),(function(){}))}();n._interpolateMaterialBetweenValues(e,t,r,["alpha","mode","gl_type","smooth","offset","morph","angle"])},this.statesManager=new ni(this)}return Object(w.a)(e,[{key:"computeCache",value:function(){return this.cache={mouseDown:this.events.find((function(e){return e.type===qr.MOUSE_DOWN})),mouseUp:this.events.find((function(e){return e.type===qr.MOUSE_UP})),mouseHover:this.events.find((function(e){return e.type===qr.MOUSE_HOVER})),start:this.events.find((function(e){return e.type===qr.START})),lookAt:this.events.find((function(e){return e.type===qr.LOOK_AT})),follow:this.events.find((function(e){return e.type===qr.FOLLOW})),keyDown:this.events.filter((function(e){return e.type===qr.KEY_DOWN})),keyUp:this.events.filter((function(e){return e.type===qr.KEY_UP}))},this.cache}},{key:"newState",value:function(e){var t=new rn;return t.name=e,t.update(this.object),this.selectedState=this.states.length,this.states.push(t),t}},{key:"addState",value:function(e,t){this.states.splice(t,0,e)}},{key:"removeState",value:function(e){this.selectedState===e&&(this.selectedState=void 0),this.states.splice(e,1)}},{key:"selectState",value:function(e){void 0!==e&&this.states[e].execute(this.object),this.selectedState=e}},{key:"hasEventType",value:function(e,t){return e===qr.KEY_DOWN||e===qr.KEY_UP?void 0!==t&&this.events.some((function(r){return r.type===e&&r.key===t})):this.events.some((function(t){return t.type===e}))}},{key:"newEvent",value:function(){var e=this,t=[qr.MOUSE_DOWN,qr.MOUSE_UP,qr.MOUSE_HOVER,qr.KEY_DOWN].find((function(t){return!1===e.hasEventType(t)})),r=new tn(t);return this.events.push(r),r}},{key:"addEvent",value:function(e,t){this.events.splice(t,0,e);for(var r=this.events[t].targets,n=0,o=r.length;n<o;++n)void 0!==r[n].object&&$r.add(r[n])}},{key:"removeEvent",value:function(e){for(var t=this.events[e].targets,r=0,n=t.length;r<n;++r)void 0!==t[r].object&&$r.delete(t[r]);this.events.splice(e,1)}},{key:"copy",value:function(e){this.selectedState=e.selectedState;for(var t=0,r=e.states.length;t<r;++t)this.addState(e.states[t].clone(),t);for(var n=0,o=e.events.length;n<o;++n){this.addEvent(e.events[n].clone(),n);for(var l=e.events[n].targets,c=0,h=l.length;c<h;++c){var d=l[c].clone();l[c].object===e.object?(d.object=this.object,d.state=this.states[e.states.indexOf(l[c].state)]):(d.object=l[c].object,d.state=l[c].state),this.events[n].addTarget(d,c)}}return this}},{key:"clone",value:function(t){return new e(t).copy(this)}},{key:"toJSON",value:function(e){void 0===e&&(e={nodes:{},geometries:{},materials:{},textures:{},images:{},interactionStates:{}});var t={uuid:this.uuid};if(void 0!==this.selectedState&&(t.selectedState=this.selectedState),this.states.length>0){t.states=[];for(var r=0,n=this.states.length;r<n;++r)t.states.push(Ai(e.interactionStates,this.states[r],e))}if(this.events.length>0){t.events=[];for(var o=0,l=this.events.length;o<l;++o)t.events.push(this.events[o].toJSON())}return t}},{key:"fromJSON",value:function(e,t,r){if(this.uuid=e.uuid,this.selectedState=e.selectedState,this.states=[],this.events=[],void 0!==e.states)for(var n=0,o=e.states.length;n<o;++n)this.states.push(r[e.states[n]]);if(void 0!==e.events)for(var l=0,c=e.events.length;l<c;++l)this.events.push((new tn).fromJSON(e.events[l],t,r));return this}},{key:"start",value:function(){void 0!==this._animation&&(this._animation.pause(),this._animation=void 0,this._removeBackLayer()),this.states.length>1?(this.states[0].execute(this.object),this._currentState=this.states[0],this._prevState=void 0):void 0!==this._state0?this._state0.execute(this.object):this.events.some((function(e){return e.type===qr.LOOK_AT||e.type===qr.FOLLOW}))&&(this._state0=new rn,this._state0.update(this.object))}},{key:"end",value:function(){var e;void 0!==this._animation&&(this._animation.pause(),this._animation=void 0,this._removeBackLayer()),this.states.length>1?this.states[null!==(e=this.selectedState)&&void 0!==e?e:0].execute(this.object):void 0!==this._state0&&(this._state0.execute(this.object),this._state0=void 0),this._currentState=void 0,this._prevState=void 0}},{key:"lookAt",value:function(e){var t,r=this;this.object.lookAt(e),null===(t=this._animation)||void 0===t||t.finished.then((function(){r.lookAt(e)}))}},{key:"follow",value:function(e){this.object.position.copy(e),null!==this.object.parent&&this.object.position.applyMatrix4((new r.Matrix4).copy(this.object.parent.matrixWorld).invert()),this.object.position.applyMatrix4((new r.Matrix4).copy(this.object.hiddenMatrix).invert())}},{key:"play",value:function(e){this.object.visible&&void 0!==e.state&&this.animate(e.state,e)}},{key:"reverse",value:function(e){this.object.visible&&void 0!==this._prevState&&this.animate(this._prevState,e)}},{key:"_removeBackLayer",value:function(){if("material"in this.object){var e=this.object.material;if(e instanceof Array)for(var t=0,r=e.length;t<r;++t)for(var n=e[t].layersList,o=n.head;o;)if(o.backLayer){delete o.backLayer;var l=o.next;n.removeLayer(o.id),o=l}else o.isBack?(o.isBack=!1,o=o.next):o=o.next;else for(var c=e.layersList,h=c.head;h;)for(;h;)if(h.backLayer){delete h.backLayer;var d=h.next;c.removeLayer(h.id),h=d}else h.isBack?(h.isBack=!1,h=h.next):h=h.next}}},{key:"getTimingFunction",value:function(e,t,r){switch(e){case Kr.LINEAR:return"cubicBezier( 0, 0, 1, 1 )";case Kr.EASE:return"cubicBezier( .25, .1, .25, 1 )";case Kr.EASE_IN:return"cubicBezier( .42, 0, 1, 1 )";case Kr.EASE_OUT:return"cubicBezier( 0, 0, .58, 1 )";case Kr.EASE_IN_OUT:return"cubicBezier( .42, 0, .58, 1 )";case Kr.CUBIC:return"cubicBezier( ".concat(t[0],", ").concat(t[1],", ").concat(t[2],", ").concat(t[3]," )");case Kr.SPRING:return"spring( ".concat(r.mass,", ").concat(r.stiffness,", ").concat(r.damping,", ").concat(r.velocity," )")}}},{key:"animate",value:function(e,t){var r,i,n,s,o,a,l=this;if(this._currentState===e){if(null===(r=this._animation)||void 0===r?void 0:r.reversed){var c=null!==(n=null===(i=this._animation)||void 0===i?void 0:i.currentTime)&&void 0!==n?n:0;null===(s=this._animation)||void 0===s||s.reset(),null===(o=this._animation)||void 0===o||o.seek(c),null===(a=this._animation)||void 0===a||a.play()}}else this._prevState=this._currentState,this._currentState=e,void 0!==this._animation&&this._animation.pause(),this._removeBackLayer(),!0===t.cycle&&!0===t.repeat?this._animation=ti.timeline({duration:t.duration,delay:t.delay/2,endDelay:t.delay/2,direction:"alternate",loop:!0,rewind:t.rewind,easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}):!0===t.cycle&&!1===t.repeat?this._animation=ti.timeline({duration:t.duration,delay:t.delay,endDelay:t.delay/2,direction:"alternate",rewind:t.rewind,easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}):!1===t.cycle&&!0===t.repeat?this._animation=ti.timeline({duration:t.duration,delay:t.delay,direction:"normal",loop:!0,easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}):this._animation=ti.timeline({duration:t.duration,delay:t.delay,direction:"normal",easing:this.getTimingFunction(t.easing,t.cubicControls,t.springParameters)}),this._animation.finished.then((function(){l._removeBackLayer(),l._animation=void 0})),this.animateMatrix(e),this.animateGeometry(e),this.animateMaterial(e),this.animateCamera(e)}},{key:"animateMatrix",value:function(e){var t,i,n,s,o=this;if(!1===this.object.position.equals(e.position)){var l=this.object.position.clone(),c={t:0};null===(t=this._animation)||void 0===t||t.add({targets:c,t:1,update:function(){o.object.position.lerpVectors(l,e.position,c.t)}},0)}if(!1===this.object.scale.equals(e.scale)){var h=this.object.scale.clone(),d={t:0};null===(i=this._animation)||void 0===i||i.add({targets:d,t:1,update:function(){o.object.scale.lerpVectors(h,e.scale,d.t)}},0)}if(!1===this.object.rotation.equals(e.rotation)){var f=this.object.quaternion.clone(),v={t:0},m={x:this.object.rotation.x-e.rotation.x,y:this.object.rotation.y-e.rotation.y,z:this.object.rotation.z-e.rotation.z},y=e.rotation.clone(),A=.01*r.MathUtils.DEG2RAD,w=359.99*r.MathUtils.DEG2RAD;m.x===2*Math.PI?0===y.x?y.x=A:y.x===2*Math.PI&&(y.x=w):m.x===2*-Math.PI&&(0===y.x?y.x=-A:y.x===2*Math.PI&&(y.x=-w)),m.y===2*Math.PI?0===y.y?y.y=A:y.y===2*Math.PI&&(y.y=w):m.y===2*-Math.PI&&(0===y.y?y.y=-A:y.y===2*Math.PI&&(y.y=-w)),m.z===2*Math.PI?0===y.z?y.z=A:y.z===2*Math.PI&&(y.z=w):m.z===2*-Math.PI&&(0===y.z?y.z=-A:y.z===2*Math.PI&&(y.z=-w));var x=(new r.Quaternion).setFromEuler(y);null===(n=this._animation)||void 0===n||n.add({targets:v,t:1,update:function(){!function(e,t,r,i){if(0===i)return r.copy(e);if(1===i)return r.copy(t);var n=e.w*t.w+e.x*t.x+e.y*t.y+e.z*t.z;if(n>=1)return r.copy(e);var s=1-n*n;if(s<=Number.EPSILON){var o=1-i;return r.w=o*e.w+i*t.w,r.x=o*e.x+i*t.x,r.y=o*e.y+i*t.y,r.z=o*e.z+i*t.z,r.normalize(),r}var l=Math.sqrt(s),a=Math.atan2(l,n),c=Math.sin((1-i)*a)/l,h=Math.sin(i*a)/l;r.w=e.w*c+t.w*h,r.x=e.x*c+t.x*h,r.y=e.y*c+t.y*h,r.z=e.z*c+t.z*h}(f,x,o.object.quaternion,v.t)}},0)}var O=new r.Vector3,a=new r.Quaternion,E=new r.Vector3;if(e.hiddenMatrix.decompose(O,a,E),"hiddenMatrix"in this.object){var C=new r.Vector3,D=new r.Quaternion,S=new r.Vector3;if(this.object.hiddenMatrix.decompose(C,D,S),!1===this.object.hiddenMatrix.equals(e.hiddenMatrix)){var B=new r.Vector3,T=new r.Quaternion,k=new r.Vector3,u={t:0},_=this.object.hiddenMatrix;null===(s=this._animation)||void 0===s||s.add({targets:u,t:1,update:function(){T.slerpQuaternions(D,a,u.t),B.lerpVectors(C,O,u.t),k.lerpVectors(S,E,u.t),_.compose(B,T,k)}},0)}}}},{key:"animateGeometry",value:function(e){var t;if("geometry"in this.object&&void 0!==e.geometry){var r=this.object.geometry.userData.parameters,n=e.geometry;if(n.width!==r.width||n.height!==r.height||n.depth!==r.depth){var o=this.object;null===(t=this._animation)||void 0===t||t.add({targets:r,width:n.width,height:n.height,depth:n.depth,update:function(){o.updateGeometry({parameters:{width:r.width,height:r.height,depth:r.depth}})}},0)}}}},{key:"animateMaterial",value:function(e){if("material"in this.object)if(this.object.material instanceof Array)for(var t=0,r=this.object.material.length;t<r;++t)this._interpolateMaterial(this.object.material[t],e.material[t]);else{if(this.object.material.userData.isAsset)return;this._interpolateMaterial(this.object.material,e.material)}}},{key:"_interpolateMaterial",value:function(e,t){for(var r=e.layersList.head,i=0;r;)if(!0!==r.isBack){var n=t.layersList[i++];if(Ct(r)){var o=r.uniforms["f".concat(r.id,"_texture")].value,l=n.uniforms["f".concat(n.id,"_texture")].value;o.image===l.image?this._interpolateMaterialTexture(e,r,n):this._interpolateMaterialBetweenLayers(e,r,n)}else"gradient"===r.type?r.uniforms["f".concat(r.id,"_gl_type")].value===n.uniforms["f".concat(n.id,"_gl_type")].value?this._interpolateMaterialGradient(e,r,n):this._interpolateMaterialBetweenLayers(e,r,n):this._interpolateMaterialBetweenValues(e,r,n);r=r.next}else r=r.next}},{key:"animateCamera",value:function(e){var t;if("CombinedCamera"===this.object.objectType&&void 0!==e.camera){var r=this.object,n="OrthographicCamera"===r.cameraType?e.camera.zoomOrtho:e.camera.zoomPersp;r.zoom!==n&&(null===(t=this._animation)||void 0===t||t.add({targets:r,zoom:n,update:function(){r.updateProjectionMatrix()}},0))}}}]),e}(),Ei=function(e){return function(e){Object(x.a)(n,e);var t=S(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return Object(w.a)(n,[{key:"hasEntityChild",value:function(){return this.children.some((function(e){return pt(e)}))}},{key:"attach",value:function(e,t){this.updateWorldMatrix(!0,!1);var i=(new r.Matrix4).copy(this.matrixWorld).invert();return null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),i.multiply(e.parent.matrixWorld)),pt(e)?e.hiddenMatrix.premultiply(i):e.applyMatrix4(i),e.updateWorldMatrix(!1,!1),this.add(e),void 0!==t&&(this.children.pop(),this.children.splice(t,0,e)),this}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var r=0;r<e.children.length;r++){var n=e.children[r];this.add(n.clone())}return this}},{key:"toJSON",value:function(e){var t=void 0===e,i={object:{uuid:"",objectType:""}};void 0===e&&(e={geometries:{},materials:{},textures:{},images:{},interactionStates:{},nodes:{}},i.metadata={version:1.5,type:"Object",generator:"Object3D.toJSON"});var n={uuid:this.uuid,objectType:this.type};if(""!==this.name&&(n.name=this.name),n.matrix=this.matrix.toArray(),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),n.layers=this.layers.mask,"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),this.children.length>0){n.children=[];var o,l=C(this.children);try{for(l.s();!(o=l.n()).done;){var c=o.value;(pt(c)||c instanceof r.Light)&&n.children.push(c.toJSON(e).object)}}catch(e){l.e(e)}finally{l.f()}}if(t){var h=xi(e.geometries),d=xi(e.materials),f=xi(e.textures),s=xi(e.images),v=xi(e.interactionStates),a=function(e){var t=[];for(var r in e)t.push(e[r]);return t}(e.nodes);h.length>0&&(i.geometries=h),d.length>0&&(i.materials=d),f.length>0&&(i.textures=f),s.length>0&&(i.images=s),v.length>0&&(i.interactionStates=v),a.length>0&&(i.nodes=a)}return i.object=n,i}},{key:"fromJSON",value:function(e){return this.uuid=e.uuid,void 0!==e.name&&(this.name=e.name),void 0!==e.matrix?(this.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(this.matrixAutoUpdate=e.matrixAutoUpdate),this.matrixAutoUpdate&&this.matrix.decompose(this.position,this.quaternion,this.scale)):(void 0!==e.position&&this.position.fromArray(e.position),void 0!==e.rotation&&this.rotation.fromArray(e.rotation),void 0!==e.quaternion&&this.quaternion.fromArray(e.quaternion),void 0!==e.scale&&this.scale.fromArray(e.scale)),this.castShadow=void 0!==e.castShadow,this.receiveShadow=void 0!==e.receiveShadow,void 0!==e.visible&&(this.visible=e.visible),void 0!==e.frustumCulled&&(this.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(this.renderOrder=e.renderOrder),void 0!==e.layers&&(this.layers.mask=e.layers),void 0!==e.userData&&(this.userData=e.userData),this}}]),n}(e)},Ci=function(e){return"isEntity"in e},Di=function(e){return"isAbstractMesh"in e},Si=function(e){return"objectHelper"in e},Bi=function(e){return function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.apply(this,arguments)).objectType="",e.isEntity=!0,e.raycastLock=!1,e.scaleLock=!1,e.hiddenMatrix=new r.Matrix4,e.interaction=new Oi(Object(m.a)(e)),e.forceComputeSize=!1,e}return Object(w.a)(n,[{key:"visibility",get:function(){return this.visible},set:function(e){this.visible=e;var t,r=C(this.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;Ci(n)&&n.traverseEntity((function(t){Si(t)&&t.visible&&(t.objectHelper.visible=e)}))}}catch(e){r.e(e)}finally{r.f()}}},{key:"interactionCache",get:function(){return void 0===this.interaction.cache&&this.interaction.computeCache(),this.interaction.cache}},{key:"traverseEntity",value:function(e){e(this);var t,r=C(this.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;Ci(n)&&n.traverseEntity(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"computeSingleBoundingBox",value:function(){this.singleBoundingBox||(this.singleBoundingBox=new xt),this.singleBoundingBox.setFromObjectSize(this,!1),this.singleBoundingBox.computeVertices(),this.singleBoundingBox.computeEdges(),this.singleBoundingBox.computeFaces()}},{key:"computeComplexBoundingBox",value:function(e){this.complexBoundingBox||(this.complexBoundingBox=new xt),this.complexBoundingBox.setFromObjectSize(this,e),this.complexBoundingBox.computeVertices(),this.complexBoundingBox.computeEdges(),this.complexBoundingBox.computeFaces()}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);var t,r=C(this.children);try{for(r.s();!(t=r.n()).done;){t.value.updateMatrixWorld(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"updateWorldMatrix",value:function(e,t){var r=this.parent;if(e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.multiplyMatrices(this.hiddenMatrix,this.matrix):(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.hiddenMatrix),this.matrixWorld.multiplyMatrices(this.matrixWorld,this.matrix)),t){var n,o=C(this.children);try{for(o.s();!(n=o.n()).done;){n.value.updateWorldMatrix(!1,!0)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"shallowClone",value:function(e){return(new this.constructor).shallowCopy(this,e)}},{key:"shallowCopy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e,!1),this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),void 0!==e.interaction&&this.interaction.copy(e.interaction),!0===t){var r,o=C(e.children);try{for(o.s();!(r=o.n()).done;){var l=r.value;Ci(l)&&this.add(l.shallowClone())}}catch(e){o.e(e)}finally{o.f()}}return this}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e,!1),this.raycastLock=e.raycastLock,this.scaleLock=e.scaleLock,this.hiddenMatrix.copy(e.hiddenMatrix),void 0!==e.interaction&&this.interaction.copy(e.interaction),!0===t){var r,o=C(e.children);try{for(o.s();!(r=o.n()).done;){var l=r.value;Ci(l)&&this.add(l.clone())}}catch(e){o.e(e)}finally{o.f()}}return this}},{key:"keepChildrenMatrixWorld",value:function(){var e=new r.Matrix4,t=this.matrixWorld.clone();this.updateWorldMatrix(!1,!1),e.copy(this.matrixWorld).invert(),e.multiply(t);var n,o=C(this.children);try{for(o.s();!(n=o.n()).done;){var l=n.value;Ci(l)&&l.hiddenMatrix.premultiply(e)}}catch(e){o.e(e)}finally{o.f()}}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),r=t.object;return!0===this.raycastLock&&(r.raycastLock=!0),!0===this.scaleLock&&(r.scaleLock=!0),r.hiddenMatrix=this.hiddenMatrix.toArray(),void 0!==this.interaction&&(r.interaction=this.interaction.toJSON(e)),t}},{key:"fromJSON",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),void 0!==e.raycastLock&&(this.raycastLock=e.raycastLock),void 0!==e.scaleLock&&(this.scaleLock=e.scaleLock),this.hiddenMatrix.fromArray(e.hiddenMatrix),this}},{key:"fromObject3D",value:function(e){var t=e.children;return e.children=[],Object.assign(e,{raycastLock:!1,scaleLock:!1,hiddenMatrix:new r.Matrix4}),this.copy(e),e.children=t,this}}]),n}(Ei(e))},Ti=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(A.a)(this,n),(o=t.call(this)).object=e,e.computeComplexBoundingBox(!0);var i=e.complexBoundingBox.getSize(new r.Vector3),c=.1;return o.parameters={type:void 0!==l.type?l.type:"radial",hideBase:void 0!==l.hideBase&&l.hideBase,count:void 0!==l.count?l.count:3,ra_radius:void 0!==l.ra_radius?l.ra_radius:2*Math.max(i.x,i.y),ra_startAngle:void 0!==l.ra_startAngle?l.ra_startAngle:0,ra_endAngle:void 0!==l.ra_endAngle?l.ra_endAngle:360,ra_align:void 0!==l.ra_align&&l.ra_align,ra_axis:void 0!==l.ra_axis?l.ra_axis:"y",ra_scale:void 0!==l.ra_scale?l.ra_scale.clone():new r.Vector3,ra_rotation:void 0!==l.ra_rotation?l.ra_rotation.clone():new r.Euler,ra_position:void 0!==l.ra_position?l.ra_position.clone():new r.Vector3,li_scale:void 0!==l.li_scale?l.li_scale.clone():new r.Vector3,li_rotation:void 0!==l.li_rotation?l.li_rotation.clone():new r.Euler,li_position:void 0!==l.li_position?l.li_position.clone():new r.Vector3(i.x+i.x*c,0,0).round(),gr_count:void 0!==l.gr_count?l.gr_count.clone():new r.Vector3(2,2,2),gr_size:void 0!==l.gr_size?l.gr_size.clone():new r.Vector3(i.x+i.x*c,i.y+i.y*c,i.z+i.z*c).round(),gr_fromCenter:void 0===l.gr_fromCenter||l.gr_fromCenter},o.update(),o.setHideBase(o.parameters.hideBase),o}return Object(w.a)(n,[{key:"refreshMaterial",value:function(){if("material"in this.object){var e,t=C(this.children);try{for(t.s();!(e=t.n()).done;){e.value.material=this.object.material}}catch(e){t.e(e)}finally{t.f()}}}},{key:"setHideBase",value:function(e){if("material"in this.object){if(Array.isArray(this.object.material)){if(this.children.length>0){var t,r=C(this.object.material);try{for(r.s();!(t=r.n()).done;){t.value.visible=!0}}catch(e){r.e(e)}finally{r.f()}if(e){var n,o=this.object.material.map((function(e){return e.clone()})),l=C(this.children);try{for(l.s();!(n=l.n()).done;){n.value.material=o}}catch(e){l.e(e)}finally{l.f()}}else{var c,h=C(this.children);try{for(h.s();!(c=h.n()).done;){c.value.material=this.object.material}}catch(e){h.e(e)}finally{h.f()}}}var d,f=C(this.object.material);try{for(f.s();!(d=f.n()).done;){d.value.visible=!e}}catch(e){f.e(e)}finally{f.f()}}else{if(this.children.length>0)if(this.object.material.visible=!0,e){var v,m=this.object.material.clone(),y=C(this.children);try{for(y.s();!(v=y.n()).done;){v.value.material=m}}catch(e){y.e(e)}finally{y.f()}}else{var A,w=C(this.children);try{for(w.s();!(A=w.n()).done;){A.value.material=this.object.material}}catch(e){w.e(e)}finally{w.f()}}this.object.material.visible=!e}this.parameters.hideBase=e}}},{key:"update",value:function(){switch(this._updateCount(),this.parameters.type){case"radial":this._updateRadial(this.parameters);break;case"linear":this._updateLinear(this.parameters);break;case"grid":this._updateGrid(this.parameters)}}},{key:"_updateCount",value:function(){var e="grid"===this.parameters.type?this.parameters.gr_count.x*this.parameters.gr_count.y*this.parameters.gr_count.z:this.parameters.count;if(this.children.length!==e)if(this.children.length<e)for(var t=0,r=e-this.children.length;t<r;++t){var n=this.object.shallowClone(!1);n.visible=!0,this.add(n),this.parameters.hideBase&&this.setHideBase(!0)}else for(var o=0,l=this.children.length-e;o<l;++o)this.remove(this.children[0])}},{key:"_updateRadial",value:function(e){var s,t=e.ra_startAngle*r.MathUtils.DEG2RAD,i=t-e.ra_endAngle*r.MathUtils.DEG2RAD,n=new r.Euler(e.ra_rotation.x*r.MathUtils.DEG2RAD,e.ra_rotation.y*r.MathUtils.DEG2RAD,e.ra_rotation.z*r.MathUtils.DEG2RAD);switch(e.ra_axis){case"x":s=new r.Vector3(1,0,0);break;case"y":s=new r.Vector3(0,1,0);break;case"z":s=new r.Vector3(0,0,1)}var o,l=C(this.children.entries());try{for(l.s();!(o=l.n()).done;){var c=Object(f.a)(o.value,2),h=c[0],d=c[1];d.hiddenMatrix.identity(),d.scale.x=e.ra_scale.x+1,d.scale.y=e.ra_scale.y+1,d.scale.z=e.ra_scale.z+1,d.position.setScalar(0);var a=i/e.count*h-t;switch(e.ra_axis){case"x":d.rotation.set(0,a,0);break;case"y":d.rotation.set(0,0,a);break;case"z":d.rotation.set(a,0,0)}d.translateOnAxis(s,e.ra_radius),d.position.add(e.ra_position),!0===e.ra_align?(d.rotation.x+=n.x,d.rotation.y+=n.y,d.rotation.z+=n.z):d.rotation.copy(n)}}catch(e){l.e(e)}finally{l.f()}}},{key:"_updateLinear",value:function(e){if("linear"!==e.type)throw new Error;var t,n=new r.Euler(e.li_rotation.x*r.MathUtils.DEG2RAD,e.li_rotation.y*r.MathUtils.DEG2RAD,e.li_rotation.z*r.MathUtils.DEG2RAD),o=C(this.children.entries());try{for(o.s();!(t=o.n()).done;){var l=Object(f.a)(t.value,2),c=l[0],h=l[1];h.hiddenMatrix.identity(),h.scale.x=e.li_scale.x*c+1,h.scale.y=e.li_scale.y*c+1,h.scale.z=e.li_scale.z*c+1,h.rotation.x=n.x*c,h.rotation.y=n.y*c,h.rotation.z=n.z*c,h.position.x=e.li_position.x*c,h.position.y=e.li_position.y*c,h.position.z=e.li_position.z*c}}catch(e){o.e(e)}finally{o.f()}}},{key:"_updateGrid",value:function(e){var t=0;if(!0===e.gr_fromCenter)for(var n={x:e.gr_count.x%2==0?2:1,y:e.gr_count.y%2==0?2:1,z:e.gr_count.z%2==0?2:1},o=new r.Vector3(e.gr_size.x*(e.gr_count.x-n.x)*.5,e.gr_size.y*(e.gr_count.y-n.y)*.5,e.gr_size.z*(e.gr_count.z-n.z)*.5),l=0;l<e.gr_count.x;l++)for(var c=0;c<e.gr_count.y;c++)for(var s=0;s<e.gr_count.z;s++){var h=this.children[t++];h.hiddenMatrix.identity(),h.scale.setScalar(1),h.rotation.set(0,0,0),h.position.x=e.gr_size.x*l-o.x,h.position.y=e.gr_size.y*c-o.y,h.position.z=e.gr_size.z*s-o.z}else for(var d=0;d<e.gr_count.x;d++)for(var f=0;f<e.gr_count.y;f++)for(var v=0;v<e.gr_count.z;v++){var m=this.children[t++];m.hiddenMatrix.identity(),m.scale.setScalar(1),m.rotation.set(0,0,0),m.position.x=e.gr_size.x*d,m.position.y=-e.gr_size.y*f,m.position.z=-e.gr_size.z*v}}},{key:"toJSON",value:function(){return{type:"Cloner",parameters:{type:this.parameters.type,hideBase:this.parameters.hideBase,count:this.parameters.count,ra_radius:this.parameters.ra_radius,ra_startAngle:this.parameters.ra_startAngle,ra_endAngle:this.parameters.ra_endAngle,ra_align:this.parameters.ra_align,ra_axis:this.parameters.ra_axis,ra_scale:this.parameters.ra_scale.toArray(),ra_rotation:this.parameters.ra_rotation.toArray(),ra_position:this.parameters.ra_position.toArray(),li_scale:this.parameters.li_scale.toArray(),li_rotation:this.parameters.li_rotation.toArray(),li_position:this.parameters.li_position.toArray(),gr_count:this.parameters.gr_count.toArray(),gr_size:this.parameters.gr_size.toArray(),gr_fromCenter:this.parameters.gr_fromCenter}}}},{key:"fromJSON",value:function(e){var t=e.parameters;return this.parameters.type=t.type,this.parameters.hideBase=t.hideBase,this.parameters.count=t.count,this.parameters.ra_radius=t.ra_radius,this.parameters.ra_startAngle=t.ra_startAngle,this.parameters.ra_endAngle=t.ra_endAngle,this.parameters.ra_align=t.ra_align,this.parameters.ra_axis=t.ra_axis,this.parameters.ra_scale.fromArray(t.ra_scale),this.parameters.ra_rotation.fromArray(t.ra_rotation),this.parameters.ra_position.fromArray(t.ra_position),this.parameters.li_scale.fromArray(t.li_scale),this.parameters.li_rotation.fromArray(t.li_rotation),this.parameters.li_position.fromArray(t.li_position),this.parameters.gr_count.fromArray(t.gr_count),this.parameters.gr_size.fromArray(t.gr_size),this.parameters.gr_fromCenter=t.gr_fromCenter,this.update(),this.setHideBase(this.parameters.hideBase),this}}]),n}(r.Object3D),ki=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n){var o;return Object(A.a)(this,r),(o=t.call(this,e,n)).isAbstractMesh=!0,Array.isArray(n)&&(o.selectedMaterial=0),o}return Object(w.a)(r,[{key:"cloner",get:function(){return this._cloner},set:function(e){this._cloner&&this.remove(this._cloner),e&&this.add(e),this._cloner=e}},{key:"getSelectedMaterial",value:function(e){return Array.isArray(this.material)?(void 0===this.selectedMaterial&&(this.selectedMaterial=null!=e?e:0),this.material[null!=e?e:this.selectedMaterial]):this.material}},{key:"setSelectedMaterial",value:function(e,t){Array.isArray(this.material)?(void 0===this.selectedMaterial&&(this.selectedMaterial=null!=t?t:0),t=null!=t?t:this.selectedMaterial,this.material[t].dispose(),this.material[t]=e):(this.material.dispose(),this.material=e)}},{key:"updateGeometry",value:function(e){var t=this.geometry,r=ft[t.userData.type],i="NonParametric"===this.objectType?Object.assign({},t.userData,{geometry:t}):t.userData,n=r.build(r.normalizeInputs(e,i)),s=t.uuid;this.geometry.dispose(),this.geometry=n,this.geometry.uuid=s,this.geometry.computeBoundingSphere()}},{key:"resizeGeometry",value:function(e,t,r){!function(e,t){var r=t.width,n=t.height,i=t.depth;r=Math.abs(r),n=Math.abs(n),i=Math.abs(i);var s,o,a,l=e.userData.parameters;0===r?(r=l.width,s=1):s=r/l.width,0===n?(n=l.height,o=1):o=n/l.height,0===i?(i=l.depth,a=1):a=i/l.depth,e.scale(s,o,a),l.width=r,l.height=n,l.depth=i}(this.geometry,{width:e,height:t,depth:r})}},{key:"shallowClone",value:function(e){return new this.constructor(this.geometry,this.material).shallowCopy(this,e)}},{key:"clone",value:function(e){var t="NonParametric"===this.objectType?Object.assign({},this.geometry.userData,{geometry:this.geometry.clone()}):this.geometry.userData,r=vt(t),i=Array.isArray(this.material)?this.material.map((function(e){return e.clone()})):this.material.clone();return new this.constructor(r,i).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e,t),e.cloner&&(this.cloner=new Ti(e,e.cloner.parameters),this.add(this.cloner)),this}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e),n=t.object;if(void 0!==this.cloner&&(n.cloner=this.cloner.toJSON()),n.geometry=function(e,t,r){if(void 0===e[t.uuid])if(t.userData.type,"NonParametricGeometry"===t.userData.type||"SubdivGeometry"===t.userData.type){var n=t.originalGeometry;if(void 0!==n){var o=t.userData;(t=n).userData=o}e[t.uuid]=t.toJSON()}else{var l=t.userData;if("VectorGeometry"===l.type){var c=t.userData.shape;l=Object.assign({},l,{shape:c.toJSON()})}e[t.uuid]={uuid:t.uuid,userData:l}}return t.uuid}(e.geometries,this.geometry,this.material),Array.isArray(this.material)){for(var o=[],l=0,c=this.material.length;l<c;l++)o.push(Ai(e.materials,this.material[l],e));n.material=o}else n.material=Ai(e.materials,this.material,e);return t}},{key:"fromJSON",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e),void 0!==e.selectedMaterial&&(this.selectedMaterial=e.selectedMaterial),void 0!==e.cloner&&(this.cloner=new Ti(this).fromJSON(e.cloner)),this}}]),r}(Bi(r.Mesh)),_i=function(e){var t;return(t=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e;return Object(A.a)(this,r),(e=t.apply(this,arguments)).isObjectHelper=!0,e}return r}(e)).geometryHelper=new r.BoxBufferGeometry(30,30,30),t},Mi=new r.Ray,Li=new r.Sphere,Ni=new r.Matrix4,Fi=function(e,t,i,n){var s=t,o=e.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),Li.copy(s.boundingSphere),Li.applyMatrix4(o),!1!==i.ray.intersectsSphere(Li)&&(Ni.copy(o).invert(),Mi.copy(i.ray).applyMatrix4(Ni),null===s.boundingBox||!1!==Mi.intersectsBox(s.boundingBox))){var a,l,c,h,d,f,u=s.index,v=s.attributes.position,p=s.drawRange;for(d=Math.max(0,p.start),f=Math.min(u.count,p.start+p.count);d<f;d+=3)if(l=u.getX(d),c=u.getX(d+1),h=u.getX(d+2),a=g(e,i,Mi,v,l,c,h))return a.faceIndex=Math.floor(d/3),void n.push(a)}function g(e,t,i,n,s,o,a){var l=new r.Vector3,c=new r.Vector3,h=new r.Vector3,u=new r.Vector3,d=new r.Vector3;if(l.fromBufferAttribute(n,s),c.fromBufferAttribute(n,o),h.fromBufferAttribute(n,a),null===i.intersectTriangle(l,c,h,!1,u))return null;d.copy(u),d.applyMatrix4(e.matrixWorld);var p=t.ray.origin.distanceTo(d);return p<t.near||p>t.far?null:{faceIndex:1,distance:p,point:d.clone(),object:e}}},Ii=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o;Object(A.a)(this,n),(o=t.call(this,e)).object=e;var l=new r.SphereGeometry(15,4,2),i=new r.MeshBasicMaterial({wireframe:!0,fog:!1,toneMapped:!1}),c=new r.Mesh(l,i);return o.add(c),o.object=e,o.name="CombinedCameraHelper: ".concat(e.uuid),o}return Object(w.a)(n,[{key:"raycast",value:function(e,t){Fi(this.object,n.geometryHelper,e,t)}}]),n}(_i(r.CameraHelper)),ji=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10066329;return Object(A.a)(this,r),(n=t.call(this,e,o,l)).object=e,n.name="DirectionalLightHelper: ".concat(e.uuid),n}return Object(w.a)(r,[{key:"raycast",value:function(e,t){Fi(this.object,r.geometryHelper,e,t)}}]),r}(_i(r.DirectionalLightHelper)),Pi=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15;return Object(A.a)(this,r),(n=t.call(this,o)).object=e,n.object.updateMatrixWorld(),n.name="EmptyObjectHelper: ".concat(e.uuid),n.matrix=e.matrixWorld,n.matrixAutoUpdate=!1,n}return Object(w.a)(r,[{key:"raycast",value:function(e,t){Fi(this.object,r.geometryHelper,e,t)}},{key:"update",value:function(){}}]),r}(_i(r.AxesHelper)),Ri=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6710886;return Object(A.a)(this,r),(n=t.call(this,e,o,l)).object=e,n.name="PointLightHelper: ".concat(e.uuid),n}return Object(w.a)(r,[{key:"raycast",value:function(e,t){Fi(this.object,r.geometryHelper,e,t)}}]),r}(_i(r.PointLightHelper)),zi=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6710886;return Object(A.a)(this,r),(n=t.call(this,e,o)).object=e,n.name="SpotLightHelper: ".concat(e.uuid),n}return Object(w.a)(r,[{key:"raycast",value:function(e,t){Fi(this.object,r.geometryHelper,e,t)}},{key:"update",value:function(){if(void 0!==this.object){var e=r._vector,t=this.object.distance?this.object.distance:1e3,n=t*Math.tan(this.object.angle);this.cone.scale.set(n,n,t),e.setFromMatrixPosition(this.object.target.matrixWorld),this.cone.lookAt(e);var o=void 0!==this.color?this.color:this.light.color;if(this.cone.material instanceof Array)for(var l=0,c=this.cone.material.length;l<c;l++)this.cone.material[l].color.set(o);else this.cone.material.color.set(o)}}}]),r}(_i(r.SpotLightHelper));zi._vector=new r.Vector3,new r.Sphere,new r.Matrix4,new r.Ray,new r.Vector3;var Ui=new r.Vector3(0,0,1),Gi=new r.Vector3,Vi=new r.Vector3,Hi=new r.Matrix3,Ji=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,i,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce.create({}),l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jr({side:r.DoubleSide});return Object(A.a)(this,n),(e=t.call(this,o,l)).recursiveSelection=!1,e.objectType="VectorObject",e.eventDispatcher=new r.EventDispatcher,e._onShapeUpdate=function(){if(e.geometry instanceof we){if(e.geometry.updateFromShape()){var t=e.geometry.drawCount,r=e.geometry.userData;e.updateGeometry(Object.assign(e.geometry.userData,{parameters:Object.assign(r.parameters,{surfaceMaxCount:t+1e3})}))}}else e.updateGeometry({});e.computeSingleBoundingBox(),e.geometry.computeBoundingSphere(),e.geometry.computeBoundingBox()},e.castShadow=!0,e.receiveShadow=!0,e.forceComputeSize=!0,e.shape=o.userData.shape,null===(i=e.shape.eventDispatcher)||void 0===i||i.addEventListener("update",e._onShapeUpdate),e}return Object(w.a)(n,[{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e);return t.object.objectType="VectorObject",t}},{key:"setHelperVisibility",value:function(){}},{key:"updateGeometry",value:function(e){if(Object(v.a)(Object(E.a)(n.prototype),"updateGeometry",this).call(this,e),"userData"in this.geometry){var t=this.geometry.userData.parameters;this.eventDispatcher.dispatchEvent({type:"geometryUpdate",parameters:t})}}},{key:"setShape",value:function(e){var t,r;this.shape&&(null===(t=this.shape.eventDispatcher)||void 0===t||t.removeEventListener("update",this._onShapeUpdate)),this.shape=e,null===(r=this.shape.eventDispatcher)||void 0===r||r.addEventListener("update",this._onShapeUpdate)}},{key:"updateWorldMatrix",value:function(e,t){Object(v.a)(Object(E.a)(n.prototype),"updateWorldMatrix",this).call(this,e,t),Hi.getNormalMatrix(this.matrixWorld),Gi.copy(Ui).applyMatrix3(Hi).normalize(),Vi.setFromMatrixPosition(this.matrixWorld),this.shape.plane.setFromNormalAndCoplanarPoint(Gi,Vi)}},{key:"clone",value:function(e){var t=this.shape.clone(),r=this.material.clone(),i=this.geometry.userData,o=Ce.create(Object.assign({},i,{shape:t})),s=new n(o,r).copy(this,e);return s.geometry=o,s.material=r,s.shape=t,t.update(),s}},{key:"raycast",value:function(e,t){ki.prototype.raycast.call(this,e,t)}}]),n}(ki);new r.TextureLoader,new r.Vector2,new r.Vector2,new r.Vector2,new r.LineBasicMaterial({linewidth:1,depthTest:!0,depthWrite:!1,side:r.FrontSide,transparent:!1,vertexColors:!0}),new r.MeshBasicMaterial({opacity:.2,transparent:!0,vertexColors:!0,side:r.DoubleSide}),new r.MeshBasicMaterial({color:16777215,transparent:!0,opacity:.1,vertexColors:!1,side:r.BackSide});var Qi=function(e,t){return function(e){Object(x.a)(n,e);var r=S(n);function n(){var e;return Object(A.a)(this,n),(e=r.apply(this,arguments)).objectHelper=new t(Object(m.a)(e)),e.enableHelper=!1,e}return Object(w.a)(n,[{key:"visibility",get:function(){return this.visible},set:function(e){this.visible=e,this.setHelperVisibility(e),this.setHelperChildrenVisibility(e)}},{key:"geometryHelper",get:function(){return t.geometryHelper}},{key:"setHelperVisibility",value:function(e){this.objectHelper.visible=e}},{key:"setHelperChildrenVisibility",value:function(e){var t,r=C(this.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;Ci(n)&&n.traverseEntity((function(t){Si(t)&&t.visible&&(t.objectHelper.visible=e)}))}}catch(e){r.e(e)}finally{r.f()}}},{key:"raycast",value:function(e,t){this.objectHelper.raycast(e,t)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e,t),void 0!==e.enableHelper&&(this.enableHelper=e.enableHelper),void 0!==e.objectHelper&&(this.objectHelper.visible=e.objectHelper.visible),this}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e);return t.object.enableHelper=this.enableHelper,t}},{key:"fromJSON",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),void 0!==e.enableHelper&&(this.enableHelper=!0),this}}]),n}(e)},Yi=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:45,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5e4;return Object(A.a)(this,n),(e=t.call(this)).objectType="CombinedCamera",e.width=window.innerWidth,e.height=window.innerHeight,e.orthoCamera=new r.OrthographicCamera(-.5*o,.5*o,.5*l,-.5*l,c,s),e.perspCamera=new r.PerspectiveCamera(i,o/l,c,s),e._cameraType="OrthographicCamera",e.left=e.orthoCamera.left,e.right=e.orthoCamera.right,e.top=e.orthoCamera.top,e.bottom=e.orthoCamera.bottom,e.far=e.orthoCamera.far,e.view=e.orthoCamera.view,e.aspect=e.perspCamera.aspect,e.fov=e.perspCamera.fov,e.focus=e.perspCamera.focus,e.filmGauge=e.perspCamera.filmGauge,e.filmOffset=e.perspCamera.filmOffset,e.targetOffset=1e3,e.toOrthographic(!0),e}return Object(w.a)(n,[{key:"setDefault",value:function(){this.name="Default Camera",this.isEntity=!1,this.enableHelper=!1,this.objectHelper.visible=!1}},{key:"isPerspectiveCamera",get:function(){return"PerspectiveCamera"===this.cameraType}},{key:"isOrthographicCamera",get:function(){return!this.isPerspectiveCamera}},{key:"cameraType",get:function(){return this._cameraType},set:function(e){"PerspectiveCamera"===e?this.toPerspective():"OrthographicCamera"===e&&this.toOrthographic()}},{key:"near",get:function(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.near:this.orthoCamera.near},set:function(e){"PerspectiveCamera"===this._cameraType?this.perspCamera.near=e:this.orthoCamera.near=e}},{key:"zoom",get:function(){return"PerspectiveCamera"===this._cameraType?this.perspCamera.zoom:this.orthoCamera.zoom},set:function(e){e>=0&&("PerspectiveCamera"===this._cameraType?this.perspCamera.zoom=e:this.orthoCamera.zoom=e)}},{key:"getTarget",value:function(e){var t=this.getWorldDirection(new r.Vector3).multiplyScalar(this.targetOffset);return e.copy(this.position).add(t),e}},{key:"getViewFrontToObject",value:function(e){var t=e.getWorldPosition(new r.Vector3),i=e.getWorldDirection(new r.Vector3).multiplyScalar(this.targetOffset);return{position:t.clone().add(i),target:t}}},{key:"getViewToObject",value:function(e){var t=e.getWorldPosition(new r.Vector3),i=this.getWorldDirection(new r.Vector3).multiplyScalar(this.targetOffset);return{position:t.clone().sub(i),target:t}}},{key:"setViewplaneSize",value:function(e,t){this.left=.5*-e,this.right=.5*e,this.top=.5*t,this.bottom=.5*-t,this.aspect=e/t,this.updateProjectionMatrix()}},{key:"toOrthographic",value:function(e){this.orthoCamera.left=this.left,this.orthoCamera.right=this.right,this.orthoCamera.top=this.top,this.orthoCamera.bottom=this.bottom,this.orthoCamera.view=this.view,this.orthoCamera.far=this.far,this.orthoCamera.updateProjectionMatrix(),this.projectionMatrix=this.orthoCamera.projectionMatrix,this.projectionMatrixInverse=this.orthoCamera.projectionMatrixInverse,this._cameraType="OrthographicCamera",!0!==this.enableHelper&&!0!==e||this.objectHelper.update()}},{key:"toPerspective",value:function(e){this.perspCamera.aspect=this.aspect,this.perspCamera.fov=this.fov,this.perspCamera.view=this.view,this.perspCamera.far=this.far,this.perspCamera.updateProjectionMatrix(),this.projectionMatrix=this.perspCamera.projectionMatrix,this.projectionMatrixInverse=this.perspCamera.projectionMatrixInverse,this._cameraType="PerspectiveCamera",!0!==this.enableHelper&&!0!==e||this.objectHelper.update()}},{key:"setFocalLength",value:function(e){this.perspCamera.setFocalLength(e),this.toPerspective()}},{key:"getFocalLength",value:function(){return this.perspCamera.getFocalLength()}},{key:"getEffectiveFOV",value:function(){return this.perspCamera.getEffectiveFOV()}},{key:"getFilmWidth",value:function(){return this.perspCamera.getFilmWidth()}},{key:"getFilmHeight",value:function(){return this.perspCamera.getFilmHeight()}},{key:"setViewOffset",value:function(e,t,r,i,n,s){"PerspectiveCamera"===this._cameraType?this.perspCamera.setViewOffset(e,t,r,i,n,s):this.orthoCamera.setViewOffset(e,t,r,i,n,s)}},{key:"clearViewOffset",value:function(){"PerspectiveCamera"===this._cameraType?(this.perspCamera.clearViewOffset(),this.toPerspective()):(this.orthoCamera.clearViewOffset(),this.toOrthographic())}},{key:"updateProjectionMatrix",value:function(e){"PerspectiveCamera"===this._cameraType?this.toPerspective(e):"OrthographicCamera"===this._cameraType&&this.toOrthographic(e)}},{key:"updateMatrixWorld",value:function(e){Object(v.a)(Object(E.a)(n.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,t){Object(v.a)(Object(E.a)(n.prototype),"updateWorldMatrix",this).call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"raycast",value:function(e,t){this.enableHelper&&this.objectHelper.visible&&this.objectHelper.raycast(e,t)}},{key:"copy",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e,t),this.orthoCamera.copy(e.orthoCamera),this.perspCamera.copy(e.perspCamera),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.far=e.far,this.view=null===e.view?null:Object.assign({},e.view),this._cameraType=e._cameraType,this.aspect=e.aspect,this.fov=e.fov,this.focus=e.focus,this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this.targetOffset=e.targetOffset,this.updateProjectionMatrix(),this}},{key:"fromCameraRender",value:function(e){var t={near:this.orthoCamera.near,far:this.orthoCamera.far},r={near:this.perspCamera.near,far:this.perspCamera.far};return this.copy(e),this.name="",this.isEntity=!0,this.enableHelper=!0,this.objectHelper.visible=!0,this.orthoCamera.near=t.near,this.orthoCamera.far=t.far,this.perspCamera.near=r.near,this.perspCamera.far=r.far,this.updateProjectionMatrix(),this}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),r=t.object;return r.objectType="CombinedCamera",r.cameraType=this.cameraType,r.targetOffset=this.targetOffset,r.left=this.left,r.right=this.right,r.top=this.top,r.bottom=this.bottom,null!==this.view&&(r.view=Object.assign({},this.view)),r.zoomOrtho=this.orthoCamera.zoom,r.nearOrtho=this.orthoCamera.near,r.far=this.far,r.aspect=this.aspect,r.fov=this.fov,r.focus=this.focus,r.filmGauge=this.filmGauge,r.filmOffset=this.filmOffset,r.zoomPersp=this.perspCamera.zoom,r.nearPersp=this.perspCamera.near,t}},{key:"fromJSON",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),this.cameraType=e.cameraType,void 0!==e.targetOffset&&(this.targetOffset=e.targetOffset),void 0!==e.left&&(this.left=e.left),void 0!==e.right&&(this.right=e.right),void 0!==e.top&&(this.top=e.top),void 0!==e.bottom&&(this.bottom=e.bottom),void 0!==e.view&&(this.view=Object.assign({},e.view)),void 0!==e.zoomOrtho&&(this.orthoCamera.zoom=e.zoomOrtho),void 0!==e.nearOrtho&&(this.orthoCamera.near=e.nearOrtho),void 0!==e.far&&(this.far=e.far),void 0!==e.aspect&&(this.aspect=e.aspect),void 0!==e.fov&&(this.fov=e.fov),void 0!==e.focus&&(this.focus=e.focus),void 0!==e.filmGauge&&(this.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(this.filmOffset=e.filmOffset),void 0!==e.zoomPersp&&(this.perspCamera.zoom=e.zoomPersp),void 0!==e.nearPersp&&(this.perspCamera.near=e.nearPersp),this.updateProjectionMatrix(),this}}]),n}(Qi(Bi(r.Camera),Ii)),Wi=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e;return Object(A.a)(this,r),(e=t.apply(this,arguments)).objectType="EmptyObject",e}return Object(w.a)(r,[{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e);return t.object.objectType="EmptyObject",t}}]),r}(Qi(Bi(r.Group),Pi)),Xi=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;Object(A.a)(this,n);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];(e=t.call.apply(t,[this].concat(l))).objectType="LightDirectional",e._gizmos={},e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024;var h=e.shadow.camera;h.top=1250,h.bottom=-1250,h.right=1250,h.left=-1250,h.near=1,h.far=2500;var i=new r.CameraHelper(e.shadow.camera);return i.visible=!1,e._gizmos.shadowmap=i,e.update(),e}return Object(w.a)(n,[{key:"gizmos",get:function(){return this._gizmos}},{key:"showGizmos",value:function(){for(var e in this._gizmos){var t=this._gizmos[e];t instanceof r.CameraHelper&&(t.visible=!0)}}},{key:"hideGizmos",value:function(){for(var e in this._gizmos){var t=this._gizmos[e];t instanceof r.CameraHelper&&(t.visible=!1)}}},{key:"update",value:function(){for(var e in this.shadow.camera.updateProjectionMatrix(),this._gizmos){var t=this._gizmos[e];t instanceof r.CameraHelper&&t.update()}}},{key:"updateMatrixWorld",value:function(e){Object(v.a)(Object(E.a)(n.prototype),"updateMatrixWorld",this).call(this,e),!0===this.enableHelper&&!0===this.objectHelper.visible&&this.objectHelper.update()}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),r=t.object;return r.objectType="LightDirectional",r.color=this.color.getHex(),r.intensity=this.intensity,r.shadow=this.shadow.toJSON(),t}},{key:"fromJSON",value:function(e){var t;Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),this.color.set(e.color),this.intensity=e.intensity,this.shadow.normalBias=null!==(t=e.shadow.normalBias)&&void 0!==t?t:0,this.shadow.radius=e.shadow.radius,this.shadow.mapSize.fromArray(e.shadow.mapSize);var r=this.shadow.camera,i=e.shadow.camera;return r.near=i.near,r.far=i.far,r.zoom=i.zoom,r.left=i.left,r.right=i.right,r.top=i.top,r.bottom=i.bottom,void 0!==i.view&&(r.view=Object.assign({},i.view)),this}}]),n}(Qi(Bi(r.DirectionalLight),ji)),Ki=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;Object(A.a)(this,n);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];(e=t.call.apply(t,[this].concat(l))).objectType="LightPoint",e._gizmos={},e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024;var h=e.shadow.camera;h.fov=90,h.aspect=1,h.near=100,h.far=2500;var i=new r.Vector3(-h.far+e.position.x,-h.far+e.position.y,-h.far+e.position.z),d=new r.Vector3(h.far+e.position.x,h.far+e.position.y,h.far+e.position.z),s=new r.Box3(i,d),f=new r.Box3Helper(s,new r.Color(16755200));return f.visible=!1,e._gizmos.shadowmap=f,e.update(),e}return Object(w.a)(n,[{key:"gizmos",get:function(){return this._gizmos}},{key:"showGizmos",value:function(){for(var e in this._gizmos){var t=this._gizmos[e];t instanceof r.Box3Helper&&(t.visible=!0)}}},{key:"hideGizmos",value:function(){for(var e in this._gizmos){var t=this._gizmos[e];t instanceof r.Box3Helper&&(t.visible=!1)}}},{key:"update",value:function(){if(this.shadow&&(this.shadow.camera.updateProjectionMatrix(),this._gizmos))for(var e in this._gizmos){var t=this._gizmos[e];if(t instanceof r.Box3Helper){var n=this.shadow.camera,o=new r.Vector3(-n.far+this.position.x,-n.far+this.position.y,-n.far+this.position.z),l=new r.Vector3(n.far+this.position.x,n.far+this.position.y,n.far+this.position.z);t.box.set(o,l),t.updateMatrixWorld(!0)}}}},{key:"updateMatrixWorld",value:function(e){Object(v.a)(Object(E.a)(n.prototype),"updateWorldMatrix",this).call(this,e),!0===this.enableHelper&&!0===this.objectHelper.visible&&this.objectHelper.update()}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),r=t.object;return r.objectType="LightPoint",r.color=this.color.getHex(),r.intensity=this.intensity,r.distance=this.distance,r.decay=this.decay,r.shadow=this.shadow.toJSON(),t}},{key:"fromJSON",value:function(e){var t;Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),this.color.set(e.color),this.intensity=e.intensity,this.distance=e.distance,this.decay=e.decay,this.shadow.normalBias=null!==(t=e.shadow.normalBias)&&void 0!==t?t:0,this.shadow.radius=e.shadow.radius,this.shadow.mapSize.fromArray(e.shadow.mapSize);var r=this.shadow.camera,i=e.shadow.camera;return r.near=i.near,r.far=i.far,r.zoom=i.zoom,r.fov=i.fov,r.focus=i.focus,r.aspect=i.aspect,r.filmGauge=i.filmGauge,r.filmOffset=i.filmOffset,void 0!==i.view&&(r.view=Object.assign({},i.view)),this}}]),n}(Qi(Bi(r.PointLight),Ri)),qi=new r.Vector3,Zi=new r.Vector3,$i=new r.Quaternion,ea=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;Object(A.a)(this,n);for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];(e=t.call.apply(t,[this].concat(l))).objectType="LightSpot",e._gizmos={},e.shadow.mapSize.width=1024,e.shadow.mapSize.height=1024;var h=e.shadow.camera;h.fov=2*r.MathUtils.RAD2DEG*e.angle,h.aspect=1,h.near=100,h.far=2500;var i=new r.CameraHelper(e.shadow.camera);return i.visible=!1,e._gizmos.shadowmap=i,e.update(),e}return Object(w.a)(n,[{key:"gizmos",get:function(){return this._gizmos}},{key:"showGizmos",value:function(){for(var e in this._gizmos){var t=this._gizmos[e];t instanceof r.CameraHelper&&(t.visible=!0)}}},{key:"hideGizmos",value:function(){for(var e in this._gizmos){var t=this._gizmos[e];t instanceof r.CameraHelper&&(t.visible=!1)}}},{key:"update",value:function(){for(var e in this.shadow.camera.updateProjectionMatrix(),this._gizmos){var t=this._gizmos[e];t instanceof r.CameraHelper&&t.update()}}},{key:"updateMatrixWorld",value:function(e){Object(v.a)(Object(E.a)(n.prototype),"updateWorldMatrix",this).call(this,e),Zi.setFromMatrixPosition(this.matrixWorld),$i.setFromRotationMatrix(this.matrixWorld),qi.copy(this.up).applyQuaternion($i).negate().multiplyScalar(this.distance),this.target.position.copy(Zi).add(qi),this.target.updateMatrixWorld(),!0===this.enableHelper&&!0===this.objectHelper.visible&&this.objectHelper.update()}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),r=t.object;return r.objectType="LightSpot",r.color=this.color.getHex(),r.intensity=this.intensity,r.distance=this.distance,r.angle=this.angle,r.decay=this.decay,r.penumbra=this.penumbra,r.shadow=this.shadow.toJSON(),t}},{key:"fromJSON",value:function(e){var t;Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),this.color.set(e.color),this.intensity=e.intensity,this.distance=e.distance,this.angle=e.angle,this.decay=e.decay,this.penumbra=e.penumbra,this.shadow.normalBias=null!==(t=e.shadow.normalBias)&&void 0!==t?t:0,this.shadow.radius=e.shadow.radius,this.shadow.mapSize.fromArray(e.shadow.mapSize);var r=this.shadow.camera,i=e.shadow.camera;return r.near=i.near,r.far=i.far,r.zoom=i.zoom,r.fov=i.fov,r.focus=i.focus,r.aspect=i.aspect,r.filmGauge=i.filmGauge,r.filmOffset=i.filmOffset,void 0!==i.view&&(r.view=Object.assign({},i.view)),this}}]),n}(Qi(Bi(r.SpotLight),zi)),ta=function(e){return"VIDEO"===e.tagName},ra=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"resize",value:function(e,t,r){var n,i=e/t;if(r.image){var s=r.image;i>(n=ta(s)?s.videoWidth/s.videoHeight:s.width/s.height)&&("WEBCAM"==r.imageType?r.repeat.set(-1,1*n/i):r.repeat.set(1,1*n/i)),i<n&&("WEBCAM"==r.imageType?r.repeat.set(1*i/n*-1,1):r.repeat.set(1*i/n,1)),i==n&&("WEBCAM"==r.imageType?r.repeat.set(-1,1):r.repeat.set(1,1))}}},{key:"resizeTextureLayer",value:function(e,t,r){var s,i=e/t,n=void 0!==r.image?r.image.width/r.image.height:1;s=i>n?{x:1,y:n/i}:i<n?{x:i/n,y:1}:{x:1,y:1},r.repeat.set(s.x,s.y),r.updateMatrix()}},{key:"resizeTextureLayers",value:function(t,r,n){for(var i=n.userData.layers,o=i.getLayers(),l=0;l<o.length;l++){var s=o[l];Ct(s)&&(e.resizeTextureLayer(t,r,s.uniforms["f".concat(s.id,"_texture")].value),i.updateLayerUniform())}}},{key:"resizeComplex",value:function(e,t,r,i){var s,n=e/t,o=r.image;s=ta(o)?o.videoWidth/o.videoHeight:o.width/o.height,i.geometry.type.includes("Shape")?(n>s&&("WEBCAM"==r.imageType?r.repeat.set(1/e*-1,1/t*s/n):r.repeat.set(1/e,1/t*s/n)),n<s&&("WEBCAM"==r.imageType?r.repeat.set(1/e*n/s*-1,1/t):r.repeat.set(1/e*n/s,1/t)),n==s&&("WEBCAM"==r.imageType?r.repeat.set(1/e*-1,1/t):r.repeat.set(1/e,1/t))):(n>s&&("WEBCAM"==r.imageType?r.repeat.set(-1,1*s/n):r.repeat.set(1,1*s/n)),n<s&&("WEBCAM"==r.imageType?r.repeat.set(1*n/s*-1,1):r.repeat.set(1*n/s,1)),n==s&&("WEBCAM"==r.imageType?r.repeat.set(-1,1):r.repeat.set(1,1)))}}]),e}(),na=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jr;return Object(A.a)(this,n),(r=t.call(this,e,o)).objectType="Mesh2D",r.castShadow=!0,r.receiveShadow=!0,r}return Object(w.a)(n,[{key:"updateGeometry",value:function(e){Object(v.a)(Object(E.a)(n.prototype),"updateGeometry",this).call(this,e),this.material.userData.layers&&ra.resizeTextureLayers(this.geometry.userData.parameters.width,this.geometry.userData.parameters.height,this.material)}},{key:"resizeGeometry",value:function(e,t){Object(v.a)(Object(E.a)(n.prototype),"resizeGeometry",this).call(this,e,t,0),this.material.userData.layers&&ra.resizeTextureLayers(this.geometry.userData.parameters.width,this.geometry.userData.parameters.height,this.material)}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e);return t.object.objectType="Mesh2D",t}}],[{key:"fromTexture",value:function(e){var t,i;if(e instanceof r.VideoTexture){var o=e.image;t=.5*o.videoWidth,i=.5*o.videoHeight}else{var l=e.image;t=.5*l.width,i=.5*l.height}var c=it.create({parameters:{width:t,height:i}}),s=new jr;return s.layersList.changeLayer(0,{type:lt.TEXTURE,texture:e}),s.layersList.moveLayer(0,1),s.dispose(),new n(c,s)}}]),n}(ki),ia=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Rr;return Object(A.a)(this,r),(n=t.call(this,e,o)).objectType="Mesh3D",n.castShadow=!0,n.receiveShadow=!0,n}return Object(w.a)(r,[{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e);return t.object.objectType="Mesh3D",t}}]),r}(ki),aa=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Rr;return Object(A.a)(this,r),(n=t.call(this,e,o)).objectType="NonParametric",n}return Object(w.a)(r,[{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e);return t.object.objectType="NonParametric",t}}]),r}(ia),oa=function(){function e(t,i,n){var o=this;Object(A.a)(this,e),this.isEnable=!1,this._enableEvent={},this._map={},this._prevAncestors=[],this._raycaster=new O,this._intersection=new r.Vector3,this._plane=new r.Plane,this._normal=new r.Vector3,this._position=new r.Vector3,this._onMouseDown=function(e){o._raycaster.setFromCamera(o._getPointer(e.clientX,e.clientY),o._camera),o._handleMouseDownEvent()},this._onMouseUp=function(e){o._raycaster.setFromCamera(o._getPointer(e.clientX,e.clientY),o._camera),o._handleMouseUpEvent()},this._onMouseMove=function(e){o._raycaster.setFromCamera(o._getPointer(e.clientX,e.clientY),o._camera),o._camera.getWorldDirection(o._normal),o._normal.negate(),o._handleMouseHoverEvent(),o._handleLookAtEvent(),o._handleFollowEvent()},this._onTouchStart=function(e){1===e.touches.length&&(e.preventDefault(),o._raycaster.setFromCamera(o._getPointer(e.touches[0].clientX,e.touches[0].clientY),o._camera),o._camera.getWorldDirection(o._normal),o._normal.negate(),o._handleMouseDownEvent(),o._handleMouseHoverEvent(),o._handleLookAtEvent(),o._handleFollowEvent())},this._onTouchEnd=function(){o._handleMouseUpEvent(),o._handleMouseHoverEvent(!0)},this._onTouchMove=function(e){1===e.touches.length&&(e.preventDefault(),e.stopPropagation(),o._raycaster.setFromCamera(o._getPointer(e.touches[0].clientX,e.touches[0].clientY),o._camera),o._camera.getWorldDirection(o._normal),o._normal.negate(),o._handleMouseHoverEvent(),o._handleLookAtEvent(),o._handleFollowEvent())},this._onKeyDown=function(e){o._handleKeyDownEvent(e.key)},this._onKeyUp=function(e){o._handleKeyUpEvent(e.key)},this._domElement=t,this._scene=i,this._camera=n}return Object(w.a)(e,[{key:"activate",value:function(){var e=this;this.isEnable=!0,this._scene.traverseEntity((function(t){if(void 0!==t.interaction){t.interaction.start();var r,n=C(t.interaction.events);try{for(n.s();!(r=n.n()).done;){var o=r.value.type;e._enableEvent[o]=!0,o!==qr.KEY_DOWN&&o!==qr.KEY_UP&&o!==qr.START&&o!==qr.LOOK_AT&&o!==qr.FOLLOW||(void 0===e._map[o]&&(e._map[o]=[]),e._map[o].push(t))}}catch(e){n.e(e)}finally{n.f()}}})),void 0!==this._enableEvent[qr.START]&&this._handleStartEvent(),void 0!==this._enableEvent[qr.MOUSE_DOWN]&&(this._domElement.addEventListener("pointerdown",this._onMouseDown,!1),this._domElement.addEventListener("touchstart",this._onTouchStart,!1)),void 0!==this._enableEvent[qr.MOUSE_UP]&&(this._domElement.addEventListener("pointerup",this._onMouseUp,!1),this._domElement.addEventListener("touchend",this._onTouchEnd,!1)),void 0===this._enableEvent[qr.MOUSE_HOVER]&&void 0===this._enableEvent[qr.LOOK_AT]&&void 0===this._enableEvent[qr.FOLLOW]||(this._domElement.addEventListener("pointermove",this._onMouseMove,!1),this._domElement.addEventListener("touchstart",this._onTouchStart,!1),this._domElement.addEventListener("touchend",this._onTouchEnd,!1),this._domElement.addEventListener("touchmove",this._onTouchMove,!1)),void 0!==this._enableEvent[qr.KEY_DOWN]&&document.addEventListener("keydown",this._onKeyDown,!1),void 0!==this._enableEvent[qr.KEY_UP]&&document.addEventListener("keyup",this._onKeyUp,!1)}},{key:"deactivate",value:function(){this._scene.traverseEntity((function(e){void 0!==e.interaction&&e.interaction.end(),e.interaction.cache=void 0})),this._domElement.removeEventListener("pointerdown",this._onMouseDown),this._domElement.removeEventListener("pointerup",this._onMouseUp),this._domElement.removeEventListener("pointermove",this._onMouseMove),this._domElement.removeEventListener("touchstart",this._onTouchStart),this._domElement.removeEventListener("touchend",this._onTouchEnd),this._domElement.removeEventListener("touchmove",this._onTouchMove),document.removeEventListener("keydown",this._onKeyDown),document.removeEventListener("keyup",this._onKeyUp),this._enableEvent={},this._map={},this.isEnable=!1}},{key:"reset",value:function(){this._scene.traverseEntity((function(e){e.interaction.start()})),this._handleStartEvent()}},{key:"_getPointer",value:function(e,t){var r=this._domElement.getBoundingClientRect();return{x:(e-r.left)/r.width*2-1,y:-(t-r.top)/r.height*2+1}}},{key:"_handleStartEvent",value:function(){var e;null===(e=this._map[qr.START])||void 0===e||e.forEach((function(e){var t;null===(t=e.interactionCache.start)||void 0===t||t.dispatch()}))}},{key:"_handleMouseDownEvent",value:function(){for(var e,t=this._raycastMesh(this._raycaster),r=0,n=t.length;r<n;++r){var o=t[r].object;if(null===(e=o.interactionCache.mouseDown)||void 0===e||e.dispatch(),o.traverseAncestors((function(e){var t;e instanceof Wi&&(null===(t=e.interactionCache.mouseDown)||void 0===t||t.dispatch())})),!o.interactionCache.follow)break}}},{key:"_handleMouseUpEvent",value:function(){for(var e,t=this._raycastMesh(this._raycaster),r=0,n=t.length;r<n;++r){var o=t[r].object;if(null===(e=o.interactionCache.mouseUp)||void 0===e||e.dispatch(),o.traverseAncestors((function(e){var t;e instanceof Wi&&(null===(t=e.interactionCache.mouseUp)||void 0===t||t.dispatch())})),!o.interactionCache.follow)break}}},{key:"_handleMouseHoverEvent",value:function(){var e,t,r=this,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(void 0!==this._enableEvent[qr.MOUSE_HOVER]){var o;if(!n){var l=this._raycastMesh(this._raycaster).find((function(e){return!e.object.interactionCache.follow}));o=l?l.object:void 0}if(this._prevObject!==o){void 0!==this._prevObject&&(null===(e=this._prevObject.interactionCache.mouseHover)||void 0===e||e.dispatchReverse()),void 0!==o&&(null===(t=o.interactionCache.mouseHover)||void 0===t||t.dispatch());var c=[];null==o||o.traverseAncestors((function(e){e instanceof Wi&&e.interactionCache.mouseHover&&c.push(e)})),this._prevAncestors.filter((function(e){var t;return!c.includes(e)&&(null===(t=e.interactionCache.mouseHover)||void 0===t||t.dispatchReverse(),!0)}));var h=c.filter((function(e){var t;return!r._prevAncestors.includes(e)&&(null===(t=e.interactionCache.mouseHover)||void 0===t||t.dispatch(),!0)})),s=this._prevAncestors.filter((function(e){return c.includes(e)}));this._prevAncestors=[].concat(Object(y.a)(s),Object(y.a)(h))}this._prevObject=o}}},{key:"_handleLookAtEvent",value:function(){var e,t=this;null===(e=this._map[qr.LOOK_AT])||void 0===e||e.forEach((function(e){var r,n=null===(r=e.interactionCache.lookAt)||void 0===r?void 0:r.distance;void 0!==n&&(t._plane.set(t._normal,-n),t._raycaster.ray.intersectPlane(t._plane,t._intersection),e.interaction.lookAt(t._intersection))}))}},{key:"_handleFollowEvent",value:function(){var e,t=this;null===(e=this._map[qr.FOLLOW])||void 0===e||e.forEach((function(e){t._plane.setFromNormalAndCoplanarPoint(t._normal,e.getWorldPosition(t._position)),t._raycaster.ray.intersectPlane(t._plane,t._intersection),e.interaction.follow(t._intersection)}))}},{key:"_handleKeyDownEvent",value:function(e){var t;null===(t=this._map[qr.KEY_DOWN])||void 0===t||t.forEach((function(t){var r,i=null===(r=t.interactionCache.keyDown)||void 0===r?void 0:r.find((function(t){return t.key===e}));null==i||i.dispatch()}))}},{key:"_handleKeyUpEvent",value:function(e){var t;null===(t=this._map[qr.KEY_UP])||void 0===t||t.forEach((function(t){var r,i=null===(r=t.interactionCache.keyUp)||void 0===r?void 0:r.find((function(t){return t.key===e}));null==i||i.dispatch()}))}},{key:"_raycastMesh",value:function(e){var t=[];return function r(i){var n,o=C(i.children);try{for(o.s();!(n=o.n()).done;){var l=n.value;Ci(l)&&!l.raycastLock&&l.visible&&(Di(l)&&e.intersectObject(l,!1,t),r(l))}}catch(e){o.e(e)}finally{o.f()}}(this._scene),t}}]),e}(),sa="varying vec2 vUv;void main(){vUv=position.xy*0.5+0.5;gl_Position=vec4(position.xy,1.0,1.0);}",ua=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object(A.a)(this,n),(e=t.call(this,{type:"BokehMaterial",defines:{PASS:o?"2":"1"},uniforms:{kernel64:new r.Uniform(null),kernel16:new r.Uniform(null),inputBuffer:new r.Uniform(null),cocBuffer:new r.Uniform(null),texelSize:new r.Uniform(new r.Vector2),scale:new r.Uniform(1)},fragmentShader:"uniform sampler2D inputBuffer;uniform sampler2D cocBuffer;uniform vec2 texelSize;uniform float scale;\n#if PASS == 1\nuniform vec4 kernel64[32];\n#else\nuniform vec4 kernel16[8];\n#endif\nvarying vec2 vUv;void main(){\n#ifdef FOREGROUND\nvec2 CoCNearFar=texture2D(cocBuffer,vUv).rg;float CoC=CoCNearFar.r*scale;\n#else\nfloat CoC=texture2D(cocBuffer,vUv).g*scale;\n#endif\nif(CoC==0.0){gl_FragColor=texture2D(inputBuffer,vUv);}else{\n#ifdef FOREGROUND\nvec2 step=texelSize*max(CoC,CoCNearFar.g*scale);\n#else\nvec2 step=texelSize*CoC;\n#endif\n#if PASS == 1\nvec4 acc=vec4(0.0);for(int i=0;i<32;++i){vec4 kernel=kernel64[i];vec2 uv=step*kernel.xy+vUv;acc+=texture2D(inputBuffer,uv);uv=step*kernel.zw+vUv;acc+=texture2D(inputBuffer,uv);}gl_FragColor=acc/64.0;\n#else\nvec4 maxValue=texture2D(inputBuffer,vUv);for(int i=0;i<8;++i){vec4 kernel=kernel16[i];vec2 uv=step*kernel.xy+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);uv=step*kernel.zw+vUv;maxValue=max(texture2D(inputBuffer,uv),maxValue);}gl_FragColor=maxValue;\n#endif\n}}",vertexShader:sa,blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,l&&(e.defines.FOREGROUND="1"),e.generateKernel(),e}return Object(w.a)(n,[{key:"generateKernel",value:function(){for(var e=new Float32Array(128),t=new Float32Array(32),i=0,n=0,o=0;o<80;++o){var l=2.39996323*o,c=Math.sqrt(o)/Math.sqrt(80),a=c*Math.cos(l),h=c*Math.sin(l);o%5==0?(t[n++]=a,t[n++]=h):(e[i++]=a,e[i++]=h)}for(var s=[],d=[],f=0;f<128;)s.push(new r.Vector4(e[f++],e[f++],e[f++],e[f++]));for(var v=0;v<32;)d.push(new r.Vector4(t[v++],t[v++],t[v++],t[v++]));this.uniforms.kernel64.value=s,this.uniforms.kernel16.value=d}},{key:"setTexelSize",value:function(e,t){this.uniforms.texelSize.value.set(e,t)}}]),n}(r.ShaderMaterial),la=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o;return Object(A.a)(this,n),(o=t.call(this,{type:"CircleOfConfusionMaterial",defines:{DEPTH_PACKING:"0"},uniforms:{depthBuffer:new r.Uniform(null),focusDistance:new r.Uniform(0),focalLength:new r.Uniform(0),cameraNear:new r.Uniform(.3),cameraFar:new r.Uniform(1e3)},fragmentShader:"#include <common>\n#include <packing>\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform float focusDistance;uniform float focalLength;uniform float cameraNear;uniform float cameraFar;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}void main(){float depth=readDepth(vUv);\n#ifdef PERSPECTIVE_CAMERA\nfloat viewZ=perspectiveDepthToViewZ(depth,cameraNear,cameraFar);float linearDepth=viewZToOrthographicDepth(viewZ,cameraNear,cameraFar);\n#else\nfloat linearDepth=depth;\n#endif\nfloat signedDistance=linearDepth-focusDistance;float magnitude=smoothstep(0.0,focalLength,abs(signedDistance));gl_FragColor.rg=vec2(step(signedDistance,0.0)*magnitude,step(0.0,signedDistance)*magnitude);}",vertexShader:sa,blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,o.adoptCameraSettings(e),o}return Object(w.a)(n,[{key:"depthPacking",get:function(){return Number(this.defines.DEPTH_PACKING)},set:function(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}},{key:"adoptCameraSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof r.PerspectiveCamera?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}}]),n}(r.ShaderMaterial),ca=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Vector2;return Object(A.a)(this,n),(e=t.call(this,{type:"ConvolutionMaterial",uniforms:{inputBuffer:new r.Uniform(null),texelSize:new r.Uniform(new r.Vector2),halfTexelSize:new r.Uniform(new r.Vector2),kernel:new r.Uniform(0),scale:new r.Uniform(1)},fragmentShader:"#include <common>\n#include <dithering_pars_fragment>\nuniform sampler2D inputBuffer;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec4 sum=texture2D(inputBuffer,vUv0);sum+=texture2D(inputBuffer,vUv1);sum+=texture2D(inputBuffer,vUv2);sum+=texture2D(inputBuffer,vUv3);gl_FragColor=sum*0.25;\n#include <dithering_fragment>\n}",vertexShader:"uniform vec2 texelSize;uniform vec2 halfTexelSize;uniform float kernel;uniform float scale;varying vec2 vUv0;varying vec2 vUv1;varying vec2 vUv2;varying vec2 vUv3;void main(){vec2 uv=position.xy*0.5+0.5;vec2 dUv=(texelSize*vec2(kernel)+halfTexelSize)*scale;vUv0=vec2(uv.x-dUv.x,uv.y+dUv.y);vUv1=vec2(uv.x+dUv.x,uv.y+dUv.y);vUv2=vec2(uv.x+dUv.x,uv.y-dUv.y);vUv3=vec2(uv.x-dUv.x,uv.y-dUv.y);gl_Position=vec4(position.xy,1.0,1.0);}",blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e.setTexelSize(o.x,o.y),e.kernelSize=da.LARGE,e}return Object(w.a)(n,[{key:"getKernel",value:function(){return ha[this.kernelSize]}},{key:"setTexelSize",value:function(e,t){this.uniforms.texelSize.value.set(e,t),this.uniforms.halfTexelSize.value.set(e,t).multiplyScalar(.5)}}]),n}(r.ShaderMaterial),ha=[new Float32Array([0,0]),new Float32Array([0,1,1]),new Float32Array([0,1,1,2]),new Float32Array([0,1,2,2,3]),new Float32Array([0,1,2,3,4,4,5]),new Float32Array([0,1,2,3,4,5,7,8,9,10])],da={VERY_SMALL:0,SMALL:1,MEDIUM:2,LARGE:3,VERY_LARGE:4,HUGE:5},fa=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,{type:"CopyMaterial",uniforms:{inputBuffer:new r.Uniform(null),opacity:new r.Uniform(1)},fragmentShader:"uniform sampler2D inputBuffer;uniform float opacity;varying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);gl_FragColor=opacity*texel;\n#include <encodings_fragment>\n}",vertexShader:sa,blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e}return n}(r.ShaderMaterial),va=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Vector2,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pa.COLOR;return Object(A.a)(this,n),(e=t.call(this,{type:"EdgeDetectionMaterial",defines:{LOCAL_CONTRAST_ADAPTATION_FACTOR:"2.0",EDGE_THRESHOLD:"0.1",DEPTH_THRESHOLD:"0.01",PREDICATION_MODE:"0",PREDICATION_THRESHOLD:"0.01",PREDICATION_SCALE:"2.0",PREDICATION_STRENGTH:"1.0",DEPTH_PACKING:"0"},uniforms:{inputBuffer:new r.Uniform(null),depthBuffer:new r.Uniform(null),predicationBuffer:new r.Uniform(null),texelSize:new r.Uniform(o)},fragmentShader:"varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\n#if EDGE_DETECTION_MODE == 1\n#include <common>\n#endif\n#if EDGE_DETECTION_MODE == 0 || PREDICATION_MODE == 1\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nfloat readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}vec3 gatherNeighbors(){float p=readDepth(vUv);float pLeft=readDepth(vUv0);float pTop=readDepth(vUv1);return vec3(p,pLeft,pTop);}\n#elif PREDICATION_MODE == 2\nuniform sampler2D predicationBuffer;vec3 gatherNeighbors(){float p=texture2D(predicationBuffer,vUv).r;float pLeft=texture2D(predicationBuffer,vUv0).r;float pTop=texture2D(predicationBuffer,vUv1).r;return vec3(p,pLeft,pTop);}\n#endif\n#if PREDICATION_MODE != 0\nvec2 calculatePredicatedThreshold(){vec3 neighbours=gatherNeighbors();vec2 delta=abs(neighbours.xx-neighbours.yz);vec2 edges=step(PREDICATION_THRESHOLD,delta);return PREDICATION_SCALE*EDGE_THRESHOLD*(1.0-PREDICATION_STRENGTH*edges);}\n#endif\n#if EDGE_DETECTION_MODE != 0\nuniform sampler2D inputBuffer;\n#endif\nvoid main(){\n#if EDGE_DETECTION_MODE == 0\nconst vec2 threshold=vec2(DEPTH_THRESHOLD);\n#elif PREDICATION_MODE != 0\nvec2 threshold=calculatePredicatedThreshold();\n#else\nconst vec2 threshold=vec2(EDGE_THRESHOLD);\n#endif\n#if EDGE_DETECTION_MODE == 0\nvec3 neighbors=gatherNeighbors();vec2 delta=abs(neighbors.xx-vec2(neighbors.y,neighbors.z));vec2 edges=step(threshold,delta);if(dot(edges,vec2(1.0))==0.0){discard;}gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 1\nfloat l=linearToRelativeLuminance(texture2D(inputBuffer,vUv).rgb);float lLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv0).rgb);float lTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv1).rgb);vec4 delta;delta.xy=abs(l-vec2(lLeft,lTop));vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}float lRight=linearToRelativeLuminance(texture2D(inputBuffer,vUv2).rgb);float lBottom=linearToRelativeLuminance(texture2D(inputBuffer,vUv3).rgb);delta.zw=abs(l-vec2(lRight,lBottom));vec2 maxDelta=max(delta.xy,delta.zw);float lLeftLeft=linearToRelativeLuminance(texture2D(inputBuffer,vUv4).rgb);float lTopTop=linearToRelativeLuminance(texture2D(inputBuffer,vUv5).rgb);delta.zw=abs(vec2(lLeft,lTop)-vec2(lLeftLeft,lTopTop));maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges.xy*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#elif EDGE_DETECTION_MODE == 2\nvec4 delta;vec3 c=texture2D(inputBuffer,vUv).rgb;vec3 cLeft=texture2D(inputBuffer,vUv0).rgb;vec3 t=abs(c-cLeft);delta.x=max(max(t.r,t.g),t.b);vec3 cTop=texture2D(inputBuffer,vUv1).rgb;t=abs(c-cTop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0))==0.0){discard;}vec3 cRight=texture2D(inputBuffer,vUv2).rgb;t=abs(c-cRight);delta.z=max(max(t.r,t.g),t.b);vec3 cBottom=texture2D(inputBuffer,vUv3).rgb;t=abs(c-cBottom);delta.w=max(max(t.r,t.g),t.b);vec2 maxDelta=max(delta.xy,delta.zw);vec3 cLeftLeft=texture2D(inputBuffer,vUv4).rgb;t=abs(c-cLeftLeft);delta.z=max(max(t.r,t.g),t.b);vec3 cTopTop=texture2D(inputBuffer,vUv5).rgb;t=abs(c-cTopTop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(maxDelta.xy,delta.zw);float finalDelta=max(maxDelta.x,maxDelta.y);edges*=step(finalDelta,LOCAL_CONTRAST_ADAPTATION_FACTOR*delta.xy);gl_FragColor=vec4(edges,0.0,1.0);\n#endif\n}",vertexShader:"uniform vec2 texelSize;varying vec2 vUv;varying vec2 vUv0;varying vec2 vUv1;\n#if EDGE_DETECTION_MODE != 0\nvarying vec2 vUv2;varying vec2 vUv3;varying vec2 vUv4;varying vec2 vUv5;\n#endif\nvoid main(){vUv=position.xy*0.5+0.5;vUv0=vUv+texelSize*vec2(-1.0,0.0);vUv1=vUv+texelSize*vec2(0.0,-1.0);\n#if EDGE_DETECTION_MODE != 0\nvUv2=vUv+texelSize*vec2(1.0,0.0);vUv3=vUv+texelSize*vec2(0.0,1.0);vUv4=vUv+texelSize*vec2(-2.0,0.0);vUv5=vUv+texelSize*vec2(0.0,-2.0);\n#endif\ngl_Position=vec4(position.xy,1.0,1.0);}",blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e.setEdgeDetectionMode(l),e}return Object(w.a)(n,[{key:"depthPacking",get:function(){return Number(this.defines.DEPTH_PACKING)},set:function(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}},{key:"setEdgeDetectionMode",value:function(e){this.defines.EDGE_DETECTION_MODE=e.toFixed(0),this.needsUpdate=!0}},{key:"setLocalContrastAdaptationFactor",value:function(e){this.defines.LOCAL_CONTRAST_ADAPTATION_FACTOR=e.toFixed("6"),this.needsUpdate=!0}},{key:"setEdgeDetectionThreshold",value:function(e){this.defines.EDGE_THRESHOLD=e.toFixed("6"),this.defines.DEPTH_THRESHOLD=(.1*e).toFixed("6"),this.needsUpdate=!0}},{key:"setPredicationMode",value:function(e){this.defines.PREDICATION_MODE=e.toFixed(0),this.needsUpdate=!0}},{key:"setPredicationBuffer",value:function(e){this.uniforms.predicationBuffer.value=e}},{key:"setPredicationThreshold",value:function(e){this.defines.PREDICATION_THRESHOLD=e.toFixed("6"),this.needsUpdate=!0}},{key:"setPredicationScale",value:function(e){this.defines.PREDICATION_SCALE=e.toFixed("6"),this.needsUpdate=!0}},{key:"setPredicationStrength",value:function(e){this.defines.PREDICATION_STRENGTH=e.toFixed("6"),this.needsUpdate=!0}}]),n}(r.ShaderMaterial),pa={DEPTH:0,LUMA:1,COLOR:2},ma=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,c=arguments.length>3?arguments[3]:void 0,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return Object(A.a)(this,n),(e=t.call(this,{type:"EffectMaterial",defines:{DEPTH_PACKING:"0",ENCODE_OUTPUT:"1"},uniforms:{inputBuffer:new r.Uniform(null),depthBuffer:new r.Uniform(null),resolution:new r.Uniform(new r.Vector2),texelSize:new r.Uniform(new r.Vector2),cameraNear:new r.Uniform(.3),cameraFar:new r.Uniform(1e3),aspect:new r.Uniform(1),time:new r.Uniform(0)},blending:r.NoBlending,depthWrite:!1,depthTest:!1,dithering:s})).toneMapped=!1,null!==o&&e.setShaderParts(o),null!==l&&e.setDefines(l),null!==i&&e.setUniforms(i),e.adoptCameraSettings(c),e}return Object(w.a)(n,[{key:"depthPacking",get:function(){return Number(this.defines.DEPTH_PACKING)},set:function(e){this.defines.DEPTH_PACKING=e.toFixed(0),this.needsUpdate=!0}},{key:"setShaderParts",value:function(e){return this.fragmentShader="#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\nuniform sampler2D inputBuffer;\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nuniform highp sampler2D depthBuffer;\n#else\nuniform mediump sampler2D depthBuffer;\n#endif\nuniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;float readDepth(const in vec2 uv){\n#if DEPTH_PACKING == 3201\nreturn unpackRGBAToDepth(texture2D(depthBuffer,uv));\n#else\nreturn texture2D(depthBuffer,uv).r;\n#endif\n}float getViewZ(const in float depth){\n#ifdef PERSPECTIVE_CAMERA\nreturn perspectiveDepthToViewZ(depth,cameraNear,cameraFar);\n#else\nreturn orthographicDepthToViewZ(depth,cameraNear,cameraFar);\n#endif\n}FRAGMENT_HEADvoid main(){FRAGMENT_MAIN_UVvec4 color0=texture2D(inputBuffer,UV);vec4 color1=vec4(0.0);FRAGMENT_MAIN_IMAGEgl_FragColor=color0;\n#ifdef ENCODE_OUTPUT\n#include <encodings_fragment>\n#endif\n#include <dithering_fragment>\n}".replace(ga.FRAGMENT_HEAD,e.get(ga.FRAGMENT_HEAD)).replace(ga.FRAGMENT_MAIN_UV,e.get(ga.FRAGMENT_MAIN_UV)).replace(ga.FRAGMENT_MAIN_IMAGE,e.get(ga.FRAGMENT_MAIN_IMAGE)),this.vertexShader="uniform vec2 resolution;uniform vec2 texelSize;uniform float cameraNear;uniform float cameraFar;uniform float aspect;uniform float time;varying vec2 vUv;VERTEX_HEADvoid main(){vUv=position.xy*0.5+0.5;VERTEX_MAIN_SUPPORTgl_Position=vec4(position.xy,1.0,1.0);}".replace(ga.VERTEX_HEAD,e.get(ga.VERTEX_HEAD)).replace(ga.VERTEX_MAIN_SUPPORT,e.get(ga.VERTEX_MAIN_SUPPORT)),this.needsUpdate=!0,this}},{key:"setDefines",value:function(e){var t,r=C(e.entries());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.defines[n[0]]=n[1]}}catch(e){r.e(e)}finally{r.f()}return this.needsUpdate=!0,this}},{key:"setUniforms",value:function(e){var t,r=C(e.entries());try{for(r.s();!(t=r.n()).done;){var n=t.value;this.uniforms[n[0]]=n[1]}}catch(e){r.e(e)}finally{r.f()}return this}},{key:"adoptCameraSettings",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;null!==e&&(this.uniforms.cameraNear.value=e.near,this.uniforms.cameraFar.value=e.far,e instanceof r.PerspectiveCamera?this.defines.PERSPECTIVE_CAMERA="1":delete this.defines.PERSPECTIVE_CAMERA,this.needsUpdate=!0)}},{key:"setSize",value:function(e,t){var r=Math.max(e,1),i=Math.max(t,1);this.uniforms.resolution.value.set(r,i),this.uniforms.texelSize.value.set(1/r,1/i),this.uniforms.aspect.value=r/i}}]),n}(r.ShaderMaterial),ga={FRAGMENT_HEAD:"FRAGMENT_HEAD",FRAGMENT_MAIN_UV:"FRAGMENT_MAIN_UV",FRAGMENT_MAIN_IMAGE:"FRAGMENT_MAIN_IMAGE",VERTEX_HEAD:"VERTEX_HEAD",VERTEX_MAIN_SUPPORT:"VERTEX_MAIN_SUPPORT"},ya=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]&&arguments[0],l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;Object(A.a)(this,n);var i=null!==l;return(e=t.call(this,{type:"LuminanceMaterial",uniforms:{inputBuffer:new r.Uniform(null),threshold:new r.Uniform(0),smoothing:new r.Uniform(1),range:new r.Uniform(i?l:new r.Vector2)},fragmentShader:"#include <common>\nuniform sampler2D inputBuffer;\n#ifdef RANGE\nuniform vec2 range;\n#elif defined(THRESHOLD)\nuniform float threshold;uniform float smoothing;\n#endif\nvarying vec2 vUv;void main(){vec4 texel=texture2D(inputBuffer,vUv);float l=linearToRelativeLuminance(texel.rgb);\n#ifdef RANGE\nfloat low=step(range.x,l);float high=step(l,range.y);l*=low*high;\n#elif defined(THRESHOLD)\nl=smoothstep(threshold,threshold+smoothing,l);\n#endif\n#ifdef COLOR\ngl_FragColor=vec4(texel.rgb*l,l);\n#else\ngl_FragColor=vec4(l);\n#endif\n}",vertexShader:sa,blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e.colorOutput=o,e.useThreshold=!0,e.useRange=i,e}return Object(w.a)(n,[{key:"threshold",get:function(){return this.uniforms.threshold.value},set:function(e){this.uniforms.threshold.value=e}},{key:"smoothing",get:function(){return this.uniforms.smoothing.value},set:function(e){this.uniforms.smoothing.value=e}},{key:"useThreshold",get:function(){return void 0!==this.defines.THRESHOLD},set:function(e){e?this.defines.THRESHOLD="1":delete this.defines.THRESHOLD,this.needsUpdate=!0}},{key:"colorOutput",get:function(){return void 0!==this.defines.COLOR},set:function(e){e?this.defines.COLOR="1":delete this.defines.COLOR,this.needsUpdate=!0}},{key:"setColorOutputEnabled",value:function(e){this.colorOutput=e}},{key:"useRange",get:function(){return void 0!==this.defines.RANGE},set:function(e){e?this.defines.RANGE="1":delete this.defines.RANGE,this.needsUpdate=!0}},{key:"luminanceRange",get:function(){return this.useRange},set:function(e){this.useRange=e}},{key:"setLuminanceRangeEnabled",value:function(e){this.useRange=e}}]),n}(r.ShaderMaterial),Aa=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return Object(A.a)(this,n),(e=t.call(this,{type:"MaskMaterial",uniforms:{maskTexture:new r.Uniform(o),inputBuffer:new r.Uniform(null),strength:new r.Uniform(1)},fragmentShader:"uniform sampler2D maskTexture;uniform sampler2D inputBuffer;\n#if MASK_FUNCTION != 0\nuniform float strength;\n#endif\nvarying vec2 vUv;void main(){\n#if COLOR_CHANNEL == 0\nfloat mask=texture2D(maskTexture,vUv).r;\n#elif COLOR_CHANNEL == 1\nfloat mask=texture2D(maskTexture,vUv).g;\n#elif COLOR_CHANNEL == 2\nfloat mask=texture2D(maskTexture,vUv).b;\n#else\nfloat mask=texture2D(maskTexture,vUv).a;\n#endif\n#if MASK_FUNCTION == 0\n#ifdef INVERTED\nif(mask>0.0){discard;}\n#else\nif(mask==0.0){discard;}\n#endif\n#else\nmask=clamp(mask*strength,0.0,1.0);\n#ifdef INVERTED\nmask=(1.0-mask);\n#endif\n#if MASK_FUNCTION == 1\ngl_FragColor=mask*texture2D(inputBuffer,vUv);\n#else\ngl_FragColor=vec4(mask*texture2D(inputBuffer,vUv).rgb,mask);\n#endif\n#endif\n}",vertexShader:sa,blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e.colorChannel=0,e.maskFunction=ba.DISCARD,e}return Object(w.a)(n,[{key:"maskTexture",set:function(e){this.uniforms.maskTexture.value=e}},{key:"colorChannel",set:function(e){this.defines.COLOR_CHANNEL=e.toFixed(0),this.needsUpdate=!0}},{key:"maskFunction",set:function(e){this.defines.MASK_FUNCTION=e.toFixed(0),this.needsUpdate=!0}},{key:"inverted",get:function(){return void 0!==this.defines.INVERTED},set:function(e){this.inverted&&!e?delete this.defines.INVERTED:e&&(this.defines.INVERTED="1"),this.needsUpdate=!0}},{key:"strength",get:function(){return this.uniforms.strength.value},set:function(e){this.uniforms.strength.value=e}}]),n}(r.ShaderMaterial),ba={DISCARD:0,MULTIPLY:1,MULTIPLY_RGB_SET_ALPHA:2},wa=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new r.Vector2,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.Vector2;return Object(A.a)(this,n),(e=t.call(this,{type:"SMAAWeightsMaterial",defines:{MAX_SEARCH_STEPS_INT:"16",MAX_SEARCH_STEPS_FLOAT:"16.0",MAX_SEARCH_STEPS_DIAG_INT:"8",MAX_SEARCH_STEPS_DIAG_FLOAT:"8.0",CORNER_ROUNDING:"25",CORNER_ROUNDING_NORM:"0.25",AREATEX_MAX_DISTANCE:"16.0",AREATEX_MAX_DISTANCE_DIAG:"20.0",AREATEX_PIXEL_SIZE:"(1.0 / vec2(160.0, 560.0))",AREATEX_SUBTEX_SIZE:"(1.0 / 7.0)",SEARCHTEX_SIZE:"vec2(66.0, 33.0)",SEARCHTEX_PACKED_SIZE:"vec2(64.0, 16.0)"},uniforms:{inputBuffer:new r.Uniform(null),areaTexture:new r.Uniform(null),searchTexture:new r.Uniform(null),texelSize:new r.Uniform(o),resolution:new r.Uniform(l)},fragmentShader:"#define sampleLevelZeroOffset(t, coord, offset) texture2D(t, coord + offset * texelSize)\n#if __VERSION__ < 300\n#define round(v) floor(v + 0.5)\n#endif\nuniform sampler2D inputBuffer;uniform sampler2D areaTexture;uniform sampler2D searchTexture;uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}vec2 decodeDiagBilinearAccess(in vec2 e){e.r=e.r*abs(5.0*e.r-5.0*0.75);return round(e);}vec4 decodeDiagBilinearAccess(in vec4 e){e.rb=e.rb*abs(5.0*e.rb-5.0*0.75);return round(e);}vec2 searchDiag1(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 searchDiag2(const in vec2 texCoord,const in vec2 dir,out vec2 e){vec4 coord=vec4(texCoord,-1.0,1.0);coord.x+=0.25*texelSize.x;vec3 t=vec3(texelSize,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(coord.z<float(MAX_SEARCH_STEPS_DIAG_INT-1)&&coord.w>0.9)){break;}coord.xyz=t*vec3(dir,1.0)+coord.xyz;e=texture2D(inputBuffer,coord.xy).rg;e=decodeDiagBilinearAccess(e);coord.w=dot(e,vec2(0.5));}return coord.zw;}vec2 areaDiag(const in vec2 dist,const in vec2 e,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE_DIAG,AREATEX_MAX_DISTANCE_DIAG)*e+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.x+=0.5;texCoord.y+=AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTexture,texCoord).rg;}vec2 calculateDiagWeights(const in vec2 texCoord,const in vec2 e,const in vec4 subsampleIndices){vec2 weights=vec2(0.0);vec4 d;vec2 end;if(e.r>0.0){d.xz=searchDiag1(texCoord,vec2(-1.0,1.0),end);d.x+=float(end.y>0.9);}else{d.xz=vec2(0.0);}d.yw=searchDiag1(texCoord,vec2(1.0,-1.0),end);if(d.x+d.y>2.0){vec4 coords=vec4(-d.x+0.25,d.x,d.y,-d.y-0.25)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.xy=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).rg;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).rg;c.yxwz=decodeDiagBilinearAccess(c.xyzw);vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.z);}d.xz=searchDiag2(texCoord,vec2(-1.0,-1.0),end);if(sampleLevelZeroOffset(inputBuffer,texCoord,vec2(1,0)).r>0.0){d.yw=searchDiag2(texCoord,vec2(1.0),end);d.y+=float(end.y>0.9);}else{d.yw=vec2(0.0);}if(d.x+d.y>2.0){vec4 coords=vec4(-d.x,-d.x,d.y,d.y)*texelSize.xyxy+texCoord.xyxy;vec4 c;c.x=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(-1,0)).g;c.y=sampleLevelZeroOffset(inputBuffer,coords.xy,vec2(0,-1)).r;c.zw=sampleLevelZeroOffset(inputBuffer,coords.zw,vec2(1,0)).gr;vec2 cc=vec2(2.0)*c.xz+c.yw;movec(bvec2(step(0.9,d.zw)),cc,vec2(0.0));weights+=areaDiag(d.xy,cc,subsampleIndices.w).gr;}return weights;}float searchLength(const in vec2 e,const in float offset){vec2 scale=SEARCHTEX_SIZE*vec2(0.5,-1.0);vec2 bias=SEARCHTEX_SIZE*vec2(offset,1.0);scale+=vec2(-1.0,1.0);bias+=vec2(0.5,-0.5);scale*=1.0/SEARCHTEX_PACKED_SIZE;bias*=1.0/SEARCHTEX_PACKED_SIZE;return texture2D(searchTexture,scale*e+bias).r;}float searchXLeft(in vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x>end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(-2.0,0.0)*texelSize+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.0)+3.25;return texelSize.x*offset+texCoord.x;}float searchXRight(vec2 texCoord,const in float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.x<end&&e.g>0.8281&&e.r==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(2.0,0.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e,0.5)+3.25;return-texelSize.x*offset+texCoord.x;}float searchYUp(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;++i){if(!(texCoord.y>end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=-vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.0)+3.25;return texelSize.y*offset+texCoord.y;}float searchYDown(vec2 texCoord,const in float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<MAX_SEARCH_STEPS_INT;i++){if(!(texCoord.y<end&&e.r>0.8281&&e.g==0.0)){break;}e=texture2D(inputBuffer,texCoord).rg;texCoord=vec2(0.0,2.0)*texelSize.xy+texCoord;}float offset=-(255.0/127.0)*searchLength(e.gr,0.5)+3.25;return-texelSize.y*offset+texCoord.y;}vec2 area(const in vec2 dist,const in float e1,const in float e2,const in float offset){vec2 texCoord=vec2(AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texCoord=AREATEX_PIXEL_SIZE*texCoord+0.5*AREATEX_PIXEL_SIZE;texCoord.y=AREATEX_SUBTEX_SIZE*offset+texCoord.y;return texture2D(areaTexture,texCoord).rg;}void detectHorizontalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,1)).r;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).r;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(0,-2)).r;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,-2)).r;weights*=clamp(factor,0.0,1.0);\n#endif\n}void detectVerticalCornerPattern(inout vec2 weights,const in vec4 texCoord,const in vec2 d){\n#if !defined(DISABLE_CORNER_DETECTION)\nvec2 leftRight=step(d.xy,d.yx);vec2 rounding=(1.0-CORNER_ROUNDING_NORM)*leftRight;rounding/=leftRight.x+leftRight.y;vec2 factor=vec2(1.0);factor.x-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(1,0)).g;factor.x-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(1,1)).g;factor.y-=rounding.x*sampleLevelZeroOffset(inputBuffer,texCoord.xy,vec2(-2,0)).g;factor.y-=rounding.y*sampleLevelZeroOffset(inputBuffer,texCoord.zw,vec2(-2,1)).g;weights*=clamp(factor,0.0,1.0);\n#endif\n}void main(){vec4 weights=vec4(0.0);vec4 subsampleIndices=vec4(0.0);vec2 e=texture2D(inputBuffer,vUv).rg;if(e.g>0.0){\n#if !defined(DISABLE_DIAG_DETECTION)\nweights.rg=calculateDiagWeights(vUv,e,subsampleIndices);if(weights.r==-weights.g){\n#endif\nvec2 d;vec3 coords;coords.x=searchXLeft(vOffset[0].xy,vOffset[2].x);coords.y=vOffset[1].y;d.x=coords.x;float e1=texture2D(inputBuffer,coords.xy).r;coords.z=searchXRight(vOffset[0].zw,vOffset[2].y);d.y=coords.z;d=round(resolution.xx*d+-vPixCoord.xx);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.zy,vec2(1,0)).r;weights.rg=area(sqrtD,e1,e2,subsampleIndices.y);coords.y=vUv.y;detectHorizontalCornerPattern(weights.rg,coords.xyzy,d);\n#if !defined(DISABLE_DIAG_DETECTION)\n}else{e.r=0.0;}\n#endif\n}if(e.r>0.0){vec2 d;vec3 coords;coords.y=searchYUp(vOffset[1].xy,vOffset[2].z);coords.x=vOffset[0].x;d.x=coords.y;float e1=texture2D(inputBuffer,coords.xy).g;coords.z=searchYDown(vOffset[1].zw,vOffset[2].w);d.y=coords.z;d=round(resolution.yy*d-vPixCoord.yy);vec2 sqrtD=sqrt(abs(d));float e2=sampleLevelZeroOffset(inputBuffer,coords.xz,vec2(0,1)).g;weights.ba=area(sqrtD,e1,e2,subsampleIndices.x);coords.x=vUv.x;detectVerticalCornerPattern(weights.ba,coords.xyxz,d);}gl_FragColor=weights;}",vertexShader:"uniform vec2 texelSize;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixCoord;void main(){vUv=position.xy*0.5+0.5;vPixCoord=vUv*resolution;vOffset[0]=vUv.xyxy+texelSize.xyxy*vec4(-0.25,-0.125,1.25,-0.125);vOffset[1]=vUv.xyxy+texelSize.xyxy*vec4(-0.125,-0.25,-0.125,1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*texelSize.xxyy*MAX_SEARCH_STEPS_FLOAT;gl_Position=vec4(position.xy,1.0,1.0);}",blending:r.NoBlending,depthWrite:!1,depthTest:!1})).toneMapped=!1,e}return Object(w.a)(n,[{key:"setOrthogonalSearchSteps",value:function(e){var t=Math.min(Math.max(e,0),112);this.defines.MAX_SEARCH_STEPS_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_FLOAT=t.toFixed("1"),this.needsUpdate=!0}},{key:"setDiagonalSearchSteps",value:function(e){var t=Math.min(Math.max(e,0),20);this.defines.MAX_SEARCH_STEPS_DIAG_INT=t.toFixed("0"),this.defines.MAX_SEARCH_STEPS_DIAG_FLOAT=t.toFixed("1"),this.needsUpdate=!0}},{key:"setCornerRounding",value:function(e){var t=Math.min(Math.max(e,0),100);this.defines.CORNER_ROUNDING=t.toFixed("4"),this.defines.CORNER_ROUNDING_NORM=(t/100).toFixed("4"),this.needsUpdate=!0}},{key:"diagonalDetection",get:function(){return void 0===this.defines.DISABLE_DIAG_DETECTION},set:function(e){e?delete this.defines.DISABLE_DIAG_DETECTION:this.defines.DISABLE_DIAG_DETECTION="1",this.needsUpdate=!0}},{key:"cornerRounding",get:function(){return void 0===this.defines.DISABLE_CORNER_DETECTION},set:function(e){e?delete this.defines.DISABLE_CORNER_DETECTION:this.defines.DISABLE_CORNER_DETECTION="1",this.needsUpdate=!0}}]),n}(r.ShaderMaterial),xa=new r.Camera,Oa=null,Ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Pass",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.Scene,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:xa;Object(A.a)(this,e),this.name=t,this.scene=n,this.camera=i,this.screen=null,this.rtt=!0,this.needsSwap=!0,this.needsDepthTexture=!1,this.enabled=!0}return Object(w.a)(e,[{key:"renderToScreen",get:function(){return!this.rtt},set:function(e){if(this.rtt===e){var t=this.getFullscreenMaterial();null!==t&&(t.needsUpdate=!0),this.rtt=!e}}},{key:"getFullscreenMaterial",value:function(){return null!==this.screen?this.screen.material:null}},{key:"setFullscreenMaterial",value:function(e){var t=this.screen;null!==t?t.material=e:((t=new r.Mesh(function(){if(null===Oa){var e=new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),t=new Float32Array([0,0,2,0,0,2]);void 0!==(Oa=new r.BufferGeometry).setAttribute?(Oa.setAttribute("position",new r.BufferAttribute(e,3)),Oa.setAttribute("uv",new r.BufferAttribute(t,2))):(Oa.addAttribute("position",new r.BufferAttribute(e,3)),Oa.addAttribute("uv",new r.BufferAttribute(t,2)))}return Oa}(),e)).frustumCulled=!1,null===this.scene&&(this.scene=new r.Scene),this.scene.add(t),this.screen=t)}},{key:"getDepthTexture",value:function(){return null}},{key:"setDepthTexture",value:function(e){}},{key:"render",value:function(e,t,r,i,n){throw new Error("Render method not implemented!")}},{key:"setSize",value:function(e,t){}},{key:"initialize",value:function(e,t,r){}},{key:"dispose",value:function(){var e=this.getFullscreenMaterial();null!==e&&e.dispose();for(var t=0,n=Object.keys(this);t<n.length;t++){var o=n[t],l=this[o];if(null!==l&&"function"==typeof l.dispose){if(l instanceof r.Scene)continue;this[o].dispose()}}}}]),e}(),Ca=-1,Da=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(A.a)(this,e),this.resizable=t,this.base=new r.Vector2(1,1),this.target=new r.Vector2(n,i),this.s=o}return Object(w.a)(e,[{key:"scale",get:function(){return this.s},set:function(e){this.s=e,this.target.x=Ca,this.target.y=Ca,this.resizable.setSize(this.base.x,this.base.y)}},{key:"width",get:function(){var e=this.base,t=this.target;return t.x!==Ca?t.x:t.y!==Ca?Math.round(t.y*(e.x/e.y)):Math.round(e.x*this.s)},set:function(e){this.target.x=e,this.resizable.setSize(this.base.x,this.base.y)}},{key:"height",get:function(){var e=this.base,t=this.target;return t.y!==Ca?t.y:t.x!==Ca?Math.round(t.x/(e.x/e.y)):Math.round(e.y*this.s)},set:function(e){this.target.y=e,this.resizable.setSize(this.base.x,this.base.y)}}],[{key:"AUTO_SIZE",get:function(){return Ca}}]),e}(),Sa=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=o.resolutionScale,c=void 0===l?.5:l,h=o.width,d=void 0===h?Da.AUTO_SIZE:h,f=o.height,i=void 0===f?Da.AUTO_SIZE:f,v=o.kernelSize,y=void 0===v?da.LARGE:v;return Object(A.a)(this,n),(e=t.call(this,"BlurPass")).renderTargetA=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,magFilter:r.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),e.renderTargetA.texture.name="Blur.Target.A",e.renderTargetB=e.renderTargetA.clone(),e.renderTargetB.texture.name="Blur.Target.B",e.resolution=new Da(Object(m.a)(e),d,i,c),e.convolutionMaterial=new ca,e.ditheredConvolutionMaterial=new ca,e.ditheredConvolutionMaterial.dithering=!0,e.dithering=!1,e.kernelSize=y,e}return Object(w.a)(n,[{key:"width",get:function(){return this.resolution.width},set:function(e){this.resolution.width=e}},{key:"height",get:function(){return this.resolution.height},set:function(e){this.resolution.height=e}},{key:"scale",get:function(){return this.convolutionMaterial.uniforms.scale.value},set:function(e){this.convolutionMaterial.uniforms.scale.value=e,this.ditheredConvolutionMaterial.uniforms.scale.value=e}},{key:"kernelSize",get:function(){return this.convolutionMaterial.kernelSize},set:function(e){this.convolutionMaterial.kernelSize=e,this.ditheredConvolutionMaterial.kernelSize=e}},{key:"getResolutionScale",value:function(){return this.resolution.scale}},{key:"setResolutionScale",value:function(e){this.resolution.scale=e}},{key:"render",value:function(e,t,r,i,n){var o,p,l,s=this.scene,c=this.camera,a=this.renderTargetA,h=this.renderTargetB,d=this.convolutionMaterial,f=d.uniforms,u=d.getKernel(),v=t;for(this.setFullscreenMaterial(d),p=0,l=u.length-1;p<l;++p)o=0==(1&p)?a:h,f.kernel.value=u[p],f.inputBuffer.value=v.texture,e.setRenderTarget(o),e.render(s,c),v=o;this.dithering&&(f=(d=this.ditheredConvolutionMaterial).uniforms,this.setFullscreenMaterial(d)),f.kernel.value=u[p],f.inputBuffer.value=v.texture,e.setRenderTarget(this.renderToScreen?null:r),e.render(s,c)}},{key:"setSize",value:function(e,t){var r=this.resolution;r.base.set(e,t);var i=r.width,n=r.height;this.renderTargetA.setSize(i,n),this.renderTargetB.setSize(i,n),this.convolutionMaterial.setTexelSize(1/i,1/n),this.ditheredConvolutionMaterial.setTexelSize(1/i,1/n)}},{key:"initialize",value:function(e,t,i){t||i!==r.UnsignedByteType||(this.renderTargetA.texture.format=r.RGBFormat,this.renderTargetB.texture.format=r.RGBFormat),void 0!==i&&(this.renderTargetA.texture.type=i,this.renderTargetB.texture.type=i)}}],[{key:"AUTO_SIZE",get:function(){return Da.AUTO_SIZE}}]),n}(Ea),Ba=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e;return Object(A.a)(this,r),(e=t.call(this,"ClearMaskPass",null,null)).needsSwap=!1,e}return Object(w.a)(r,[{key:"render",value:function(e,t,r,i,n){var s=e.state.buffers.stencil;s.setLocked(!1),s.setTest(!1)}}]),r}(Ea),Ta=new r.Color,ka=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object(A.a)(this,r),(e=t.call(this,"ClearPass",null,null)).needsSwap=!1,e.color=n,e.depth=o,e.stencil=l,e.overrideClearColor=null,e.overrideClearAlpha=-1,e}return Object(w.a)(r,[{key:"render",value:function(e,t,r,i,n){var s=this.overrideClearColor,o=this.overrideClearAlpha,a=e.getClearAlpha(),l=null!==s,c=o>=0;l?(Ta.copy(e.getClearColor(Ta)),e.setClearColor(s,c?o:a)):c&&e.setClearAlpha(o),e.setRenderTarget(this.renderToScreen?null:t),e.clear(this.color,this.depth,this.stencil),l?e.setClearColor(Ta,a):c&&e.setClearAlpha(a)}}]),r}(Ea),_a=!1,Ma=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(A.a)(this,e),this.originalMaterials=new Map,this.material=null,this.materials=null,this.materialsBackSide=null,this.materialsDoubleSide=null,this.setMaterial(n),this.meshCount=0,this.replaceMaterial=function(e){if(e.isMesh){var n;switch(e.material.side){case r.DoubleSide:n=t.materialsDoubleSide;break;case r.BackSide:n=t.materialsBackSide;break;default:n=t.materials}t.originalMaterials.set(e,e.material),e.isSkinnedMesh?e.material=n[2]:e.isInstancedMesh?e.material=n[1]:e.material=n[0],++t.meshCount}}}return Object(w.a)(e,[{key:"setMaterial",value:function(e){if(this.disposeMaterials(),this.material=e,null!==e){for(var t=this.materials=[e.clone(),e.clone(),e.clone()],n=0,o=t;n<o.length;n++){var l=o[n];l.uniforms=Object.assign({},e.uniforms),l.side=r.FrontSide}t[2].skinning=!0,this.materialsBackSide=t.map((function(t){var i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=r.BackSide,i})),this.materialsDoubleSide=t.map((function(t){var i=t.clone();return i.uniforms=Object.assign({},e.uniforms),i.side=r.DoubleSide,i}))}}},{key:"render",value:function(e,t,r){var i=e.shadowMap.enabled;if(e.shadowMap.enabled=!1,_a){var n=this.originalMaterials;this.meshCount=0,t.traverse(this.replaceMaterial),e.render(t,r);var o,l=C(n);try{for(l.s();!(o=l.n()).done;){var c=o.value;c[0].material=c[1]}}catch(e){l.e(e)}finally{l.f()}this.meshCount!==n.size&&n.clear()}else{var h=t.overrideMaterial;t.overrideMaterial=this.material,e.render(t,r),t.overrideMaterial=h}e.shadowMap.enabled=i}},{key:"disposeMaterials",value:function(){if(null!==this.material){var e,t=C(this.materials.concat(this.materialsBackSide).concat(this.materialsDoubleSide));try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(e){t.e(e)}finally{t.f()}}}},{key:"dispose",value:function(){this.originalMaterials.clear(),this.disposeMaterials()}}],[{key:"workaroundEnabled",get:function(){return _a},set:function(e){_a=e}}]),e}(),La=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Object(A.a)(this,r),(o=t.call(this,"RenderPass",e,n)).needsSwap=!1,o.clearPass=new ka,o.overrideMaterialManager=null===l?null:new Ma(l),o}return Object(w.a)(r,[{key:"renderToScreen",get:function(){return Object(v.a)(Object(E.a)(r.prototype),"renderToScreen",this)},set:function(e){Object(c.a)(Object(E.a)(r.prototype),"renderToScreen",e,this,!0),this.clearPass.renderToScreen=e}},{key:"overrideMaterial",get:function(){var e=this.overrideMaterialManager;return null!==e?e.material:null},set:function(e){var t=this.overrideMaterialManager;null!==e?null!==t?t.setMaterial(e):this.overrideMaterialManager=new Ma(e):null!==t&&(t.dispose(),this.overrideMaterialManager=null)}},{key:"clear",get:function(){return this.clearPass.enabled},set:function(e){this.clearPass.enabled=e}},{key:"getClearPass",value:function(){return this.clearPass}},{key:"render",value:function(e,t,r,i,n){var s=this.scene,o=this.camera,a=s.background,l=this.renderToScreen?null:t;this.clear&&(null!==this.clearPass.overrideClearColor&&(s.background=null),this.clearPass.render(e,t)),e.setRenderTarget(l),null!==this.overrideMaterialManager?this.overrideMaterialManager.render(e,s,o):e.render(s,o),s.background!==a&&(s.background=a)}}]),r}(Ea),Na=function(e){Object(x.a)(n,e);var t=S(n);function n(e,o){var l,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},h=c.resolutionScale,i=void 0===h?1:h,d=c.width,f=void 0===d?Da.AUTO_SIZE:d,v=c.height,s=void 0===v?Da.AUTO_SIZE:v,y=c.renderTarget;Object(A.a)(this,n),(l=t.call(this,"DepthPass")).needsSwap=!1,l.renderPass=new La(e,o,new r.MeshDepthMaterial({depthPacking:r.RGBADepthPacking}));var a=l.renderPass.getClearPass();return a.overrideClearColor=new r.Color(16777215),a.overrideClearAlpha=1,l.renderTarget=y,void 0===l.renderTarget&&(l.renderTarget=new r.WebGLRenderTarget(1,1,{minFilter:r.NearestFilter,magFilter:r.NearestFilter,stencilBuffer:!1}),l.renderTarget.texture.name="DepthPass.Target"),l.resolution=new Da(Object(m.a)(l),f,s,i),l}return Object(w.a)(n,[{key:"texture",get:function(){return this.renderTarget.texture}},{key:"getResolutionScale",value:function(){return this.resolutionScale}},{key:"setResolutionScale",value:function(e){this.resolutionScale=e,this.setSize(this.resolution.base.x,this.resolution.base.y)}},{key:"render",value:function(e,t,r,i,n){var s=this.renderToScreen?null:this.renderTarget;this.renderPass.render(e,s)}},{key:"setSize",value:function(e,t){var r=this.resolution;r.base.set(e,t),this.renderTarget.setSize(r.width,r.height)}}]),n}(Ea),Fa=13,Ia=16,ja=new Map([[0,null],[1,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x+y,1.0)*opacity+x*(1.0-opacity);}"],[2,"vec3 blend(const in vec3 x,const in vec3 y,const in float opacity){return y*opacity+x*(1.0-opacity);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){float a=min(y.a,opacity);return vec4(blend(x.rgb,y.rgb,a),max(x.a,a));}"],[3,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y)*0.5*opacity+x*(1.0-opacity);}"],[4,"float blend(const in float x,const in float y){return(y==0.0)? y : max(1.0-(1.0-x)/y,0.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[5,"float blend(const in float x,const in float y){return(y==1.0)? y : min(x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[6,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return min(x,y)*opacity+x*(1.0-opacity);}"],[7,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return abs(x-y)*opacity+x*(1.0-opacity);}"],[8,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(x+y-2.0*x*y)*opacity+x*(1.0-opacity);}"],[9,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x,y)*opacity+x*(1.0-opacity);}"],[10,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return x*y*opacity+x*(1.0-opacity);}"],[11,"float blend(const in float x,const in float y){return(y>0.0)? min(x/y,1.0): 1.0;}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[12,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-abs(1.0-x-y))*opacity+x*(1.0-opacity);}"],[Fa,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return y*opacity+x*(1.0-opacity);}"],[14,"float blend(const in float x,const in float y){return(x<0.5)?(2.0*x*y):(1.0-2.0*(1.0-x)*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[15,"float blend(const in float x,const in float y){return(y==1.0)? y : min(x*x/(1.0-y),1.0);}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[Ia,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return(1.0-(1.0-x)*(1.0-y))*opacity+x*(1.0-opacity);}"],[17,"float blend(const in float x,const in float y){return(y<0.5)?(2.0*x*y+x*x*(1.0-2.0*y)):(sqrt(x)*(2.0*y-1.0)+2.0*x*(1.0-y));}vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){vec4 z=vec4(blend(x.r,y.r),blend(x.g,y.g),blend(x.b,y.b),blend(x.a,y.a));return z*opacity+x*(1.0-opacity);}"],[18,"vec4 blend(const in vec4 x,const in vec4 y,const in float opacity){return max(x+y-1.0,0.0)*opacity+x*(1.0-opacity);}"]]),Pa=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(A.a)(this,n),(o=t.call(this)).blendFunction=e,o.opacity=new r.Uniform(l),o}return Object(w.a)(n,[{key:"getBlendFunction",value:function(){return this.blendFunction}},{key:"setBlendFunction",value:function(e){this.blendFunction=e,this.dispatchEvent({type:"change"})}},{key:"getShaderCode",value:function(){return ja.get(this.blendFunction)}}]),n}(r.EventDispatcher),Ra=function(e){Object(x.a)(n,e);var t=S(n);function n(e,r){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},c=l.attributes,h=void 0===c?za.NONE:c,d=l.blendFunction,i=void 0===d?Ia:d,f=l.defines,v=void 0===f?new Map:f,m=l.uniforms,s=void 0===m?new Map:m,y=l.extensions,w=void 0===y?null:y,x=l.vertexShader,a=void 0===x?null:x;return Object(A.a)(this,n),(o=t.call(this)).name=e,o.attributes=h,o.fragmentShader=r,o.vertexShader=a,o.defines=v,o.uniforms=s,o.extensions=w,o.blendMode=new Pa(i),o.blendMode.addEventListener("change",(function(e){return o.setChanged()})),o}return Object(w.a)(n,[{key:"setChanged",value:function(){this.dispatchEvent({type:"change"})}},{key:"getAttributes",value:function(){return this.attributes}},{key:"setAttributes",value:function(e){this.attributes=e,this.setChanged()}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"setFragmentShader",value:function(e){this.fragmentShader=e,this.setChanged()}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"setVertexShader",value:function(e){this.vertexShader=e,this.setChanged()}},{key:"setDepthTexture",value:function(e){}},{key:"update",value:function(e,t,r){}},{key:"setSize",value:function(e,t){}},{key:"initialize",value:function(e,t,r){}},{key:"dispose",value:function(){for(var e=0,t=Object.keys(this);e<t.length;e++){var n=t[e],o=this[n];if(null!==o&&"function"==typeof o.dispose){if(o instanceof r.Scene)continue;this[n].dispose()}}}}]),n}(r.EventDispatcher),za={NONE:0,DEPTH:1,CONVOLUTION:2};function Ua(e,t){for(var i,r=[];null!==(i=e.exec(t));)r.push(i[1]);return r}function Ga(e,t,r){var i,n,o,l=C(t);try{for(l.s();!(o=l.n()).done;){var s=o.value;i="$1"+e+s.charAt(0).toUpperCase()+s.slice(1),n=new RegExp("([^\\.])(\\b"+s+"\\b)","g");var c,h=C(r.entries());try{for(h.s();!(c=h.n()).done;){var d=c.value;null!==d[1]&&r.set(d[0],d[1].replace(n,i))}}catch(e){h.e(e)}finally{h.f()}}}catch(e){l.e(e)}finally{l.f()}}function Va(e,t,r,i,n,s,o){var a=/(?:\w+\s+(\w+)\([\w\s,]*\)\s*{[^}]+})/g,l=t.blendMode,c=new Map([["fragment",t.getFragmentShader()],["vertex",t.getVertexShader()]]),u=void 0!==c.get("fragment")&&/mainImage/.test(c.get("fragment")),h=void 0!==c.get("fragment")&&/mainUv/.test(c.get("fragment")),p=[],d=[],f=!1,g=!1;if(void 0===c.get("fragment"))console.error("Missing fragment shader",t);else if(h&&0!=(o&za.CONVOLUTION))console.error("Effects that transform UV coordinates are incompatible with convolution effects",t);else if(u||h){if(h&&(r.set(ga.FRAGMENT_MAIN_UV,r.get(ga.FRAGMENT_MAIN_UV)+"\t"+e+"MainUv(UV);\n"),f=!0),null!==c.get("vertex")&&/mainSupport/.test(c.get("vertex"))){var v="\t"+e+"MainSupport(";/mainSupport *\([\w\s]*?uv\s*?\)/.test(c.get("vertex"))&&(v+="vUv"),v+=");\n",r.set(ga.VERTEX_MAIN_SUPPORT,r.get(ga.VERTEX_MAIN_SUPPORT)+v),p=p.concat(Ua(/(?:varying\s+\w+\s+(\w*))/g,c.get("vertex"))),d=d.concat(p).concat(Ua(a,c.get("vertex")))}if(d=d.concat(Ua(a,c.get("fragment"))).concat(Array.from(t.defines.keys()).map((function(e){return e.replace(/\([\w\s,]*\)/g,"")}))).concat(Array.from(t.uniforms.keys())),t.uniforms.forEach((function(t,r){return s.set(e+r.charAt(0).toUpperCase()+r.slice(1),t)})),t.defines.forEach((function(t,r){return n.set(e+r.charAt(0).toUpperCase()+r.slice(1),t)})),Ga(e,d,n),Ga(e,d,c),i.set(l.blendFunction,l),u){var m=e+"MainImage(color0, UV, ";0!=(o&za.DEPTH)&&/MainImage *\([\w\s,]*?depth[\w\s,]*?\)/.test(c.get("fragment"))&&(m+="depth, ",g=!0),m+="color1);\n\t";var y=e+"BlendOpacity";s.set(y,l.opacity),m+="color0 = blend"+l.getBlendFunction()+"(color0, color1, "+y+");\n\n\t",r.set(ga.FRAGMENT_MAIN_IMAGE,r.get(ga.FRAGMENT_MAIN_IMAGE)+m),r.set(ga.FRAGMENT_HEAD,r.get(ga.FRAGMENT_HEAD)+"uniform float "+y+";\n\n")}r.set(ga.FRAGMENT_HEAD,r.get(ga.FRAGMENT_HEAD)+c.get("fragment")+"\n"),null!==c.get("vertex")&&r.set(ga.VERTEX_HEAD,r.get(ga.VERTEX_HEAD)+c.get("vertex")+"\n")}else console.error("The fragment shader contains neither a mainImage nor a mainUv function",t);return{varyings:p,transformedUv:f,readDepth:g}}var Ha,Ja,Qa,Ya,Wa=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var r;Object(A.a)(this,n);for(var o=arguments.length,l=new Array(o>1?o-1:0),c=1;c<o;c++)l[c-1]=arguments[c];return(r=t.call(this,"EffectPass")).setFullscreenMaterial(new ma(null,null,null,e)),r.effects=l.sort((function(e,t){return t.attributes-e.attributes})),r.skipRendering=!1,r.uniforms=0,r.varyings=0,r.minTime=1,r.maxTime=Number.POSITIVE_INFINITY,r}return Object(w.a)(n,[{key:"encodeOutput",get:function(){return void 0!==this.getFullscreenMaterial().defines.ENCODE_OUTPUT},set:function(e){if(this.encodeOutput!==e){var t=this.getFullscreenMaterial();t.needsUpdate=!0,e?t.defines.ENCODE_OUTPUT="1":delete t.defines.ENCODE_OUTPUT}}},{key:"dithering",get:function(){return this.getFullscreenMaterial().dithering},set:function(e){var t=this.getFullscreenMaterial();t.dithering!==e&&(t.dithering=e,t.needsUpdate=!0)}},{key:"verifyResources",value:function(e){var t=e.capabilities,r=Math.min(t.maxFragmentUniforms,t.maxVertexUniforms);this.uniforms>r&&console.warn("The current rendering context doesn't support more than "+r+" uniforms, but "+this.uniforms+" were defined"),r=t.maxVaryings,this.varyings>r&&console.warn("The current rendering context doesn't support more than "+r+" varyings, but "+this.varyings+" were defined")}},{key:"updateMaterial",value:function(){var e,t,r=/\bblend\b/g,n=new Map([[ga.FRAGMENT_HEAD,""],[ga.FRAGMENT_MAIN_UV,""],[ga.FRAGMENT_MAIN_IMAGE,""],[ga.VERTEX_HEAD,""],[ga.VERTEX_MAIN_SUPPORT,""]]),o=new Map,i=new Map,l=new Map,s=new Set,a=0,c=0,h=0,d=!1,u=!1,f=C(this.effects);try{for(f.s();!(t=f.n()).done;){var v=t.value;if(0===v.blendMode.getBlendFunction())h|=v.getAttributes()&za.DEPTH;else if(0!=(h&za.CONVOLUTION)&&0!=(v.getAttributes()&za.CONVOLUTION))console.error("Convolution effects cannot be merged",v);else if(h|=v.getAttributes(),c+=(e=Va("e"+a++,v,n,o,i,l,h)).varyings.length,d=d||e.transformedUv,u=u||e.readDepth,null!==v.extensions){var m,y=C(v.extensions);try{for(y.s();!(m=y.n()).done;){var A=m.value;s.add(A)}}catch(e){y.e(e)}finally{y.f()}}}}catch(e){f.e(e)}finally{f.f()}var w,x=C(o.values());try{for(x.s();!(w=x.n()).done;){var O=w.value;n.set(ga.FRAGMENT_HEAD,n.get(ga.FRAGMENT_HEAD)+O.getShaderCode().replace(r,"blend"+O.getBlendFunction())+"\n")}}catch(e){x.e(e)}finally{x.f()}0!=(h&za.DEPTH)?(u&&n.set(ga.FRAGMENT_MAIN_IMAGE,"float depth = readDepth(UV);\n\n\t"+n.get(ga.FRAGMENT_MAIN_IMAGE)),this.needsDepthTexture=null===this.getDepthTexture()):this.needsDepthTexture=!1,d?(n.set(ga.FRAGMENT_MAIN_UV,"vec2 transformedUv = vUv;\n"+n.get(ga.FRAGMENT_MAIN_UV)),i.set("UV","transformedUv")):i.set("UV","vUv"),n.forEach((function(e,t,r){return r.set(t,e.trim().replace(/^#/,"\n#"))})),this.uniforms=l.size,this.varyings=c,this.skipRendering=0===a,this.needsSwap=!this.skipRendering;var E=this.getFullscreenMaterial();if(E.setShaderParts(n).setDefines(i).setUniforms(l),E.extensions={},s.size>0){var D,S=C(s);try{for(S.s();!(D=S.n()).done;){var B=D.value;E.extensions[B]=!0}}catch(e){S.e(e)}finally{S.f()}}this.needsUpdate=!1}},{key:"recompile",value:function(e){this.updateMaterial(),void 0!==e&&this.verifyResources(e)}},{key:"getDepthTexture",value:function(){return this.getFullscreenMaterial().uniforms.depthBuffer.value}},{key:"setDepthTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BasicDepthPacking,i=this.getFullscreenMaterial();i.uniforms.depthBuffer.value=e,i.depthPacking=t,i.needsUpdate=!0;var n,o=C(this.effects);try{for(o.s();!(n=o.n()).done;){var l=n.value;l.setDepthTexture(e,t)}}catch(e){o.e(e)}finally{o.f()}}},{key:"render",value:function(e,t,r,i,n){var s=this.getFullscreenMaterial(),o=s.uniforms.time.value+i;this.needsUpdate&&this.recompile(e);var l,c=C(this.effects);try{for(c.s();!(l=c.n()).done;){l.value.update(e,t,i)}}catch(e){c.e(e)}finally{c.f()}this.skipRendering&&!this.renderToScreen||(s.uniforms.inputBuffer.value=t.texture,s.uniforms.time.value=o<=this.maxTime?o:this.minTime,e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera))}},{key:"setSize",value:function(e,t){this.getFullscreenMaterial().setSize(e,t);var r,n=C(this.effects);try{for(n.s();!(r=n.n()).done;){r.value.setSize(e,t)}}catch(e){n.e(e)}finally{n.f()}}},{key:"initialize",value:function(e,t,r){var n=this;this.capabilities=e.capabilities;var o,l=C(this.effects);try{for(l.s();!(o=l.n()).done;){var c=o.value;c.initialize(e,t,r),c.addEventListener("change",(function(e){return n.handleEvent(e)}))}}catch(e){l.e(e)}finally{l.f()}this.updateMaterial(),this.verifyResources(e)}},{key:"dispose",value:function(){Object(v.a)(Object(E.a)(n.prototype),"dispose",this).call(this);var e,t=C(this.effects);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(e){t.e(e)}finally{t.f()}}},{key:"handleEvent",value:function(e){switch(e.type){case"change":this.needsUpdate=!0}}}]),n}(Ea),Xa=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=o.width,c=void 0===l?Da.AUTO_SIZE:l,h=o.height,d=void 0===h?Da.AUTO_SIZE:h,i=o.renderTarget,f=o.luminanceRange,s=o.colorOutput;return Object(A.a)(this,n),(e=t.call(this,"LuminancePass")).setFullscreenMaterial(new ya(s,f)),e.needsSwap=!1,e.renderTarget=i,void 0===e.renderTarget&&(e.renderTarget=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:s?r.RGBAFormat:r.LuminanceFormat,stencilBuffer:!1,depthBuffer:!1}),e.renderTarget.texture.name="LuminancePass.Target",e.renderTarget.texture.generateMipmaps=!1),e.resolution=new Da(Object(m.a)(e),c,d),e}return Object(w.a)(n,[{key:"texture",get:function(){return this.renderTarget.texture}},{key:"render",value:function(e,t,r,i,n){this.getFullscreenMaterial().uniforms.inputBuffer.value=t.texture,e.setRenderTarget(this.renderToScreen?null:this.renderTarget),e.render(this.scene,this.camera)}},{key:"setSize",value:function(e,t){var r=this.resolution;r.base.set(e,t),this.renderTarget.setSize(r.width,r.height)}}]),n}(Ea),Ka=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n){var o;return Object(A.a)(this,r),(o=t.call(this,"MaskPass",e,n)).needsSwap=!1,o.clearPass=new ka(!1,!1,!0),o.inverse=!1,o}return Object(w.a)(r,[{key:"clear",get:function(){return this.clearPass.enabled},set:function(e){this.clearPass.enabled=e}},{key:"render",value:function(e,t,r,i,n){var s=e.getContext(),o=e.state.buffers,a=this.scene,l=this.camera,c=this.clearPass,h=this.inverse?0:1,u=1-h;o.color.setMask(!1),o.depth.setMask(!1),o.color.setLocked(!0),o.depth.setLocked(!0),o.stencil.setTest(!0),o.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),o.stencil.setFunc(s.ALWAYS,h,4294967295),o.stencil.setClear(u),o.stencil.setLocked(!0),this.clear&&(this.renderToScreen?c.render(e,null):(c.render(e,t),c.render(e,r))),this.renderToScreen?(e.setRenderTarget(null),e.render(a,l)):(e.setRenderTarget(t),e.render(a,l),e.setRenderTarget(r),e.render(a,l)),o.color.setLocked(!1),o.depth.setLocked(!1),o.stencil.setLocked(!1),o.stencil.setFunc(s.EQUAL,1,4294967295),o.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),o.stencil.setLocked(!0)}}]),r}(Ea),qa=function(e){Object(x.a)(r,e);var t=S(r);function r(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inputBuffer";return Object(A.a)(this,r),(n=t.call(this,"ShaderPass")).setFullscreenMaterial(e),n.uniform=null,n.setInput(o),n}return Object(w.a)(r,[{key:"setInput",value:function(e){var t=this.getFullscreenMaterial();if(this.uniform=null,null!==t){var r=t.uniforms;void 0!==r&&void 0!==r[e]&&(this.uniform=r[e])}}},{key:"render",value:function(e,t,r,i,n){null!==this.uniform&&null!==t&&(this.uniform.value=t.texture),e.setRenderTarget(this.renderToScreen?null:r),e.render(this.scene,this.camera)}}]),r}(Ea),Za=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=o.blendFunction,c=void 0===l?Ia:l,h=o.luminanceThreshold,d=void 0===h?.9:h,f=o.luminanceSmoothing,i=void 0===f?.025:f,v=o.resolutionScale,y=void 0===v?.5:v,w=o.intensity,s=void 0===w?1:w,x=o.width,O=void 0===x?Da.AUTO_SIZE:x,E=o.height,a=void 0===E?Da.AUTO_SIZE:E,C=o.kernelSize,D=void 0===C?da.LARGE:C;return Object(A.a)(this,n),(e=t.call(this,"BloomEffect","uniform sampler2D texture;uniform float intensity;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){outputColor=clamp(texture2D(texture,uv)*intensity,0.0,1.0);}",{blendFunction:c,uniforms:new Map([["texture",new r.Uniform(null)],["intensity",new r.Uniform(s)]])})).renderTarget=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,magFilter:r.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),e.renderTarget.texture.name="Bloom.Target",e.renderTarget.texture.generateMipmaps=!1,e.uniforms.get("texture").value=e.renderTarget.texture,e.blurPass=new Sa({resolutionScale:y,width:O,height:a,kernelSize:D}),e.blurPass.resolution.resizable=Object(m.a)(e),e.luminancePass=new Xa({renderTarget:e.renderTarget,colorOutput:!0}),e.luminancePass.resolution=e.resolution,e.luminanceMaterial.threshold=d,e.luminanceMaterial.smoothing=i,e}return Object(w.a)(n,[{key:"texture",get:function(){return this.renderTarget.texture}},{key:"luminanceMaterial",get:function(){return this.luminancePass.getFullscreenMaterial()}},{key:"resolution",get:function(){return this.blurPass.resolution}},{key:"width",get:function(){return this.resolution.width},set:function(e){this.resolution.width=e}},{key:"height",get:function(){return this.resolution.height},set:function(e){this.resolution.height=e}},{key:"dithering",get:function(){return this.blurPass.dithering},set:function(e){this.blurPass.dithering=e}},{key:"kernelSize",get:function(){return this.blurPass.kernelSize},set:function(e){this.blurPass.kernelSize=e}},{key:"distinction",get:function(){return console.warn(this.name,"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead."),1},set:function(e){console.warn(this.name,"The distinction field has been removed, use luminanceMaterial.threshold and luminanceMaterial.smoothing instead.")}},{key:"intensity",get:function(){return this.uniforms.get("intensity").value},set:function(e){this.uniforms.get("intensity").value=e}},{key:"getResolutionScale",value:function(){return this.resolution.scale}},{key:"setResolutionScale",value:function(e){this.resolution.scale=e}},{key:"update",value:function(e,t,r){var i=this.renderTarget;this.luminancePass.enabled?(this.luminancePass.render(e,t,i),this.blurPass.render(e,i,i)):this.blurPass.render(e,t,i)}},{key:"setSize",value:function(e,t){this.blurPass.setSize(e,t),this.renderTarget.setSize(this.resolution.width,this.resolution.height)}},{key:"initialize",value:function(e,t,i){this.blurPass.initialize(e,t,i),t||i!==r.UnsignedByteType||(this.renderTarget.texture.format=r.RGBFormat),void 0!==i&&(this.renderTarget.texture.type=i)}}]),n}(Ra),$a=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.blendFunction,l=void 0===o?Fa:o,c=e.brightness,h=void 0===c?0:c,d=e.contrast,i=void 0===d?0:d;return Object(A.a)(this,n),t.call(this,"BrightnessContrastEffect","uniform float brightness;uniform float contrast;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=inputColor.rgb+vec3(brightness-0.5);if(contrast>0.0){color/=vec3(1.0-contrast);}else{color*=vec3(1.0+contrast);}outputColor=vec4(min(color+vec3(0.5),1.0),inputColor.a);}",{blendFunction:l,uniforms:new Map([["brightness",new r.Uniform(h)],["contrast",new r.Uniform(i)]])})}return n}(Ra),eo=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Fa;return Object(A.a)(this,r),t.call(this,"ColorAverageEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){float sum=inputColor.r+inputColor.g+inputColor.b;outputColor=vec4(vec3(sum/3.0),inputColor.a);}",{blendFunction:e})}return r}(Ra),to=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=e.blendFunction,l=void 0===o?Fa:o,c=e.offset,h=void 0===c?new r.Vector2(.001,5e-4):c;return Object(A.a)(this,n),t.call(this,"ChromaticAberrationEffect","varying vec2 vUvR;varying vec2 vUvB;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 color=inputColor;\n#ifdef ALPHA\nvec2 ra=texture2D(inputBuffer,vUvR).ra;vec2 ba=texture2D(inputBuffer,vUvB).ba;color.r=ra.x;color.b=ba.x;color.a=max(max(ra.y,ba.y),inputColor.a);\n#else\ncolor.r=texture2D(inputBuffer,vUvR).r;color.b=texture2D(inputBuffer,vUvB).b;\n#endif\noutputColor=color;}",{vertexShader:"uniform vec2 offset;varying vec2 vUvR;varying vec2 vUvB;void mainSupport(const in vec2 uv){vUvR=uv+offset;vUvB=uv-offset;}",blendFunction:l,attributes:za.CONVOLUTION,uniforms:new Map([["offset",new r.Uniform(h)]])})}return Object(w.a)(n,[{key:"offset",get:function(){return this.uniforms.get("offset").value},set:function(e){this.uniforms.get("offset").value=e}},{key:"initialize",value:function(e,t,r){t?this.defines.set("ALPHA","1"):this.defines.delete("ALPHA")}}]),n}(Ra),ro=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=l.blendFunction,h=void 0===c?Fa:c,d=l.focusDistance,i=void 0===d?0:d,f=l.focalLength,v=void 0===f?.1:f,y=l.bokehScale,s=void 0===y?1:y,w=l.width,x=void 0===w?Da.AUTO_SIZE:w,O=l.height,a=void 0===O?Da.AUTO_SIZE:O;Object(A.a)(this,n),(o=t.call(this,"DepthOfFieldEffect","uniform sampler2D nearColorBuffer;uniform sampler2D farColorBuffer;uniform sampler2D nearCoCBuffer;uniform float scale;void mainImage(const in vec4 inputColor,const in vec2 uv,const in float depth,out vec4 outputColor){vec4 colorNear=texture2D(nearColorBuffer,uv);vec4 colorFar=texture2D(farColorBuffer,uv);float CoCNear=texture2D(nearCoCBuffer,uv).r;CoCNear=min(CoCNear*scale,1.0);vec4 result=inputColor*(1.0-colorFar.a)+colorFar;result=mix(result,colorNear,CoCNear);outputColor=result;}",{blendFunction:h,attributes:za.DEPTH,uniforms:new Map([["nearColorBuffer",new r.Uniform(null)],["farColorBuffer",new r.Uniform(null)],["nearCoCBuffer",new r.Uniform(null)],["scale",new r.Uniform(1)]])})).camera=e,o.renderTarget=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,magFilter:r.LinearFilter,stencilBuffer:!1,depthBuffer:!1}),o.renderTarget.texture.name="DoF.Intermediate",o.renderTarget.texture.generateMipmaps=!1,o.renderTargetMasked=o.renderTarget.clone(),o.renderTargetMasked.texture.name="DoF.Masked.Far",o.renderTargetNear=o.renderTarget.clone(),o.renderTargetNear.texture.name="DoF.Bokeh.Near",o.uniforms.get("nearColorBuffer").value=o.renderTargetNear.texture,o.renderTargetFar=o.renderTarget.clone(),o.renderTargetFar.texture.name="DoF.Bokeh.Far",o.uniforms.get("farColorBuffer").value=o.renderTargetFar.texture,o.renderTargetCoC=o.renderTarget.clone(),o.renderTargetCoC.texture.format=r.RGBFormat,o.renderTargetCoC.texture.name="DoF.CoC",o.renderTargetCoCBlurred=o.renderTargetCoC.clone(),o.renderTargetCoCBlurred.texture.name="DoF.CoC.Blurred",o.uniforms.get("nearCoCBuffer").value=o.renderTargetCoCBlurred.texture,o.cocPass=new qa(new la(e));var E=o.circleOfConfusionMaterial;E.uniforms.focusDistance.value=i,E.uniforms.focalLength.value=v,o.blurPass=new Sa({width:x,height:a,kernelSize:da.MEDIUM}),o.blurPass.resolution.resizable=Object(m.a)(o),o.maskPass=new qa(new Aa(o.renderTargetCoC.texture));var C=o.maskPass.getFullscreenMaterial();return C.maskFunction=ba.MULTIPLY_RGB_SET_ALPHA,C.colorChannel=1,o.bokehNearBasePass=new qa(new ua(!1,!0)),o.bokehNearFillPass=new qa(new ua(!0,!0)),o.bokehFarBasePass=new qa(new ua(!1,!1)),o.bokehFarFillPass=new qa(new ua(!0,!1)),o.bokehScale=s,o.target=null,o}return Object(w.a)(n,[{key:"circleOfConfusionMaterial",get:function(){return this.cocPass.getFullscreenMaterial()}},{key:"resolution",get:function(){return this.blurPass.resolution}},{key:"bokehScale",get:function(){return this.uniforms.get("scale").value},set:function(e){[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].map((function(e){return e.getFullscreenMaterial().uniforms.scale})).forEach((function(t){t.value=e})),this.maskPass.getFullscreenMaterial().uniforms.strength.value=e,this.uniforms.get("scale").value=e}},{key:"calculateFocusDistance",value:function(e){var t=this.camera,r=t.far-t.near,i=t.position.distanceTo(e);return Math.min(Math.max(i/r,0),1)}},{key:"setDepthTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BasicDepthPacking,i=this.circleOfConfusionMaterial;i.uniforms.depthBuffer.value=e,i.depthPacking=t}},{key:"update",value:function(e,t,r){var i=this.renderTarget,n=this.renderTargetCoC,s=this.renderTargetCoCBlurred,o=this.renderTargetMasked,a=this.bokehFarBasePass,l=this.bokehFarFillPass,c=a.getFullscreenMaterial().uniforms,h=l.getFullscreenMaterial().uniforms,u=this.bokehNearBasePass,d=this.bokehNearFillPass,p=u.getFullscreenMaterial().uniforms,f=d.getFullscreenMaterial().uniforms;if(null!==this.target){var v=this.calculateFocusDistance(this.target);this.circleOfConfusionMaterial.uniforms.focusDistance.value=v}this.cocPass.render(e,null,n),this.blurPass.render(e,n,s),this.maskPass.render(e,t,o),c.cocBuffer.value=h.cocBuffer.value=n.texture,a.render(e,o,i),l.render(e,i,this.renderTargetFar),p.cocBuffer.value=f.cocBuffer.value=s.texture,u.render(e,t,i),d.render(e,i,this.renderTargetNear)}},{key:"setSize",value:function(e,t){var r=this.resolution,i=[this.cocPass,this.blurPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass];i.push(this.renderTargetCoC,this.renderTargetMasked),i.forEach((function(r){return r.setSize(e,t)}));var n=r.width,s=r.height;(i=[this.renderTarget,this.renderTargetNear,this.renderTargetFar,this.renderTargetCoCBlurred]).forEach((function(e){return e.setSize(n,s)})),[this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((function(e){return e.getFullscreenMaterial().setTexelSize(1/n,1/s)}))}},{key:"initialize",value:function(e,t,i){[this.cocPass,this.maskPass,this.bokehNearBasePass,this.bokehNearFillPass,this.bokehFarBasePass,this.bokehFarFillPass].forEach((function(r){return r.initialize(e,t,i)})),this.blurPass.initialize(e,t,r.UnsignedByteType),t||i!==r.UnsignedByteType||(this.renderTargetNear.texture.type=r.RGBFormat),void 0!==i&&(this.renderTarget.texture.type=i,this.renderTargetNear.texture.type=i,this.renderTargetFar.texture.type=i,this.renderTargetMasked.texture.type=i)}}]),n}(Ra),no=(new r.Vector3,new r.Matrix4,function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=o.blendFunction,c=void 0===l?Fa:l,h=o.hue,d=void 0===h?0:h,f=o.saturation,i=void 0===f?0:f;return Object(A.a)(this,n),(e=t.call(this,"HueSaturationEffect","uniform vec3 hue;uniform float saturation;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 color=vec3(dot(inputColor.rgb,hue.xyz),dot(inputColor.rgb,hue.zxy),dot(inputColor.rgb,hue.yzx));float average=(color.r+color.g+color.b)/3.0;vec3 diff=average-color;if(saturation>0.0){color+=diff*(1.0-1.0/(1.001-saturation));}else{color+=diff*-saturation;}outputColor=vec4(min(color,1.0),inputColor.a);}",{blendFunction:c,uniforms:new Map([["hue",new r.Uniform(new r.Vector3)],["saturation",new r.Uniform(i)]])})).setHue(d),e}return Object(w.a)(n,[{key:"setHue",value:function(e){var t=Math.sin(e),r=Math.cos(e);this.uniforms.get("hue").value.set(2*r,-Math.sqrt(3)*t-r,Math.sqrt(3)*t-r).addScalar(1).divideScalar(3)}}]),n}(Ra)),io=(new r.Color,function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.blendFunction,l=void 0===o?Ia:o,c=n.premultiply,h=void 0!==c&&c;return Object(A.a)(this,r),(e=t.call(this,"NoiseEffect","void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec3 noise=vec3(rand(uv*time));\n#ifdef PREMULTIPLY\noutputColor=vec4(min(inputColor.rgb*noise,vec3(1.0)),inputColor.a);\n#else\noutputColor=vec4(noise,inputColor.a);\n#endif\n}",{blendFunction:l})).premultiply=h,e}return Object(w.a)(r,[{key:"premultiply",get:function(){return this.defines.has("PREMULTIPLY")},set:function(e){this.premultiply!==e&&(e?this.defines.set("PREMULTIPLY","1"):this.defines.delete("PREMULTIPLY"),this.setChanged())}}]),r}(Ra)),ao=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return Object(A.a)(this,n),(e=t.call(this,"PixelationEffect","uniform bool active;uniform vec2 d;void mainUv(inout vec2 uv){if(active){uv=vec2(d.x*(floor(uv.x/d.x)+0.5),d.y*(floor(uv.y/d.y)+0.5));}}",{uniforms:new Map([["active",new r.Uniform(!1)],["d",new r.Uniform(new r.Vector2)]])})).resolution=new r.Vector2,e.granularity=o,e}return Object(w.a)(n,[{key:"getGranularity",value:function(){return this.granularity}},{key:"setGranularity",value:function(e){(e=Math.floor(e))%2>0&&(e+=1);var t=this.uniforms;t.get("active").value=e>0,t.get("d").value.set(e,e).divide(this.resolution),this.granularity=e}},{key:"setSize",value:function(e,t){this.resolution.set(e,t),this.setGranularity(this.granularity)}}]),n}(Ra),oo=(new r.Vector3,new r.Vector3,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAAQCAYAAACm53kpAAAAeElEQVRYR+2XSwqAMAxEJ168ePEqwRSKhIIiuHjJqiU0gWE+1CQdApcVAMUAuARaMGCX1MIL/Ow13++9lW2s3mW9MWvsnWc/2fvGygwPAN4E8QzAA4CXAB6AHjG4JTHYI1ey3pcx6FHnEfhLDOIBKAmUBK6/ANUDTlROXAHd9EC1AAAAAElFTkSuQmCC"),so="data:image/png;base64,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",uo=function(e){Object(x.a)(n,e);var t=S(n);function n(e,o){var l,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:lo.HIGH,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pa.COLOR;Object(A.a)(this,n),(l=t.call(this,"SMAAEffect","uniform sampler2D weightMap;varying vec2 vOffset0;varying vec2 vOffset1;void movec(const in bvec2 c,inout vec2 variable,const in vec2 value){if(c.x){variable.x=value.x;}if(c.y){variable.y=value.y;}}void movec(const in bvec4 c,inout vec4 variable,const in vec4 value){movec(c.xy,variable.xy,value.xy);movec(c.zw,variable.zw,value.zw);}void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){vec4 a;a.x=texture2D(weightMap,vOffset0).a;a.y=texture2D(weightMap,vOffset1).g;a.wz=texture2D(weightMap,uv).rb;vec4 color=inputColor;if(dot(a,vec4(1.0))>=1e-5){bool h=max(a.x,a.z)>max(a.y,a.w);vec4 blendingOffset=vec4(0.0,a.y,0.0,a.w);vec2 blendingWeight=a.yw;movec(bvec4(h),blendingOffset,vec4(a.x,0.0,a.z,0.0));movec(bvec2(h),blendingWeight,a.xz);blendingWeight/=dot(blendingWeight,vec2(1.0));vec4 blendingCoord=blendingOffset*vec4(texelSize,-texelSize)+uv.xyxy;color=blendingWeight.x*texture2D(inputBuffer,blendingCoord.xy);color+=blendingWeight.y*texture2D(inputBuffer,blendingCoord.zw);}outputColor=color;}",{vertexShader:"varying vec2 vOffset0;varying vec2 vOffset1;void mainSupport(const in vec2 uv){vOffset0=uv+texelSize*vec2(1.0,0.0);vOffset1=uv+texelSize*vec2(0.0,1.0);}",blendFunction:Fa,attributes:za.CONVOLUTION|za.DEPTH,uniforms:new Map([["weightMap",new r.Uniform(null)]])})).renderTargetEdges=new r.WebGLRenderTarget(1,1,{minFilter:r.LinearFilter,stencilBuffer:!1,depthBuffer:!1,format:r.RGBFormat}),l.renderTargetEdges.texture.name="SMAA.Edges",l.renderTargetWeights=l.renderTargetEdges.clone(),l.renderTargetWeights.texture.name="SMAA.Weights",l.renderTargetWeights.texture.format=r.RGBAFormat,l.uniforms.get("weightMap").value=l.renderTargetWeights.texture,l.clearPass=new ka(!0,!1,!1),l.clearPass.overrideClearColor=new r.Color(0),l.clearPass.overrideClearAlpha=1,l.edgeDetectionPass=new qa(new va(new r.Vector2,c)),l.weightsPass=new qa(new wa);var s=new r.Texture(e);s.name="SMAA.Search",s.magFilter=r.NearestFilter,s.minFilter=r.NearestFilter,s.format=r.RGBAFormat,s.generateMipmaps=!1,s.needsUpdate=!0,s.flipY=!0;var h=new r.Texture(o);h.name="SMAA.Area",h.minFilter=r.LinearFilter,h.format=r.RGBAFormat,h.generateMipmaps=!1,h.needsUpdate=!0,h.flipY=!1;var a=l.weightsPass.getFullscreenMaterial();return a.uniforms.searchTexture.value=s,a.uniforms.areaTexture.value=h,l.applyPreset(i),l}return Object(w.a)(n,[{key:"edgeDetectionMaterial",get:function(){return this.edgeDetectionPass.getFullscreenMaterial()}},{key:"colorEdgesMaterial",get:function(){return this.edgeDetectionMaterial}},{key:"weightsMaterial",get:function(){return this.weightsPass.getFullscreenMaterial()}},{key:"setEdgeDetectionThreshold",value:function(e){this.edgeDetectionPass.getFullscreenMaterial().setEdgeDetectionThreshold(e)}},{key:"setOrthogonalSearchSteps",value:function(e){this.weightsPass.getFullscreenMaterial().setOrthogonalSearchSteps(e)}},{key:"applyPreset",value:function(e){var t=this.edgeDetectionMaterial,r=this.weightsMaterial;switch(e){case lo.LOW:t.setEdgeDetectionThreshold(.15),r.setOrthogonalSearchSteps(4),r.diagonalDetection=!1,r.cornerRounding=!1;break;case lo.MEDIUM:t.setEdgeDetectionThreshold(.1),r.setOrthogonalSearchSteps(8),r.diagonalDetection=!1,r.cornerRounding=!1;break;case lo.HIGH:t.setEdgeDetectionThreshold(.1),r.setOrthogonalSearchSteps(16),r.setDiagonalSearchSteps(8),r.setCornerRounding(25),r.diagonalDetection=!0,r.cornerRounding=!0;break;case lo.ULTRA:t.setEdgeDetectionThreshold(.05),r.setOrthogonalSearchSteps(32),r.setDiagonalSearchSteps(16),r.setCornerRounding(25),r.diagonalDetection=!0,r.cornerRounding=!0}}},{key:"setDepthTexture",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.BasicDepthPacking,i=this.edgeDetectionMaterial;i.uniforms.depthBuffer.value=e,i.depthPacking=t}},{key:"update",value:function(e,t,r){this.clearPass.render(e,this.renderTargetEdges),this.edgeDetectionPass.render(e,t,this.renderTargetEdges),this.weightsPass.render(e,this.renderTargetEdges,this.renderTargetWeights)}},{key:"setSize",value:function(e,t){var r=this.edgeDetectionPass.getFullscreenMaterial(),i=this.weightsPass.getFullscreenMaterial();this.renderTargetEdges.setSize(e,t),this.renderTargetWeights.setSize(e,t),i.uniforms.resolution.value.set(e,t),i.uniforms.texelSize.value.set(1/e,1/t),r.uniforms.texelSize.value.copy(i.uniforms.texelSize.value)}},{key:"dispose",value:function(){var e=this.weightsPass.getFullscreenMaterial().uniforms;e.searchTexture.value.dispose(),e.areaTexture.value.dispose(),Object(v.a)(Object(E.a)(n.prototype),"dispose",this).call(this)}}],[{key:"searchImageDataURL",get:function(){return oo}},{key:"areaImageDataURL",get:function(){return so}}]),n}(Ra),lo={LOW:0,MEDIUM:1,HIGH:2,ULTRA:3},co=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(A.a)(this,n);var l=Object.assign({blendFunction:Fa,eskil:!1,offset:.5,darkness:.5},o);return(e=t.call(this,"VignetteEffect","uniform float offset;uniform float darkness;void mainImage(const in vec4 inputColor,const in vec2 uv,out vec4 outputColor){const vec2 center=vec2(0.5);vec3 color=inputColor.rgb;\n#ifdef ESKIL\nvec2 coord=(uv-center)*vec2(offset);color=mix(color,vec3(1.0-darkness),dot(coord,coord));\n#else\nfloat d=distance(uv,center);color*=smoothstep(0.8,offset*0.799,d*(darkness+offset));\n#endif\noutputColor=vec4(color,inputColor.a);}",{blendFunction:l.blendFunction,uniforms:new Map([["offset",new r.Uniform(l.offset)],["darkness",new r.Uniform(l.darkness)]])})).eskil=l.eskil,e}return Object(w.a)(n,[{key:"eskil",get:function(){return this.defines.has("ESKIL")},set:function(e){this.eskil!==e&&(e?this.defines.set("ESKIL","1"):this.defines.delete("ESKIL"),this.setChanged())}}]),n}(Ra),ho=function(e){Object(x.a)(n,e);var t=S(n);function n(){return Object(A.a)(this,n),t.apply(this,arguments)}return Object(w.a)(n,[{key:"load",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;4===arguments.length?(e=arguments[1],t=arguments[3]):3!==arguments.length&&"function"==typeof arguments[0]||(e=arguments[1],t=null);var i=this.manager,n=new r.LoadingManager;return new Promise((function(r,s){var o=new Image,a=new Image;n.onError=function(e){i.itemError(e),null!==t?(t("Failed to load ".concat(e)),r()):s("Failed to load ".concat(e))},n.onLoad=function(){var t=[o,a];e(t),r(t)},o.addEventListener("error",(function(e){n.itemError("smaa-search")})),a.addEventListener("error",(function(e){n.itemError("smaa-area")})),o.addEventListener("load",(function(){i.itemEnd("smaa-search"),n.itemEnd("smaa-search")})),a.addEventListener("load",(function(){i.itemEnd("smaa-area"),n.itemEnd("smaa-area")})),i.itemStart("smaa-search"),i.itemStart("smaa-area"),n.itemStart("smaa-search"),n.itemStart("smaa-area"),o.src=oo,a.src=so}))}}]),n}(r.Loader),fo=function(){function e(t,r){Object(A.a)(this,e),this.enabled=!1,this.effect=new t(r),Object.defineProperty(this,"opacity",{enumerable:!0,set:function(e){this.effect.blendMode.opacity.value=e},get:function(){return this.effect.blendMode.opacity.value}}),Object.defineProperty(this,"blendFunction",{enumerable:!0,set:function(e){this.effect.blendMode.setBlendFunction(Number(e))},get:function(){return this.effect.blendMode.blendFunction}}),this.blendFunction=Fa}return Object(w.a)(e,[{key:"toJSON",value:function(){var e,t=Object.assign({},this),r=Object.getPrototypeOf(this),n=C(Object.getOwnPropertyNames(r));try{for(n.s();!(e=n.n()).done;){var o=e.value,l=Object.getOwnPropertyDescriptor(r,o);l&&"function"==typeof l.get&&(t[o]=this[o])}}catch(e){n.e(e)}finally{n.f()}return["constructor","effect","subscriptions"].forEach((function(e){return delete t[e]})),t}}]),e}(),vo=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e;return Object(A.a)(this,r),(e=t.call(this,Za)).blendFunction=Ia,e}return Object(w.a)(r,[{key:"intensity",get:function(){return this.effect.intensity},set:function(e){this.effect.intensity=e}},{key:"luminanceThreshold",get:function(){return this.effect.luminanceMaterial.threshold},set:function(e){this.effect.luminanceMaterial.threshold=e}},{key:"luminanceSmoothing",get:function(){return this.effect.luminanceMaterial.smoothing},set:function(e){this.effect.luminanceMaterial.smoothing=e}},{key:"blurScale",get:function(){return this.effect.blurPass.scale},set:function(e){this.effect.blurPass.scale=e}},{key:"kernelSize",get:function(){return this.effect.blurPass.kernelSize},set:function(e){this.effect.blurPass.kernelSize=e}}]),r}(fo),po=function(e){Object(x.a)(r,e);var t=S(r);function r(){return Object(A.a)(this,r),t.call(this,$a)}return Object(w.a)(r,[{key:"contrast",get:function(){return this.effect.uniforms.get("contrast").value},set:function(e){this.effect.uniforms.get("contrast").value=e}},{key:"brightness",get:function(){return this.effect.uniforms.get("brightness").value},set:function(e){this.effect.uniforms.get("brightness").value=e}}]),r}(fo),mo=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this,to)).effect.offset=new r.Vector2(.01,.01),e}return Object(w.a)(n,[{key:"offset",get:function(){return[1e3*this.effect.offset.x,1e3*this.effect.offset.y]},set:function(e){this.effect.offset.set(e[0]/1e3,e[1]/1e3)}}]),n}(fo),go=function(e){Object(x.a)(r,e);var t=S(r);function r(){return Object(A.a)(this,r),t.call(this,eo)}return r}(fo),yo=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e;return Object(A.a)(this,r),(e=t.call(this,no))._hue=0,e}return Object(w.a)(r,[{key:"hue",get:function(){return this._hue},set:function(e){this._hue=e,this.effect.setHue(e)}},{key:"saturation",get:function(){return this.effect.uniforms.get("saturation").value},set:function(e){this.effect.uniforms.get("saturation").value=e}}]),r}(fo),Ao=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e;return Object(A.a)(this,r),(e=t.call(this,io)).blendFunction=14,e}return r}(fo),bo=function(e){Object(x.a)(r,e);var t=S(r);function r(){return Object(A.a)(this,r),t.call(this,co)}return Object(w.a)(r,[{key:"eskil",get:function(){return this.effect.eskil},set:function(e){this.effect.eskil=e}},{key:"darkness",get:function(){return this.effect.uniforms.get("darkness").value},set:function(e){this.effect.uniforms.get("darkness").value=e}},{key:"offset",get:function(){return this.effect.uniforms.get("offset").value},set:function(e){this.effect.uniforms.get("offset").value=e}}]),r}(fo),wo=function(e){Object(x.a)(r,e);var t=S(r);function r(e){return Object(A.a)(this,r),t.call(this,ro,e)}return Object(w.a)(r,[{key:"focalLength",get:function(){return this.effect.circleOfConfusionMaterial.uniforms.focalLength.value},set:function(e){this.effect.circleOfConfusionMaterial.uniforms.focalLength.value=e}},{key:"focusDistance",get:function(){return this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value},set:function(e){this.effect.circleOfConfusionMaterial.uniforms.focusDistance.value=e}},{key:"bokehScale",get:function(){return this.effect.bokehScale},set:function(e){this.effect.bokehScale=e}}]),r}(fo),xo=function(e){Object(x.a)(r,e);var t=S(r);function r(){return Object(A.a)(this,r),t.call(this,ao)}return Object(w.a)(r,[{key:"granularity",get:function(){return this.effect.getGranularity()},set:function(e){this.effect.setGranularity(e)}}]),r}(fo);function Oo(e,t){return t&&t.enabled&&e.push(t.effect),e}var Eo=function(){function e(){Object(A.a)(this,e),this.effects=new Map,this.loadingManager=new r.LoadingManager,this.smaaImageLoader=new ho(this.loadingManager),this.renderPass=new La,this.depthPass=new Na,this.clock=new r.Clock,this.enabled=!1,this.debug=!1,this.effects.set("bloom",new vo),this.effects.set("chromaticAberration",new mo),this.effects.set("vignette",new bo),this.effects.set("noise",new Ao),this.effects.set("colorAverage",new go),this.effects.set("hueSaturation",new yo),this.effects.set("brightnessContrast",new po),this.effects.set("depthOfField",new wo),this.effects.set("pixelation",new xo)}return Object(w.a)(e,[{key:"reinit",value:function(){if(this.effectComposer=new(function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.depthBuffer,o=void 0===n||n,l=r.stencilBuffer,c=void 0!==l&&l,h=r.multisampling,i=void 0===h?0:h,d=r.frameBufferType;Object(A.a)(this,e),this.renderer=t,this.inputBuffer=null,this.outputBuffer=null,null!==this.renderer&&(this.renderer.autoClear=!1,this.inputBuffer=this.createBuffer(o,c,d,i),this.outputBuffer=this.inputBuffer.clone(),this.enableExtensions()),this.copyPass=new qa(new fa),this.depthTexture=null,this.passes=[],this.autoRenderToScreen=!0}return Object(w.a)(e,[{key:"multisampling",get:function(){return this.inputBuffer instanceof r.WebGLMultisampleRenderTarget?this.inputBuffer.samples:0},set:function(e){var t=this.inputBuffer,r=this.multisampling;r>0&&e>0?(this.inputBuffer.samples=e,this.outputBuffer.samples=e):r!==e&&(this.inputBuffer.dispose(),this.outputBuffer.dispose(),this.inputBuffer=this.createBuffer(t.depthBuffer,t.stencilBuffer,t.texture.type,e),this.inputBuffer.depthTexture=this.depthTexture,this.outputBuffer=this.inputBuffer.clone())}},{key:"getRenderer",value:function(){return this.renderer}},{key:"enableExtensions",value:function(){var e=this.inputBuffer.texture.type,t=this.renderer.capabilities,i=this.renderer.getContext();e!==r.UnsignedByteType&&(t.isWebGL2?i.getExtension("EXT_color_buffer_float"):i.getExtension("EXT_color_buffer_half_float"))}},{key:"replaceRenderer",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this.renderer;if(null!==i&&i!==e){var n=i.getSize(new r.Vector2),s=e.getSize(new r.Vector2),o=i.domElement.parentNode;this.renderer=e,this.renderer.autoClear=!1,n.equals(s)||this.setSize(),t&&null!==o&&(o.removeChild(i.domElement),o.appendChild(e.domElement)),this.enableExtensions()}return i}},{key:"createDepthTexture",value:function(){var e=this.depthTexture=new r.DepthTexture;return this.inputBuffer.depthTexture=e,this.inputBuffer.dispose(),this.inputBuffer.stencilBuffer?(e.format=r.DepthStencilFormat,e.type=r.UnsignedInt248Type):e.type=r.UnsignedIntType,e}},{key:"deleteDepthTexture",value:function(){if(null!==this.depthTexture){this.depthTexture.dispose(),this.depthTexture=null,this.inputBuffer.depthTexture=null,this.inputBuffer.dispose();var e,t=C(this.passes);try{for(t.s();!(e=t.n()).done;){e.value.setDepthTexture(null)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"createBuffer",value:function(e,t,i,n){var s=this.renderer.getDrawingBufferSize(new r.Vector2),o={format:this.renderer.getContext().getContextAttributes().alpha||i!==r.UnsignedByteType?r.RGBAFormat:r.RGBFormat,minFilter:r.LinearFilter,magFilter:r.LinearFilter,stencilBuffer:t,depthBuffer:e,type:i},a=n>0?new r.WebGLMultisampleRenderTarget(s.width,s.height,o):new r.WebGLRenderTarget(s.width,s.height,o);return n>0&&(a.samples=n),a.texture.name="EffectComposer.Buffer",a.texture.generateMipmaps=!1,a}},{key:"addPass",value:function(e,t){var i=this.passes,n=this.renderer,s=n.getDrawingBufferSize(new r.Vector2),o=n.getContext().getContextAttributes().alpha,a=this.inputBuffer.texture.type;if(e.setSize(s.width,s.height),e.initialize(n,o,a),this.autoRenderToScreen&&(i.length>0&&(i[i.length-1].renderToScreen=!1),e.renderToScreen&&(this.autoRenderToScreen=!1)),void 0!==t?i.splice(t,0,e):i.push(e),this.autoRenderToScreen&&(i[i.length-1].renderToScreen=!0),e.needsDepthTexture||null!==this.depthTexture)if(null===this.depthTexture){var l,c=this.createDepthTexture(),h=C(i);try{for(h.s();!(l=h.n()).done;)(e=l.value).setDepthTexture(c)}catch(e){h.e(e)}finally{h.f()}}else e.setDepthTexture(this.depthTexture)}},{key:"removePass",value:function(e){var t=this.passes,r=t.indexOf(e);if(-1!==r&&t.splice(r,1).length>0){if(null!==this.depthTexture){t.reduce((function(e,t){return e||t.needsDepthTexture}),!1)||(e.getDepthTexture()===this.depthTexture&&e.setDepthTexture(null),this.deleteDepthTexture())}this.autoRenderToScreen&&r===t.length&&(e.renderToScreen=!1,t.length>0&&(t[t.length-1].renderToScreen=!0))}}},{key:"removeAllPasses",value:function(){var e=this.passes;this.deleteDepthTexture(),e.length>0&&(this.autoRenderToScreen&&(e[e.length-1].renderToScreen=!1),this.passes=[])}},{key:"render",value:function(e){var i,t,s,r,n=this.renderer,o=this.copyPass,l=this.inputBuffer,a=this.outputBuffer,c=!1,h=C(this.passes);try{for(h.s();!(r=h.n()).done;){var d=r.value;d.enabled&&(d.render(n,l,a,e,c),d.needsSwap&&(c&&(o.renderToScreen=d.renderToScreen,i=n.getContext(),(t=n.state.buffers.stencil).setFunc(i.NOTEQUAL,1,4294967295),o.render(n,l,a,e,c),t.setFunc(i.EQUAL,1,4294967295)),s=l,l=a,a=s),d instanceof Ka?c=!0:d instanceof Ba&&(c=!1))}}catch(e){h.e(e)}finally{h.f()}}},{key:"setSize",value:function(e,t,i){var n=this.renderer;if(void 0===e||void 0===t){var o=n.getSize(new r.Vector2);e=o.width,t=o.height}else n.setSize(e,t,i);var s=n.getDrawingBufferSize(new r.Vector2);this.inputBuffer.setSize(s.width,s.height),this.outputBuffer.setSize(s.width,s.height);var l,c=C(this.passes);try{for(c.s();!(l=c.n()).done;){l.value.setSize(s.width,s.height)}}catch(e){c.e(e)}finally{c.f()}}},{key:"reset",value:function(){this.dispose(),this.autoRenderToScreen=!0}},{key:"dispose",value:function(){var e,t=C(this.passes);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(e){t.e(e)}finally{t.f()}this.passes=[],null!==this.inputBuffer&&this.inputBuffer.dispose(),null!==this.outputBuffer&&this.outputBuffer.dispose(),this.deleteDepthTexture(),this.copyPass.dispose()}}]),e}())(this.renderer),this.renderPass=new La(this.scene,this.camera),this.enabled){var e=new uo(this.search,this.area,lo.ULTRA,pa.COLOR);e.edgeDetectionMaterial.setPredicationMode(1),e.edgeDetectionMaterial.setEdgeDetectionThreshold(.05),e.edgeDetectionMaterial.setPredicationThreshold(.002),e.edgeDetectionMaterial.setPredicationScale(1),this.depthPass=new Na(this.scene,this.camera),this.effectComposer.addPass(this.renderPass),this.effectComposer.addPass(this.depthPass),this.effectComposer.addPass(new Wa(this.camera,e));var t=[this.effects.get("chromaticAberration"),this.effects.get("bloom"),this.effects.get("colorAverage"),this.effects.get("hueSaturation"),this.effects.get("brightnessContrast"),this.effects.get("vignette"),this.effects.get("noise")].reduce(Oo,[]),n=[this.effects.get("pixelation")].reduce(Oo,[]);n.length>0&&this.effectComposer.addPass(Object(l.a)(Wa,[this.camera].concat(Object(y.a)(n)))),this.effectComposer.addPass(Object(l.a)(Wa,[this.camera].concat(Object(y.a)(t))))}else this.effectComposer.addPass(this.renderPass)}},{key:"init",value:function(e){var t=this,r=e.renderer,n=e.camera,o=e.scene;return this.renderer=r,this.scene=o,this.camera=n,this.smaaImageLoader.load((function(e){var r=Object(f.a)(e,2),n=r[0],o=r[1];t.search=n,t.area=o,t.reinit()}))}},{key:"setInternalSize",value:function(e,t){var r=this.renderer,i=this.effectComposer;if(r){e=Math.round(e),t=Math.round(t);var n=r.getPixelRatio(),o=i.inputBuffer,s=o.width,l=o.height;if(s/n!==e||l/n!==t){i.inputBuffer.setSize(e*n,t*n),i.outputBuffer.setSize(e*n,t*n);var c,h=C(i.passes);try{for(h.s();!(c=h.n()).done;){c.value.setSize(e*n,t*n)}}catch(e){h.e(e)}finally{h.f()}}}}},{key:"fromJSON",value:function(e){var t=this;e&&(Object.keys(e).forEach((function(r){var n=e[r],i=t.effects.get(r);Object.keys(n).forEach((function(e){i[e]=n[e]}))})),this.enabled=e.enabled)}},{key:"toJSON",value:function(){var e={};return this.effects.forEach((function(t,r){e[r]=t.toJSON()}),e),Object.assign({enabled:this.enabled},e)}},{key:"render",value:function(){var e;null===(e=this.effectComposer)||void 0===e||e.render(this.clock.getDelta())}}]),e}(),Co=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.call(this)).objectType="Scene",e.alpha=1,e.backupFog=new r.Fog(16777215,.1,2e3),e.fogUseBGColor=!1,e.directionalLightState=!0,e.ambientLightState=!0,e.shadowsState=!0,e.wireframeState=!1,e._color=new r.Color(1644825),e.canvas={mode:1,preset:"fullscreen",size:{width:512,height:512},editorSize:{width:1,height:1},color:[0,0,0,.5]},e.name="Untitled",e}return Object(w.a)(n,[{key:"color",get:function(){return this._color},set:function(e){!0===this.fogUseBGColor&&this.backupFog.color.copy(e),this._color.copy(e)}},{key:"enableFog",get:function(){return null!==this.fog},set:function(e){this.fog=!0===e?this.backupFog:null}},{key:"init",value:function(e,t){this.camera=new Yi(e,t),this.camera.setDefault(),this.camera.orthoCamera.near=-5e4,this.camera.perspCamera.near=50,this.camera.orthoCamera.far=1e5,this.camera.perspCamera.far=1e5,this.camera.updateProjectionMatrix(),this.camera.position.set(0,0,this.camera.targetOffset),this.camera.lookAt(new r.Vector3(0,0,-1)),this.add(this.camera),this.canvas.size.width=e,this.canvas.size.height=t,this.ambientLight=new r.HemisphereLight(13882323,8553090,.75),this.ambientLight.name="Default Ambient Light",this.add(this.ambientLight),this.directionalLight=new r.DirectionalLight(16777215,.75),this.directionalLight.name="Default Directional Light",this.directionalLight.position.set(85e4,13e5,1e6),this.activeCamera=this.camera,this.activeCamera.add(this.directionalLight),this.postprocessing=new Eo}},{key:"initFromObjectLoader",value:function(e){var t=this;return this.traverse((function(r){r.uuid===e.ambientLight?t.ambientLight=r:r.uuid===e.directionalLight?t.directionalLight=r:(r.uuid===e.activeCamera&&(t.activeCamera=r),r.uuid===e.camera&&(t.camera=r,t.camera.setDefault()))})),this}},{key:"addDefaultChild",value:function(){var e=new jr,t=e.userData.layers,r=t.head.id;t.getLayer(r).uniforms["f".concat(r,"_color")].value.setRGB(1,1,1);var i=new na(it.create({parameters:{width:320,height:320}}),e);return i.position.z=-1,this.add(i),i}},{key:"raycast",value:function(e){var t=[];return function r(i){var n,o=C(i.children);try{for(o.s();!(n=o.n()).done;){var l=n.value;Ci(l)&&!l.raycastLock&&l.visible&&((mt(l)||gt(l)&&l.enableHelper)&&e.intersectObject(l,!1,t),r(l))}}catch(e){o.e(e)}finally{o.f()}}(this),t}},{key:"traverseEntity",value:function(e){var t,r=C(this.children);try{for(r.s();!(t=r.n()).done;){var n=t.value;Ci(n)&&this.camera!==n&&n.traverseEntity(e)}}catch(e){r.e(e)}finally{r.f()}}},{key:"toJSON",value:function(e){var t,i,o,s,l,a=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),c=a.object;return c.objectType="Scene",c.activeCamera=null===(t=this.activeCamera)||void 0===t?void 0:t.uuid,c.camera=null===(i=this.camera)||void 0===i?void 0:i.uuid,c.directionalLight=null===(o=this.directionalLight)||void 0===o?void 0:o.uuid,c.ambientLight=null===(s=this.ambientLight)||void 0===s?void 0:s.uuid,c.color=this.color.toArray(),c.alpha=this.alpha,this.background instanceof r.Texture?c.background=this.background.toJSON(e):this.background instanceof r.Color&&(c.background=this.background.toArray()),null!==this.environment&&(c.environment=this.environment.toJSON(e)),!0===this.enableFog&&(c.enableFog=!0,!0===this.fogUseBGColor&&(c.fogUseBGColor=!0),null!==this.fog&&(c.fog=this.fog.toJSON())),!0===this.directionalLightState&&(c.directionalLightState=!0),!0===this.ambientLightState&&(c.ambientLightState=!0),!0===this.shadowsState&&(c.shadowsState=!0),!0===this.wireframeState&&(c.wireframeState=!0),c.canvas={mode:this.canvas.mode,preset:this.canvas.preset,editorSize:{width:window.innerWidth,height:window.innerHeight},color:this.canvas.color},1!==this.canvas.mode&&(c.canvas.size={width:this.canvas.size.width,height:this.canvas.size.height}),c.postprocessing=null===(l=this.postprocessing)||void 0===l?void 0:l.toJSON(),a}},{key:"fromJSON",value:function(e){var t,i,o,s,l,a;Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e),this.postprocessing=new Eo,this.color.fromArray(e.color),this.alpha=e.alpha,void 0!==e.background&&Array.isArray(e.background)&&(this.background=(new r.Color).fromArray(e.background)),void 0!==e.fog&&("FogExp2"===e.fog.type?this.backupFog=new r.FogExp2(e.fog.color,e.fog.density):this.backupFog=new r.Fog(e.fog.color,e.fog.near,e.fog.far)),this.fogUseBGColor=null!==(t=e.fogUseBGColor)&&void 0!==t&&t,this.enableFog=null!==(i=e.enableFog)&&void 0!==i&&i,this.directionalLightState=null!==(o=e.directionalLightState)&&void 0!==o&&o,this.ambientLightState=null!==(s=e.ambientLightState)&&void 0!==s&&s,this.shadowsState=null!==(l=e.shadowsState)&&void 0!==l&&l,this.wireframeState=null!==(a=e.wireframeState)&&void 0!==a&&a;var c=e.canvas;return this.canvas.mode=c.mode,c.size&&(this.canvas.size={width:c.size.width,height:c.size.height}),this.canvas.editorSize=c.editorSize?{width:c.editorSize.width,height:c.editorSize.height}:{width:window.innerWidth,height:window.innerHeight},c.color&&(this.canvas.color=Object(y.a)(c.color)),this.postprocessing.fromJSON(e.postprocessing),this}},{key:"dispose",value:function(){this.traverseEntity((function(e){"geometry"in e&&e.geometry.dispose(),"material"in e&&(e.material instanceof Array?e.material.forEach((function(e){return e.dispose()})):e.material.dispose())}))}}]),n}(Ei(r.Scene));!function(e){e[e.STANDARD=1]="STANDARD",e[e.UPPERCASE=2]="UPPERCASE",e[e.LOWERCASE=3]="LOWERCASE"}(Ha||(Ha={})),function(e){e[e.TOP=1]="TOP",e[e.MIDDLE=2]="MIDDLE",e[e.BOTTOM=3]="BOTTOM"}(Ja||(Ja={})),function(e){e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.CENTER=3]="CENTER",e[e.JUSTIFY=4]="JUSTIFY"}(Qa||(Qa={})),function(e){e[e.TO_RIGHT=1]="TO_RIGHT",e[e.TO_LEFT=-1]="TO_LEFT"}(Ya||(Ya={}));var Do=new r.Vector2,So=function(){function e(t,n,i){Object(A.a)(this,e),this.message=[],this.endLine=!0,this.yLinePos=t,this.lineHeight=n,this.maxCharSize=i,this.nextChar3DPos=new r.Vector2(0,this.yLinePos+this.maxCharSize*this.lineHeight),this.align=Qa.LEFT}return Object(w.a)(e,[{key:"addChar3D",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.message.length;this.message.splice(r,0,e),e.fontSize>this.maxCharSize?(this.maxCharSize=e.fontSize,this.nextChar3DPos.y=this.yLinePos+this.maxCharSize*this.lineHeight,this.fullUpdate(t)):(e.updatePosition(this.nextChar3DPos,t),this.nextChar3DPos.x+=e.charSize)}},{key:"deleteChar3D",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.message.length-1,t=this.message[e];return t?(this.message.splice(e,1),this.nextChar3DPos.x-=t.charSize,t):void 0}},{key:"isEndLine",value:function(e){this.endLine=e}},{key:"fullUpdate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.nextChar3DPos.x=0;for(var r=t,n=this.message.length;r<n;r+=1)this.message[r].updatePosition(this.nextChar3DPos,e),this.nextChar3DPos.x+=this.message[r].charSize}},{key:"checkOverFlow",value:function(e){var t,r=this.message.length-1;if(r<=0)return!1;for(;r>=0;){if(" "!==this.message[r].char){t=this.message[r];break}r-=1}return!!(r>=0&&t&&t.localPosition.x+t.charSize>e)}},{key:"containSpaceOverFlow",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.message.length-1,t=e;t>=0;t-=1)if(" "===this.message[t].char)return!0;return!1}},{key:"containSpace",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.message.length-1;if(this.endLine)return!0;for(var t=e;t>=0;t-=1)if(" "===this.message[t].char)return!0;return!1}},{key:"popWord",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.message.length-1,r=[],i=!0;for(e=t;e>=0;e-=1){if(" "===this.message[e].char){i=!1,0===r.length&&(e-=1,r.splice(0,0,this.message[e]));break}r.splice(0,0,this.message[e])}return i?r=[]:this.message.splice(e+1,r.length),r}},{key:"getWord",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=[],i=e;for(i=e;;i+=t){if(!this.message[i]||" "===this.message[i].char){0===r.length&&this.message[i]&&(r.push(this.message[i]),this.message.splice(i,1));break}t>0?(r.push(this.message[i]),this.message.splice(i,1),i-=t):(r.splice(0,0,this.message[i]),this.message.splice(i,1))}return r}},{key:"getWordAtIndex",value:function(e){for(var t=[],r=e;r<this.message.length&&" "!==this.message[r].char;r++)t.push(this.message[r]);for(var n=e-1;n>=0&&" "!==this.message[n].char;n--)t.splice(0,0,this.message[n]);return t}},{key:"wordSize",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=0,i=e;i>=0&&i<this.message.length;){if(" "===this.message[i].char){0===r&&(r=this.message[i].charSize);break}r+=this.message[i].charSize,i+=t}return(i<0||i>=this.message.length)&&!this.endLine?this.message[e]?this.message[e].charSize:999999999:0===r?999999999:r}},{key:"spaceLeft",value:function(e){return e-this.nextChar3DPos.x}},{key:"popChar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.message.length-1;return this.nextChar3DPos.x-=this.message[e].charSize,this.message.splice(e,1)}},{key:"isEmpty",value:function(){return!this.message.length}},{key:"updateNextCharPosY",value:function(){this.nextChar3DPos.y=this.yLinePos+this.maxCharSize*this.lineHeight}},{key:"updateYLinePos",value:function(e){this.yLinePos=e,this.updateNextCharPosY()}},{key:"updatelineHeight",value:function(e){this.lineHeight=e,this.updateNextCharPosY()}},{key:"updateFontSize",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.message.length-1,n=t;n<=r;n+=1)this.message[n].updateFontSize(e);this.maxCharSize=e,this.nextChar3DPos.y=this.yLinePos+this.maxCharSize*this.lineHeight}},{key:"countSpaces",value:function(){for(var e=0,t=0;t<this.message.length;t++)" "===this.message[t].char&&(e+=1);return e}},{key:"alignText",value:function(e,t,r,i,n){switch(r){case Qa.LEFT:this.leftAlign(e,n);break;case Qa.CENTER:this.centerAlign(this.spaceLeft(t),e,n);break;case Qa.RIGHT:this.rightAlign(this.spaceLeft(t),e,n);break;case Qa.JUSTIFY:this.justifyAlign(this.spaceLeft(t),e,n)}}},{key:"offsetCharacters",value:function(e,t,r){Do.set(t,r);for(var i=this.message.length,n=0;n<i;n++)this.message[n].updatePosition(this.message[n].localPosition.add(Do),e)}},{key:"leftAlign",value:function(e,t){this.align=Qa.LEFT,this.offsetCharacters(e,0,t)}},{key:"centerAlign",value:function(e,t,r){this.align=Qa.CENTER,this.offsetCharacters(t,e/2,r)}},{key:"rightAlign",value:function(e,t,r){this.align=Qa.RIGHT,this.offsetCharacters(t,e,r)}},{key:"justifyAlign",value:function(e,t,r){if(this.align=Qa.JUSTIFY,this.endLine)this.offsetCharacters(t,0,r);else{var i=this.countSpaces();if(0!==i)for(var n=e/i,s=0,o=0;o<this.message.length;o++)" "===this.message[o].char&&(s+=n),Do.set(s,r),this.message[o].updatePosition(this.message[o].localPosition.add(Do),t);else this.offsetCharacters(t,0,r)}}},{key:"clone",value:function(){var t=new e(this.yLinePos,this.lineHeight,this.maxCharSize);t.nextChar3DPos=this.nextChar3DPos.clone(),t.align=this.align,t.endLine=this.endLine;for(var r=0;r<this.message.length;r++)t.message.push(this.message[r].clone());return t}}]),e}(),Bo=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o,l=e.char,c=e.originalChar,i=e.fontFamily,h=e.letterSpacing,s=e.fontSize,d=e.LOD,f=void 0===d?16:d,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new r.MeshBasicMaterial({color:0,opacity:1,visible:!0,transparent:!0,side:r.DoubleSide});Object(A.a)(this,n);var v=n.loadChar(l,i,f);return(o=t.call(this,v.geometry,a)).char=l,o.originalChar=null!=c?c:l,o.fontFamily=i,o.letterSpacing=h,o.fontSize=s,o.LOD=f,o.resolution=v.resolution,o.glyphsHa=v.glyphsHa,o.localPosition=new r.Vector2,o.charSize=0,o.geometry.userData={type:"CharacterGeometry",parameters:{char:o.char,fontFamily:o.fontFamily,letterSpacing:o.letterSpacing,fontSize:o.fontSize,lod:o.LOD,resolution:o.resolution,charSize:o.charSize,localPosition:o.localPosition}},o.updateFontSize(o.fontSize),o}return Object(w.a)(n,[{key:"updatePosition",value:function(e,t){this.localPosition.copy(e);var i=new r.Vector3(this.localPosition.x,-this.localPosition.y,0);this.position.copy(i).add(t)}},{key:"updateFontSize",value:function(e){var t=e/this.resolution;this.fontSize=e,this.scale.set(this.fontSize,this.fontSize,1),this.charSize=this.glyphsHa*t*this.letterSpacing}},{key:"updateFontFamily",value:function(e){if(this.fontFamily!==e){this.fontFamily=e;var t=n.loadChar(this.char,e,this.LOD);this.geometry=t.geometry,this.resolution=t.resolution,this.glyphsHa=t.glyphsHa,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}}},{key:"updateChar",value:function(e){if(this.char!==e){this.char=e;var t=n.loadChar(e,this.fontFamily,this.LOD);this.geometry=t.geometry,this.resolution=t.resolution,this.glyphsHa=t.glyphsHa,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}}},{key:"updateLetterSpacing",value:function(e){this.letterSpacing!==e&&(this.letterSpacing=e,this.updateFontSize(this.fontSize))}},{key:"updateLOD",value:function(e){if(this.LOD!==e){this.LOD=e;var t=n.loadChar(this.char,this.fontFamily,this.LOD);this.geometry=t.geometry,this.resolution=t.resolution,this.glyphsHa=t.glyphsHa,this.geometry.userData={type:"CharacterGeometry",parameters:{char:this.char,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,lod:this.LOD,resolution:this.resolution,charSize:this.charSize,localPosition:this.localPosition}},this.updateFontSize(this.fontSize)}}},{key:"clone",value:function(){return new n({char:this.char,originalChar:this.originalChar,fontFamily:this.fontFamily,letterSpacing:this.letterSpacing,fontSize:this.fontSize,LOD:this.LOD}).copy(this)}}],[{key:"FONTS_PATH",get:function(){return n._fontPath},set:function(e){n._fontPath=e}},{key:"loadFont",value:function(e){return new Promise((function(t,i){n.fontCache[e]?t(n.fontCache[e]):(new r.FontLoader).load(n.FONTS_PATH+e+".json",(function(r){n.fontCache[e]=r,t(r)}),void 0,i)}))}},{key:"loadChar",value:function(e,t,i){if(n.charCache[e]){if(n.charCache[e][i]&&n.charCache[e][i].fontFamily===t)return n.charCache[e][i]}else n.charCache[e]={};var o=n.fontCache[t],s=o.generateShapes(e,1);return n.charCache[e][i]={geometry:new r.ShapeBufferGeometry(s,i),fontFamily:t,resolution:o.data.resolution,glyphsHa:o.data.glyphs[e].ha},n.charCache[e][i]}}]),n}(r.Mesh);Bo.charCache={},Bo.fontCache={},Bo._fontPath="/_assets/_fonts/";var To=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jr({transparent:!0,opacity:1,visible:!1,side:r.DoubleSide});return Object(A.a)(this,n),(o=t.call(this,e,l)).objectType="TextFrame",o.material.visible=!1,o._geometryUserData=e.userData,o.userData.textFrame={hexColor:6974058,opacity:1,visible:!0,fontSize:16,lineHeight:1.5,letterSpacing:1,fontFamily:"roboto_regular",textTransform:Ha.STANDARD,horizontalAlignment:1,verticalAlignment:Ja.TOP,LOD:16,maxLineSize:o._geometryUserData.parameters.width,textOrigin:new r.Vector3(-.5*o._geometryUserData.parameters.width,.5*o._geometryUserData.parameters.height,0),textLines:[]},o.createTextLine(),o}return Object(w.a)(n,[{key:"raycast",value:function(e,t){var r=[];if(Object(v.a)(Object(E.a)(n.prototype),"raycast",this).call(this,e,r),r.length>0)t.push(r[0]);else for(var i=[],o=0,l=this.children.length;o<l;++o)if(this.children[o]instanceof Bo&&(e.intersectObject(this.children[o],!1,i),i.length>0))return i[0].object=this,void t.push(i[0])}},{key:"updateGeometry",value:function(e){var t,r,i=this.userData,o=this.geometry.userData,s=o.parameters.width,l=null===(t=e.parameters)||void 0===t?void 0:t.width,a=null===(r=e.parameters)||void 0===r?void 0:r.height,c=o.parameters.height,h=i.textFrame;Object(v.a)(Object(E.a)(n.prototype),"updateGeometry",this).call(this,e),h.maxLineSize=o.parameters.width,h.textOrigin.set(-.5*o.parameters.width,.5*o.parameters.height,0),void 0!==a&&c!==a?(this.checkOverFlow(),this.checkCapacity()):void 0!==l&&(s<l?this.checkCapacity():s>l&&this.checkOverFlow())}},{key:"checkOverFlow",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.userData,r=t.textFrame.textOrigin,i=t.textFrame.textLines,n=e;n<i.length;n++){i[n].updateYLinePos(this.getNewLinePosition(n)),i[n].fullUpdate(r);for(var o=[];i[n].checkOverFlow(t.textFrame.maxLineSize);)i[n].containSpaceOverFlow()?o.splice(0,0,i[n].getWord(i[n].message.length-1,Ya.TO_LEFT)):o.splice(0,0,i[n].popChar());if(o.length>0){void 0===i[n+1]&&(i[n].isEndLine(!1),this.createTextLine());for(var l=0,s=0;s<o.length;s+=1)for(var c=0;c<o[s].length;c+=1)i[n+1].addChar3D(o[s][c],r,l),l+=1;i[n+1].fullUpdate(r)}i[n].fullUpdate(r)}this.textFullUpdate(e)}},{key:"checkCapacity",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.userData,r=t.textFrame.textOrigin,i=t.textFrame.maxLineSize,n=t.textFrame.textLines,o=e;o<n.length;o+=1)if(n[o].updateYLinePos(this.getNewLinePosition(o)),n[o].fullUpdate(r),n[o-1])for(;!n[o-1].endLine;){var l=void 0,s=n[o-1].spaceLeft(i);if(!(n[o].wordSize(0,Ya.TO_RIGHT)<=s)){n[o].isEmpty()?(n[o].endLine&&n[o-1].isEndLine(!0),n.splice(o,1),o-=1):(n[o].updateYLinePos(this.getNewLinePosition(o)),n[o].fullUpdate(r));break}l=n[o].containSpace()?n[o].getWord(0,Ya.TO_RIGHT):n[o].popChar(0);for(var c=0;c<l.length;c+=1)l[c]&&n[o-1].addChar3D(l[c],r)}this.textFullUpdate(e)}},{key:"createTextLine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.userData.textFrame.textLines.length,t=this.userData.textFrame;t.textLines.splice(e,0,new So(this.getNewLinePosition(e),t.lineHeight,t.fontSize))}},{key:"textFullUpdate",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.userData.textFrame,r=t.textLines,i=this.getVerticalAlignmentOffSet(),n=e;n<r.length;n++)r[n].updateYLinePos(this.getNewLinePosition(n)),r[n].fullUpdate(t.textOrigin),r[n].alignText(t.textOrigin,t.maxLineSize,t.horizontalAlignment,t.verticalAlignment,i)}},{key:"getVerticalAlignmentOffSet",value:function(){switch(this.userData.textFrame.verticalAlignment){case Ja.TOP:return 0;case Ja.MIDDLE:return this.getRemainingVerticalSpace()/2;case Ja.BOTTOM:return this.getRemainingVerticalSpace();default:return 0}}},{key:"getRemainingVerticalSpace",value:function(){var e=this.userData.textFrame.textLines;return this.geometry.userData.parameters.height-this.getNewLinePosition(e.length)}},{key:"getNewLinePosition",value:function(e){for(var t=this.userData.textFrame.textLines,r=0,n=0;n<e;n+=1)r+=t[n].maxCharSize*t[n].lineHeight;return r}},{key:"updateColor",value:function(e){var t=this.userData;t.textFrame.hexColor=e;for(var r=t.textFrame.textLines,n=0;n<r.length;n++)for(var o=r[n].message,l=0;l<o.length;l++)o[l].material.color.setHex(e)}},{key:"updateOpacity",value:function(e){var t=this.userData;t.textFrame.opacity=e;for(var r=t.textFrame.textLines,n=0;n<r.length;n++)for(var o=r[n].message,l=0;l<o.length;l++)o[l].material.opacity=e}},{key:"updateVisible",value:function(e){var t=this.userData;t.textFrame.visible=e;for(var r=t.textFrame.textLines,n=0;n<r.length;n++)for(var o=r[n].message,l=0;l<o.length;l++)o[l].material.visible=e}},{key:"updateFontFamily",value:function(e){return vr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,o,l,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Bo.loadFont(e);case 2:for(r=this.userData.textFrame,n=r.textLines,r.fontFamily=e,o=0;o<n.length;o++)for(l=n[o].message,c=0;c<l.length;c++)l[c].updateFontFamily(e);this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity();case 6:case"end":return t.stop()}}),t,this)})))}},{key:"updateFontSize",value:function(e){var t=this.userData.textFrame,r=t.textLines,i=t.fontSize;t.fontSize=e;for(var n=0;n<r.length;n++)r[n].updateFontSize(e);this.textFullUpdate(),e>i?this.checkOverFlow():e<i&&this.checkCapacity()}},{key:"updateTextTransform",value:function(e){return vr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,n,o,l,c,h,d,f,v,m,y;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.userData.textFrame,t.next=3,Bo.loadFont(r.fontFamily);case 3:n=r.textLines,t.t0=(r.textTransform=e,e),t.next=t.t0===Ha.UPPERCASE?7:t.t0===Ha.LOWERCASE?9:11;break;case 7:for(o=0;o<n.length;o++)for(l=n[o].message,c=0;c<l.length;c++)n[o].message[c].updateChar(l[c].char.toUpperCase());return t.abrupt("break",12);case 9:for(h=0;h<n.length;h++)for(d=n[h].message,f=0;f<d.length;f++)n[h].message[f].updateChar(d[f].char.toLowerCase());return t.abrupt("break",12);case 11:for(v=0;v<n.length;v++)for(m=n[v].message,y=0;y<m.length;y++)n[v].message[y].updateChar(m[y].originalChar);case 12:this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity();case 13:case"end":return t.stop()}}),t,this)})))}},{key:"updateLetterSpacing",value:function(e){var t=this.userData,r=t.textFrame.textLines;t.textFrame.letterSpacing=e;for(var n=0;n<r.length;n++)for(var o=r[n].message,l=0;l<o.length;l++)o[l].updateLetterSpacing(e);this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity()}},{key:"updateLOD",value:function(e){var t=this.userData;t.textFrame.LOD=e;for(var r=t.textFrame.textLines,n=0;n<r.length;n++);this.textFullUpdate(),this.checkOverFlow(),this.checkCapacity()}},{key:"updateLineHeight",value:function(e){var t=this.userData,r=t.textFrame.textLines;t.textFrame.lineHeight=e;for(var n=0;n<r.length;n++)r[n].updatelineHeight(e);this.textFullUpdate()}},{key:"updateVerticalAlignment",value:function(e){this.userData.textFrame.verticalAlignment=e,this.textFullUpdate()}},{key:"updateHorizontalAlignment",value:function(e){this.userData.textFrame.horizontalAlignment=e,this.textFullUpdate()}},{key:"copy",value:function(e,t){Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e,t);var i=this.userData,o=e.userData,s=this.geometry.userData;i.textFrame.textOrigin=new r.Vector3(-.5*s.parameters.width,.5*s.parameters.height,0);var l=o.textFrame.textLines;i.textFrame.textLines=[];for(var c=0;c<l.length;c++){var h=l[c].clone(),d=h.message;i.textFrame.textLines.push(h);for(var f=0;f<d.length;f++)this.add(d[f])}return this.textFullUpdate(),this.updateColor(o.textFrame.hexColor),this}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(n.prototype),"toJSON",this).call(this,e),r=t.object;r.objectType="TextFrame";var i=this.userData.textFrame.textLines.map((function(e){var t=e.message.map((function(e){return{char:e.char,originalChar:e.originalChar,fontFamily:e.fontFamily,letterSpacing:e.letterSpacing,fontSize:e.fontSize,LOD:e.LOD}}));return{align:e.align,endLine:e.endLine,lineHeight:e.lineHeight,maxCharSize:e.maxCharSize,yLinePos:e.yLinePos,message:t}}));return r.userData.textFrame.textLinesData=i,t}},{key:"fromJSONasync",value:function(e){var t=this,o=Object.create(null,{fromJSON:{get:function(){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",t)}}});return vr(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,l,c=this;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.fromJSON.call(this,e),void 0===e.userData){t.next=7;break}return n=e.userData.textFrame,t.next=4,Bo.loadFont(n.fontFamily);case 4:n.textOrigin=new r.Vector3(n.textOrigin.x,n.textOrigin.y,n.textOrigin.z),l=new r.MeshBasicMaterial({color:n.hexColor,opacity:n.opacity,visible:n.visible,transparent:!0,side:r.DoubleSide}),n.textLinesData&&(n.textLines=n.textLinesData.map((function(e,t){var r=new So(Number(e.yLinePos),Number(e.lineHeight),Number(e.maxCharSize)),s=e.message.map((function(e,s){if(void 0===e.char){var o=n.textLines[t].message[s];if("geometries"in o){var h=o.geometries[0].userData.parameters;Object.assign(e,{LOD:h.lod,char:h.char,fontFamily:h.fontFamily,fontSize:h.fontSize,letterSpacing:h.letterSpacing,originalChar:h.char})}}var d={char:e.char,fontFamily:e.fontFamily,letterSpacing:Number(e.letterSpacing),fontSize:Number(e.fontSize),LOD:e.LOD},a=new Bo(d,l.clone());return r.addChar3D(a,n.textOrigin),c.add(a),a}));return r.message=s,r})),this.userData.textFrame=n),this.textFullUpdate();case 7:return t.abrupt("return",this);case 8:case"end":return t.stop()}}),t,this)})))}}]),n}(ki);To.VERTICAL_ALIGN=Ja,To.HORIZONTAL_ALIGN=Qa,To.TEXT_TRANSFORM=Ha,To.TRAVEL_DIRECTION=Ya;var ko,_o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{};function Mo(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets option of @rollup/plugin-commonjs appropriately for this require call to behave properly.')}!function(e){var t={exports:{}};!function(e,t){e.exports=function(){function e(t,r,i){function n(o,a){if(!r[o]){if(!t[o]){if(!a&&Mo)return Mo(o);if(s)return s(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[o]={exports:{}};t[o][0].call(c.exports,(function(e){return n(t[o][1][e]||e)}),c,c.exports,e,t,r,i)}return r[o].exports}for(var s=Mo,o=0;o<i.length;o++)n(i[o]);return n}return e}()({1:[function(e,t,r){var i=e("inherits"),n=e("multimath"),s=e("./mm_unsharp_mask"),o=e("./mm_resize");function a(e){var t=e||[],r={js:t.indexOf("js")>=0,wasm:t.indexOf("wasm")>=0};n.call(this,r),this.features={js:r.js,wasm:r.wasm&&this.has_wasm()},this.use(s),this.use(o)}i(a,n),a.prototype.resizeAndUnsharp=function(e,t){var r=this.resize(e,t);return e.unsharpAmount&&this.unsharp_mask(r,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),r},t.exports=a},{"./mm_resize":4,"./mm_unsharp_mask":9,inherits:19,multimath:20}],2:[function(e,t,r){function i(e){return e<0?0:e>255?255:e}function n(e,t,r,n,s,o){var a,l,c,h,u,d,p,f,v,g,m,y=0,A=0;for(v=0;v<n;v++){for(u=0,g=0;g<s;g++){for(d=o[u++],p=o[u++],f=y+4*d|0,a=l=c=h=0;p>0;p--)h=h+(m=o[u++])*e[f+3]|0,c=c+m*e[f+2]|0,l=l+m*e[f+1]|0,a=a+m*e[f]|0,f=f+4|0;t[A+3]=i(h+8192>>14),t[A+2]=i(c+8192>>14),t[A+1]=i(l+8192>>14),t[A]=i(a+8192>>14),A=A+4*n|0}A=4*(v+1)|0,y=(v+1)*r*4|0}}function s(e,t,r,n,s,o){var a,l,c,h,u,d,p,f,v,g,m,y=0,A=0;for(v=0;v<n;v++){for(u=0,g=0;g<s;g++){for(d=o[u++],p=o[u++],f=y+4*d|0,a=l=c=h=0;p>0;p--)h=h+(m=o[u++])*e[f+3]|0,c=c+m*e[f+2]|0,l=l+m*e[f+1]|0,a=a+m*e[f]|0,f=f+4|0;t[A+3]=i(h+8192>>14),t[A+2]=i(c+8192>>14),t[A+1]=i(l+8192>>14),t[A]=i(a+8192>>14),A=A+4*n|0}A=4*(v+1)|0,y=(v+1)*r*4|0}}t.exports={convolveHorizontally:n,convolveVertically:s}},{}],3:[function(e,t,r){t.exports="AGFzbQEAAAAADAZkeWxpbmsAAAAAAAEXA2AAAGAGf39/f39/AGAHf39/f39/fwACDwEDZW52Bm1lbW9yeQIAAAMEAwABAgYGAX8AQQALB1cFEV9fd2FzbV9jYWxsX2N0b3JzAAAIY29udm9sdmUAAQpjb252b2x2ZUhWAAIMX19kc29faGFuZGxlAwAYX193YXNtX2FwcGx5X2RhdGFfcmVsb2NzAAAK7AMDAwABC8YDAQ9/AkAgA0UNACAERQ0AA0AgDCENQQAhE0EAIQcDQCAHQQJqIQYCfyAHQQF0IAVqIgcuAQIiFEUEQEGAwAAhCEGAwAAhCUGAwAAhCkGAwAAhCyAGDAELIBIgBy4BAGohCEEAIQsgFCEHQQAhDiAGIQlBACEPQQAhEANAIAUgCUEBdGouAQAiESAAIAhBAnRqKAIAIgpBGHZsIBBqIRAgCkH/AXEgEWwgC2ohCyAKQRB2Qf8BcSARbCAPaiEPIApBCHZB/wFxIBFsIA5qIQ4gCEEBaiEIIAlBAWohCSAHQQFrIgcNAAsgC0GAQGshCCAOQYBAayEJIA9BgEBrIQogEEGAQGshCyAGIBRqCyEHIAEgDUECdGogCUEOdSIGQf8BIAZB/wFIGyIGQQAgBkEAShtBCHRBgP4DcSAKQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EQdEGAgPwHcSALQQ51IgZB/wEgBkH/AUgbIgZBACAGQQBKG0EYdHJyIAhBDnUiBkH/ASAGQf8BSBsiBkEAIAZBAEobcjYCACADIA1qIQ0gE0EBaiITIARHDQALIAxBAWoiDCACbCESIAMgDEcNAAsLCx4AQQAgAiADIAQgBSAAEAEgAkEAIAQgBSAGIAEQAQs="},{}],4:[function(e,t,r){t.exports={name:"resize",fn:e("./resize"),wasm_fn:e("./resize_wasm"),wasm_src:e("./convolve_wasm_base64")}},{"./convolve_wasm_base64":3,"./resize":5,"./resize_wasm":8}],5:[function(e,t,r){var i=e("./resize_filter_gen"),n=e("./convolve").convolveHorizontally,s=e("./convolve").convolveVertically;function o(e,t,r){for(var i=3,n=t*r*4|0;i<n;)e[i]=255,i=i+4|0}t.exports=function(e){var t=e.src,r=e.width,a=e.height,l=e.toWidth,c=e.toHeight,h=e.scaleX||e.toWidth/e.width,u=e.scaleY||e.toHeight/e.height,d=e.offsetX||0,p=e.offsetY||0,f=e.dest||new Uint8Array(l*c*4),v=void 0===e.quality?3:e.quality,g=e.alpha||!1,m=i(v,r,l,h,d),y=i(v,a,c,u,p),A=new Uint8Array(l*a*4);return n(t,A,r,a,l,m),s(A,f,a,l,c,y),g||o(f,l,c),f}},{"./convolve":2,"./resize_filter_gen":6}],6:[function(e,t,r){var i=e("./resize_filter_info"),n=14;function s(e){return Math.round(e*((1<<n)-1))}t.exports=function(e,t,r,n,o){var a,l,c,h,u,d,p,f,v,g,m,y,A,w,x,b,O,E=i[e].filter,C=1/n,D=Math.min(1,n),S=i[e].win/D,B=Math.floor(2*(S+1)),T=new Int16Array((B+2)*r),k=0,_=!T.subarray||!T.set;for(a=0;a<r;a++){for(l=(a+.5)*C+o,c=Math.max(0,Math.floor(l-S)),u=(h=Math.min(t-1,Math.ceil(l+S)))-c+1,d=new Float32Array(u),p=new Int16Array(u),f=0,v=c,g=0;v<=h;v++,g++)f+=m=E((v+.5-l)*D),d[g]=m;for(y=0,g=0;g<d.length;g++)y+=A=d[g]/f,p[g]=s(A);for(p[r>>1]+=s(1-y),w=0;w<p.length&&0===p[w];)w++;if(w<p.length){for(x=p.length-1;x>0&&0===p[x];)x--;if(b=c+w,O=x-w+1,T[k++]=b,T[k++]=O,_)for(g=w;g<=x;g++)T[k++]=p[g];else T.set(p.subarray(w,x+1),k),k+=O}else T[k++]=0,T[k++]=0}return T}},{"./resize_filter_info":7}],7:[function(e,t,r){t.exports=[{win:.5,filter:function(e){return e>=-.5&&e<.5?1:0}},{win:1,filter:function(e){if(e<=-1||e>=1)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*(.54+.46*Math.cos(t/1))}},{win:2,filter:function(e){if(e<=-2||e>=2)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/2)/(t/2)}},{win:3,filter:function(e){if(e<=-3||e>=3)return 0;if(e>-1.1920929e-7&&e<1.1920929e-7)return 1;var t=e*Math.PI;return Math.sin(t)/t*Math.sin(t/3)/(t/3)}}]},{}],8:[function(e,t,r){var i=e("./resize_filter_gen");function n(e,t,r){for(var i=3,n=t*r*4|0;i<n;)e[i]=255,i=i+4|0}function s(e){return new Uint8Array(e.buffer,0,e.byteLength)}var o=!0;try{o=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0]}catch(e){}function a(e,t,r){if(o)t.set(s(e),r);else for(var i=r,n=0;n<e.length;n++){var a=e[n];t[i++]=255&a,t[i++]=a>>8&255}}t.exports=function(e){var t=e.src,r=e.width,s=e.height,o=e.toWidth,l=e.toHeight,c=e.scaleX||e.toWidth/e.width,h=e.scaleY||e.toHeight/e.height,u=e.offsetX||0,d=e.offsetY||0,p=e.dest||new Uint8Array(o*l*4),f=void 0===e.quality?3:e.quality,v=e.alpha||!1,g=i(f,r,o,c,u),m=i(f,s,l,h,d),y=0,A=this.__align(y+Math.max(t.byteLength,p.byteLength)),w=this.__align(A+s*o*4),x=this.__align(w+g.byteLength),b=x+m.byteLength,O=this.__instance("resize",b),E=new Uint8Array(this.__memory.buffer),C=new Uint32Array(this.__memory.buffer),D=new Uint32Array(t.buffer);return C.set(D),a(g,E,w),a(m,E,x),(O.exports.convolveHV||O.exports._convolveHV)(w,x,A,r,s,o,l),new Uint32Array(p.buffer).set(new Uint32Array(this.__memory.buffer,0,l*o)),v||n(p,o,l),p}},{"./resize_filter_gen":6}],9:[function(e,t,r){t.exports={name:"unsharp_mask",fn:e("./unsharp_mask"),wasm_fn:e("./unsharp_mask_wasm"),wasm_src:e("./unsharp_mask_wasm_base64")}},{"./unsharp_mask":10,"./unsharp_mask_wasm":11,"./unsharp_mask_wasm_base64":12}],10:[function(e,t,r){var i=e("glur/mono16");function n(e,t,r){for(var i,n,s,o,a=t*r,l=new Uint16Array(a),c=0;c<a;c++)i=e[4*c],n=e[4*c+1],s=e[4*c+2],o=i>=n&&i>=s?i:n>=s&&n>=i?n:s,l[c]=o<<8;return l}t.exports=function(e,t,r,s,o,a){var l,c,h,u,d;if(!(0===s||o<.5)){o>2&&(o=2);var p=n(e,t,r),f=new Uint16Array(p);i(f,t,r,o);for(var v=s/100*4096+.5|0,g=a<<8,m=t*r,y=0;y<m;y++)u=(l=p[y])-f[y],Math.abs(u)>=g&&(h=((c=(c=(c=l+(v*u+2048>>12))>65280?65280:c)<0?0:c)<<12)/(l=0!==l?l:1)|0,e[d=4*y]=e[d]*h+2048>>12,e[d+1]=e[d+1]*h+2048>>12,e[d+2]=e[d+2]*h+2048>>12)}}},{"glur/mono16":18}],11:[function(e,t,r){t.exports=function(e,t,r,i,n,s){if(!(0===i||n<.5)){n>2&&(n=2);var o=t*r,a=4*o,l=2*o,c=2*o,h=4*Math.max(t,r),u=32,d=0,p=a,f=p+l,v=f+c,g=v+c,m=g+h,y=this.__instance("unsharp_mask",a+l+2*c+h+u,{exp:Math.exp}),A=new Uint32Array(e.buffer);new Uint32Array(this.__memory.buffer).set(A);var w=y.exports.hsv_v16||y.exports._hsv_v16;w(d,p,t,r),(w=y.exports.blurMono16||y.exports._blurMono16)(p,f,v,g,m,t,r,n),(w=y.exports.unsharp||y.exports._unsharp)(d,d,p,f,t,r,i,s),A.set(new Uint32Array(this.__memory.buffer,0,o))}}},{}],12:[function(e,t,r){t.exports="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"},{}],13:[function(e,t,r){var i=100;function n(e,t){this.create=e,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0,this.idle=t||2e3}n.prototype.acquire=function(){var e,t=this;return 0!==this.available.length?e=this.available.pop():((e=this.create()).id=this.lastId++,e.release=function(){return t.release(e)}),this.acquired[e.id]=e,e},n.prototype.release=function(e){var t=this;delete this.acquired[e.id],e.lastUsed=Date.now(),this.available.push(e),0===this.timeoutId&&(this.timeoutId=setTimeout((function(){return t.gc()}),i))},n.prototype.gc=function(){var e=this,t=Date.now();this.available=this.available.filter((function(r){return!(t-r.lastUsed>e.idle&&(r.destroy(),1))})),0!==this.available.length?this.timeoutId=setTimeout((function(){return e.gc()}),i):this.timeoutId=0},t.exports=n},{}],14:[function(e,t,r){var i=2;t.exports=function(e,t,r,n,s,o){var a=r/e,l=n/t,c=(2*o+i+1)/s;if(c>.5)return[[r,n]];var h=Math.ceil(Math.log(Math.min(a,l))/Math.log(c));if(h<=1)return[[r,n]];for(var u=[],d=0;d<h;d++){var p=Math.round(Math.pow(Math.pow(e,h-d-1)*Math.pow(r,d+1),1/h)),f=Math.round(Math.pow(Math.pow(t,h-d-1)*Math.pow(n,d+1),1/h));u.push([p,f])}return u}},{}],15:[function(e,t,r){var i=1e-5;function n(e){var t=Math.round(e);return Math.abs(e-t)<i?t:Math.floor(e)}function s(e){var t=Math.round(e);return Math.abs(e-t)<i?t:Math.ceil(e)}t.exports=function(e){var t,r,i,o,a,l,c=e.toWidth/e.width,h=e.toHeight/e.height,u=n(e.srcTileSize*c)-2*e.destTileBorder,d=n(e.srcTileSize*h)-2*e.destTileBorder;if(u<1||d<1)throw new Error("Internal error in pica: target tile width/height is too small.");var p,f=[];for(o=0;o<e.toHeight;o+=d)for(i=0;i<e.toWidth;i+=u)(t=i-e.destTileBorder)<0&&(t=0),t+(a=i+u+e.destTileBorder-t)>=e.toWidth&&(a=e.toWidth-t),(r=o-e.destTileBorder)<0&&(r=0),r+(l=o+d+e.destTileBorder-r)>=e.toHeight&&(l=e.toHeight-r),p={toX:t,toY:r,toWidth:a,toHeight:l,toInnerX:i,toInnerY:o,toInnerWidth:u,toInnerHeight:d,offsetX:t/c-n(t/c),offsetY:r/h-n(r/h),scaleX:c,scaleY:h,x:n(t/c),y:n(r/h),width:s(a/c),height:s(l/h)},f.push(p);return f}},{}],16:[function(e,t,r){function i(e){return Object.prototype.toString.call(e)}t.exports.isCanvas=function(e){var t=i(e);return"[object HTMLCanvasElement]"===t||"[object OffscreenCanvas]"===t||"[object Canvas]"===t},t.exports.isImage=function(e){return"[object HTMLImageElement]"===i(e)},t.exports.isImageBitmap=function(e){return"[object ImageBitmap]"===i(e)},t.exports.limiter=function(e){var t=0,r=[];function i(){t<e&&r.length&&(t++,r.shift()())}return function(e){return new Promise((function(n,s){r.push((function(){e().then((function(e){n(e),t--,i()}),(function(e){s(e),t--,i()}))})),i()}))}},t.exports.cib_quality_name=function(e){switch(e){case 0:return"pixelated";case 1:return"low";case 2:return"medium"}return"high"},t.exports.cib_support=function(e){return Promise.resolve().then((function(){if("undefined"==typeof createImageBitmap)return!1;var t=e(100,100);return createImageBitmap(t,0,0,100,100,{resizeWidth:10,resizeHeight:10,resizeQuality:"high"}).then((function(e){var r=10===e.width;return e.close(),t=null,r}))})).catch((function(){return!1}))},t.exports.worker_offscreen_canvas_support=function(){return new Promise((function(e,t){if("undefined"!=typeof OffscreenCanvas){var r=btoa("(".concat(n.toString(),")(self);")),i=new Worker("data:text/javascript;base64,".concat(r));i.onmessage=function(t){return e(t.data)},i.onerror=t}else e(!1);function n(e){"undefined"!=typeof createImageBitmap?Promise.resolve().then((function(){var e=new OffscreenCanvas(10,10);return e.getContext("2d").rect(0,0,1,1),createImageBitmap(e,0,0,1,1)})).then((function(){return e.postMessage(!0)}),(function(){return e.postMessage(!1)})):e.postMessage(!1)}})).then((function(e){return e}),(function(){return!1}))},t.exports.can_use_canvas=function(e){var t=!1;try{var r=e(2,1).getContext("2d"),i=r.createImageData(2,1);i.data[0]=12,i.data[1]=23,i.data[2]=34,i.data[3]=255,i.data[4]=45,i.data[5]=56,i.data[6]=67,i.data[7]=255,r.putImageData(i,0,0),i=null,12===(i=r.getImageData(0,0,2,1)).data[0]&&23===i.data[1]&&34===i.data[2]&&255===i.data[3]&&45===i.data[4]&&56===i.data[5]&&67===i.data[6]&&255===i.data[7]&&(t=!0)}catch(e){}return t},t.exports.cib_can_use_region=function(){return new Promise((function(e){if("undefined"!=typeof createImageBitmap){var t=new Image;t.src="data:image/jpeg;base64,/9j/4QBiRXhpZgAATU0AKgAAAAgABQESAAMAAAABAAYAAAEaAAUAAAABAAAASgEbAAUAAAABAAAAUgEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAAAAABIAAAAAQAAAEgAAAAB/9sAQwAEAwMEAwMEBAMEBQQEBQYKBwYGBgYNCQoICg8NEBAPDQ8OERMYFBESFxIODxUcFRcZGRsbGxAUHR8dGh8YGhsa/9sAQwEEBQUGBQYMBwcMGhEPERoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoa/8IAEQgAAQACAwERAAIRAQMRAf/EABQAAQAAAAAAAAAAAAAAAAAAAAf/xAAUAQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIQAxAAAAF/P//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAQUCf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Bf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Bf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEABj8Cf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8hf//aAAwDAQACAAMAAAAQH//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQMBAT8Qf//EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQIBAT8Qf//EABQQAQAAAAAAAAAAAAAAAAAAAAD/2gAIAQEAAT8Qf//Z",t.onload=function(){createImageBitmap(t,0,0,t.width,t.height).then((function(r){r.width===t.width&&r.height===t.height?e(!0):e(!1)}),(function(){return e(!1)}))},t.onerror=function(){return e(!1)}}else e(!1)}))}},{}],17:[function(e,t,r){t.exports=function(){var t,r=e("./mathlib");onmessage=function(e){var i=e.data.opts,n=!1;if(!i.src&&i.srcBitmap){var s=new OffscreenCanvas(i.width,i.height),o=s.getContext("2d",{alpha:Boolean(i.alpha)});o.drawImage(i.srcBitmap,0,0),i.src=o.getImageData(0,0,i.width,i.height).data,s.width=s.height=0,s=null,i.srcBitmap.close(),i.srcBitmap=null,n=!0}t||(t=new r(e.data.features));var a=t.resizeAndUnsharp(i);if(n){var l=new ImageData(new Uint8ClampedArray(a),i.toWidth,i.toHeight),c=new OffscreenCanvas(i.toWidth,i.toHeight);c.getContext("2d",{alpha:Boolean(i.alpha)}).putImageData(l,0,0),createImageBitmap(c).then((function(e){postMessage({bitmap:e},[e])}))}else postMessage({data:a},[a.buffer])}}},{"./mathlib":1}],18:[function(e,t,r){var i,n,s,o,a,l;function c(e){e<.5&&(e=.5);var t=Math.exp(.527076)/e,r=Math.exp(-t),c=Math.exp(-2*t),h=(1-r)*(1-r)/(1+2*t*r-c);return i=h,n=h*(t-1)*r,s=h*(t+1)*r,o=-h*c,a=2*r,l=-c,new Float32Array([i,n,s,o,a,l,(i+n)/(1-a-l),(s+o)/(1-a-l)])}function h(e,t,r,i,n,s){var o,a,l,c,h,u,d,p,f,v,g,m,y,A;for(f=0;f<s;f++){for(d=f,p=0,c=h=(o=e[u=f*n])*i[6],g=i[0],m=i[1],y=i[4],A=i[5],v=0;v<n;v++)l=(a=e[u])*g+o*m+c*y+h*A,h=c,c=l,o=a,r[p]=c,p++,u++;for(p--,d+=s*(n-1),c=h=(o=e[--u])*i[7],a=o,g=i[2],m=i[3],v=n-1;v>=0;v--)l=a*g+o*m+c*y+h*A,h=c,c=l,o=a,a=e[u],t[d]=r[p]+c,u--,p--,d-=s}}function u(e,t,r,i){if(i){var n=new Uint16Array(e.length),s=new Float32Array(Math.max(t,r)),o=c(i);h(e,n,s,o,t,r),h(n,e,s,o,r,t)}}t.exports=u},{}],19:[function(e,t,r){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},{}],20:[function(e,t,r){var i=e("object-assign"),n=e("./lib/base64decode"),s=e("./lib/wa_detect"),o={js:!0,wasm:!0};function a(e){if(!(this instanceof a))return new a(e);var t=i({},o,e||{});if(this.options=t,this.__cache={},this.__init_promise=null,this.__modules=t.modules||{},this.__memory=null,this.__wasm={},this.__isLE=1===new Uint32Array(new Uint8Array([1,0,0,0]).buffer)[0],!this.options.js&&!this.options.wasm)throw new Error('mathlib: at least "js" or "wasm" should be enabled')}a.prototype.has_wasm=s,a.prototype.use=function(e){return this.__modules[e.name]=e,this.options.wasm&&this.has_wasm()&&e.wasm_fn?this[e.name]=e.wasm_fn:this[e.name]=e.fn,this},a.prototype.init=function(){if(this.__init_promise)return this.__init_promise;if(!this.options.js&&this.options.wasm&&!this.has_wasm())return Promise.reject(new Error('mathlib: only "wasm" was enabled, but it\'s not supported'));var e=this;return this.__init_promise=Promise.all(Object.keys(e.__modules).map((function(t){var r=e.__modules[t];return e.options.wasm&&e.has_wasm()&&r.wasm_fn?e.__wasm[t]?null:WebAssembly.compile(e.__base64decode(r.wasm_src)).then((function(r){e.__wasm[t]=r})):null}))).then((function(){return e})),this.__init_promise},a.prototype.__base64decode=n,a.prototype.__reallocate=function(e){if(!this.__memory)return this.__memory=new WebAssembly.Memory({initial:Math.ceil(e/65536)}),this.__memory;var t=this.__memory.buffer.byteLength;return t<e&&this.__memory.grow(Math.ceil((e-t)/65536)),this.__memory},a.prototype.__instance=function(e,t,r){if(t&&this.__reallocate(t),!this.__wasm[e]){var n=this.__modules[e];this.__wasm[e]=new WebAssembly.Module(this.__base64decode(n.wasm_src))}if(!this.__cache[e]){var s={memoryBase:0,memory:this.__memory,tableBase:0,table:new WebAssembly.Table({initial:0,element:"anyfunc"})};this.__cache[e]=new WebAssembly.Instance(this.__wasm[e],{env:i(s,r||{})})}return this.__cache[e]},a.prototype.__align=function(e,t){var r=e%(t=t||8);return e+(r?t-r:0)},t.exports=a},{"./lib/base64decode":21,"./lib/wa_detect":22,"object-assign":23}],21:[function(e,t,r){var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports=function(e){for(var t=e.replace(/[\r\n=]/g,""),r=t.length,n=new Uint8Array(3*r>>2),s=0,o=0,a=0;a<r;a++)a%4==0&&a&&(n[o++]=s>>16&255,n[o++]=s>>8&255,n[o++]=255&s),s=s<<6|i.indexOf(t.charAt(a));var l=r%4*6;return 0===l?(n[o++]=s>>16&255,n[o++]=s>>8&255,n[o++]=255&s):18===l?(n[o++]=s>>10&255,n[o++]=s>>2&255):12===l&&(n[o++]=s>>4&255),n}},{}],22:[function(e,t,r){var i;t.exports=function(){if(void 0!==i)return i;if(i=!1,"undefined"==typeof WebAssembly)return i;try{var e=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),t=new WebAssembly.Module(e);return 0!==new WebAssembly.Instance(t,{}).exports.test(4)&&(i=!0),i}catch(e){}return i}},{}],23:[function(e,t,r){var i=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable;function o(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}function a(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},r=0;r<10;r++)t["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach((function(e){i[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(e){return!1}}t.exports=a()?Object.assign:function(e,t){for(var r,a,l=o(e),c=1;c<arguments.length;c++){for(var h in r=Object(arguments[c]))n.call(r,h)&&(l[h]=r[h]);if(i){a=i(r);for(var u=0;u<a.length;u++)s.call(r,a[u])&&(l[a[u]]=r[a[u]])}}return l}},{}],24:[function(e,t,r){var i=arguments[3],n=arguments[4],s=arguments[5],o=JSON.stringify;t.exports=function(e,t){for(var r,a=Object.keys(s),l=0,c=a.length;l<c;l++){var h=a[l],u=s[h].exports;if(u===e||u&&u.default===e){r=h;break}}if(!r){r=Math.floor(Math.pow(16,8)*Math.random()).toString(16);var d={};for(l=0,c=a.length;l<c;l++)d[h=a[l]]=h;n[r]=["function(require,module,exports){"+e+"(self); }",d]}var p=Math.floor(Math.pow(16,8)*Math.random()).toString(16),f={};f[r]=r,n[p]=["function(require,module,exports){var f = require("+o(r)+");(f.default ? f.default : f)(self);}",f];var v={};function g(e){for(var t in v[e]=!0,n[e][1]){var r=n[e][1][t];v[r]||g(r)}}g(p);var m="("+i+")({"+Object.keys(v).map((function(e){return o(e)+":["+n[e][0]+","+o(n[e][1])+"]"})).join(",")+"},{},["+o(p)+"])",y=window.URL||window.webkitURL||window.mozURL||window.msURL,A=new Blob([m],{type:"text/javascript"});if(t&&t.bare)return A;var w=y.createObjectURL(A),x=new Worker(w);return x.objectURL=w,x}},{}],"/index.js":[function(e,t,r){function i(e,t){return l(e)||a(e,t)||s(e,t)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function a(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,s=[],o=!0,a=!1;try{for(r=r.call(e);!(o=(i=r.next()).done)&&(s.push(i.value),!t||s.length!==t);o=!0);}catch(e){a=!0,n=e}finally{try{o||null==r.return||r.return()}finally{if(a)throw n}}return s}}function l(e){if(Array.isArray(e))return e}var c=e("object-assign"),h=e("webworkify"),u=e("./lib/mathlib"),d=e("./lib/pool"),p=e("./lib/utils"),f=e("./lib/worker"),v=e("./lib/stepper"),g=e("./lib/tiler"),m={},y=!1;try{"undefined"!=typeof navigator&&navigator.userAgent&&(y=navigator.userAgent.indexOf("Safari")>=0)}catch(e){}var A=1;"undefined"!=typeof navigator&&(A=Math.min(navigator.hardwareConcurrency||1,4));var w={tile:1024,concurrency:A,features:["js","wasm","ww"],idle:2e3,createCanvas:function(e,t){var r=document.createElement("canvas");return r.width=e,r.height=t,r}},x={quality:3,alpha:!1,unsharpAmount:0,unsharpRadius:0,unsharpThreshold:0},b=!1,O=!1,E=!1,C=!1,D=!1;function S(){return{value:h(f),destroy:function(){if(this.value.terminate(),"undefined"!=typeof window){var e=window.URL||window.webkitURL||window.mozURL||window.msURL;e&&e.revokeObjectURL&&this.value.objectURL&&e.revokeObjectURL(this.value.objectURL)}}}}function B(e){if(!(this instanceof B))return new B(e);this.options=c({},w,e||{});var t="lk_".concat(this.options.concurrency);this.__limit=m[t]||p.limiter(this.options.concurrency),m[t]||(m[t]=this.__limit),this.features={js:!1,wasm:!1,cib:!1,ww:!1},this.__workersPool=null,this.__requested_features=[],this.__mathlib=null}B.prototype.init=function(){var t=this;if(this.__initPromise)return this.__initPromise;if("undefined"!=typeof ImageData&&"undefined"!=typeof Uint8ClampedArray)try{new ImageData(new Uint8ClampedArray(400),10,10),b=!0}catch(e){}"undefined"!=typeof ImageBitmap&&(ImageBitmap.prototype&&ImageBitmap.prototype.close?O=!0:this.debug("ImageBitmap does not support .close(), disabled"));var r=this.options.features.slice();if(r.indexOf("all")>=0&&(r=["cib","wasm","js","ww"]),this.__requested_features=r,this.__mathlib=new u(r),r.indexOf("ww")>=0&&"undefined"!=typeof window&&"Worker"in window)try{e("webworkify")((function(){})).terminate(),this.features.ww=!0;var i="wp_".concat(JSON.stringify(this.options));m[i]?this.__workersPool=m[i]:(this.__workersPool=new d(S,this.options.idle),m[i]=this.__workersPool)}catch(e){}var n,s,o=this.__mathlib.init().then((function(e){c(t.features,e.features)}));n=O?p.cib_support(this.options.createCanvas).then((function(e){t.features.cib&&r.indexOf("cib")<0?t.debug("createImageBitmap() resize supported, but disabled by config"):r.indexOf("cib")>=0&&(t.features.cib=e)})):Promise.resolve(!1),E=p.can_use_canvas(this.options.createCanvas),s=(s=O&&b&&-1!==r.indexOf("ww")?p.worker_offscreen_canvas_support():Promise.resolve(!1)).then((function(e){C=e}));var a=p.cib_can_use_region().then((function(e){D=e}));return this.__initPromise=Promise.all([o,n,s,a]).then((function(){return t})),this.__initPromise},B.prototype.__invokeResize=function(e,t){var r=this;return t.__mathCache=t.__mathCache||{},Promise.resolve().then((function(){return r.features.ww?new Promise((function(i,n){var s=r.__workersPool.acquire();t.cancelToken&&t.cancelToken.catch((function(e){return n(e)})),s.value.onmessage=function(e){s.release(),e.data.err?n(e.data.err):i(e.data)};var o=[];e.src&&o.push(e.src.buffer),e.srcBitmap&&o.push(e.srcBitmap),s.value.postMessage({opts:e,features:r.__requested_features,preload:{wasm_nodule:r.__mathlib.__}},o)})):{data:r.__mathlib.resizeAndUnsharp(e,t.__mathCache)}}))},B.prototype.__extractTileData=function(e,t,r,i,n){if(this.features.ww&&C&&(p.isCanvas(t)||D))return this.debug("Create tile for OffscreenCanvas"),createImageBitmap(i.srcImageBitmap||t,e.x,e.y,e.width,e.height).then((function(e){return n.srcBitmap=e,n}));if(p.isCanvas(t))return i.srcCtx||(i.srcCtx=t.getContext("2d",{alpha:Boolean(r.alpha)})),this.debug("Get tile pixel data"),n.src=i.srcCtx.getImageData(e.x,e.y,e.width,e.height).data,n;this.debug("Draw tile imageBitmap/image to temporary canvas");var s=this.options.createCanvas(e.width,e.height),o=s.getContext("2d",{alpha:Boolean(r.alpha)});return o.globalCompositeOperation="copy",o.drawImage(i.srcImageBitmap||t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),this.debug("Get tile pixel data"),n.src=o.getImageData(0,0,e.width,e.height).data,s.width=s.height=0,n},B.prototype.__landTileData=function(e,t,r){var i;if(this.debug("Convert raw rgba tile result to ImageData"),t.bitmap)return r.toCtx.drawImage(t.bitmap,e.toX,e.toY),null;if(b)i=new ImageData(new Uint8ClampedArray(t.data),e.toWidth,e.toHeight);else if((i=r.toCtx.createImageData(e.toWidth,e.toHeight)).data.set)i.data.set(t.data);else for(var n=i.data.length-1;n>=0;n--)i.data[n]=t.data[n];return this.debug("Draw tile"),y?r.toCtx.putImageData(i,e.toX,e.toY,e.toInnerX-e.toX,e.toInnerY-e.toY,e.toInnerWidth+1e-5,e.toInnerHeight+1e-5):r.toCtx.putImageData(i,e.toX,e.toY,e.toInnerX-e.toX,e.toInnerY-e.toY,e.toInnerWidth,e.toInnerHeight),null},B.prototype.__tileAndResize=function(e,t,r){var i=this,n={srcCtx:null,srcImageBitmap:null,isImageBitmapReused:!1,toCtx:null},s=function(t){return i.__limit((function(){if(r.canceled)return r.cancelToken;var s={width:t.width,height:t.height,toWidth:t.toWidth,toHeight:t.toHeight,scaleX:t.scaleX,scaleY:t.scaleY,offsetX:t.offsetX,offsetY:t.offsetY,quality:r.quality,alpha:r.alpha,unsharpAmount:r.unsharpAmount,unsharpRadius:r.unsharpRadius,unsharpThreshold:r.unsharpThreshold};return i.debug("Invoke resize math"),Promise.resolve(s).then((function(s){return i.__extractTileData(t,e,r,n,s)})).then((function(e){return i.debug("Invoke resize math"),i.__invokeResize(e,r)})).then((function(e){return r.canceled?r.cancelToken:(n.srcImageData=null,i.__landTileData(t,e,n))}))}))};return Promise.resolve().then((function(){if(n.toCtx=t.getContext("2d",{alpha:Boolean(r.alpha)}),p.isCanvas(e))return null;if(p.isImageBitmap(e))return n.srcImageBitmap=e,n.isImageBitmapReused=!0,null;if(p.isImage(e))return O?(i.debug("Decode image via createImageBitmap"),createImageBitmap(e).then((function(e){n.srcImageBitmap=e})).catch((function(e){return null}))):null;throw new Error('Pica: ".from" should be Image, Canvas or ImageBitmap')})).then((function(){if(r.canceled)return r.cancelToken;i.debug("Calculate tiles");var e=g({width:r.width,height:r.height,srcTileSize:i.options.tile,toWidth:r.toWidth,toHeight:r.toHeight,destTileBorder:r.__destTileBorder}).map((function(e){return s(e)}));function o(e){e.srcImageBitmap&&(e.isImageBitmapReused||e.srcImageBitmap.close(),e.srcImageBitmap=null)}return i.debug("Process tiles"),Promise.all(e).then((function(){return i.debug("Finished!"),o(n),t}),(function(e){throw o(n),e}))}))},B.prototype.__processStages=function(e,t,r,n){var s=this;if(n.canceled)return n.cancelToken;var o,a=i(e.shift(),2),l=a[0],h=a[1],u=0===e.length;return n=c({},n,{toWidth:l,toHeight:h,quality:u?n.quality:Math.min(1,n.quality)}),u||(o=this.options.createCanvas(l,h)),this.__tileAndResize(t,u?r:o,n).then((function(){return u?r:(n.width=l,n.height=h,s.__processStages(e,o,r,n))})).then((function(e){return o&&(o.width=o.height=0),e}))},B.prototype.__resizeViaCreateImageBitmap=function(e,t,r){var i=this,n=t.getContext("2d",{alpha:Boolean(r.alpha)});return this.debug("Resize via createImageBitmap()"),createImageBitmap(e,{resizeWidth:r.toWidth,resizeHeight:r.toHeight,resizeQuality:p.cib_quality_name(r.quality)}).then((function(e){if(r.canceled)return r.cancelToken;if(!r.unsharpAmount)return n.drawImage(e,0,0),e.close(),n=null,i.debug("Finished!"),t;i.debug("Unsharp result");var s=i.options.createCanvas(r.toWidth,r.toHeight),o=s.getContext("2d",{alpha:Boolean(r.alpha)});o.drawImage(e,0,0),e.close();var a=o.getImageData(0,0,r.toWidth,r.toHeight);return i.__mathlib.unsharp_mask(a.data,r.toWidth,r.toHeight,r.unsharpAmount,r.unsharpRadius,r.unsharpThreshold),n.putImageData(a,0,0),s.width=s.height=0,a=o=s=n=null,i.debug("Finished!"),t}))},B.prototype.resize=function(e,t,r){var i=this;this.debug("Start resize...");var n=c({},x);if(isNaN(r)?r&&(n=c(n,r)):n=c(n,{quality:r}),n.toWidth=t.width,n.toHeight=t.height,n.width=e.naturalWidth||e.width,n.height=e.naturalHeight||e.height,0===t.width||0===t.height)return Promise.reject(new Error("Invalid output size: ".concat(t.width,"x").concat(t.height)));n.unsharpRadius>2&&(n.unsharpRadius=2),n.canceled=!1,n.cancelToken&&(n.cancelToken=n.cancelToken.then((function(e){throw n.canceled=!0,e}),(function(e){throw n.canceled=!0,e})));var s=3;return n.__destTileBorder=Math.ceil(Math.max(s,2.5*n.unsharpRadius|0)),this.init().then((function(){if(n.canceled)return n.cancelToken;if(i.features.cib)return i.__resizeViaCreateImageBitmap(e,t,n);if(!E){var r=new Error("Pica: cannot use getImageData on canvas, make sure fingerprinting protection isn't enabled");throw r.code="ERR_GET_IMAGE_DATA",r}var s=v(n.width,n.height,n.toWidth,n.toHeight,i.options.tile,n.__destTileBorder);return i.__processStages(s,e,t,n)}))},B.prototype.resizeBuffer=function(e){var t=this,r=c({},x,e);return this.init().then((function(){return t.__mathlib.resizeAndUnsharp(r)}))},B.prototype.toBlob=function(e,t,r){return t=t||"image/png",new Promise((function(i){if(e.toBlob)e.toBlob((function(e){return i(e)}),t,r);else if(e.convertToBlob)i(e.convertToBlob({type:t,quality:r}));else{for(var n=atob(e.toDataURL(t,r).split(",")[1]),s=n.length,o=new Uint8Array(s),a=0;a<s;a++)o[a]=n.charCodeAt(a);i(new Blob([o],{type:t}))}}))},B.prototype.debug=function(){},t.exports=B},{"./lib/mathlib":1,"./lib/pool":13,"./lib/stepper":14,"./lib/tiler":15,"./lib/utils":16,"./lib/worker":17,"object-assign":23,webworkify:24}]},{},[])("/index.js")}(t)}(),function(e){e[e.TEXT=0]="TEXT",e[e.ARRAY_BUFFER=1]="ARRAY_BUFFER",e[e.BINARY_STRING=2]="BINARY_STRING"}(ko||(ko={}));function Lo(e){!function(e){var t;if(void 0!==e){var r,n=C(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(void 0!==(null===(t=o.userData)||void 0===t?void 0:t.type)){var l=o.userData.parameters;"extrudeDepth"in l||Object.assign(l,{extrudeDepth:0}),"extrudeBevelSize"in l||Object.assign(l,{extrudeBevelSize:0}),"extrudeBevelSegments"in l||Object.assign(l,{extrudeBevelSegments:1})}}}catch(e){n.e(e)}finally{n.f()}}}(e.geometries),function(e){if(void 0!==e){var t,n=C(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;if(void 0!==o.quaternion){var l=(new r.Quaternion).fromArray(o.quaternion);Object.assign(o,{rotation:(new r.Euler).setFromQuaternion(l).toArray()})}}}catch(e){n.e(e)}finally{n.f()}}}(e.interactionStates),No(e.object),function(e){if(void 0!==e){var t,r=C(e);try{for(r.s();!(t=r.n()).done;)for(var n=t.value.userData.layers.head;n;){for(var o in n.uniforms){var l="f".concat(n.id,"_tex"),c="f".concat(n.id,"_texture");o===l&&(n.uniforms[c]=n.uniforms[l],delete n.uniforms[l])}n=n.next}}catch(e){r.e(e)}finally{r.f()}}}(e.materials)}function No(e){var t,i,n,s;if(void 0===(null===(t=e.userData)||void 0===t?void 0:t.type))if("OrthographicCamera"===e.type||"PerspectiveCamera"===e.type){var o=e;Object.assign(e,{objectType:"CombinedCamera",cameraType:o.type,isDefaultCamera:!0,hiddenMatrix:(new r.Matrix4).toArray(),name:"Default Camera",far:1e5,zoomOrtho:o.zoom,zoomPersp:1,nearOrtho:-5e4,nearPersp:50}),delete e.type,void 0!==o.typeCamera&&(Object.assign(e,{cameraType:o.typeCamera}),delete e.typeCamera)}else"Scene"===e.type?(Object.assign(e,{objectType:e.type}),delete e.type):"HemisphereLight"===e.type?Object.assign(e,{isDefaultAmbientLight:!0}):"DirectionalLight"===e.type&&Object.assign(e,{isDefaultDirectionalLight:!0});if(void 0!==e.userData){var l=e.userData;void 0!==l.type&&(Object.assign(e,{objectType:l.type}),delete l.type),void 0!==l.interaction&&(Object.assign(e,{interaction:l.interaction}),delete l.interaction),!0===l.isDefaultAmbientLight?(Object.assign(e,{isDefaultAmbientLight:!0}),delete l.isDefaultAmbientLight):!0===l.isDefaultDirectionalLight?(Object.assign(e,{isDefaultDirectionalLight:!0}),delete l.isDefaultDirectionalLight):!0===l.isDefaultCamera&&(Object.assign(e,{isDefaultCamera:!0}),delete l.isDefaultCamera),Object.assign(e,{raycastLock:l.lock,scaleLock:l.scaleLock,hiddenMatrix:null!==(n=null===(i=l.hiddenMatrix)||void 0===i?void 0:i.elements)&&void 0!==n?n:(new r.Matrix4).toArray()}),delete l.lock,delete l.scaleLock,delete l.hiddenMatrix,delete l.isEntity}if(void 0!==(null===(s=e.interaction)||void 0===s?void 0:s.events)){var c,h=C(e.interaction.events);try{for(h.s();!(c=h.n()).done;){var d=c.value;if(void 0!==d.targets){var f,v=C(d.targets);try{for(v.s();!(f=v.n()).done;){var m=f.value;void 0!==m.springControls&&(Object.assign(m,{springParameters:{mass:m.springControls[0],stiffness:m.springControls[1],damping:m.springControls[2],velocity:m.springControls[3]}}),delete m.springControls)}}catch(e){v.e(e)}finally{v.f()}}}}catch(e){h.e(e)}finally{h.f()}}if(void 0!==e.children){var y,A=C(e.children);try{for(A.s();!(y=A.n()).done;){No(y.value)}}catch(e){A.e(e)}finally{A.f()}}}function Fo(e){Io(e.object,e.object)}function Io(e,t){var r;if("HemisphereLight"===e.type||!0===e.isDefaultAmbientLight?t.ambientLight=e.uuid:!0===(null===(r=e.userData)||void 0===r?void 0:r.isDefaultDirectionalLight)||!0===e.isDefaultDirectionalLight?t.directionalLight=e.uuid:!0===e.isDefaultCamera&&(t.camera=e.uuid,t.activeCamera=e.uuid,Object.assign(e,{name:"Default Camera"})),void 0!==e.children){var n,o=C(e.children);try{for(o.s();!(n=o.n()).done;){Io(n.value,t)}}catch(e){o.e(e)}finally{o.f()}}}function jo(e){!function(e){var t,i,n,s,o,a,l;if("Scene"===e.objectType){var c=e.userData,h=null!==(t=c.rgb)&&void 0!==t?t:{r:25,g:25,b:25},u=null!==(i=c.fogColor)&&void 0!==i?i:{r:25,g:25,b:25};Object.assign(e,{color:[h.r/255,h.g/255,h.b/255],alpha:c.alpha,enableFog:c.fogEnable,fogUseBGColor:c.fogUseBGColor,fog:{color:(new r.Color).setRGB(u.r/255,u.g/255,u.b/255).getHex(),near:c.fogNear,far:c.fogFar},directionalLightState:c.directionalLightState,ambientLightState:c.ambientLightState,shadowsState:c.shadowsState,wireframeState:c.wireframeState,canvas:{mode:null!==(n=c.canvasMode)&&void 0!==n?n:1,size:{width:null!==(o=null===(s=c.canvasCustomSize)||void 0===s?void 0:s.width)&&void 0!==o?o:512,height:null!==(l=null===(a=c.canvasCustomSize)||void 0===a?void 0:a.height)&&void 0!==l?l:512}}}),delete c.rgb,delete c.alpha,delete c.fogEnable,delete c.fogUseBGColor,delete c.fogColor,delete c.fogNear,delete c.fogFar,delete c.directionalLightState,delete c.ambientLightState,delete c.shadowsState,delete c.wireframeState,delete c.canvasMode,delete c.canvasFullScreen,delete c.canvasCustomSize}}(e.object)}function Po(e,t){var i=(new r.Color).set(e);return{uuid:r.MathUtils.generateUUID(),type:"c",r:i.r,g:i.g,b:i.b,value:e,alpha:null==t?void 0:t.uuid,nodeType:"Color"}}function Ro(e){return{uuid:r.MathUtils.generateUUID(),type:"f",value:e,nodeType:"Float"}}function zo(e){return{uuid:r.MathUtils.generateUUID(),type:"i",value:e,nodeType:"Int"}}function Uo(e){var t=e.x,i=e.y;return{uuid:r.MathUtils.generateUUID(),type:"v2",x:t,y:i,nodeType:"Vector2"}}function Go(e){var t=e.x,i=e.y,n=e.z;return{uuid:r.MathUtils.generateUUID(),type:"v3",x:t,y:i,z:n,nodeType:"Vector3"}}function Vo(e,t){var i={uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"Blend",a:null==e?void 0:e.uuid,b:t.uuid};return"mode"in t&&(i.mode=t.mode),i}function Ho(e,t){var r,n=e.uniforms,i=e.id,l=zo(n["f".concat(i,"_mode")].value),s=Ro(n["f".concat(i,"_alpha")].value),c=Po(n["f".concat(i,"_color")].value,s);return[c,s,l].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(r={},Object(o.a)(r,"f".concat(i,"_color"),c.uuid),Object(o.a)(r,"f".concat(i,"_alpha"),s.uuid),Object(o.a)(r,"f".concat(i,"_mode"),l.uuid),r)}),c}function Jo(e,t,i){var n,l=t.uniforms,s=t.id,c=Ro(l["f".concat(s,"_alpha")].value),a=zo(l["f".concat(s,"_mode")].value);return[c,a].forEach((function(e){return i[e.uuid]=e})),Object.assign(t,{uniforms:(n={},Object(o.a)(n,"f".concat(s,"_alpha"),c.uuid),Object(o.a)(n,"f".concat(s,"_mode"),a.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"basic",nodeType:"Basic",shadingAlpha:c.uuid,shadingBlend:a.uuid}}var Qo=new r.Matrix4,Yo=["RectangleGeometry","TriangleGeometry","PolygonGeometry","StarGeometry"];function Wo(e){var t={};!function(e,t){if(void 0!==e){var r,n=C(e);try{for(n.s();!(r=n.n()).done;){var o=r.value,l=Ko(o.userData.layers),c=l.beforeLayers,h=l.lightingLayer,d=l.afterLayers;if(h){var s=qo(o,h,t);if(t[s.uuid]=s,c.length>0){var f=Zo(c[0],t);t[f.uuid]=f;for(var v=1,m=c.length;v<m;++v){var y=Zo(c[v],t),A=Vo(f,y);t[A.uuid]=A,t[y.uuid]=y,f=A}s.color=f.uuid}if(d.length>0){var w,x=void 0,O=C(d);try{for(O.s();!(w=O.n()).done;){var E=Zo(w.value,t),D=Vo(x,E);t[D.uuid]=D,t[E.uuid]=E,x=D}}catch(e){O.e(e)}finally{O.f()}s.afterColor=null==x?void 0:x.uuid}Object.assign(o,{type:"ShaderMaterial",wireframeLinecap:"",wireframeLinejoin:"",vertex:null==s?void 0:s.uuid,fragment:null==s?void 0:s.uuid}),delete o.color,delete o.emissive,delete o.specular,delete o.shininess,delete o.roughness,delete o.metalness}else console.error("Material upgrade: could not find a ligthing layer")}}catch(e){n.e(e)}finally{n.f()}}}(e.materials,t),function(e,t){if(void 0!==e){var r,n=C(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(o.material)if(Array.isArray(o.material)){var l,c=C(o.material);try{for(c.s();!(l=c.n()).done;){var h,d=C(l.value.layersList);try{for(d.s();!(h=d.n()).done;){Zo(h.value,t)}}catch(e){d.e(e)}finally{d.f()}}}catch(e){c.e(e)}finally{c.f()}}else{var f,v=C(o.material.layersList);try{for(v.s();!(f=v.n()).done;){Zo(f.value,t)}}catch(e){v.e(e)}finally{v.f()}}}}catch(e){n.e(e)}finally{n.f()}}}(e.interactionStates,t),function(e,t){var i;if(void 0!==e){var n,o=C(e);try{for(o.s();!(n=o.n()).done;){var l=n.value;if(l.userData&&Yo.includes(null===(i=l.userData)||void 0===i?void 0:i.type)){var c=l.userData.parameters,h=c.extrudeBevelSize;if(h>0){c.width+=2*h,c.height+=2*h,c.extrudeDepth+=2*h;var s=Xo(t,l.uuid);if(void 0!==s){var d=new r.Object3D;Qo.fromArray(s.matrix),d.applyMatrix4(Qo),d.position.z-=h,d.updateMatrix(),s.matrix=d.matrix.toArray()}}}}}catch(e){o.e(e)}finally{o.f()}}}(e.geometries,e.object),t!=={}&&(e.nodes=function(e){var t=[];for(var r in e)t.push(e[r]);return t}(t))}function Xo(e,t){var r=e.geometry;if(r&&r===t)return e;var i=e.children;if(i)for(var n=0,o=i.length;n<o;n++){var l=Xo(i[n],t);if(void 0!==l)return l}}function Ko(e){for(var i,t=[],r=[],n=e.head;n;){if("light"===n.type){i=n,n=n.next;break}t.push(n),n=n.next}for(;n;)r.unshift(n),n=n.next;return{beforeLayers:t,lightingLayer:i,afterLayers:r}}function qo(e,t,i){var n,s;switch(e.userData.type){case"BasicMaterial":n=Jo(0,t,i),s="BasicNodeMaterial";break;case"PhongMaterial":n=function(e,t,i){var n,l,s,c=t.uniforms,a=t.id,h=Po(null!==(l=e.specular)&&void 0!==l?l:69905),d=Ro(null!==(s=e.shininess)&&void 0!==s?s:30),f=Ro(c["f".concat(a,"_alpha")].value),u=zo(c["f".concat(a,"_mode")].value);return[h,d,f,u].forEach((function(e){return i[e.uuid]=e})),Object.assign(t,{uniforms:(n={},Object(o.a)(n,"f".concat(a,"_alpha"),f.uuid),Object(o.a)(n,"f".concat(a,"_mode"),u.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"phong",nodeType:"Phong",specular:h.uuid,shininess:d.uuid,shadingAlpha:f.uuid,shadingBlend:u.uuid}}(e,t,i),s="PhongNodeMaterial";break;case"LambertMaterial":n=function(e,t,i){var n,l,s,c=t.uniforms,a=t.id,h=Po(null!==(l=e.emissive)&&void 0!==l?l:0),d=Ro(null!==(s=e.emissiveIntensity)&&void 0!==s?s:1),f=Ro(c["f".concat(a,"_alpha")].value),u=zo(c["f".concat(a,"_mode")].value);return[d,h,f,u].forEach((function(e){return i[e.uuid]=e})),Object.assign(t,{uniforms:(n={},Object(o.a)(n,"f".concat(a,"_alpha"),f.uuid),Object(o.a)(n,"f".concat(a,"_mode"),u.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"lambert",nodeType:"Lambert",emissiveIntensity:d.uuid,emissive:h.uuid,shadingAlpha:f.uuid,shadingBlend:u.uuid}}(e,t,i),s="LambertNodeMaterial";break;case"ToonMaterial":n=function(e,t,i){var n,l,s,c=t.uniforms,a=t.id,h=Po(null!==(l=e.specular)&&void 0!==l?l:69905),d=Ro(null!==(s=e.shininess)&&void 0!==s?s:30),f=Ro(c["f".concat(a,"_alpha")].value),u=zo(c["f".concat(a,"_mode")].value);return[h,d,f,u].forEach((function(e){return i[e.uuid]=e})),Object.assign(t,{uniforms:(n={},Object(o.a)(n,"f".concat(a,"_alpha"),f.uuid),Object(o.a)(n,"f".concat(a,"_mode"),u.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"toon",nodeType:"Toon",specular:h.uuid,shininess:d.uuid,shadingAlpha:f.uuid,shadingBlend:u.uuid}}(e,t,i),s="ToonNodeMaterial";break;case"PhysicalMaterial":n=function(e,t,i){var n,l,s,c,a=t.uniforms,h=t.id,d=Ro(null!==(l=e.roughness)&&void 0!==l?l:.3),f=Ro(null!==(s=e.metalness)&&void 0!==s?s:0),u=Ro(null!==(c=e.reflectivity)&&void 0!==c?c:.5),v=Ro(a["f".concat(h,"_alpha")].value),p=zo(a["f".concat(h,"_mode")].value);return[d,f,u,v,p].forEach((function(e){return i[e.uuid]=e})),Object.assign(t,{uniforms:(n={},Object(o.a)(n,"f".concat(h,"_alpha"),v.uuid),Object(o.a)(n,"f".concat(h,"_mode"),p.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"standard",nodeType:"Standard",roughness:d.uuid,metalness:f.uuid,reflectivity:u.uuid,shadingAlpha:v.uuid,shadingBlend:p.uuid}}(e,t,i),s="StandardNodeMaterial";break;default:console.warn("Material upgrade: could not find a properly material node to ".concat(e.userData.type)),n=Jo(0,t,i),s="BasicNodeMaterial"}return Object.assign(e.userData,{nodeType:s}),n}function Zo(e,t){switch(e.type){case"light":return function(e,t){var n,i=e.uniforms,l=e.id,s=Ro(i["f".concat(l,"_alpha")].value),c=zo(i["f".concat(l,"_mode")].value);return[s,c].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(l,"_alpha"),s.uuid),Object(o.a)(n,"f".concat(l,"_mode"),c.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"CustomTexture",alpha:s.uuid,mode:c.uuid}}(e,t);case"color":return Ho(e,t);case"depth":return function(e,t){var n,i=e.uniforms,l=e.id,s=zo(i["f".concat(l,"_mode")].value),c=Ro(i["f".concat(l,"_alpha")].value),a=Ro(i["f".concat(l,"_near")].value),h=Ro(i["f".concat(l,"_far")].value),d=Ro(i["f".concat(l,"_isVector")].value),f=Go(i["f".concat(l,"_origin")].value),u=Po(i["f".concat(l,"_colorA")].value),v=Po(i["f".concat(l,"_colorB")].value);return[a,h,d,f,u,v,c,s].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(l,"_near"),a.uuid),Object(o.a)(n,"f".concat(l,"_far"),h.uuid),Object(o.a)(n,"f".concat(l,"_isVector"),d.uuid),Object(o.a)(n,"f".concat(l,"_origin"),f.uuid),Object(o.a)(n,"f".concat(l,"_colorA"),u.uuid),Object(o.a)(n,"f".concat(l,"_colorB"),v.uuid),Object(o.a)(n,"f".concat(l,"_alpha"),c.uuid),Object(o.a)(n,"f".concat(l,"_mode"),s.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"Depth",near:a.uuid,far:h.uuid,isVector:d.uuid,origin:f.uuid,colorA:u.uuid,colorB:v.uuid,alpha:c.uuid,mode:s.uuid}}(e,t);case"fresnel":return function(e,t){var n,i=e.uniforms,l=e.id,s=zo(i["f".concat(l,"_mode")].value),c=Ro(i["f".concat(l,"_alpha")].value),a=Po(i["f".concat(l,"_color")].value),h=Ro(i["f".concat(l,"_bias")].value),d=Ro(i["f".concat(l,"_scale")].value),f=Ro(i["f".concat(l,"_intensity")].value),u=Ro(i["f".concat(l,"_factor")].value);return[a,h,d,f,u,c,s].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(l,"_color"),a.uuid),Object(o.a)(n,"f".concat(l,"_bias"),h.uuid),Object(o.a)(n,"f".concat(l,"_scale"),d.uuid),Object(o.a)(n,"f".concat(l,"_intensity"),f.uuid),Object(o.a)(n,"f".concat(l,"_factor"),u.uuid),Object(o.a)(n,"f".concat(l,"_alpha"),c.uuid),Object(o.a)(n,"f".concat(l,"_mode"),s.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"Fresnel",color:a.uuid,bias:h.uuid,scale:d.uuid,intensity:f.uuid,factor:u.uuid,alpha:c.uuid,mode:s.uuid}}(e,t);case"gradient":return function(e,t){var n,l,i=e.uniforms,c=e.id,s=zo(i["f".concat(c,"_mode")].value),h=Ro(i["f".concat(c,"_alpha")].value),a=zo(i["f".concat(c,"_gl_type")].value),d=zo(i["f".concat(c,"_num")].value),f=(l=i["f".concat(c,"_smooth")].value,{uuid:r.MathUtils.generateUUID(),type:"b",value:l,nodeType:"Bool"}),u=function(e,t){return{uuid:r.MathUtils.generateUUID(),type:"v4[]",size:10,value:t,nodeType:"Vector4Array"}}(0,i["f".concat(c,"_colors")].value),v=function(e,t){return{uuid:r.MathUtils.generateUUID(),type:"f[]",size:10,value:t,nodeType:"FloatArray"}}(0,i["f".concat(c,"_steps")].value),p=Uo(i["f".concat(c,"_offset")].value),m=Uo(i["f".concat(c,"_morph")].value),y=Ro(i["f".concat(c,"_angle")].value);return[a,d,f,u,v,p,m,y,h,s].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(c,"_gl_type"),a.uuid),Object(o.a)(n,"f".concat(c,"_num"),d.uuid),Object(o.a)(n,"f".concat(c,"_smooth"),f.uuid),Object(o.a)(n,"f".concat(c,"_colors"),u.uuid),Object(o.a)(n,"f".concat(c,"_steps"),v.uuid),Object(o.a)(n,"f".concat(c,"_offset"),p.uuid),Object(o.a)(n,"f".concat(c,"_morph"),m.uuid),Object(o.a)(n,"f".concat(c,"_angle"),y.uuid),Object(o.a)(n,"f".concat(c,"_alpha"),h.uuid),Object(o.a)(n,"f".concat(c,"_mode"),s.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"Gradient",gl_type:a.uuid,num:d.uuid,smooth:f.uuid,colors:u.uuid,steps:v.uuid,offset:p.uuid,morph:m.uuid,angle:y.uuid,alpha:h.uuid,mode:s.uuid}}(e,t);case"noise":return function(e,t){var n,i=e.uniforms,l=e.id,s=zo(i["f".concat(l,"_mode")].value),c=Ro(i["f".concat(l,"_alpha")].value),a=Ro(i["f".concat(l,"_scale")].value),h=Ro(i["f".concat(l,"_move")].value),d=Uo(i["f".concat(l,"_fA")].value),f=Uo(i["f".concat(l,"_fB")].value),u=Uo(i["f".concat(l,"_distortion")].value),v=Po(i["f".concat(l,"_colorA")].value),p=Po(i["f".concat(l,"_colorB")].value),m=Po(i["f".concat(l,"_colorC")].value),y=Po(i["f".concat(l,"_colorD")].value),g=zo(i["f".concat(l,"_intA")].value),A=zo(i["f".concat(l,"_intB")].value),w=zo(i["f".concat(l,"_intC")].value),x=zo(i["f".concat(l,"_intD")].value);return[a,h,d,f,u,v,p,m,y,g,A,w,x,c,s].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(l,"_scale"),a.uuid),Object(o.a)(n,"f".concat(l,"_move"),h.uuid),Object(o.a)(n,"f".concat(l,"_fA"),d.uuid),Object(o.a)(n,"f".concat(l,"_fB"),f.uuid),Object(o.a)(n,"f".concat(l,"_distortion"),u.uuid),Object(o.a)(n,"f".concat(l,"_colorA"),v.uuid),Object(o.a)(n,"f".concat(l,"_colorB"),p.uuid),Object(o.a)(n,"f".concat(l,"_colorC"),m.uuid),Object(o.a)(n,"f".concat(l,"_colorD"),y.uuid),Object(o.a)(n,"f".concat(l,"_intA"),g.uuid),Object(o.a)(n,"f".concat(l,"_intB"),A.uuid),Object(o.a)(n,"f".concat(l,"_intC"),w.uuid),Object(o.a)(n,"f".concat(l,"_intD"),x.uuid),Object(o.a)(n,"f".concat(l,"_alpha"),c.uuid),Object(o.a)(n,"f".concat(l,"_mode"),s.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"Noise",scale:a.uuid,move:h.uuid,fA:d.uuid,fB:f.uuid,distortion:u.uuid,colorA:v.uuid,colorB:p.uuid,colorC:m.uuid,colorD:y.uuid,intA:g.uuid,intB:A.uuid,intC:w.uuid,intD:x.uuid,alpha:c.uuid,mode:s.uuid}}(e,t);case"normal":return function(e,t){var n,i=e.uniforms,l=e.id,s=zo(i["f".concat(l,"_mode")].value),c=Ro(i["f".concat(l,"_alpha")].value),a=Go(i["f".concat(l,"_cnormal")].value);return[a,c,s].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(l,"_cnormal"),a.uuid),Object(o.a)(n,"f".concat(l,"_alpha"),c.uuid),Object(o.a)(n,"f".concat(l,"_mode"),s.uuid),n)}),{uuid:r.MathUtils.generateUUID(),type:"v3",nodeType:"CustomNormal",cnormal:a.uuid,alpha:c.uuid,mode:s.uuid}}(e,t);case"texture":return function(e,t){var n,l,p,i=e.uniforms,c=e.id,s=r.MathUtils.generateUUID(),h=zo(i["f".concat(c,"_mode")].value),a=Ro(i["f".concat(c,"_alpha")].value),d=Ro(i["f".concat(c,"_crop")].value),f={uuid:r.MathUtils.generateUUID(),type:"v2",index:0,nodeType:"UV"},u=(l=i["f".concat(c,"_texture")].value,p=f,{uuid:r.MathUtils.generateUUID(),type:"v4",value:l,uv:p.uuid,project:!1,nodeType:"Texture"}),v=function(e){return{uuid:r.MathUtils.generateUUID(),type:"m3",elements:e.elements,nodeType:"Matrix3"}}(i["f".concat(c,"_mat")].value);return[u,f,v,d,a,h].forEach((function(e){return t[e.uuid]=e})),Object.assign(e,{uniforms:(n={},Object(o.a)(n,"f".concat(c,"_texture"),u.uuid),Object(o.a)(n,"f".concat(c,"_mat"),v.uuid),Object(o.a)(n,"f".concat(c,"_crop"),d.uuid),Object(o.a)(n,"f".concat(c,"_alpha"),a.uuid),Object(o.a)(n,"f".concat(c,"_mode"),h.uuid),n)}),{uuid:s,type:"v3",nodeType:"CustomTexture",texture:u.uuid,crop:d.uuid,alpha:a.uuid,mode:h.uuid}}(e,t);default:return console.warn('Material upgrade: could not find a properly "layer" node to '.concat(e.type)),Ho(e,t)}}function $o(e){var t=e.metadata;return console.info("File format version ".concat(null==t?void 0:t.version)),void 0===(null==t?void 0:t.version)?(console.warn("Unknow file version"),!1):((t.version<=1.1||4.5===t.version)&&(Lo(e),t.version=1.2,console.warn("File upgraded from v1.1 or inferior to v1.2")),1.2===t.version&&(Fo(e),t.version=1.3,console.warn("File upgraded from v1.2 to v1.3")),1.3===t.version&&(jo(e),t.version=1.4,console.warn("File upgraded from v1.3 to v1.4")),1.4===t.version&&(Wo(e),t.version=1.5,console.warn("File upgraded from v1.4 to v1.5")),!0)}var es,ts=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ht.create({}),o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Rr;return Object(A.a)(this,r),(e=t.call(this,n,o)).objectType="SubdivObject",e.resized=!1,e.addToCheckpoints=!1,e.castShadow=!0,e.receiveShadow=!0,e.forceComputeSize=!0,e.subdivPointer=ht.activeSubdivPtr,e}return Object(w.a)(r,[{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e);return t.object.objectType="SubdivObject",t}},{key:"updateGeometry",value:function(e){var t=this.geometry,r=ft[t.userData.type],i="SubdivObject"===this.objectType?Object.assign({},t.userData,{geometry:t,subdivPointer:this.subdivPointer,smoothShading:this.smoothShading}):t.userData,n=r.build(r.normalizeInputs(e,i));this.geometry.dispose(),this.geometry=n,this.geometry.computeBoundingSphere()}},{key:"clone",value:function(e){var t,n=this.material.clone(),i=null!==(t=this.geometry.originalGeometry)&&void 0!==t||this.geometry;i=ht.clone(Object.assign({},this.geometry.userData.parameters),this.subdivPointer,this.smoothShading),this.subdivPointer=ht.activeSubdivPtr;var o=new r(i,n).copy(this,e);return o.geometry=i,o.material=n,o}}]),r}(ki);!function(e){e.EQUAL="==",e.NOT_EQUAL="!=",e.GREATER=">",e.GREATER_EQUAL=">=",e.LESS="<",e.LESS_EQUAL="<=",e.AND="&&",e.OR="||"}(es||(es={}));var rs=function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Dt,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Dt,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.GREATER,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Dt,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new Dt;return Object(A.a)(this,r),(e=t.call(this)).nodeType="Cond",e.a=n,e.b=o,e.op=l,e.ifNode=i,e.elseNode=c,e}return Object(w.a)(r,[{key:"getType",value:function(e){if(this.ifNode){var t=this.ifNode.getType(e),r=this.elseNode.getType(e);return e.getTypeLength(r)>e.getTypeLength(t)?r:t}return"b"}},{key:"getCondType",value:function(e){return e.getTypeLength(this.b.getType(e))>e.getTypeLength(this.a.getType(e))?this.b.getType(e):this.a.getType(e)}},{key:"generate",value:function(e,t){var r,n=this.getType(e),i=this.getCondType(e),o=this.a.build(e,i),s=this.b.build(e,i);if(this.type=n,this.ifNode){var l=this.ifNode.build(e,n),c=this.elseNode.build(e,n);r="( "+[o,this.op,s,"?",l,":",c].join(" ")+" )"}else r="( "+o+" "+this.op+" "+s+" )";return e.format(r,this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.a.copy(e.a),this.b.copy(e.b),this.op=e.op,this.ifNode.copy(e.ifNode),this.elseNode.copy(e.elseNode),this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).a=this.a.toJSON(e).uuid,t.b=this.b.toJSON(e).uuid,t.op=this.op,this.ifNode&&(t.ifNode=this.ifNode.toJSON(e).uuid),this.elseNode&&(t.elseNode=this.elseNode.toJSON(e).uuid)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.a&&(this.a=t.getNode(e.a)),e.b&&(this.b=t.getNode(e.b)),e.op&&(this.op=e.op),e.ifNode&&(this.ifNode=t.getNode(e.ifNode)),e.elseNode&&(this.elseNode=t.getNode(e.elseNode)),this}}]),r}(St);rs.EQUAL=es.EQUAL,rs.NOT_EQUAL=es.NOT_EQUAL,rs.GREATER=es.GREATER,rs.GREATER_EQUAL=es.GREATER_EQUAL,rs.LESS=es.LESS,rs.LESS_EQUAL=es.LESS_EQUAL,rs.AND=es.AND,rs.OR=es.OR;var ns={Int:_t,Float:kt,Bool:Mt,Vector2:Lt,Vector3:Nt,Vector4:mr,Matrix3:Kt,Matrix4:function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o;return Object(A.a)(this,n),(o=t.call(this,"m4")).nodeType="Matrix4",o.value=null!=e?e:new r.Matrix4,o}return Object(w.a)(n,[{key:"generateReadonly",value:function(e,t,r,i,n,s){return e.format("mat4("+this.value.elements.join(", ")+")",i,t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.elements=e.elements,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||((t=this.createJSONNode(e)).elements=this.value.elements.concat()),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(n.prototype),"fromJSON",this).call(this,e,t),e.elements&&(this.elements=e.elements),this}},{key:"elements",get:function(){return this.value.elements},set:function(e){this.value.fromArray(e)}}]),n}(Bt),FloatArray:It,Vector4Array:Ft,Normal:Er,Position:Cr,Reflect:Dr,UV:Pt,Attribute:function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1?arguments[1]:void 0;return Object(A.a)(this,r),(e=t.call(this,o)).nodeType="Attribute",e.name=n,e}return Object(w.a)(r,[{key:"getAttributeType",value:function(e){return"number"==typeof this.type?e.getConstructorFromLength(this.type):this.type}},{key:"getType",value:function(e){var t=this.getAttributeType(e);return e.getTypeByFormat(t)}},{key:"generate",value:function(e,t,r,i,n){i=this.getAttributeType(e);var s=e.getAttribute(this.name,i),o=e.isShader("vertex")?this.name:s.varying.name;return e.format(o,this.getType(e),t)}},{key:"toJSON",value:function(e){var t=Object(v.a)(Object(E.a)(r.prototype),"toJSON",this).call(this,e);return t.nodeType=this.nodeType,t.name=this.name,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.scope&&(this.scope=e.scope),e.name&&(this.name=e.name),this}}]),r}(St),Const:Vt,Struct:tr,Varying:function(e){Object(x.a)(r,e);var t=S(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(A.a)(this,r),(e=t.call(this,n)).nodeType="Varying",e.value=o,e}return Object(w.a)(r,[{key:"getType",value:function(e){return e.getTypeByFormat(this.type)}},{key:"generate",value:function(e,t,r,i,n){var s=e.getVar(this.uuid,this.type);return this.value&&e.isShader("vertex")&&e.addNodeCode(s.name+" = "+this.value.build(e,this.getType(e))+";"),e.format(s.name,this.getType(e),t)}},{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(r.prototype),"copy",this).call(this,e),this.value=e.value,this}},{key:"toJSON",value:function(e){var t=this.getJSONNode(e);return t||(t=this.createJSONNode(e),this.value&&(t.value=this.value)),t.nodeType=this.nodeType,t}},{key:"fromJSON",value:function(e,t){return Object(v.a)(Object(E.a)(r.prototype),"fromJSON",this).call(this,e,t),e.value&&(this.value=e.value),this}}]),r}(Dt),SpecularMIPLevel:Yr,MaxMIPLevel:Qr,ColorSpace:Jt,Noise:sr,TextureCubeUV:Or,TextureCube:Sr,Operator:ur,Math:xr,Cond:rs,Fresnel:Zt,Depth:cr,Blend:lr,Raw:Lr,CubeTexture:hr,Texture:Xt,CustomTexture:qt,VertexDisplacement:or,CustomNormal:$t,Gradient:rr,Matcap:dr,Expression:Ht,Color:Tt,Phong:Pr,Basic:Fr,Lambert:zr,Standard:Wr,Toon:Vr},is=function(){function e(){Object(A.a)(this,e),this._nodes={},this._dataNodes={},this._textures={},this.uuid=r.MathUtils.generateUUID()}return Object(w.a)(e,[{key:"init",value:function(e,t){this._dataNodes=e,this._textures=t}},{key:"clear",value:function(){this._nodes={},this._dataNodes={},this._textures={}}},{key:"getNode",value:function(e){var t=this._nodes[e];return t||(t=this.createNode(e)),t}},{key:"getNodeData",value:function(e){return this._dataNodes[e]}},{key:"getTexture",value:function(e){var t=this._textures[e];if(!t)throw new Error("This texture does not exist in the library "+e);return t}},{key:"createNode",value:function(e){var t=this._dataNodes[e];if(!t)throw new Error("Failed to create Node from uuid: "+e+", its data does not seem to exist");var r=ns[t.nodeType];if(!r)throw new Error("Failed to create Node from uuid: "+e+" and nodeType: "+t.nodeType+", constructor for this not is not registered");var i=(new r).fromJSON(t,this);return this._nodes[e]=i,i}}]),e}(),as=function(){function e(){Object(A.a)(this,e),this._buffers=[]}return Object(w.a)(e,[{key:"parse",value:function(e){var t,i=new r.BufferGeometry;if(this._vertexData=e.vertexData,this._loadBuffers(this._vertexData.buffers),i.uuid=e.uuid,this._vertexData.accessors)for(var n=0,o=this._vertexData.accessors.length;n<o;++n){var l=this._vertexData.accessors[n].attributeName;"indices"===l?i.setIndex(this._loadAccessor(n)):i.setAttribute(l,this._loadAccessor(n))}if(null===(t=e.data)||void 0===t?void 0:t.groups){var c,h=C(e.data.groups);try{for(h.s();!(c=h.n()).done;){var d=c.value;i.addGroup(d.start,d.count,d.materialIndex)}}catch(e){h.e(e)}finally{h.f()}}return i}},{key:"_loadAccessor",value:function(e){var t=this._vertexData.accessors[e],i=this._loadBufferView(t.bufferView),n=ss[t.type],s=new(0,os[t.componentType])(i.buffer);return new r.BufferAttribute(s,n)}},{key:"_loadBufferView",value:function(e){var t=this._vertexData.bufferViews[e],r=this._buffers[t.buffer],i=t.byteLength||0,n=t.byteOffset||0;return r.slice(n,n+i)}},{key:"_loadBuffers",value:function(e){var t,r=C(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.uri){for(var o=n.uri.slice(n.uri.indexOf("base64")+7),l=atob(o),c=new Uint8Array(l.length),h=0;h<l.length;h++)c[h]=l.charCodeAt(h);this._buffers.push(c)}}}catch(e){r.e(e)}finally{r.f()}}}]),e}(),os={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ss={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},us=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var r;return Object(A.a)(this,n),(r=t.call(this,e)).dracoLoader=null,r.ktx2Loader=null,r.meshoptDecoder=null,r.pluginCallbacks=[],r.register((function(e){return new fs(e)})),r.register((function(e){return new ps(e)})),r.register((function(e){return new ms(e)})),r.register((function(e){return new vs(e)})),r.register((function(e){return new hs(e)})),r.register((function(e){return new gs(e)})),r}return Object(w.a)(n,[{key:"load",value:function(e,t,i,n){var o,s=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:r.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);var a=function(t){n?n(t):console.error(t),s.manager.itemError(e),s.manager.itemEnd(e)},l=new r.FileLoader(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(r){try{s.parse(r,o,(function(r){t(r),s.manager.itemEnd(e)}),a)}catch(e){a(e)}}),i,a)}},{key:"setDRACOLoader",value:function(e){return this.dracoLoader=e,this}},{key:"setDDSLoader",value:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}},{key:"setKTX2Loader",value:function(e){return this.ktx2Loader=e,this}},{key:"setMeshoptDecoder",value:function(e){return this.meshoptDecoder=e,this}},{key:"register",value:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}},{key:"unregister",value:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}},{key:"parse",value:function(e,t,i,n){var s,o={},a={};if("string"==typeof e)s=e;else if(r.LoaderUtils.decodeText(new Uint8Array(e,0,4))===ys){try{o[cs.KHR_BINARY_GLTF]=new As(e)}catch(e){return void(n&&n(e))}s=o[cs.KHR_BINARY_GLTF].content}else s=r.LoaderUtils.decodeText(new Uint8Array(e));var l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var c=new Rs(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});c.fileLoader.setRequestHeader(this.requestHeader);for(var h=0;h<this.pluginCallbacks.length;h++){var d=this.pluginCallbacks[h](c);a[d.name]=d,o[d.name]=!0}if(l.extensionsUsed)for(var f=0;f<l.extensionsUsed.length;++f){var v=l.extensionsUsed[f],m=l.extensionsRequired||[];switch(v){case cs.KHR_MATERIALS_UNLIT:o[v]=new ds;break;case cs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:o[v]=new Os;break;case cs.KHR_DRACO_MESH_COMPRESSION:o[v]=new bs(l,this.dracoLoader);break;case cs.KHR_TEXTURE_TRANSFORM:o[v]=new ws;break;case cs.KHR_MESH_QUANTIZATION:o[v]=new Es;break;default:m.indexOf(v)>=0&&void 0===a[v]&&console.warn('THREE.GLTFLoader: Unknown extension "'+v+'".')}}c.setExtensions(o),c.setPlugins(a),c.parse(i,n)}}}]),n}(r.Loader);function ls(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}var cs={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"},hs=function(){function e(t){Object(A.a)(this,e),this.parser=t,this.name=cs.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}return Object(w.a)(e,[{key:"_markDefs",value:function(){for(var e=this.parser,t=this.parser.json.nodes||[],r=0,n=t.length;r<n;r++){var o=t[r];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}}},{key:"_loadLight",value:function(e){var t=this.parser,i="light:"+e,n=t.cache.get(i);if(n)return n;var a,s=t.json,o=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e],l=new r.Color(16777215);void 0!==o.color&&l.fromArray(o.color);var c=void 0!==o.range?o.range:0;switch(o.type){case"directional":(a=new r.DirectionalLight(l)).target.position.set(0,0,-1),a.add(a.target);break;case"point":(a=new r.PointLight(l)).distance=c;break;case"spot":(a=new r.SpotLight(l)).distance=c,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+o.type)}return a.position.set(0,0,0),a.decay=2,void 0!==o.intensity&&(a.intensity=o.intensity),a.name=t.createUniqueName(o.name||"light_"+e),n=Promise.resolve(a),t.cache.add(i,n),n}},{key:"createNodeAttachment",value:function(e){var t=this,r=this.parser,i=r.json.nodes[e],n=(i.extensions&&i.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then((function(e){return r._getNodeRef(t.cache,n,e)}))}}]),e}(),ds=function(){function e(){Object(A.a)(this,e),this.name=cs.KHR_MATERIALS_UNLIT}return Object(w.a)(e,[{key:"getMaterialType",value:function(){return r.MeshBasicMaterial}},{key:"extendParams",value:function(e,t,i){var n=[];e.color=new r.Color(1,1,1),e.opacity=1;var s=t.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){var o=s.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==s.baseColorTexture&&n.push(i.assignTexture(e,"map",s.baseColorTexture))}return Promise.all(n)}}]),e}(),fs=function(){function e(t){Object(A.a)(this,e),this.parser=t,this.name=cs.KHR_MATERIALS_CLEARCOAT}return Object(w.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var i=this.parser,n=i.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();var s=[],o=n.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&s.push(i.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&s.push(i.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(s.push(i.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var l=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new r.Vector2(l,-l)}return Promise.all(s)}}]),e}(),vs=function(){function e(t){Object(A.a)(this,e),this.parser=t,this.name=cs.KHR_MATERIALS_TRANSMISSION}return Object(w.a)(e,[{key:"getMaterialType",value:function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?r.MeshPhysicalMaterial:null}},{key:"extendMaterialParams",value:function(e,t){var r=this.parser,i=r.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();var n=[],s=i.extensions[this.name];return void 0!==s.transmissionFactor&&(t.transmission=s.transmissionFactor),void 0!==s.transmissionTexture&&n.push(r.assignTexture(t,"transmissionMap",s.transmissionTexture)),Promise.all(n)}}]),e}(),ps=function(){function e(t){Object(A.a)(this,e),this.parser=t,this.name=cs.KHR_TEXTURE_BASISU}return Object(w.a)(e,[{key:"loadTexture",value:function(e){var t=this.parser,r=t.json,i=r.textures[e];if(!i.extensions||!i.extensions[this.name])return null;var n=i.extensions[this.name],s=r.images[n.source],o=t.options.ktx2Loader;if(!o){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,s,o)}}]),e}(),ms=function(){function e(t){Object(A.a)(this,e),this.parser=t,this.name=cs.EXT_TEXTURE_WEBP,this.isSupported=null}return Object(w.a)(e,[{key:"loadTexture",value:function(e){var t=this.name,r=this.parser,i=r.json,n=i.textures[e];if(!n.extensions||!n.extensions[t])return null;var s=n.extensions[t],o=i.images[s.source],a=r.textureLoader;if(o.uri){var l=r.options.manager.getHandler(o.uri);null!==l&&(a=l)}return this.detectSupport().then((function(n){if(n)return r.loadTextureImage(e,o,a);if(i.extensionsRequired&&i.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)}))}},{key:"detectSupport",value:function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}]),e}(),gs=function(){function e(t){Object(A.a)(this,e),this.name=cs.EXT_MESHOPT_COMPRESSION,this.parser=t}return Object(w.a)(e,[{key:"loadBufferView",value:function(e){var t=this.parser.json,r=t.bufferViews[e];if(r.extensions&&r.extensions[this.name]){var n=r.extensions[this.name],o=this.parser.getDependency("buffer",n.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,l.ready]).then((function(e){var t=n.byteOffset||0,i=n.byteLength||0,s=n.count,r=n.byteStride,a=new ArrayBuffer(s*r),o=new Uint8Array(e[0],t,i);return l.decodeGltfBuffer(new Uint8Array(a),s,r,o,n.mode,n.filter),a}))}return null}}]),e}(),ys="glTF",As=function e(t){Object(A.a)(this,e),this.name=cs.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(t,0,12);if(this.header={magic:r.LoaderUtils.decodeText(new Uint8Array(t.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==ys)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var i=this.header.length-12,o=new DataView(t,12),s=0;s<i;){var l=o.getUint32(s,!0);s+=4;var c=o.getUint32(s,!0);if(s+=4,1313821514===c){var h=new Uint8Array(t,12+s,l);this.content=r.LoaderUtils.decodeText(h)}else if(5130562===c){var d=12+s;this.body=t.slice(d,d+l)}s+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")},bs=function(){function e(t,r){if(Object(A.a)(this,e),!r)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=cs.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=r,this.dracoLoader.preload()}return Object(w.a)(e,[{key:"decodePrimitive",value:function(e,t){var r=this.json,i=this.dracoLoader,n=e.extensions[this.name].bufferView,s=e.extensions[this.name].attributes,o={},a={},l={};for(var c in s){var h=ks[c]||c.toLowerCase();o[h]=s[c]}for(var d in e.attributes){var f=ks[d]||d.toLowerCase();if(void 0!==s[d]){var v=r.accessors[e.attributes[d]],m=Ds[v.componentType];l[f]=m,a[f]=!0===v.normalized}}return t.getDependency("bufferView",n).then((function(e){return new Promise((function(t){i.decodeDracoFile(e,(function(e){for(var r in e.attributes){var n=e.attributes[r],o=a[r];void 0!==o&&(n.normalized=o)}t(e)}),o,l)}))}))}}]),e}(),ws=function(){function e(){Object(A.a)(this,e),this.name=cs.KHR_TEXTURE_TRANSFORM}return Object(w.a)(e,[{key:"extendTexture",value:function(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}]),e}(),xs=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var o;Object(A.a)(this,n),(o=t.call(this)).isGLTFSpecularGlossinessMaterial=!0;var l=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),i=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),s=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),a={specular:{value:(new r.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};return o._extraUniforms=a,o.onBeforeCompile=function(e){for(var t in a)e.uniforms[t]=a[t];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",l).replace("#include <metalnessmap_pars_fragment>",i).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",s).replace("#include <lights_physical_fragment>",h)},Object.defineProperties(Object(m.a)(o),{specular:{get:function(){return a.specular.value},set:function(e){a.specular.value=e}},specularMap:{get:function(){return a.specularMap.value},set:function(e){a.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return a.glossiness.value},set:function(e){a.glossiness.value=e}},glossinessMap:{get:function(){return a.glossinessMap.value},set:function(e){a.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete o.metalness,delete o.roughness,delete o.metalnessMap,delete o.roughnessMap,o.setValues(e),o}return Object(w.a)(n,[{key:"copy",value:function(e){return Object(v.a)(Object(E.a)(n.prototype),"copy",this).call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}]),n}(r.MeshStandardMaterial),Os=function(){function e(){Object(A.a)(this,e),this.name=cs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}return Object(w.a)(e,[{key:"getMaterialType",value:function(){return xs}},{key:"extendParams",value:function(e,t,i){var n=t.extensions[this.name];e.color=new r.Color(1,1,1),e.opacity=1;var s=[];if(Array.isArray(n.diffuseFactor)){var o=n.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==n.diffuseTexture&&s.push(i.assignTexture(e,"map",n.diffuseTexture)),e.emissive=new r.Color(0,0,0),e.glossiness=void 0!==n.glossinessFactor?n.glossinessFactor:1,e.specular=new r.Color(1,1,1),Array.isArray(n.specularFactor)&&e.specular.fromArray(n.specularFactor),void 0!==n.specularGlossinessTexture){var l=n.specularGlossinessTexture;s.push(i.assignTexture(e,"glossinessMap",l)),s.push(i.assignTexture(e,"specularMap",l))}return Promise.all(s)}},{key:"createMaterial",value:function(e){var t=new xs(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=r.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}]),e}(),Es=function e(){Object(A.a)(this,e),this.name=cs.KHR_MESH_QUANTIZATION},Cs=function(e){Object(x.a)(r,e);var t=S(r);function r(e,n,o,i){return Object(A.a)(this,r),t.call(this,e,n,o,i)}return Object(w.a)(r,[{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,r=this.sampleValues,i=this.valueSize,n=e*i*3+i,o=0;o!==i;o++)t[o]=r[n+o];return t}}]),r}(r.Interpolant);Cs.prototype.beforeStart_=Cs.prototype.copySampleValue_,Cs.prototype.afterEnd_=Cs.prototype.copySampleValue_,Cs.prototype.interpolate_=function(e,t,r,i){for(var n=this.resultBuffer,s=this.sampleValues,o=this.valueSize,a=2*o,l=3*o,c=i-t,h=(r-t)/c,u=h*h,d=u*h,p=e*l,f=p-l,v=-2*d+3*u,g=d-u,m=1-v,y=g-u+h,A=0;A!==o;A++){var w=s[f+A+o],x=s[f+A+a]*c,O=s[p+A+o],E=s[p+A]*c;n[A]=m*w+y*x+v*O+g*E}return n};var Ds={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Ss={9728:r.NearestFilter,9729:r.LinearFilter,9984:r.NearestMipmapNearestFilter,9985:r.LinearMipmapNearestFilter,9986:r.NearestMipmapLinearFilter,9987:r.LinearMipmapLinearFilter},Bs={33071:r.ClampToEdgeWrapping,33648:r.MirroredRepeatWrapping,10497:r.RepeatWrapping},Ts={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ks={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},_s={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ms={CUBICSPLINE:void 0,LINEAR:r.InterpolateLinear,STEP:r.InterpolateDiscrete};function Ls(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function Ns(e){return void 0===e.DefaultMaterial&&(e.DefaultMaterial=new r.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.FrontSide})),e.DefaultMaterial}function Fs(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function Is(e,t){void 0!==t.extras&&("object"==Object(d.a)(t.extras)?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function ul(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var o=t.extras.targetNames;if(e.morphTargetInfluences.length===o.length){e.morphTargetDictionary={};for(var l=0,c=o.length;l<c;l++)e.morphTargetDictionary[o[l]]=l}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function dl(e){var t=e.extensions&&e.extensions[cs.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+js(t.attributes):e.indices+":"+js(e.attributes)+":"+e.mode}function js(e){for(var t="",r=Object.keys(e).sort(),n=0,o=r.length;n<o;n++)t+=r[n]+":"+e[r[n]]+";";return t}function Ps(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var Rs=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(A.a)(this,e),this.json=t,this.extensions={},this.plugins={},this.options=n,this.cache=new ls,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new r.ImageBitmapLoader(this.options.manager):this.textureLoader=new r.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new r.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}return Object(w.a)(e,[{key:"setExtensions",value:function(e){this.extensions=e}},{key:"setPlugins",value:function(e){this.plugins=e}},{key:"parse",value:function(e,t){var r=this,i=this.json,n=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(t){var s={scene:t[0][i.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:i.asset,parser:r,userData:{}};Fs(n,s,i),Is(s,i),Promise.all(r._invokeAll((function(e){return e.afterRoot&&e.afterRoot(s)}))).then((function(){e(s)}))})).catch(t)}},{key:"_markDefs",value:function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n=0,o=t.length;n<o;n++)for(var l=t[n].joints,c=0,h=l.length;c<h;c++)e[l[c]].isBone=!0;for(var d=0,f=e.length;d<f;d++){var v=e[d];void 0!==v.mesh&&(this._addNodeRef(this.meshCache,v.mesh),void 0!==v.skin&&(r[v.mesh].isSkinnedMesh=!0)),void 0!==v.camera&&this._addNodeRef(this.cameraCache,v.camera)}}},{key:"_addNodeRef",value:function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}},{key:"_getNodeRef",value:function(e,t,r){if(e.refs[t]<=1)return r;var i=r.clone();return i.name+="_instance_"+e.uses[t]++,i}},{key:"_invokeOne",value:function(e){var t=Object.values(this.plugins);t.push(this);for(var r=0;r<t.length;r++){var n=e(t[r]);if(n)return n}return null}},{key:"_invokeAll",value:function(e){var t=Object.values(this.plugins);t.unshift(this);for(var r=[],n=0;n<t.length;n++){var o=e(t[n]);o&&r.push(o)}return r}},{key:"getDependency",value:function(e,t){var r=e+":"+t,i=this.cache.get(r);if(!i){switch(e){case"scene":i=this.loadScene(t);break;case"node":i=this.loadNode(t);break;case"mesh":i=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":i=this.loadAccessor(t);break;case"bufferView":i=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":i=this.loadBuffer(t);break;case"material":i=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":i=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":i=this.loadSkin(t);break;case"animation":i=this.loadAnimation(t);break;case"camera":i=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(r,i)}return i}},{key:"getDependencies",value:function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map((function(t,i){return r.getDependency(e,i)}))),this.cache.add(e,t)}return t}},{key:"loadBuffer",value:function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[cs.KHR_BINARY_GLTF].body);var i=this.options;return new Promise((function(e,n){r.load(Ls(t.uri,i.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}},{key:"loadBufferView",value:function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var r=t.byteLength||0,i=t.byteOffset||0;return e.slice(i,i+r)}))}},{key:"loadAccessor",value:function(e){var t=this,i=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse)return Promise.resolve(null);var s=[];return void 0!==n.bufferView?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),void 0!==n.sparse&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then((function(e){var p,o,s=e[0],l=Ts[n.type],a=Ds[n.componentType],c=a.BYTES_PER_ELEMENT,h=c*l,d=n.byteOffset||0,u=void 0!==n.bufferView?i.bufferViews[n.bufferView].byteStride:void 0,f=!0===n.normalized;if(u&&u!==h){var v=Math.floor(d/u),m="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+v+":"+n.count,y=t.cache.get(m);y||(p=new a(s,v*u,n.count*u/c),y=new r.InterleavedBuffer(p,u/c),t.cache.add(m,y)),o=new r.InterleavedBufferAttribute(y,l,d%u/c,f)}else p=null===s?new a(n.count*l):new a(s,d,n.count*l),o=new r.BufferAttribute(p,l,f);if(void 0!==n.sparse){var A=Ts.SCALAR,w=Ds[n.sparse.indices.componentType],x=n.sparse.indices.byteOffset||0,O=n.sparse.values.byteOffset||0,E=new w(e[1],x,n.sparse.count*A),C=new a(e[2],O,n.sparse.count*l);null!==s&&(o=new r.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(var D=0,S=E.length;D<S;D++){var B=E[D];if(o.setX(B,C[D*l]),l>=2&&o.setY(B,C[D*l+1]),l>=3&&o.setZ(B,C[D*l+2]),l>=4&&o.setW(B,C[D*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))}},{key:"loadTexture",value:function(e){var t=this.json,r=this.options,i=t.textures[e],n=t.images[i.source],s=this.textureLoader;if(n.uri){var o=r.manager.getHandler(n.uri);null!==o&&(s=o)}return this.loadTextureImage(e,n,s)}},{key:"loadTextureImage",value:function(e,t,i){var n=this,s=this.json,o=this.options,a=s.textures[e],l=(t.uri||t.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];var c=self.URL||self.webkitURL,h=t.uri||"",u=!1,d=!0,p=h.search(/\.jpe?g($|\?)/i)>0||0===h.search(/^data\:image\/jpeg/);if(("image/jpeg"===t.mimeType||p)&&(d=!1),void 0!==t.bufferView)h=n.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){var r=new DataView(e,25,1).getUint8(0,!1);d=6===r||4===r||3===r}u=!0;var n=new Blob([e],{type:t.mimeType});return h=c.createObjectURL(n)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");var f=Promise.resolve(h).then((function(e){return new Promise((function(t,n){var s=t;!0===i.isImageBitmapLoader&&(s=function(e){var i=new r.Texture(e);i.needsUpdate=!0,t(i)}),i.load(Ls(e,o.path),s,void 0,n)}))})).then((function(t){!0===u&&c.revokeObjectURL(h),t.flipY=!1,a.name&&(t.name=a.name),d||(t.format=r.RGBFormat);var i=(s.samplers||{})[a.sampler]||{};return t.magFilter=Ss[i.magFilter]||r.LinearFilter,t.minFilter=Ss[i.minFilter]||r.LinearMipmapLinearFilter,t.wrapS=Bs[i.wrapS]||r.RepeatWrapping,t.wrapT=Bs[i.wrapT]||r.RepeatWrapping,n.associations.set(t,{type:"textures",index:e}),t})).catch((function(){return console.error("THREE.GLTFLoader: Couldn't load texture",h),null}));return this.textureCache[l]=f,f}},{key:"assignTexture",value:function(e,t,r){var i=this;return this.getDependency("texture",r.index).then((function(n){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),i.extensions[cs.KHR_TEXTURE_TRANSFORM]){var o=void 0!==r.extensions?r.extensions[cs.KHR_TEXTURE_TRANSFORM]:void 0;if(o){var l=i.associations.get(n);n=i.extensions[cs.KHR_TEXTURE_TRANSFORM].extendTexture(n,o),i.associations.set(n,l)}}e[t]=n}))}},{key:"assignFinalMaterial",value:function(e){var t=e.geometry,i=e.material,n=void 0!==t.attributes.tangent,s=void 0!==t.attributes.color,o=void 0===t.attributes.normal,a=Object.keys(t.morphAttributes).length>0,l=a&&void 0!==t.morphAttributes.normal;if(e.isPoints){var c="PointsMaterial:"+i.uuid,h=this.cache.get(c);h||(h=new r.PointsMaterial,r.Material.prototype.copy.call(h,i),h.color.copy(i.color),h.map=i.map,h.sizeAttenuation=!1,this.cache.add(c,h)),i=h}else if(e.isLine){var d="LineBasicMaterial:"+i.uuid,f=this.cache.get(d);f||(f=new r.LineBasicMaterial,r.Material.prototype.copy.call(f,i),f.color.copy(i.color),this.cache.add(d,f)),i=f}if(n||s||o||a){var v="ClonedMaterial:"+i.uuid+":";i.isGLTFSpecularGlossinessMaterial&&(v+="specular-glossiness:"),n&&(v+="vertex-tangents:"),s&&(v+="vertex-colors:"),o&&(v+="flat-shading:"),a&&(v+="morph-targets:"),l&&(v+="morph-normals:");var m=this.cache.get(v);m||(m=i.clone(),s&&(m.vertexColors=!0),o&&(m.flatShading=!0),a&&(m.morphTargets=!0),l&&(m.morphNormals=!0),n&&(m.vertexTangents=!0,m.normalScale&&(m.normalScale.y*=-1),m.clearcoatNormalScale&&(m.clearcoatNormalScale.y*=-1)),this.cache.add(v,m),this.associations.set(m,this.associations.get(i))),i=m}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}},{key:"getMaterialType",value:function(){return r.MeshStandardMaterial}},{key:"loadMaterial",value:function(e){var t,n=this,i=this.json,o=this.extensions,s=i.materials[e],a={},l=s.extensions||{},c=[];if(l[cs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var h=o[cs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=h.getMaterialType(),c.push(h.extendParams(a,s,n))}else if(l[cs.KHR_MATERIALS_UNLIT]){var d=o[cs.KHR_MATERIALS_UNLIT];t=d.getMaterialType(),c.push(d.extendParams(a,s,n))}else{var f=s.pbrMetallicRoughness||{};if(a.color=new r.Color(1,1,1),a.opacity=1,Array.isArray(f.baseColorFactor)){var v=f.baseColorFactor;a.color.fromArray(v),a.opacity=v[3]}void 0!==f.baseColorTexture&&c.push(n.assignTexture(a,"map",f.baseColorTexture)),a.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,a.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(c.push(n.assignTexture(a,"metalnessMap",f.metallicRoughnessTexture)),c.push(n.assignTexture(a,"roughnessMap",f.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),c.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,a)}))))}!0===s.doubleSided&&(a.side=r.DoubleSide);var m=s.alphaMode||"OPAQUE";return"BLEND"===m?(a.transparent=!0,a.depthWrite=!1):(a.transparent=!1,"MASK"===m&&(a.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&t!==r.MeshBasicMaterial&&(c.push(n.assignTexture(a,"normalMap",s.normalTexture)),a.normalScale=new r.Vector2(1,-1),void 0!==s.normalTexture.scale&&a.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&t!==r.MeshBasicMaterial&&(c.push(n.assignTexture(a,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(a.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&t!==r.MeshBasicMaterial&&(a.emissive=(new r.Color).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&t!==r.MeshBasicMaterial&&c.push(n.assignTexture(a,"emissiveMap",s.emissiveTexture)),Promise.all(c).then((function(){var i;return i=t===xs?o[cs.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(a):new t(a),s.name&&(i.name=s.name),i.map&&(i.map.encoding=r.sRGBEncoding),i.emissiveMap&&(i.emissiveMap.encoding=r.sRGBEncoding),Is(i,s),n.associations.set(i,{type:"materials",index:e}),s.extensions&&Fs(o,i,s),i}))}},{key:"createUniqueName",value:function(e){for(var t=r.PropertyBinding.sanitizeNodeName(e||""),i=t,n=1;this.nodeNamesUsed[i];++n)i=t+"_"+n;return this.nodeNamesUsed[i]=!0,i}},{key:"loadGeometries",value:function(e){var t=this,i=this.extensions,n=this.primitiveCache;function s(e){return i[cs.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(r){return Us(r,e,t)}))}for(var o=[],l=0,a=e.length;l<a;l++){var c=e[l],h=dl(c),d=n[h];if(d)o.push(d.promise);else{var f;f=c.extensions&&c.extensions[cs.KHR_DRACO_MESH_COMPRESSION]?s(c):Us(new r.BufferGeometry,c,t),n[h]={primitive:c,promise:f},o.push(f)}}return Promise.all(o)}},{key:"loadMesh",value:function(e){for(var t=this,i=this.json,n=this.extensions,s=i.meshes[e],o=s.primitives,a=[],l=0,c=o.length;l<c;l++){var h=void 0===o[l].material?Ns(this.cache):this.getDependency("material",o[l].material);a.push(h)}return a.push(t.loadGeometries(o)),Promise.all(a).then((function(i){for(var a=i.slice(0,i.length-1),l=i[i.length-1],c=[],h=0,d=l.length;h<d;h++){var f=l[h],u=o[h],v=void 0,m=a[h];if(4===u.mode||5===u.mode||6===u.mode||void 0===u.mode)!0!==(v=!0===s.isSkinnedMesh?new r.SkinnedMesh(f,m):new r.Mesh(f,m)).isSkinnedMesh||v.geometry.attributes.skinWeight.normalized||v.normalizeSkinWeights(),5===u.mode?v.geometry=Gs(v.geometry,r.TriangleStripDrawMode):6===u.mode&&(v.geometry=Gs(v.geometry,r.TriangleFanDrawMode));else if(1===u.mode)v=new r.LineSegments(f,m);else if(3===u.mode)v=new r.Line(f,m);else if(2===u.mode)v=new r.LineLoop(f,m);else{if(0!==u.mode)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+u.mode);v=new r.Points(f,m)}Object.keys(v.geometry.morphAttributes).length>0&&ul(v,s),v.name=t.createUniqueName(s.name||"mesh_"+e),Is(v,s),u.extensions&&Fs(n,v,u),t.assignFinalMaterial(v),c.push(v)}if(1===c.length)return c[0];for(var y=new r.Group,A=0,w=c.length;A<w;A++)y.add(c[A]);return y}))}},{key:"loadCamera",value:function(e){var t,i=this.json.cameras[e],n=i[i.type];if(n)return"perspective"===i.type?t=new r.PerspectiveCamera(r.MathUtils.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===i.type&&(t=new r.OrthographicCamera(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),Is(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}},{key:"loadSkin",value:function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return r.inverseBindMatrices=e,r}))}},{key:"loadAnimation",value:function(e){for(var t=this.json.animations[e],i=[],n=[],s=[],o=[],a=[],l=0,c=t.channels.length;l<c;l++){var h=t.channels[l],d=t.samplers[h.sampler],f=h.target,v=void 0!==f.node?f.node:f.id,u=void 0!==t.parameters?t.parameters[d.input]:d.input,m=void 0!==t.parameters?t.parameters[d.output]:d.output;i.push(this.getDependency("node",v)),n.push(this.getDependency("accessor",u)),s.push(this.getDependency("accessor",m)),o.push(d),a.push(f)}return Promise.all([Promise.all(i),Promise.all(n),Promise.all(s),Promise.all(o),Promise.all(a)]).then((function(i){for(var n=i[0],s=i[1],o=i[2],a=i[3],l=i[4],c=[],h=function(e,t){var h=n[e],i=s[e],d=o[e],u=a[e],f=l[e];if(void 0===h)return"continue";var p=void 0;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,_s[f.path]){case _s.weights:p=r.NumberKeyframeTrack;break;case _s.rotation:p=r.QuaternionKeyframeTrack;break;case _s.position:case _s.scale:default:p=r.VectorKeyframeTrack}var v=h.name?h.name:h.uuid,m=void 0!==u.interpolation?Ms[u.interpolation]:r.InterpolateLinear,g=[];_s[f.path]===_s.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)})):g.push(v);var y=d.array;if(d.normalized){for(var A=Ps(y.constructor),w=new Float32Array(y.length),x=0,O=y.length;x<O;x++)w[x]=y[x]*A;y=w}for(var E=0,C=g.length;E<C;E++){var D=new p(g[E]+"."+_s[f.path],i.array,y,m);"CUBICSPLINE"===u.interpolation&&(D.createInterpolant=function(e){return new Cs(this.times,this.values,this.getValueSize()/3,e)},D.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(D)}},d=0,f=n.length;d<f;d++)h(d);var v=t.name?t.name:"animation_"+e;return new r.AnimationClip(v,void 0,c)}))}},{key:"createNodeMesh",value:function(e){var t=this.json,r=this,i=t.nodes[e];return void 0===i.mesh?null:r.getDependency("mesh",i.mesh).then((function(e){var t=r._getNodeRef(r.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,r=i.weights.length;t<r;t++)e.morphTargetInfluences[t]=i.weights[t]})),t}))}},{key:"loadNode",value:function(e){var t=this.json,i=this.extensions,n=this,s=t.nodes[e],o=s.name?n.createUniqueName(s.name):"";return function(){var t=[],r=n._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return r&&t.push(r),void 0!==s.camera&&t.push(n.getDependency("camera",s.camera).then((function(e){return n._getNodeRef(n.cameraCache,s.camera,e)}))),n._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){var a;if((a=!0===s.isBone?new r.Bone:t.length>1?new r.Group:1===t.length?t[0]:new r.Object3D)!==t[0])for(var l=0,c=t.length;l<c;l++)a.add(t[l]);if(s.name&&(a.userData.name=s.name,a.name=o),Is(a,s),s.extensions&&Fs(i,a,s),void 0!==s.matrix){var h=new r.Matrix4;h.fromArray(s.matrix),a.applyMatrix4(h)}else void 0!==s.translation&&a.position.fromArray(s.translation),void 0!==s.rotation&&a.quaternion.fromArray(s.rotation),void 0!==s.scale&&a.scale.fromArray(s.scale);return n.associations.set(a,{type:"nodes",index:e}),a}))}},{key:"loadScene",value:function(e){var t=this.json,i=this.extensions,n=this.json.scenes[e],o=new r.Group;n.name&&(o.name=this.createUniqueName(n.name)),Is(o,n),n.extensions&&Fs(i,o,n);for(var a=n.nodes||[],l=[],c=0,h=a.length;c<h;c++)l.push(zs(a[c],o,t,this));return Promise.all(l).then((function(){return o}))}}]),e}();function zs(e,t,i,n){var s=i.nodes[e];return n.getDependency("node",e).then((function(e){return void 0===s.skin?e:n.getDependency("skin",s.skin).then((function(e){for(var r=[],o=0,l=(t=e).joints.length;o<l;o++)r.push(n.getDependency("node",t.joints[o]));return Promise.all(r)})).then((function(i){return e.traverse((function(e){if(e.isMesh){for(var n=[],s=[],o=0,l=i.length;o<l;o++){var c=i[o];if(c){n.push(c);var h=new r.Matrix4;void 0!==t.inverseBindMatrices&&h.fromArray(t.inverseBindMatrices.array,16*o),s.push(h)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new r.Skeleton(n,s),e.matrixWorld)}})),e}));var t})).then((function(e){t.add(e);var r=[];if(s.children)for(var o=s.children,l=0,c=o.length;l<c;l++){var h=o[l];r.push(zs(h,e,i,n))}return Promise.all(r)}))}function Us(e,t,i){var n=t.attributes,s=[];function o(t,r){return i.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var l in n){var c=ks[l]||l.toLowerCase();c in e.attributes||s.push(o(n[l],c))}if(void 0!==t.indices&&!e.index){var h=i.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));s.push(h)}return Is(e,t),function(e,t,i){var n=t.attributes,s=new r.Box3;if(void 0!==n.POSITION){var o=i.json.accessors[n.POSITION],l=o.min,c=o.max;if(void 0!==l&&void 0!==c){if(s.set(new r.Vector3(l[0],l[1],l[2]),new r.Vector3(c[0],c[1],c[2])),o.normalized){var h=Ps(Ds[o.componentType]);s.min.multiplyScalar(h),s.max.multiplyScalar(h)}var d=t.targets;if(void 0!==d){for(var f=new r.Vector3,v=new r.Vector3,m=0,y=d.length;m<y;m++){var A=d[m];if(void 0!==A.POSITION){var w=i.json.accessors[A.POSITION],x=w.min,O=w.max;if(void 0!==x&&void 0!==O){if(v.setX(Math.max(Math.abs(x[0]),Math.abs(O[0]))),v.setY(Math.max(Math.abs(x[1]),Math.abs(O[1]))),v.setZ(Math.max(Math.abs(x[2]),Math.abs(O[2]))),w.normalized){var E=Ps(Ds[w.componentType]);v.multiplyScalar(E)}f.max(v)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(f)}e.boundingBox=s;var a=new r.Sphere;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=a}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,i),Promise.all(s).then((function(){return void 0!==t.targets?function(e,t,r){for(var i=!1,n=!1,o=0,l=t.length;o<l;o++){var c=t[o];if(void 0!==c.POSITION&&(i=!0),void 0!==c.NORMAL&&(n=!0),i&&n)break}if(!i&&!n)return Promise.resolve(e);for(var s=[],h=[],a=0,d=t.length;a<d;a++){var f=t[a];if(i){var v=void 0!==f.POSITION?r.getDependency("accessor",f.POSITION):e.attributes.position;s.push(v)}if(n){var m=void 0!==f.NORMAL?r.getDependency("accessor",f.NORMAL):e.attributes.normal;h.push(m)}}return Promise.all([Promise.all(s),Promise.all(h)]).then((function(t){var r=t[0],s=t[1];return i&&(e.morphAttributes.position=r),n&&(e.morphAttributes.normal=s),e.morphTargetsRelative=!0,e}))}(e,t.targets,i):e}))}function Gs(e,t){var i=e.getIndex();if(null===i){var n=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var l=0;l<o.count;l++)n.push(l);e.setIndex(n),i=e.getIndex()}var c=i.count-2,s=[];if(t===r.TriangleFanDrawMode)for(var h=1;h<=c;h++)s.push(i.getX(0)),s.push(i.getX(h)),s.push(i.getX(h+1));else for(var d=0;d<c;d++)d%2==0?(s.push(i.getX(d)),s.push(i.getX(d+1)),s.push(i.getX(d+2))):(s.push(i.getX(d+2)),s.push(i.getX(d+1)),s.push(i.getX(d)));s.length/3!==c&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var f=e.clone();return f.setIndex(s),f}var Vs=function(){function e(){Object(A.a)(this,e)}return Object(w.a)(e,null,[{key:"computeTangents",value:function(e){e.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use BufferGeometry.computeTangents() instead.")}},{key:"mergeBufferGeometries",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=null!==e[0].index,n=new Set(Object.keys(e[0].attributes)),s=new Set(Object.keys(e[0].morphAttributes)),o={},a={},l=e[0].morphTargetsRelative,c=new r.BufferGeometry,h=0,d=0;d<e.length;++d){var u=e[d],f=0;if(i!==(null!==u.index))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(var v in u.attributes){if(!n.has(v))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+'. All geometries must have compatible attributes; make sure "'+v+'" attribute exists among all geometries, or in none of them.'),null;void 0===o[v]&&(o[v]=[]),o[v].push(u.attributes[v]),f++}if(f!==n.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". Make sure all geometries have the same number of attributes."),null;if(l!==u.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(var m in u.morphAttributes){if(!s.has(m))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+".  .morphAttributes must be consistent throughout all geometries."),null;void 0===a[m]&&(a[m]=[]),a[m].push(u.morphAttributes[m])}if(c.userData.mergedUserData=c.userData.mergedUserData||[],c.userData.mergedUserData.push(u.userData),t){var y=void 0;if(i)y=u.index.count;else{if(void 0===u.attributes.position)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+d+". The geometry must have either an index or a position attribute"),null;y=u.attributes.position.count}c.addGroup(h,y,d),h+=y}}if(i){for(var A=0,w=[],x=0;x<e.length;++x){for(var O=e[x].index,E=0;E<O.count;++E)w.push(O.getX(E)+A);A+=e[x].attributes.position.count}c.setIndex(w)}for(var C in o){var D=this.mergeBufferAttributes(o[C]);if(!D)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+C+" attribute."),null;c.setAttribute(C,D)}for(var S in a){var B=a[S][0].length;if(0===B)break;c.morphAttributes=c.morphAttributes||{},c.morphAttributes[S]=[];for(var T=0;T<B;++T){for(var k=[],_=0;_<a[S].length;++_)k.push(a[S][_][T]);var M=this.mergeBufferAttributes(k);if(!M)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+S+" morphAttribute."),null;c.morphAttributes[S].push(M)}}return c}},{key:"mergeBufferAttributes",value:function(e){for(var t,i,n,s=0,o=0;o<e.length;++o){var l=e[o];if(l.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(void 0===t&&(t=l.array.constructor),t!==l.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.array must be of consistent array types across matching attributes."),null;if(void 0===i&&(i=l.itemSize),i!==l.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.itemSize must be consistent across matching attributes."),null;if(void 0===n&&(n=l.normalized),n!==l.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. BufferAttribute.normalized must be consistent across matching attributes."),null;s+=l.array.length}for(var c=new t(s),a=0,h=0;h<e.length;++h)c.set(e[h].array,a),a+=e[h].array.length;return new r.BufferAttribute(c,i,n)}},{key:"interleaveAttributes",value:function(e){for(var t,i=0,n=0,o=0,l=e.length;o<l;++o){var c=e[o];if(void 0===t&&(t=c.array.constructor),t!==c.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;i+=c.array.length,n+=c.itemSize}for(var s=new r.InterleavedBuffer(new t(i),n),h=0,a=[],d=["getX","getY","getZ","getW"],f=["setX","setY","setZ","setW"],v=0,m=e.length;v<m;v++){var y=e[v],A=y.itemSize,w=y.count,u=new r.InterleavedBufferAttribute(s,A,h,y.normalized);a.push(u),h+=A;for(var x=0;x<w;x++)for(var O=0;O<A;O++)u[f[O]](x,y[d[O]](x))}return a}},{key:"estimateBytesUsed",value:function(e){var t=0;for(var r in e.attributes){var n=e.getAttribute(r);t+=n.count*n.itemSize*n.array.BYTES_PER_ELEMENT}var o=e.getIndex();return t+=o?o.count*o.itemSize*o.array.BYTES_PER_ELEMENT:0}},{key:"mergeVertices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e-4;t=Math.max(t,Number.EPSILON);for(var i={},n=e.getIndex(),s=e.getAttribute("position"),o=n?n.count:s.count,a=0,l=Object.keys(e.attributes),c={},h={},u=[],d=["getX","getY","getZ","getW"],f=0,v=l.length;f<v;f++){var m=l[f];c[m]=[];var y=e.morphAttributes[m];y&&(h[m]=new Array(y.length).fill().map((function(){return[]})))}for(var p=Math.log10(1/t),A=Math.pow(10,p),w=0;w<o;w++){for(var x=n?n.getX(w):w,O="",E=0,C=l.length;E<C;E++)for(var D=l[E],S=e.getAttribute(D),B=S.itemSize,T=0;T<B;T++)O+=~~(S[d[T]](x)*A)+",";if(O in i)u.push(i[O]);else{for(var k=0,_=l.length;k<_;k++)for(var M=l[k],L=e.getAttribute(M),N=e.morphAttributes[M],F=L.itemSize,I=c[M],j=h[M],P=0;P<F;P++){var R=d[P];if(I.push(L[R](x)),N)for(var z=0,U=N.length;z<U;z++)j[z].push(N[z][R](x))}i[O]=a,u.push(a),a++}}for(var G=e.clone(),V=0,H=l.length;V<H;V++){var J=l[V],Q=e.getAttribute(J),Y=new Q.array.constructor(c[J]),W=new r.BufferAttribute(Y,Q.itemSize,Q.normalized);if(G.setAttribute(J,W),J in h)for(var X=0;X<h[J].length;X++){var K=e.morphAttributes[J][X],Z=new K.array.constructor(h[J][X]),$=new r.BufferAttribute(Z,K.itemSize,K.normalized);G.morphAttributes[J][X]=$}}return G.setIndex(u),G}},{key:"toTrianglesDrawMode",value:function(e,t){if(t===r.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(t===r.TriangleFanDrawMode||t===r.TriangleStripDrawMode){var n=e.getIndex();if(null===n){var o=[],l=e.getAttribute("position");if(void 0===l)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var c=0;c<l.count;c++)o.push(c);e.setIndex(o),n=e.getIndex()}var h=n.count-2,s=[];if(t===r.TriangleFanDrawMode)for(var d=1;d<=h;d++)s.push(n.getX(0)),s.push(n.getX(d)),s.push(n.getX(d+1));else for(var f=0;f<h;f++)f%2==0?(s.push(n.getX(f)),s.push(n.getX(f+1)),s.push(n.getX(f+2))):(s.push(n.getX(f+2)),s.push(n.getX(f+1)),s.push(n.getX(f)));s.length/3!==h&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var v=e.clone();return v.setIndex(s),v.clearGroups(),v}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",t),e}},{key:"computeMorphedAttributes",value:function(e){if(!0!==e.geometry.isBufferGeometry)return console.error("THREE.BufferGeometryUtils: Geometry is not of type BufferGeometry."),null;var t=new r.Vector3,i=new r.Vector3,n=new r.Vector3,s=new r.Vector3,o=new r.Vector3,a=new r.Vector3,l=new r.Vector3,c=new r.Vector3,h=new r.Vector3;function u(e,r,u,d,p,f,v,g,m){t.fromBufferAttribute(u,f),i.fromBufferAttribute(u,v),n.fromBufferAttribute(u,g);var y=e.morphTargetInfluences;if(r.morphTargets&&d&&y){l.set(0,0,0),c.set(0,0,0),h.set(0,0,0);for(var A=0,w=d.length;A<w;A++){var x=y[A],O=d[A];0!==x&&(s.fromBufferAttribute(O,f),o.fromBufferAttribute(O,v),a.fromBufferAttribute(O,g),p?(l.addScaledVector(s,x),c.addScaledVector(o,x),h.addScaledVector(a,x)):(l.addScaledVector(s.sub(t),x),c.addScaledVector(o.sub(i),x),h.addScaledVector(a.sub(n),x)))}t.add(l),i.add(c),n.add(h)}e.isSkinnedMesh&&(e.boneTransform(f,t),e.boneTransform(v,i),e.boneTransform(g,n)),m[3*f+0]=t.x,m[3*f+1]=t.y,m[3*f+2]=t.z,m[3*v+0]=i.x,m[3*v+1]=i.y,m[3*v+2]=i.z,m[3*g+0]=n.x,m[3*g+1]=n.y,m[3*g+2]=n.z}var d,f,g,v,m,y,A,w,x,O=e.geometry,p=e.material,E=O.index,C=O.attributes.position,D=O.morphAttributes.position,S=O.morphTargetsRelative,B=O.attributes.normal,b=O.morphAttributes.position,T=O.groups,k=O.drawRange,_=new Float32Array(C.count*C.itemSize),M=new Float32Array(B.count*B.itemSize);if(null!==E)if(Array.isArray(p))for(v=0,y=T.length;v<y;v++)for(x=p[(w=T[v]).materialIndex],m=Math.max(w.start,k.start),A=Math.min(w.start+w.count,k.start+k.count);m<A;m+=3)u(e,x,C,D,S,d=E.getX(m),f=E.getX(m+1),g=E.getX(m+2),_),u(e,x,B,b,S,d,f,g,M);else for(v=Math.max(0,k.start),y=Math.min(E.count,k.start+k.count);v<y;v+=3)u(e,p,C,D,S,d=E.getX(v),f=E.getX(v+1),g=E.getX(v+2),_),u(e,p,B,b,S,d,f,g,M);else if(void 0!==C)if(Array.isArray(p))for(v=0,y=T.length;v<y;v++)for(x=p[(w=T[v]).materialIndex],m=Math.max(w.start,k.start),A=Math.min(w.start+w.count,k.start+k.count);m<A;m+=3)u(e,x,C,D,S,d=m,f=m+1,g=m+2,_),u(e,x,B,b,S,d,f,g,M);else for(v=Math.max(0,k.start),y=Math.min(C.count,k.start+k.count);v<y;v+=3)u(e,p,C,D,S,d=v,f=v+1,g=v+2,_),u(e,p,B,b,S,d,f,g,M);return{positionAttribute:C,normalAttribute:B,morphedPositionAttribute:new r.Float32BufferAttribute(_,3),morphedNormalAttribute:new r.Float32BufferAttribute(M,3)}}}]),e}(),Hs=new WeakMap,Js=function(e){Object(x.a)(n,e);var t=S(n);function n(e){var r;return Object(A.a)(this,n),(r=t.call(this,e)).decoderPath="",r.decoderConfig={},r.decoderBinary=null,r.decoderPending=null,r.workerLimit=4,r.workerPool=[],r.workerNextTaskID=1,r.workerSourceURL="",r.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},r.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"},r}return Object(w.a)(n,[{key:"setDecoderPath",value:function(e){return this.decoderPath=e,this}},{key:"setDecoderConfig",value:function(e){return this.decoderConfig=e,this}},{key:"setWorkerLimit",value:function(e){return this.workerLimit=e,this}},{key:"load",value:function(e,t,i,n){var o=this,s=new r.FileLoader(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,(function(e){var r={attributeIDs:o.defaultAttributeIDs,attributeTypes:o.defaultAttributeTypes,useUniqueIDs:!1};o.decodeGeometry(e,r).then(t).catch(n)}),i,n)}},{key:"decodeDracoFile",value:function(e,t,r,i){var n={attributeIDs:r||this.defaultAttributeIDs,attributeTypes:i||this.defaultAttributeTypes,useUniqueIDs:!!r};this.decodeGeometry(e,n).then(t)}},{key:"decodeGeometry",value:function(e,t){var r=this;for(var n in t.attributeTypes){var o=t.attributeTypes[n];void 0!==o.BYTES_PER_ELEMENT&&(t.attributeTypes[n]=o.name)}var i,l=JSON.stringify(t);if(Hs.has(e)){var c=Hs.get(e);if(c.key===l)return c.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var h=this.workerNextTaskID++,s=e.byteLength,d=this._getWorker(h,s).then((function(r){return i=r,new Promise((function(r,s){i._callbacks[h]={resolve:r,reject:s},i.postMessage({type:"decode",id:h,taskConfig:t,buffer:e},[e])}))})).then((function(e){return r._createGeometry(e.geometry)}));return d.catch((function(){return!0})).then((function(){i&&h&&r._releaseTask(i,h)})),Hs.set(e,{key:l,promise:d}),d}},{key:"_createGeometry",value:function(e){var t=new r.BufferGeometry;e.index&&t.setIndex(new r.BufferAttribute(e.index.array,1));for(var n=0;n<e.attributes.length;n++){var o=e.attributes[n],s=o.name,l=o.array,a=o.itemSize;t.setAttribute(s,new r.BufferAttribute(l,a))}return t}},{key:"_loadLibrary",value:function(e,t){var i=new r.FileLoader(this.manager);return i.setPath(this.decoderPath),i.setResponseType(t),i.setWithCredentials(this.withCredentials),new Promise((function(t,r){i.load(e,t,void 0,r)}))}},{key:"preload",value:function(){return this._initDecoder(),this}},{key:"_initDecoder",value:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!=("undefined"==typeof WebAssembly?"undefined":Object(d.a)(WebAssembly))||"js"===this.decoderConfig.type,r=[];return t?r.push(this._loadLibrary("draco_decoder.js","text")):(r.push(this._loadLibrary("draco_wasm_wrapper.js","text")),r.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(r).then((function(r){var n=r[0];t||(e.decoderConfig.wasmBinary=r[1]);var i=Qs.toString(),o=["/* draco decoder */",n,"","/* worker */",i.substring(i.indexOf("{")+1,i.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending}},{key:"_getWorker",value:function(e,t){var r=this;return this._initDecoder().then((function(){if(r.workerPool.length<r.workerLimit){var n=new Worker(r.workerSourceURL);n._callbacks={},n._taskCosts={},n._taskLoad=0,n.postMessage({type:"init",decoderConfig:r.decoderConfig}),n.onmessage=function(e){var t=e.data;switch(t.type){case"decode":n._callbacks[t.id].resolve(t);break;case"error":n._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},r.workerPool.push(n)}else r.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));var o=r.workerPool[r.workerPool.length-1];return o._taskCosts[e]=t,o._taskLoad+=t,o}))}},{key:"_releaseTask",value:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]}},{key:"debug",value:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))}},{key:"dispose",value:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}]),n}(r.Loader);function Qs(){var e,t;function r(e,t,r,i,n,s){var o=s.num_components(),a=r.num_points()*o,l=a*n.BYTES_PER_ELEMENT,c=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,n),h=e._malloc(l);t.GetAttributeDataArrayForAllPoints(r,s,c,l,h);var u=new n(e.HEAPF32.buffer,h,a).slice();return e._free(h),{name:i,array:u,itemSize:o}}onmessage=function(i){var n=i.data;switch(n.type){case"init":e=n.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var o=n.buffer,s=n.taskConfig;t.then((function(e){var t=e.draco,l=new t.Decoder,a=new t.DecoderBuffer;a.Init(new Int8Array(o),o.byteLength);try{var c=function(e,t,i,n){var a,o,s=n.attributeIDs,l=n.attributeTypes,c=t.GetEncodedGeometryType(i);if(c===e.TRIANGULAR_MESH)a=new e.Mesh,o=t.DecodeBufferToMesh(i,a);else{if(c!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");a=new e.PointCloud,o=t.DecodeBufferToPointCloud(i,a)}if(!o.ok()||0===a.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var h={index:null,attributes:[]};for(var d in s){var f=self[l[d]],v=void 0,u=void 0;if(n.useUniqueIDs)u=s[d],v=t.GetAttributeByUniqueId(a,u);else{if(-1===(u=t.GetAttributeId(a,e[s[d]])))continue;v=t.GetAttribute(a,u)}h.attributes.push(r(e,t,a,d,f,v))}return c===e.TRIANGULAR_MESH&&(h.index=function(e,t,r){var i=3*r.num_faces(),n=4*i,s=e._malloc(n);t.GetTrianglesUInt32Array(r,n,s);var o=new Uint32Array(e.HEAPF32.buffer,s,i).slice();return e._free(s),{array:o,itemSize:1}}(e,t,a)),e.destroy(a),h}(t,l,a,s),h=c.attributes.map((function(e){return e.array.buffer}));c.index&&h.push(c.index.array.buffer),self.postMessage({type:"decode",id:n.id,geometry:c},h)}catch(e){console.error(e),self.postMessage({type:"error",id:n.id,error:e.message})}finally{t.destroy(a),t.destroy(l)}}))}}}var Ys="object"==(void 0===e?"undefined":Object(d.a)(e))&&e&&e.Object===Object&&e,Ws="object"==("undefined"==typeof self?"undefined":Object(d.a)(self))&&self&&self.Object===Object&&self,Xs=Ys||Ws||Function("return this")(),Ks=Xs.Symbol,qs=Object.prototype,Zs=qs.hasOwnProperty,$s=qs.toString,eu=Ks?Ks.toStringTag:void 0,tu=Object.prototype.toString,ru=Ks?Ks.toStringTag:void 0;function nu(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":ru&&ru in Object(e)?function(e){var t=Zs.call(e,eu),r=e[eu];try{e[eu]=void 0;var i=!0}catch(e){}var n=$s.call(e);return i&&(t?e[eu]=r:delete e[eu]),n}(e):function(e){return tu.call(e)}(e)}function iu(e){return null!=e&&"object"==Object(d.a)(e)}function au(e){return"symbol"==Object(d.a)(e)||iu(e)&&"[object Symbol]"==nu(e)}function ou(e,t){for(var r=-1,i=null==e?0:e.length,n=Array(i);++r<i;)n[r]=t(e[r],r,e);return n}var su=Array.isArray,uu=Ks?Ks.prototype:void 0,lu=uu?uu.toString:void 0;function cu(e){if("string"==typeof e)return e;if(su(e))return ou(e,cu)+"";if(au(e))return lu?lu.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function hu(e){var t=Object(d.a)(e);return null!=e&&("object"==t||"function"==t)}function du(e){return e}function fu(e){if(!hu(e))return!1;var t=nu(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var vu,pu=Xs["__core-js_shared__"],mu=(vu=/[^.]+$/.exec(pu&&pu.keys&&pu.keys.IE_PROTO||""))?"Symbol(src)_1."+vu:"",gu=Function.prototype.toString;function yu(e){if(null!=e){try{return gu.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var Au=/^\[object .+?Constructor\]$/,bu=Function.prototype,wu=Object.prototype,xu=bu.toString,Ou=wu.hasOwnProperty,Eu=RegExp("^"+xu.call(Ou).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Cu(e,t){var r=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!hu(e)||(t=e,mu&&mu in t))&&(fu(e)?Eu:Au).test(yu(e));var t}(r)?r:void 0}var Du=Cu(Xs,"WeakMap"),Su=/^(?:0|[1-9]\d*)$/;function Bu(e,t){var r=Object(d.a)(e);return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&Su.test(e))&&e>-1&&e%1==0&&e<t}function Tu(e,t){return e===t||e!=e&&t!=t}function ku(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function _u(e){return null!=e&&ku(e.length)&&!fu(e)}var Mu=Object.prototype;function Lu(e){return iu(e)&&"[object Arguments]"==nu(e)}var Nu=Object.prototype,Fu=Nu.hasOwnProperty,Iu=Nu.propertyIsEnumerable,ju=Lu(function(){return arguments}())?Lu:function(e){return iu(e)&&Fu.call(e,"callee")&&!Iu.call(e,"callee")},Pu="object"==Object(d.a)(t)&&t&&!t.nodeType&&t,Ru=Pu&&"object"==Object(d.a)(n)&&n&&!n.nodeType&&n,zu=Ru&&Ru.exports===Pu?Xs.Buffer:void 0,Uu=(zu?zu.isBuffer:void 0)||function(){return!1},Gu={};function Vu(e){return function(t){return e(t)}}Gu["[object Float32Array]"]=Gu["[object Float64Array]"]=Gu["[object Int8Array]"]=Gu["[object Int16Array]"]=Gu["[object Int32Array]"]=Gu["[object Uint8Array]"]=Gu["[object Uint8ClampedArray]"]=Gu["[object Uint16Array]"]=Gu["[object Uint32Array]"]=!0,Gu["[object Arguments]"]=Gu["[object Array]"]=Gu["[object ArrayBuffer]"]=Gu["[object Boolean]"]=Gu["[object DataView]"]=Gu["[object Date]"]=Gu["[object Error]"]=Gu["[object Function]"]=Gu["[object Map]"]=Gu["[object Number]"]=Gu["[object Object]"]=Gu["[object RegExp]"]=Gu["[object Set]"]=Gu["[object String]"]=Gu["[object WeakMap]"]=!1;var Hu="object"==Object(d.a)(t)&&t&&!t.nodeType&&t,Ju=Hu&&"object"==Object(d.a)(n)&&n&&!n.nodeType&&n,Qu=Ju&&Ju.exports===Hu&&Ys.process,Yu=function(){try{return Ju&&Ju.require&&Ju.require("util").types||Qu&&Qu.binding&&Qu.binding("util")}catch(e){}}(),Wu=Yu&&Yu.isTypedArray,Xu=Wu?Vu(Wu):function(e){return iu(e)&&ku(e.length)&&!!Gu[nu(e)]},Ku=Object.prototype.hasOwnProperty;var qu,Zu,$u=(qu=Object.keys,Zu=Object,function(e){return qu(Zu(e))}),el=Object.prototype.hasOwnProperty;function tl(e){return _u(e)?function(e,t){var r=su(e),i=!r&&ju(e),n=!r&&!i&&Uu(e),s=!r&&!i&&!n&&Xu(e),o=r||i||n||s,a=o?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=a.length;for(var c in e)!t&&!Ku.call(e,c)||o&&("length"==c||n&&("offset"==c||"parent"==c)||s&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Bu(c,l))||a.push(c);return a}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||Mu))return $u(e);var t,r,i=[];for(var n in Object(e))el.call(e,n)&&"constructor"!=n&&i.push(n);return i}(e)}var rl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nl=/^\w*$/;function il(e,t){if(su(e))return!1;var r=Object(d.a)(e);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!au(e))||nl.test(e)||!rl.test(e)||null!=t&&e in Object(t)}var al=Cu(Object,"create"),sl=Object.prototype.hasOwnProperty,ll=Object.prototype.hasOwnProperty;function cl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function hl(e,t){for(var r=e.length;r--;)if(Tu(e[r][0],t))return r;return-1}cl.prototype.clear=function(){this.__data__=al?al(null):{},this.size=0},cl.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},cl.prototype.get=function(e){var t=this.__data__;if(al){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return sl.call(t,e)?t[e]:void 0},cl.prototype.has=function(e){var t=this.__data__;return al?void 0!==t[e]:ll.call(t,e)},cl.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=al&&void 0===t?"__lodash_hash_undefined__":t,this};var fl=Array.prototype.splice;function vl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}vl.prototype.clear=function(){this.__data__=[],this.size=0},vl.prototype.delete=function(e){var t=this.__data__,r=hl(t,e);return!(r<0||(r==t.length-1?t.pop():fl.call(t,r,1),--this.size,0))},vl.prototype.get=function(e){var t=this.__data__,r=hl(t,e);return r<0?void 0:t[r][1]},vl.prototype.has=function(e){return hl(this.__data__,e)>-1},vl.prototype.set=function(e,t){var r=this.__data__,i=hl(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this};var pl=Cu(Xs,"Map");function ml(e,t){var r,i,n=e.__data__;return("string"==(i=Object(d.a)(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?n["string"==typeof t?"string":"hash"]:n.map}function gl(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function yl(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function r(){var i=arguments,n=t?t.apply(this,i):i[0],s=r.cache;if(s.has(n))return s.get(n);var o=e.apply(this,i);return r.cache=s.set(n,o)||s,o};return r.cache=new(yl.Cache||gl),r}gl.prototype.clear=function(){this.size=0,this.__data__={hash:new cl,map:new(pl||vl),string:new cl}},gl.prototype.delete=function(e){var t=ml(this,e).delete(e);return this.size-=t?1:0,t},gl.prototype.get=function(e){return ml(this,e).get(e)},gl.prototype.has=function(e){return ml(this,e).has(e)},gl.prototype.set=function(e,t){var r=ml(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},yl.Cache=gl;var Al=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bl=/\\(\\)?/g,wl=function(e){var t=yl((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Al,(function(e,r,i,n){t.push(i?n.replace(bl,"$1"):r||e)})),t}),(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}();function xl(e,t){return su(e)?e:il(e,t)?[e]:wl(function(e){return null==e?"":cu(e)}(e))}function Ol(e){if("string"==typeof e||au(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function El(e,t){for(var r=0,i=(t=xl(t,e)).length;null!=e&&r<i;)e=e[Ol(t[r++])];return r&&r==i?e:void 0}function th(e){var t=this.__data__=new vl(e);this.size=t.size}th.prototype.clear=function(){this.__data__=new vl,this.size=0},th.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},th.prototype.get=function(e){return this.__data__.get(e)},th.prototype.has=function(e){return this.__data__.has(e)},th.prototype.set=function(e,t){var r=this.__data__;if(r instanceof vl){var i=r.__data__;if(!pl||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new gl(i)}return r.set(e,t),this.size=r.size,this};var Cl=Object.prototype.propertyIsEnumerable,Dl=Object.getOwnPropertySymbols,Sl=Dl?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var r=-1,i=null==e?0:e.length,n=0,s=[];++r<i;){var o=e[r];t(o)&&(s[n++]=o)}return s}(Dl(e),(function(t){return Cl.call(e,t)})))}:function(){return[]};function Bl(e){return function(e,t,r){var i=t(e);return su(e)?i:function(e,t){for(var r=-1,i=t.length,n=e.length;++r<i;)e[n+r]=t[r];return e}(i,r(e))}(e,tl,Sl)}var Tl=Cu(Xs,"DataView"),kl=Cu(Xs,"Promise"),_l=Cu(Xs,"Set"),Ml="[object Map]",Ll="[object Promise]",Nl="[object Set]",Fl="[object WeakMap]",Il="[object DataView]",jl=yu(Tl),Pl=yu(pl),Rl=yu(kl),zl=yu(_l),Ul=yu(Du),Gl=nu;(Tl&&Gl(new Tl(new ArrayBuffer(1)))!=Il||pl&&Gl(new pl)!=Ml||kl&&Gl(kl.resolve())!=Ll||_l&&Gl(new _l)!=Nl||Du&&Gl(new Du)!=Fl)&&(Gl=function(e){var t=nu(e),r="[object Object]"==t?e.constructor:void 0,i=r?yu(r):"";if(i)switch(i){case jl:return Il;case Pl:return Ml;case Rl:return Ll;case zl:return Nl;case Ul:return Fl}return t});var Vl=Gl,Hl=Xs.Uint8Array;function Jl(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new gl;++t<r;)this.add(e[t])}function Ql(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}function Yl(e,t){return e.has(t)}function Wl(e,t,r,i,n,s){var o=1&r,a=e.length,l=t.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(e),h=s.get(t);if(c&&h)return c==t&&h==e;var u=-1,d=!0,p=2&r?new Jl:void 0;for(s.set(e,t),s.set(t,e);++u<a;){var f=e[u],v=t[u];if(i)var g=o?i(v,f,u,t,e,s):i(f,v,u,e,t,s);if(void 0!==g){if(g)continue;d=!1;break}if(p){if(!Ql(t,(function(e,t){if(!Yl(p,t)&&(f===e||n(f,e,r,i,s)))return p.push(t)}))){d=!1;break}}else if(f!==v&&!n(f,v,r,i,s)){d=!1;break}}return s.delete(e),s.delete(t),d}function Xl(e){var t=-1,r=Array(e.size);return e.forEach((function(e,i){r[++t]=[i,e]})),r}function Kl(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}Jl.prototype.add=Jl.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Jl.prototype.has=function(e){return this.__data__.has(e)};var ql=Ks?Ks.prototype:void 0,Zl=ql?ql.valueOf:void 0,$l=Object.prototype.hasOwnProperty,ec="[object Arguments]",tc="[object Array]",rc="[object Object]",nc=Object.prototype.hasOwnProperty;function ic(e,t,r,i,n){return e===t||(null==e||null==t||!iu(e)&&!iu(t)?e!=e&&t!=t:function(e,t,r,i,n,s){var o=su(e),a=su(t),l=o?tc:Vl(e),c=a?tc:Vl(t),h=(l=l==ec?rc:l)==rc,u=(c=c==ec?rc:c)==rc,d=l==c;if(d&&Uu(e)){if(!Uu(t))return!1;o=!0,h=!1}if(d&&!h)return s||(s=new th),o||Xu(e)?Wl(e,t,r,i,n,s):function(e,t,r,i,n,s,o){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!s(new Hl(e),new Hl(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Tu(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=Xl;case"[object Set]":var l=1&i;if(a||(a=Kl),e.size!=t.size&&!l)return!1;var c=o.get(e);if(c)return c==t;i|=2,o.set(e,t);var h=Wl(a(e),a(t),i,n,s,o);return o.delete(e),h;case"[object Symbol]":if(Zl)return Zl.call(e)==Zl.call(t)}return!1}(e,t,l,r,i,n,s);if(!(1&r)){var p=h&&nc.call(e,"__wrapped__"),f=u&&nc.call(t,"__wrapped__");if(p||f){var v=p?e.value():e,g=f?t.value():t;return s||(s=new th),n(v,g,r,i,s)}}return!!d&&(s||(s=new th),function(e,t,r,i,n,s){var o=1&r,a=Bl(e),l=a.length;if(l!=Bl(t).length&&!o)return!1;for(var c=l;c--;){var h=a[c];if(!(o?h in t:$l.call(t,h)))return!1}var u=s.get(e),d=s.get(t);if(u&&d)return u==t&&d==e;var p=!0;s.set(e,t),s.set(t,e);for(var f=o;++c<l;){var v=e[h=a[c]],g=t[h];if(i)var m=o?i(g,v,h,t,e,s):i(v,g,h,e,t,s);if(!(void 0===m?v===g||n(v,g,r,i,s):m)){p=!1;break}f||(f="constructor"==h)}if(p&&!f){var y=e.constructor,A=t.constructor;y==A||!("constructor"in e)||!("constructor"in t)||"function"==typeof y&&y instanceof y&&"function"==typeof A&&A instanceof A||(p=!1)}return s.delete(e),s.delete(t),p}(e,t,r,i,n,s))}(e,t,r,i,ic,n))}function ac(e){return e==e&&!hu(e)}function oc(e,t){return function(r){return null!=r&&r[e]===t&&(void 0!==t||e in Object(r))}}function sc(e,t){return null!=e&&t in Object(e)}function uc(e,t){return il(e)&&ac(t)?oc(Ol(e),t):function(r){var i=function(e,t,r){var i=null==e?void 0:El(e,t);return void 0===i?void 0:i}(r,e);return void 0===i&&i===t?function(e,t){return null!=e&&function(e,t,r){for(var i=-1,n=(t=xl(t,e)).length,s=!1;++i<n;){var o=Ol(t[i]);if(!(s=null!=e&&r(e,o)))break;e=e[o]}return s||++i!=n?s:!!(n=null==e?0:e.length)&&ku(n)&&Bu(o,n)&&(su(e)||ju(e))}(e,t,sc)}(r,e):ic(t,i,3)}}function lc(e){return"function"==typeof e?e:null==e?du:"object"==Object(d.a)(e)?su(e)?uc(e[0],e[1]):function(e){var t=function(e){for(var t=tl(e),r=t.length;r--;){var i=t[r],n=e[i];t[r]=[i,n,ac(n)]}return t}(e);return 1==t.length&&t[0][2]?oc(t[0][0],t[0][1]):function(r){return r===e||function(e,t,r,i){var n=r.length,s=n;if(null==e)return!s;for(e=Object(e);n--;){var a=r[n];if(a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++n<s;){var o=(a=r[n])[0],l=e[o],c=a[1];if(a[2]){if(void 0===l&&!(o in e))return!1}else{var h,u=new th;if(!(void 0===h?ic(c,l,3,i,u):h))return!1}}return!0}(r,0,t)}}(e):function(e){return il(e)?(t=Ol(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return El(t,e)}}(e);var t}(e)}var cc=function(e,i){if(null==e)return e;if(!_u(e))return function(e,t){return e&&function(e,t,r){for(var i=-1,n=Object(e),s=r(e),o=s.length;o--;){var a=s[++i];if(!1===t(n[a],a,n))break}return e}(e,t,tl)}(e,i);for(var t=e.length,s=-1,r=Object(e);++s<t&&!1!==i(r[s],s,r););return e};function hc(e,t){if(e!==t){var r=void 0!==e,i=null===e,n=e==e,s=au(e),o=void 0!==t,a=null===t,l=t==t,c=au(t);if(!a&&!c&&!s&&e>t||s&&o&&l&&!a&&!c||i&&o&&l||!r&&l||!n)return 1;if(!i&&!s&&!c&&e<t||c&&r&&n&&!i&&!s||a&&r&&n||!o&&n||!l)return-1}return 0}function dc(e,t,r){t=t.length?ou(t,(function(e){return su(e)?function(t){return El(t,1===e.length?e[0]:e)}:e})):[du];var i=-1;return t=ou(t,Vu(lc)),function(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}(function(e,t){var r=-1,i=_u(e)?Array(e.length):[];return cc(e,(function(e,n,s){i[++r]=t(e,n,s)})),i}(e,(function(e,r,n){return{criteria:ou(t,(function(t){return t(e)})),index:++i,value:e}})),(function(e,t){return function(e,t,r){for(var i=-1,n=e.criteria,s=t.criteria,o=n.length,a=r.length;++i<o;){var l=hc(n[i],s[i]);if(l)return i>=a?l:l*("desc"==r[i]?-1:1)}return e.index-t.index}(e,t,r)}))}function fc(e){var t;return e instanceof Array?(t={},e.forEach((function(e){t[e.uuid]=e}))):t=e,t}var vc=function(e){Object(x.a)(n,e);var t=S(n);function n(){var e;return Object(A.a)(this,n),(e=t.apply(this,arguments)).path="",e.resourcePath="",e}return Object(w.a)(n,[{key:"loadFromFile",value:function(e){var t;return vr(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,o,i,l;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ko.ARRAY_BUFFER,i=new FileReader;return new Promise((function(n,s){var o=function(){s({error:!0,filename:e.name}),t.itemError(e.name),t.itemEnd(e.name)};switch(i.addEventListener("loadstart",(function(){t.itemStart(e.name)})),i.addEventListener("load",(function(e){var t,r=null===(t=e.target)||void 0===t?void 0:t.result;null!=r?n(r):o()}),!1),i.addEventListener("error",o),r){case ko.TEXT:i.readAsText(e);break;case ko.BINARY_STRING:if(void 0!==i.readAsBinaryString){i.readAsBinaryString(e);break}case ko.ARRAY_BUFFER:default:i.readAsArrayBuffer(e)}}))}(e,this.manager,ko.TEXT);case 2:return n=r.sent,o=this.parse(JSON.parse(n)),i=o.object,l=o.materials,r.abrupt("return",(i.name=null!==(t=e.name.split(".").shift())&&void 0!==t?t:e.name,this.manager.itemEnd(e.name),{scene:i,materials:l}));case 7:case"end":return r.stop()}}),r,this)})))}},{key:"load",value:function(e,t,i,n){var o=this,s=""===this.path?r.LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||s;var l=new r.FileLoader(this.manager);l.setPath(this.path),l.load(e,(function(r){var i=null;try{i=JSON.parse(r)}catch(r){return void 0!==n&&n(r),console.warn("ObjectLoader > load: can't parse ".concat(e,".")),void console.error(r)}var s=i.metadata;void 0!==s&&void 0!==s.type&&"geometry"!==s.type.toLowerCase()?o.parse(i,t):console.error("ObjectLoader: Can't load "+e)}),i,n)}},{key:"parse",value:function(e,t){var r;if(!1===$o(e))return console.error("File can not be parser"),{object:new Co,materials:{}};var i={},n=this.parseGeometries(e.geometries),s=this.loader.parseImages(e.images,(function(){void 0!==t&&t(h)})),o=this.parseTextures(e.textures,s),a=new is;a.init(fc(null!==(r=e.nodes)&&void 0!==r?r:[]),fc(o));var l=fc(this.loader.parseMaterials(e.materials,o)),c=this.customParseMaterials(l,e.materials,a),h=this.parseObject(e.object,n,c,i),u=this.parseInteractionStates(e.interactionStates,a);return this.parseInteractions(e.object,i,u),void 0!==e.images&&0!==e.images.length||void 0!==t&&t(h),{object:h,materials:c}}},{key:"parseGeometries",value:function(e){var t,r,i={};if(void 0!==e)for(var n=0,s=e.length;n<s;n++){var o=e[n],l=void 0;try{switch(null===(t=o.userData)||void 0===t?void 0:t.type){case void 0:l=this.loader.parseGeometries([o])[o.uuid];break;case"NonParametricGeometry":(l=o.vertexData?(new as).parse(o):this.loader.parseGeometries([o])[o.uuid]).userData={};var c=Object.assign({},o.userData,{geometry:l});l=Xe.create(c);break;case"SubdivGeometry":l=this.loader.parseGeometries([o])[o.uuid],l=ht.create({parameters:o.userData.parameters,geometry:l});break;default:l=vt(o.userData)}l.uuid=o.uuid,void 0!==o.name&&(l.name=o.name),i[o.uuid]=l}catch(e){console.warn("ObjectLoader > parseGeometries: error parsing geometry of type .",null===(r=o.userData)||void 0===r?void 0:r.type),console.error(e)}}return i}},{key:"parseAsync",value:function(e){var t;return vr(this,void 0,void 0,regeneratorRuntime.mark((function r(){var n,i,o,s,l,a,c,h,d;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!1!==$o(e)){r.next=2;break}return r.abrupt("return",(console.error("File can not be parser"),new Co));case 2:return n=new is,i={},r.next=6,this.parseGeometriesAsync(e.geometries);case 6:return o=r.sent,s=this.loader.parseImages(e.images,(function(){})),l=this.parseTextures(e.textures,s),n.init(fc(null!==(t=e.nodes)&&void 0!==t?t:[]),fc(l)),a=fc(this.loader.parseMaterials(e.materials,l)),c=this.customParseMaterials(a,e.materials,n),h=this.parseObject(e.object,o,c,i),d=this.parseInteractionStates(e.interactionStates,n),r.abrupt("return",(this.parseInteractions(e.object,i,d),h));case 12:case"end":return r.stop()}}),r,this)})))}},{key:"parseGeometriesAsync",value:function(e){var t,r;return vr(this,void 0,void 0,regeneratorRuntime.mark((function n(){var i,o,l,c,h,s,d,f=this;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i={},void 0===e){n.next=9;break}o=regeneratorRuntime.mark((function n(o,l){var c,v,m,y,A,w,x;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:c=e[o],v=void 0,n.prev=2,n.t0=null===(t=c.userData)||void 0===t?void 0:t.type,n.next=void 0===n.t0?6:"NonParametricGeometry"===n.t0?8:22;break;case 6:return v=f.loader.parseGeometries([c])[c.uuid],n.abrupt("break",23);case 8:if(!c.gltf){n.next=17;break}return f.gltfLoader||(f.gltfLoader=new us,(m=new Js).setDecoderPath("https://www.gstatic.com/draco/v1/decoders/"),f.gltfLoader.setDRACOLoader(m)),n.next=12,new Promise((function(e){f.gltfLoader.parse(JSON.stringify(c.gltf),"",e)}));case 12:y=n.sent,A=[],y.scene.traverse((function(e){var t=e;t.isMesh&&A.push(t.geometry)})),1===A.length?v=A[0]:(s=function(e){return c.gltf.meshes.findIndex((function(t){var r=t.primitives[0].attributes.POSITION;return c.gltf.accessors[r].count===e.index.count}))},d=void 0,void 0,w=null==(h=A)?[]:(su(s)||(s=null==s?[]:[s]),su(d=d)||(d=null==d?[]:[d]),dc(h,s,d)),v=Vs.mergeBufferGeometries(w,!0)),n.next=18;break;case 17:v=f.loader.parseGeometries([c])[c.uuid];case 18:return v.userData={},x=Object.assign({},c.userData,{geometry:v}),v=Xe.create(x),n.abrupt("break",23);case 22:v=vt(c.userData);case 23:v.uuid=c.uuid,void 0!==c.name&&(v.name=c.name),i[c.uuid]=v,n.next=29;break;case 26:n.prev=26,n.t1=n.catch(2),console.warn("ObjectLoader > parseGeometries: error parsing geometry of type .",null===(r=c.userData)||void 0===r?void 0:r.type),console.error(n.t1);case 29:case"end":return n.stop()}}),n,null,[[2,26]])})),l=0,c=e.length;case 4:if(!(l<c)){n.next=9;break}return n.delegateYield(o(l,c),"t0",6);case 6:l++,n.next=4;break;case 9:return n.abrupt("return",i);case 10:case"end":return n.stop()}}),n)})))}},{key:"parseTextures",value:function(e,t){var r=this.loader.parseTextures(e,t);return Object.keys(r).forEach((function(e){var t=(new Yt).copy(r[e]);t.uuid=e,r[e]=t})),r}},{key:"customParseMaterials",value:function(e,t,r){var i={};if(void 0!==t)for(var n=0,s=t.length;n<s;n++){var o=t[n],l=e[o.uuid],a=l.userData;if(void 0!==a.type){var c=Zr[a.type];i[o.uuid]=c.fromJSON(l,o,r)}}return i}},{key:"parseObject",value:function(e,t,r,i){var n;if(void 0!==e.geometry){var o=function(e,t){return void 0===e[t]&&console.warn("ObjectLoader > getGeometry: undefined geometry",t),e[t]}(t,e.geometry),s=function(e,t){if(void 0!==t){if(t instanceof Array){for(var r=[],n=0,o=t.length;n<o;n++){var l=t[n];void 0===e[l]&&console.warn("ObjectLoader > getMaterial: undefined material",l),r.push(e[l])}return r}return void 0===e[t]&&console.warn("ObjectLoader > getMaterial: undefined material",t),e[t]}}(r,e.material);if(o){switch(e.objectType){case"Mesh2D":n=new na(o,s).fromJSON(e);break;case"Mesh3D":n=new ia(o,s).fromJSON(e);break;case"NonParametric":n=new aa(o,s).fromJSON(e);break;case"TextFrame":(n=new To(o,s)).fromJSONasync(e).then((function(){})).catch((function(){}));break;case"VectorObject":n=new Ji(o,s).fromJSON(e);break;case"SubdivObject":(n=new ts(o,s).fromJSON(e)).subdivPointer=o.subdivPointer;break;default:return void console.warn("ObjectLoader > parseObject: unsupported object type",e.objectType)}s||(n.name+=" (Recovered)")}else(n=(new Wi).fromJSON(e)).name+=" (Recovered)",console.warn("An empty object is created instead")}else switch(e.objectType){case"Scene":n=(new Co).fromJSON(e);break;case"CombinedCamera":n=(new Yi).fromJSON(e);break;case"LightDirectional":n=(new Xi).fromJSON(e);break;case"LightPoint":n=(new Ki).fromJSON(e);break;case"LightSpot":n=(new ea).fromJSON(e);break;case"EmptyObject":n=(new Wi).fromJSON(e);break;default:if("HemisphereLight"!==e.type&&"DirectionalLight"!==e.type)return void console.warn("ObjectLoader > parseObject: unsupported object type",e.objectType);n=this.loader.parseObject(e,t,r)}if(Ci(n)&&(i[e.uuid]=n),void 0!==e.children){var l,c=C(e.children);try{for(c.s();!(l=c.n()).done;){var h=l.value,d=this.parseObject(h,t,r,i);void 0!==d&&n.add(d)}}catch(e){c.e(e)}finally{c.f()}}return n instanceof Co&&n.initFromObjectLoader(e),n}},{key:"parseInteractionStates",value:function(e,t){var r={};if(void 0!==e)for(var n=0,o=e.length;n<o;n++){var l=(new rn).fromJSON(e[n],t);r[l.uuid]=l}return r}},{key:"parseInteractions",value:function(e,t,r){var i=t[e.uuid];if(void 0!==e.interaction&&void 0!==i&&(i.interaction=new Oi(i).fromJSON(e.interaction,t,r)),void 0!==e.children){var n,o=C(e.children);try{for(o.s();!(n=o.n()).done;){var l=n.value;this.parseInteractions(l,t,r)}}catch(e){o.e(e)}finally{o.f()}}}}]),n}(function(e){return function(){return function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.DefaultLoadingManager;Object(A.a)(this,t),this.manager=n,this.loader=new e(n)}}()}(r.ObjectLoader)),pc={type:"change"},mc={type:"changeZoom"},gc={type:"start"},yc={type:"end"},Ac=navigator.platform.toUpperCase().indexOf("MAC")>=0,bc=function(e){Object(x.a)(n,e);var t=S(n);function n(e,o){var l,i,c,s,h,a;Object(A.a)(this,n),l=t.call(this),void 0===o&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),o===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),l.object=e,l.domElement=o,l.enabled=!0,l.useKeyEvents=!0,l.target=new r.Vector3,l.object.getTarget(l.target),l.minDistance=0,l.maxDistance=1/0,l.minZoom=0,l.maxZoom=1/0,l.minPolarAngle=0+1*r.MathUtils.DEG2RAD,l.maxPolarAngle=Math.PI-1*r.MathUtils.DEG2RAD,l.minAzimuthAngle=-1/0,l.maxAzimuthAngle=1/0,l.enableDamping=!1,l.dampingFactor=.1,l.enableZoom=!0,l.zoomSpeed=2,l.enableRotate=!0,l.rotateSpeed=1,l.enablePan=!0,l.panSpeed=1,l.screenSpacePanning=!0,l.keyPanSpeed=7,l.autoRotate=!1,l.autoRotateSpeed=2,l.autoRotateClockwise=!0,l.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},l.mouseButtons={LEFT:r.MOUSE.ROTATE,MIDDLE:r.MOUSE.DOLLY,RIGHT:r.MOUSE.PAN},l.touches={ONE:r.TOUCH.ROTATE,TWO:r.TOUCH.DOLLY_PAN},l.target0=l.target.clone(),l.position0=l.object.position.clone(),l.zoom0=l.object.zoom,l.getPolarAngle=function(){return y.phi},l.getAzimuthalAngle=function(){return y.theta},l.saveState=function(){d.target0.copy(d.target),d.position0.copy(d.object.position),d.zoom0=d.object.zoom},l.reset=function(){d.target.copy(d.target0),d.object.position.copy(d.position0),d.object.zoom=d.zoom0,i=0,d.object.updateProjectionMatrix(),d.dispatchEvent(pc),d.update(),v=f.NONE},l.update=function(){var t=new r.Vector3,n=(new r.Quaternion).setFromUnitVectors(e.up,new r.Vector3(0,1,0)),o=n.clone().invert(),l=new r.Vector3,m=new r.Quaternion,A=2*Math.PI;return function(){var e,r=d.object.position;t.copy(r).sub(d.target),t.applyQuaternion(n),y.setFromVector3(t),d.autoRotate&&v===f.NONE&&(!0===d.autoRotateClockwise?N(M()):(e=M(),p.theta+=e)),d.rotationLimitsMode!==d.rotationLimitsOptions.HORIZONTAL&&(y.phi+=p.phi),d.rotationLimitsMode===d.rotationLimitsOptions.VERTICAL&&!0!==d.autoRotate||(y.theta+=p.theta),d.rotationLimitsMode!==d.rotationLimitsOptions.VERTICAL&&d.rotationLimitsMode!==d.rotationLimitsOptions.BOTH||(y.phi=Math.max(c,Math.min(s,y.phi))),d.rotationLimitsMode!==d.rotationLimitsOptions.HORIZONTAL&&d.rotationLimitsMode!==d.rotationLimitsOptions.BOTH||((i+=p.theta)>d.rotationHorizontalOffset.max?(y.theta=a,i=d.rotationHorizontalOffset.max):i<-d.rotationHorizontalOffset.min&&(y.theta=h,i=-d.rotationHorizontalOffset.min));var b=d.minAzimuthAngle,O=d.maxAzimuthAngle;return isFinite(b)&&isFinite(O)&&(b<-Math.PI?b+=A:b>Math.PI&&(b-=A),O<-Math.PI?O+=A:O>Math.PI&&(O-=A),y.theta=b<=O?Math.max(b,Math.min(O,y.theta)):y.theta>(b+O)/2?Math.max(b,y.theta):Math.min(O,y.theta)),y.phi=Math.max(d.minPolarAngle,Math.min(d.maxPolarAngle,y.phi)),y.makeSafe(),y.radius*=w,y.radius=Math.max(d.minDistance,Math.min(d.maxDistance,y.radius)),d.target.add(x),t.setFromSpherical(y),t.applyQuaternion(o),r.copy(d.target).add(t),d.object.lookAt(d.target),!0===d.enableDamping?(p.theta*=1-d.dampingFactor,p.phi*=1-d.dampingFactor):p.set(0,0,0),x.set(0,0,0),w=1,!!(g||l.distanceToSquared(d.object.position)>u||8*(1-m.dot(d.object.quaternion))>u)&&(d.dispatchEvent(pc),g&&d.dispatchEvent(mc),l.copy(d.object.position),m.copy(d.object.quaternion),g=!1,!0)}}(),l.dispose=function(){d.domElement.removeEventListener("contextmenu",ce),d.domElement.removeEventListener("pointerdown",te),d.domElement.removeEventListener("wheel",ie),d.domElement.removeEventListener("touchstart",se),d.domElement.removeEventListener("touchend",le),d.domElement.removeEventListener("touchmove",ue),d.domElement.ownerDocument.removeEventListener("pointermove",re),d.domElement.ownerDocument.removeEventListener("pointerup",q),d.domElement.removeEventListener("gesturestart",H),d.domElement.removeEventListener("gesturechange",H),d.domElement.removeEventListener("gestureend",H),window.removeEventListener("keydown",ae,!1),window.removeEventListener("keyup",oe,!1)},l.zoomOut=function(){R(L())},l.zoomIn=function(){z(L())},l.setEnableDampingSpeed=function(e){this.enableDamping=e,this.rotateSpeed=!0===e?.2:1},l.resetTo=function(e,t,r){d.target.copy(e),d.object.position.copy(t),d.object.zoom=r,d.object.updateProjectionMatrix(),d.dispatchEvent(pc),d.update(),v=f.NONE},l.updateTarget=function(){this.object.getTarget(this.target),this.update()},l.rotationVerticalOffset={min:.5*Math.PI,max:.5*Math.PI},l.rotationHorizontalOffset={min:.5*Math.PI,max:.5*Math.PI},l.rotationLimitsOptions={DEFAULT:0,VERTICAL:1,HORIZONTAL:2,BOTH:3},l.rotationLimitsMode=l.rotationLimitsOptions.DEFAULT,l.updateRotationOffetLimits=function(){i=0,c=wc(y.phi-d.rotationVerticalOffset.min),s=wc(y.phi+d.rotationVerticalOffset.max),c<0&&(c=d.minPolarAngle),s<0&&(s=d.maxPolarAngle),h=wc(y.theta-d.rotationHorizontalOffset.min),a=wc(y.theta+d.rotationHorizontalOffset.max)},l.toJSON=function(){var e={};return d.useKeyEvents&&(e.useKeyEvents=!0),d.enableDamping&&(e.enableDamping=!0),d.enablePan&&(e.enablePan=!0),d.enableZoom&&(e.enableZoom=!0),d.enableRotate&&(e.enableRotate=!0),e.rotationLimitsMode=d.rotationLimitsMode,d.rotationLimitsMode!==d.rotationLimitsOptions.VERTICAL&&d.rotationLimitsMode!==d.rotationLimitsOptions.BOTH||(e.rotationVerticalOffset={min:d.rotationVerticalOffset.min,max:d.rotationVerticalOffset.max}),d.rotationLimitsMode!==d.rotationLimitsOptions.HORIZONTAL&&d.rotationLimitsMode!==d.rotationLimitsOptions.BOTH||(e.rotationHorizontalOffset={min:d.rotationHorizontalOffset.min,max:d.rotationHorizontalOffset.max}),d.autoRotate&&(e.autoRotate=!0,e.autoRotateSpeed=d.autoRotateSpeed,d.autoRotateClockwise&&(e.autoRotateClockwise=!0)),e},l.fromJSON=function(e){d.useKeyEvents=!0===e.useKeyEvents,d.setEnableDampingSpeed(!0===e.enableDamping),d.enablePan=!0===e.enablePan,d.enableZoom=!0===e.enableZoom,d.enableRotate=!0===e.enableRotate,void 0!==e.rotationLimitsMode&&(d.rotationLimitsMode=e.rotationLimitsMode),e.rotationVerticalOffset&&(d.rotationVerticalOffset={min:e.rotationVerticalOffset.min,max:e.rotationVerticalOffset.max}),e.rotationHorizontalOffset&&(d.rotationHorizontalOffset={min:e.rotationHorizontalOffset.min,max:e.rotationHorizontalOffset.max}),d.autoRotate=!0===e.autoRotate,e.autoRotateSpeed&&(d.autoRotateSpeed=e.autoRotateSpeed),d.autoRotateClockwise=!0===e.autoRotateClockwise,d.updateRotationOffetLimits()};var d=Object(m.a)(l),f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},v=f.NONE,u=1e-6,y=new r.Spherical,p=new r.Spherical,w=1,x=new r.Vector3,g=!1,O=new r.Vector2,E=new r.Vector2,C=new r.Vector2,D=new r.Vector2,S=new r.Vector2,b=new r.Vector2,B=new r.Vector2,T=new r.Vector2,k=new r.Vector2,_={};function M(){return 2*Math.PI/60/60*d.autoRotateSpeed}function L(){return Math.pow(.95,d.zoomSpeed)}function N(e){p.theta-=e}function F(e){p.phi-=e}var I=function(){var e=new r.Vector3;return function(t,r){e.setFromMatrixColumn(r,0),e.multiplyScalar(-t),x.add(e)}}(),j=function(){var e=new r.Vector3;return function(t,r){!0===d.screenSpacePanning?e.setFromMatrixColumn(r,1):(e.setFromMatrixColumn(r,0),e.crossVectors(d.object.up,e)),e.multiplyScalar(t),x.add(e)}}(),P=function(){var e=new r.Vector3;return function(t,r){var i=d.domElement;if(d.object.isPerspectiveCamera){var n=d.object.position;e.copy(n).sub(d.target);var o=e.length();o*=Math.tan(d.object.fov/2*Math.PI/180),I(2*t*o/i.clientHeight,d.object.matrix),j(2*r*o/i.clientHeight,d.object.matrix)}else d.object.isOrthographicCamera?(I(t*(d.object.right-d.object.left)/d.object.zoom/i.clientWidth,d.object.matrix),j(r*(d.object.top-d.object.bottom)/d.object.zoom/i.clientHeight,d.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),d.enablePan=!1)}}();function R(e){d.object.isPerspectiveCamera?w/=e:d.object.isOrthographicCamera?(d.object.zoom=Math.max(d.minZoom,Math.min(d.maxZoom,d.object.zoom*e)),d.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1)}function z(e){d.object.isPerspectiveCamera?w*=e:d.object.isOrthographicCamera?(d.object.zoom=Math.max(d.minZoom,Math.min(d.maxZoom,d.object.zoom/e)),d.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1)}function U(e){O.set(e.clientX,e.clientY)}function G(e){D.set(e.clientX,e.clientY)}var V=0;function H(e){if(e.preventDefault(),"gesturechange"===e.type){if(!1===d.enableZoom)return;e.scale>V?z(L()):e.scale<V&&R(L()),V=e.scale}}var J,Q,Y=!1;function W(e){if(1==e.touches.length)O.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);O.set(t,r)}}function X(e){if(1==e.touches.length)D.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);D.set(t,r)}}function K(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+r*r);B.set(0,i)}function Z(e){if(1==e.touches.length)E.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);E.set(t,r)}C.subVectors(E,O).multiplyScalar(d.rotateSpeed);var n=d.domElement;N(2*Math.PI*C.x/n.clientHeight),F(2*Math.PI*C.y/n.clientHeight),O.copy(E)}function $(e){if(1==e.touches.length)S.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),r=.5*(e.touches[0].pageY+e.touches[1].pageY);S.set(t,r)}b.subVectors(S,D).multiplyScalar(d.panSpeed),P(b.x,b.y),D.copy(S)}function ee(e){var t=e.touches[0].pageX-e.touches[1].pageX,r=e.touches[0].pageY-e.touches[1].pageY,i=Math.sqrt(t*t+r*r);T.set(0,i),k.set(0,Math.pow(T.y/B.y,d.zoomSpeed)),R(k.y),B.copy(T)}function te(e){if(!1!==d.enabled)switch(e.pointerType){case"mouse":case"pen":!1===d.useKeyEvents?function(e){var t;switch(e.preventDefault(),d.domElement.focus?d.domElement.focus():window.focus(),e.button){case 0:t=d.mouseButtons.LEFT;break;case 1:t=d.mouseButtons.MIDDLE;break;case 2:t=d.mouseButtons.RIGHT;break;default:t=-1}switch(t){case r.MOUSE.DOLLY:if(!1===d.enablePan)return;G(e),v=f.PAN;break;case r.MOUSE.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===d.enablePan)return;G(e),v=f.PAN}else{if(!1===d.enableRotate)return;U(e),v=f.ROTATE}break;case r.MOUSE.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===d.enableRotate)return;U(e),v=f.ROTATE}else{if(!1===d.enablePan)return;G(e),v=f.PAN}break;default:v=f.NONE}v!==f.NONE&&(d.domElement.ownerDocument.addEventListener("pointermove",re),d.domElement.ownerDocument.addEventListener("pointerup",q),d.dispatchEvent(gc))}(e):function(e){if(!1!==d.enabled&&!0!==d.object.enableableVectorControls&&!0!==d.object.enableableTransformControls&&"Vertex"!==d.object.enableableResizeControls&&"Face"!==d.object.enableableResizeControls&&"Edge"!==d.object.enableableResizeControls&&"Vertex"!==d.object.enableableScaleControls&&"Face"!==d.object.enableableScaleControls&&"Edge"!==d.object.enableableScaleControls){switch(e.preventDefault(),d.domElement.focus?d.domElement.focus():window.focus(),e.button){case d.mouseButtons.MIDDLE:if(!1===d.enablePan)return;G(e),v=f.PAN;break;case d.mouseButtons.LEFT:if(!0!==e.altKey||e.shiftKey||(Ac?e.metaKey:e.ctrlKey)){if("Space"===_.code){if(!1===d.enablePan)return;G(e),v=f.PAN}}else{if(!1===d.enableRotate)return;U(e),v=f.ROTATE}break;default:v=f.NONE}v!==f.NONE&&(d.domElement.ownerDocument.addEventListener("pointermove",re),d.domElement.ownerDocument.addEventListener("pointerup",q),d.dispatchEvent(gc))}}(e)}}function re(e){if(!1!==d.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1!==d.enabled)switch(e.preventDefault(),v){case f.ROTATE:if(!1===d.enableRotate)return;!function(e){E.set(e.clientX,e.clientY),C.subVectors(E,O).multiplyScalar(d.rotateSpeed);var t=d.domElement;N(2*Math.PI*C.x/t.clientHeight),F(2*Math.PI*C.y/t.clientHeight),O.copy(E),d.update()}(e);break;case f.DOLLY:if(!1===d.enableZoom)return;!function(e){T.set(e.clientX,e.clientY),k.subVectors(T,B),k.y>0?R(L()):k.y<0&&z(L()),B.copy(T),d.update()}(e);break;case f.PAN:if(!1===d.enablePan)return;!function(e){S.set(e.clientX,e.clientY),b.subVectors(S,D).multiplyScalar(d.panSpeed),P(b.x,b.y),D.copy(S),d.update()}(e)}}(e)}}function q(e){switch(e.pointerType){case"mouse":case"pen":ne()}}function ne(e){d.domElement.ownerDocument.removeEventListener("pointermove",re),d.domElement.ownerDocument.removeEventListener("pointerup",q),!1!==d.enabled&&(d.dispatchEvent(yc),v=f.NONE)}function ie(e){!1===d.enabled||!1===d.enableZoom||v!==f.NONE&&v!==f.ROTATE||(e.preventDefault(),d.dispatchEvent(gc),function(e){if(Y){if(!1===Q||(Ac?e.metaKey:e.ctrlKey)){if(!1===d.enableZoom)return;e.deltaY<0?z(L()):e.deltaY>0&&R(L())}else{if(!1===d.enablePan)return;b.set(-e.deltaX,-e.deltaY).multiplyScalar(d.panSpeed),e.altKey?P(0,b.y):e.shiftKey?P(b.x,0):P(b.x,b.y)}d.update()}else Y=!0,Q=function(e){return e.wheelDeltaY?e.wheelDeltaY===-3*e.deltaY:0===e.deltaMode}(e);J&&window.clearTimeout(J),J=window.setTimeout((function(){Y=!1,Q=void 0}),200)}(e),d.dispatchEvent(yc))}function ae(e){!1!==d.enabled&&(_=e)}function oe(){!1!==d.enabled&&(_={},v!==f.NONE&&ne(new PointerEvent("pointerover")))}function se(e){if(!1!==d.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(d.touches.ONE){case r.TOUCH.ROTATE:if(!1===d.enableRotate)return;W(e),v=f.TOUCH_ROTATE;break;case r.TOUCH.PAN:if(!1===d.enablePan)return;X(e),v=f.TOUCH_PAN;break;default:v=f.NONE}break;case 2:switch(d.touches.TWO){case r.TOUCH.DOLLY_PAN:if(!1===d.enableZoom&&!1===d.enablePan)return;!function(e){d.enableZoom&&K(e),d.enablePan&&X(e)}(e),v=f.TOUCH_DOLLY_PAN;break;case r.TOUCH.DOLLY_ROTATE:if(!1===d.enableZoom&&!1===d.enableRotate)return;!function(e){d.enableZoom&&K(e),d.enableRotate&&W(e)}(e),v=f.TOUCH_DOLLY_ROTATE;break;default:v=f.NONE}break;default:v=f.NONE}v!==f.NONE&&d.dispatchEvent(gc)}}function ue(e){if(!1!==d.enabled)switch(e.preventDefault(),v){case f.TOUCH_ROTATE:if(!1===d.enableRotate)return;Z(e),d.update();break;case f.TOUCH_PAN:if(!1===d.enablePan)return;$(e),d.update();break;case f.TOUCH_DOLLY_PAN:if(!1===d.enableZoom&&!1===d.enablePan)return;!function(e){d.enableZoom&&ee(e),d.enablePan&&$(e)}(e),d.update();break;case f.TOUCH_DOLLY_ROTATE:if(!1===d.enableZoom&&!1===d.enableRotate)return;!function(e){d.enableZoom&&ee(e),d.enableRotate&&Z(e)}(e),d.update();break;default:v=f.NONE}}function le(e){!1!==d.enabled&&(d.dispatchEvent(yc),v=f.NONE)}function ce(e){!1!==d.enabled&&e.preventDefault()}return d.domElement.addEventListener("contextmenu",ce),d.domElement.addEventListener("pointerdown",te),d.domElement.addEventListener("wheel",ie,{passive:!1}),d.domElement.addEventListener("touchstart",se,{passive:!1}),d.domElement.addEventListener("touchend",le),d.domElement.addEventListener("touchmove",ue,{passive:!1}),d.domElement.addEventListener("gesturestart",H),d.domElement.addEventListener("gesturechange",H),d.domElement.addEventListener("gestureend",H),window.addEventListener("keydown",ae,!1),window.addEventListener("keyup",oe,!1),l.update(),l.updateRotationOffetLimits(),l.setEnableDampingSpeed(!0),l}return n}(r.EventDispatcher);function wc(e){for(var t=2*Math.PI;e<=-Math.PI;)e+=t;for(;e>Math.PI;)e-=t;return e}var xc=function(){function e(t,n,i,o,s){Object(A.a)(this,e),this._aspect=1,this._renderer=t,this._camera=n,this._frameSize=(new r.Vector2).copy(i),this._editorSize=(new r.Vector2).copy(o),this._fov=null!=s?s:n.fov}return Object(w.a)(e,[{key:"frameSize",set:function(e){this._frameSize.copy(e)}},{key:"updateRenderer",value:function(){this._renderer&&this._renderer.setSize(this._frameSize.x,this._frameSize.height)}},{key:"updateViewport",value:function(){if(this._renderer&&this._camera&&"PerspectiveCamera"===this._camera.cameraType){var e=this._frameSize.x,t=this._frameSize.y,r=this._editorSize.x,i=this._editorSize.y,n=0,s=0,o=e,a=t;e<r&&(n=-(n=.5*(r-e)),o=r),t<i&&(s=-(s=.5*(i-t)),a=i),this._aspect=o/a,this._renderer.setViewport(n,s,o,a)}}},{key:"updateCamera",value:function(){if(this._camera)if("PerspectiveCamera"===this._camera.cameraType){var e=this._frameSize.y,t=this._editorSize.y,r=this._fov;e>t&&(r*=e/t,r*=1-((e-1080)/1080*(15-1)+1)/100),this._camera.aspect=this._aspect,this._camera.fov=r,this._camera.updateProjectionMatrix()}else this._camera.setViewplaneSize(this._frameSize.x,this._frameSize.y)}},{key:"revert",value:function(){var e=window.innerWidth,t=window.innerHeight;this._renderer&&(this._renderer.setViewport(0,0,e,t),this._renderer.setSize(e,t)),this._camera&&(this._camera.aspect=e/t,this._camera.fov=this._fov,this._camera.setViewplaneSize(e,t),this._camera.updateProjectionMatrix())}}]),e}(),Oc=/^\s+|\s+$/g,Ec=/^[-+]0x[0-9a-f]+$/i,Cc=/^0b[01]+$/i,Dc=/^0o[0-7]+$/i,Sc=parseInt,Bc="object"==Object(d.a)(_o)&&_o&&_o.Object===Object&&_o,Tc="object"==("undefined"==typeof self?"undefined":Object(d.a)(self))&&self&&self.Object===Object&&self,kc=Bc||Tc||Function("return this")(),_c=Object.prototype.toString,Mc=Math.max,Lc=Math.min,Nc=function(){return kc.Date.now()};function Fc(e){var t=Object(d.a)(e);return!!e&&("object"==t||"function"==t)}function Ic(e){if("number"==typeof e)return e;if(function(e){return"symbol"==Object(d.a)(e)||function(e){return!!e&&"object"==Object(d.a)(e)}(e)&&"[object Symbol]"==_c.call(e)}(e))return NaN;if(Fc(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Fc(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Oc,"");var r=Cc.test(e);return r||Dc.test(e)?Sc(e.slice(2),r?2:8):Ec.test(e)?NaN:+e}var jc,Pc,Rc;return function(e){e[e.FULLSCREEN=1]="FULLSCREEN",e[e.CUSTOM=2]="CUSTOM"}(jc||(jc={})),function(e){e.ACUTE="",e.GRAVE="`",e.CIRCUMFLEX="^",e.DIAERESIS="",e.TILDE="~"}(Pc||(Pc={})),Object.values(Pc),Bo.FONTS_PATH="_assets/_fonts/",r.ImageUtils.getDataURL=function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===Rc&&(Rc=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Rc.width=e.width,Rc.height=e.height;var r=Rc.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),t=Rc}return t.toDataURL("image/png")},t.Application=function(){function e(){Object(A.a)(this,e),this._viewportMode=jc.FULLSCREEN,this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._running=!1,window.addEventListener("resize",function(e,t,r){var i,n,s,o,a,l,c=0,h=!1,u=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var r=i,s=n;return i=n=void 0,c=t,o=e.apply(s,r)}function f(e){return c=e,a=setTimeout(g,t),h?p(e):o}function v(e){var r=e-l;return void 0===l||r>=t||r<0||u&&e-c>=s}function g(){var e=Nc();if(v(e))return m(e);a=setTimeout(g,function(e){var r=t-(e-l);return u?Lc(r,s-(e-c)):r}(e))}function m(e){return a=void 0,d&&i?p(e):(i=n=void 0,o)}function y(){var e=Nc(),r=v(e);if(i=arguments,n=this,l=e,r){if(void 0===a)return f(l);if(u)return a=setTimeout(g,t),p(l)}return void 0===a&&(a=setTimeout(g,t)),o}return t=Ic(t)||0,Fc(r)&&(h=!!r.leading,s=(u="maxWait"in r)?Mc(Ic(r.maxWait)||0,t):s,d="trailing"in r?!!r.trailing:d),y.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=n=a=void 0},y.flush=function(){return void 0===a?o:m(Nc())},y}(this.resize.bind(this),200))}return Object(w.a)(e,[{key:"start",value:function(e){var t=this;fetch(e).then((function(e){return e.json()})).then((function(e){return t._editorData=e.editor,(new vc).parseAsync(e)})).then((function(e){t._scene=e,t._camera=t._scene.activeCamera,t.init(),t._running=!0,t.run(),t.resize()})).catch((function(e){console.error(e)}))}},{key:"run",value:function(){requestAnimationFrame(this.run.bind(this)),this.render()}},{key:"render",value:function(){var e;this._running&&(this._renderer?(this._controls&&(this._controls.enableDamping||this._controls.autoRotate)&&this._controls.update(),this._playmode&&!this._playmode.isEnable&&this._playmode.activate(),this._scene&&this._camera&&((null===(e=this._scene.postprocessing)||void 0===e?void 0:e.enabled)?(this._renderer.autoClear=!0,this._scene.postprocessing.render()):(this._renderer.autoClear=!0,this._renderer.render(this._scene,this._camera)))):console.error("Application::render >>> tried to renderer without a renderer"))}},{key:"resize",value:function(){var e,t,i;this._running&&this._renderer&&(this._viewportMode===jc.FULLSCREEN&&(this._viewportWidth=window.innerWidth,this._viewportHeight=window.innerHeight,this._frameView&&(this._frameView.frameSize=new r.Vector2(this._viewportWidth,this._viewportHeight))),null===(e=this._frameView)||void 0===e||e.updateRenderer(),this._viewportMode!==jc.FULLSCREEN&&(null===(t=this._frameView)||void 0===t||t.updateViewport()),this._camera&&(null===(i=this._frameView)||void 0===i||i.updateCamera(),"PerspectiveCamera"===this._camera.cameraType&&this._viewportMode===jc.FULLSCREEN&&(this._camera.aspect=this._viewportWidth/this._viewportHeight),this._camera.updateProjectionMatrix()))}},{key:"init",value:function(){var e,t,i,n,s=document.getElementById("canvas3d");this._scene&&this._camera&&((null===(e=this._scene.postprocessing)||void 0===e?void 0:e.enabled)?(this._renderer=new r.WebGLRenderer({canvas:s,antialias:!1,stencil:!1,depth:!1,powerPreference:"high-performance"}),this._scene.postprocessing.init({renderer:this._renderer,camera:this._camera,scene:this._scene})):this._renderer=new r.WebGLRenderer({canvas:s,antialias:!0,alpha:!0,stencil:!0,depth:!0,powerPreference:"high-performance"}),this._viewportMode=null!==(t=this._scene.canvas.mode)&&void 0!==t?t:jc.FULLSCREEN,this._viewportWidth=null!==(i=this._scene.canvas.size.width)&&void 0!==i?i:window.innerWidth,this._viewportHeight=null!==(n=this._scene.canvas.size.height)&&void 0!==n?n:window.innerHeight,this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(this._viewportWidth,this._viewportHeight),this._renderer.shadowMap.enabled=!0,this._renderer.shadowMap.type=r.PCFSoftShadowMap,this._renderer.setClearColor(this._scene.color,this._scene.alpha),this._frameView=new xc(this._renderer,this._camera,new r.Vector2(this._viewportWidth,this._viewportHeight),new r.Vector2(this._scene.canvas.editorSize.width,this._scene.canvas.editorSize.height)),this._controls=new bc(this._camera,this._renderer.domElement),this._editorData&&(this._controls.fromJSON(this._editorData.orbitControls),this._controls.useKeyEvents=!1),this._playmode=new oa(this._renderer.domElement,this._scene,this._camera))}}]),e}(),Object.defineProperty(t,"__esModule",{value:!0}),t}({},THREE)}.call(this,r(22),r(298)(e))},409:function(e){e.exports=JSON.parse('{"object":{"uuid":"B6BEBD25-292C-4ECC-9729-2C0233CBC257","objectType":"Scene","name":"Noise Displace - Copy","matrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"layers":1,"children":[{"uuid":"136EB30F-59F1-4984-9989-B1277D486C9C","objectType":"Mesh3D","name":"Sphere","matrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"castShadow":true,"receiveShadow":true,"layers":1,"hiddenMatrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"interaction":{"uuid":"3E5C41A4-41DD-4799-A2C3-A4ECD1BBE69C","selectedState":0,"states":["4F870DB7-AF1A-4252-AF11-61528D7CA747","C2A354C1-B90E-45BD-898F-BA9994F4D76E"],"events":[{"type":7,"ui":{"isCollapsed":false},"targets":[{"easing":0,"duration":120000,"delay":0,"cubicControls":[0.5,0.05,0.1,0.3],"springParameters":{"mass":1,"stiffness":80,"damping":10,"velocity":0},"repeat":true,"cycle":true,"rewind":true,"object":"136EB30F-59F1-4984-9989-B1277D486C9C","state":"C2A354C1-B90E-45BD-898F-BA9994F4D76E"}]}]},"geometry":"B08055B2-7929-4354-A137-A036FA1EA91F","material":"5C62A16D-227E-413D-B6C0-7AAEB1A667CA"},{"uuid":"3B695796-4617-4F45-BF86-E0B33A41DF6B","objectType":"CombinedCamera","name":"Default Camera","matrix":[1,0,0,0,0,1,-6.039613253960852e-17,0,0,6.039613253960852e-17,1,0,1.23828125,-19.24218749999994,1000,1],"layers":1,"children":[{"uuid":"E3F6D54D-4262-4F48-815D-87A431E15474","type":"DirectionalLight","name":"Default Directional Light","layers":1,"matrix":[1,0,0,0,0,1,0,0,0,0,1,0,850000,1300000,1000000,1],"color":1947475,"intensity":9.523,"shadow":{"camera":{"uuid":"A365B353-F1AA-4566-BF6A-A7B546E473F0","type":"OrthographicCamera","layers":1,"zoom":1,"left":-5,"right":5,"top":5,"bottom":-5,"near":0.5,"far":500}}}],"hiddenMatrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"interaction":{"uuid":"B2468481-CBDD-4F0F-B576-73B5F8EA49C6"},"enableHelper":false,"cameraType":"OrthographicCamera","targetOffset":1000,"left":-960,"right":960,"top":513.5,"bottom":-513.5,"zoomOrtho":1.2277376631548256,"nearOrtho":-50000,"far":50000,"aspect":1.86952288218111,"fov":45,"focus":10,"filmGauge":35,"filmOffset":0,"zoomPersp":1,"nearPersp":50},{"uuid":"36878CE4-1A1A-40E5-B27A-7718B3714A24","type":"HemisphereLight","name":"Default Ambient Light","layers":1,"matrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,1,0,1],"color":1947475,"intensity":10,"groundColor":8553090}],"activeCamera":"3B695796-4617-4F45-BF86-E0B33A41DF6B","camera":"3B695796-4617-4F45-BF86-E0B33A41DF6B","directionalLight":"E3F6D54D-4262-4F48-815D-87A431E15474","ambientLight":"36878CE4-1A1A-40E5-B27A-7718B3714A24","color":[0.11520000000000002,0.72,0.32688000000000006],"alpha":0,"enableFog":true,"fog":{"type":"Fog","color":1947475,"near":714.285,"far":952.38},"directionalLightState":true,"ambientLightState":true,"canvas":{"mode":2,"preset":"crop","editorSize":{"width":1920,"height":1027},"color":[0,0,0,0.5],"size":{"width":700,"height":700}},"postprocessing":{"enabled":false,"bloom":{"enabled":false,"opacity":1,"blendFunction":16,"intensity":1,"luminanceThreshold":0.9,"luminanceSmoothing":0.025,"blurScale":1,"kernelSize":3},"chromaticAberration":{"enabled":false,"opacity":1,"blendFunction":13,"offset":[10,10]},"vignette":{"enabled":false,"opacity":1,"blendFunction":13,"eskil":false,"darkness":0.5,"offset":0.5},"noise":{"enabled":false,"opacity":1,"blendFunction":14},"colorAverage":{"enabled":false,"opacity":1,"blendFunction":13},"hueSaturation":{"enabled":false,"opacity":1,"blendFunction":13,"_hue":0,"hue":0,"saturation":0},"brightnessContrast":{"enabled":false,"opacity":1,"blendFunction":13,"contrast":0,"brightness":0},"depthOfField":{"enabled":false,"opacity":1,"blendFunction":13,"focalLength":0.1,"focusDistance":0,"bokehScale":1},"pixelation":{"enabled":false,"opacity":1,"blendFunction":13,"granularity":30}}},"metadata":{"version":1.5,"type":"Object","generator":"Object3D.toJSON"},"geometries":[{"uuid":"B08055B2-7929-4354-A137-A036FA1EA91F","userData":{"parameters":{"width":427,"widthSegments":128,"heightSegments":128,"phiStart":0,"phiLength":6.283185307179586,"thetaStart":0,"thetaLength":3.141592653589793,"height":427,"depth":427},"type":"SphereGeometry"}}],"materials":[{"uuid":"5C62A16D-227E-413D-B6C0-7AAEB1A667CA","type":"ShaderMaterial","reflectivity":{"uuid":"E3611D27-9EA2-43D0-AB77-8F02507A73FA","type":"f","value":0.5,"nodeType":"Float"},"transparent":true,"depthFunc":3,"depthTest":true,"depthWrite":true,"colorWrite":true,"stencilWrite":false,"stencilWriteMask":255,"stencilFunc":519,"stencilRef":0,"stencilFuncMask":255,"stencilFail":7680,"stencilZFail":7680,"stencilZPass":7680,"wireframeLinecap":"","wireframeLinejoin":"","userData":{"type":"PhysicalMaterial","category":"Physical","nodeType":"StandardNodeMaterial","layers":{"id":6,"uuid":"AA57634F-93DA-4F39-AC8B-A8E035476943","head":{"id":0,"type":"color","defines":{},"uniforms":{"f0_color":"C89DCDC3-1CFB-4293-A7C0-7D43519F6F79","f0_alpha":"EF6B24C2-574C-4D97-8364-CE54AF686694","f0_mode":"96F79248-CC01-4197-B2C8-F6A9D41EFD54"},"next":{"id":1,"type":"light","defines":{},"uniforms":{"f1_alpha":"C86769AA-6AD5-42EB-9E07-09EEAFE996DD","f1_mode":"B04305EB-5D88-4A18-9C7D-293DC261EFC4"},"next":{"id":2,"type":"displace","defines":{},"uniforms":{"f2_displacementType":"D74F068E-D23C-4C64-9600-DEE1249C5697","f2_offset":"21444366-A7EC-4CA2-9FC4-F0F4CDA6D230","f2_scale":"CB532022-57DC-4239-AC2B-5AED1B3A67DA","f2_intensity":"6775DD84-C9D7-45BB-A546-AB4D1006C8FE","f2_movement":"CC50A1D5-A81B-4AFF-BA9F-BBD73025FAB0","f2_alpha":"88A85A23-B51D-4949-939A-9D636E1F309D","f2_mode":"372D4765-E7EF-4B0B-8055-508E92CF9E4C","f2_noiseType":"1FFCD4D2-97FB-4D55-9038-D0EF4AB69C9F"},"next":{"id":3,"type":"depth","defines":{},"uniforms":{"f3_near":"04332EF3-8556-471E-A625-977E0821F1E4","f3_far":"A430E8C8-3D67-4323-B308-6D2E7CEA4433","f3_isVector":"F4A87D67-1A79-47D9-8C5B-42180BA72144","f3_origin":"408F9FFC-D777-4D53-ADC5-2E79B94342F7","f3_colorA":"3FC07EAE-1E81-47D6-AB6B-96AE354B5DE3","f3_colorB":"F8B551B1-25F6-4241-A14E-7181BBD24E9E","f3_alpha":"4D4FCCB9-96D6-466C-B1A2-B4ACE28AF6B1","f3_mode":"A39F21CF-A239-45AF-BFC2-7A7F05752B52"},"next":{"id":4,"type":"depth","defines":{},"uniforms":{"f4_near":"8763D334-72CE-42AE-87B1-DC195E73E518","f4_far":"76DA6F3A-9CD4-4F6C-B59D-12CD301D0339","f4_isVector":"6F25A343-16FD-4CF1-BDF3-CC2DB62A3987","f4_origin":"D3254543-98F8-4C88-9530-DEE07B581856","f4_colorA":"21C3C027-91DB-4D5A-B07A-0D83498BE47C","f4_colorB":"765B6A44-048E-4F3A-8FC9-9ED601D5F86C","f4_alpha":"9FC268EA-E91F-4372-A4EE-50AAFE9B5E27","f4_mode":"36DC8F96-DBCC-47DF-A7ED-72DDD1D350EA"},"next":{"id":5,"type":"fresnel","defines":{},"uniforms":{"f5_color":"7BD21B4A-1476-43C7-8950-52885E165060","f5_bias":"F1C60691-4E1B-4E56-8D35-BD21E8DB0983","f5_scale":"D7968ACE-E12E-403C-8464-ADD025510A7F","f5_intensity":"814B536F-525B-4CB9-B6FC-0FAD4F27D2BC","f5_factor":"C0031CF1-92CA-4704-88F5-D351DC3CCF3B","f5_alpha":"299128FF-44B7-4266-8643-EA5A69896D89","f5_mode":"CE1BA534-2A86-4AED-BD5E-C9C584D6646A"}}}}}}}}},"glslVersion":null,"defines":{"STANDARD":1,"USE_LAYER_DISPLACE":1},"extensions":{"derivatives":true,"shaderTextureLOD":true},"vertex":"91B618B2-1F62-4793-8F97-00E9F9CA8B06","fragment":"91B618B2-1F62-4793-8F97-00E9F9CA8B06"}],"interactionStates":[{"uuid":"4F870DB7-AF1A-4252-AF11-61528D7CA747","name":"Base State","position":[0,0,0],"rotation":[0,0,0,"XYZ"],"scale":[1,1,1],"hiddenMatrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"geometry":{"width":427,"height":427,"depth":427},"material":{"layersList":[{"id":0,"type":"color","defines":{},"uniforms":{"f0_color":"09452F91-B996-4D8A-9A44-1936474D851F","f0_alpha":"CF8097C8-D0CC-4804-9390-1B86168FC909","f0_mode":"4CDBE029-309F-43B8-BDC7-436F13CE11DD"}},{"id":1,"type":"light","defines":{},"uniforms":{"f1_alpha":"E96217C7-C031-49FA-B2B5-7A8464B50BCC","f1_mode":"FDA395B6-4868-445E-9592-76C30C33A91B"}},{"id":2,"type":"displace","defines":{},"uniforms":{"f2_displacementType":"A8CDAD0C-90C2-4B5F-8D18-0B15D3DD87A3","f2_offset":"0EB5E831-3987-4E0E-AB95-5589941F694D","f2_scale":"E84094B0-00A4-49FD-ACDD-43FBEFC69571","f2_intensity":"95F8F0C1-5D3D-481E-848A-CC9DAF4D665B","f2_movement":"71EB657E-3D6A-423B-BA17-ADB8206F0213","f2_alpha":"9E45DC64-12F0-4A7E-9A01-90B718B78445","f2_mode":"C4546F90-FC99-412B-B0D3-96437338BB51","f2_noiseType":"92A08D5B-C14A-4C02-861E-7EA908DAFAAF"}},{"id":3,"type":"depth","defines":{},"uniforms":{"f3_near":"2BFB5C93-7AD2-4001-B726-D6AE89EE44EA","f3_far":"6A5CD771-12A2-4D92-ABA2-78F528E71CF3","f3_isVector":"3EA1F499-AAC5-43BF-847E-D76494E16F11","f3_origin":"B755A5A9-79DD-4104-A360-C29F6F053F2C","f3_colorA":"38E887AF-FA58-4AFE-88B1-09D5BA4AE276","f3_colorB":"69EAD696-F700-429B-8130-1F2C2055F027","f3_alpha":"3AEF5396-0E95-4F36-913F-74281DD00C10","f3_mode":"34846E22-FC1B-4ACC-B8BA-DBF2BA2B2DE3"}},{"id":4,"type":"depth","defines":{},"uniforms":{"f4_near":"ABEBB0C7-C672-4C47-B318-119A7BC4B3E3","f4_far":"7E7172C6-E9CC-4451-8419-6C15DC45B6AA","f4_isVector":"10519437-05A4-4D9E-81C2-9B88DE0778F9","f4_origin":"7AE0944C-8686-48F6-9AE6-60B7E6734FB2","f4_colorA":"F706EB7E-CC46-43AA-881D-A6100061233A","f4_colorB":"70E49D12-B60D-47F3-9C28-08EFA36AD84D","f4_alpha":"F15FD15B-4DC8-4B31-AA96-573F53D8C827","f4_mode":"CC037DFE-98FB-4F85-8ACD-2739F3853846"}},{"id":5,"type":"fresnel","defines":{},"uniforms":{"f5_color":"C136131E-3F1C-4747-B426-AE231092576C","f5_bias":"819B0A8F-2F3E-46FB-927C-003DB328609C","f5_scale":"D587814B-C45E-42B5-AB3B-C02BC9FBB17A","f5_intensity":"A86A5A05-6C15-4EC9-94DD-0A06D15DA827","f5_factor":"94CAD86B-5659-40E7-A455-113ECB93103C","f5_alpha":"49CEAC26-BB06-4544-983E-372E14620860","f5_mode":"7DFD5EF1-E5DE-4FE2-A754-900085AD7820"}}]}},{"uuid":"C2A354C1-B90E-45BD-898F-BA9994F4D76E","name":"State 1","position":[0,0,0],"rotation":[0,0,0,"XYZ"],"scale":[1,1,1],"hiddenMatrix":[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],"geometry":{"width":427,"height":427,"depth":427},"material":{"layersList":[{"id":0,"type":"color","defines":{},"uniforms":{"f0_color":"C4395415-070C-4578-A7B6-32793603259A","f0_alpha":"8DC866E6-7ADA-43EE-84D7-2BAA8E145603","f0_mode":"CC32B0CF-8558-418F-9DCC-646FC2839E01"}},{"id":1,"type":"light","defines":{},"uniforms":{"f1_alpha":"84B175AC-EF9A-46DA-982D-F5DA73EFD3BA","f1_mode":"6F6E9D57-FB34-4F93-817E-41A4C6D739D4"}},{"id":2,"type":"displace","defines":{},"uniforms":{"f2_displacementType":"3F28C06F-F11F-4842-95B6-8227DFB3A08A","f2_offset":"89E407E8-4E99-46FE-B7B8-B6CF4F016196","f2_scale":"6D38F36E-A72B-462B-8535-8E8609590629","f2_intensity":"7FB52410-7101-4480-A60E-F6E3C22B6382","f2_movement":"5BE4B64F-7E88-4AF2-9749-E43175DE81F8","f2_alpha":"B1B56710-4CFD-4D4E-8EDA-FD19E47707A5","f2_mode":"F1D4F0C5-8542-4422-8570-5DA519703C8A","f2_noiseType":"F60E0454-1D31-4B50-9B0C-914A67E71EAE"}},{"id":3,"type":"depth","defines":{},"uniforms":{"f3_near":"B7858638-7716-40AA-9503-3D596E219544","f3_far":"6193E3AC-40C1-4648-92D4-8A8DF847FC39","f3_isVector":"36C217AF-7029-4E2E-BB26-4F9CA51FFA61","f3_origin":"7A579840-5494-4D0B-897F-B6AEAD77FD72","f3_colorA":"3308A0C5-0485-4235-B5B4-67CA2460C0ED","f3_colorB":"628AD516-BEB7-4024-B134-2B2AC8F2AB6A","f3_alpha":"A5161112-CC71-4B9E-B1C2-2A951FB2021B","f3_mode":"6146DDBE-339B-4B3F-BD54-F29F58AF5B0C"}},{"id":4,"type":"depth","defines":{},"uniforms":{"f4_near":"6F124CA4-943E-45E2-9B36-030B72C7AE50","f4_far":"858C3D19-B3A0-473B-AAA4-02D8CE08DD84","f4_isVector":"52709A75-C589-4113-BEA9-ECD93B9A37D4","f4_origin":"485CFD29-B103-4A25-8D6D-BEEB360824D5","f4_colorA":"9BAE5A73-AC16-47F0-A113-731363C57F52","f4_colorB":"83E1C980-0BF1-4857-B919-322B81FACC3C","f4_alpha":"2A1B6582-DAF5-4353-B153-9F0912F0C253","f4_mode":"16D8FA51-D25C-4A6B-8CC8-D57CFEF9D1E8"}},{"id":5,"type":"fresnel","defines":{},"uniforms":{"f5_color":"97A12F58-6ECB-4907-A720-1E2CAF827F7C","f5_bias":"C97A8234-72DA-4971-84C1-A5C72F6FAC21","f5_scale":"2DB5D970-6D2A-4C66-BC21-D8C847DB020D","f5_intensity":"5174E8EC-3B8C-47FF-AECA-7324F8DE13A7","f5_factor":"86E3F040-E3F6-4B96-A7C3-214542F39572","f5_alpha":"4C6FFD91-620C-41D2-817D-C1E280C49C70","f5_mode":"38C6C28E-0193-497E-B501-CA2A591B0AF9"}}]}}],"nodes":[{"uuid":"09452F91-B996-4D8A-9A44-1936474D851F","type":"c","r":0.11372549019607843,"g":0.7176470588235294,"b":0.3254901960784314,"value":1947475,"alpha":"A89ACC7D-5D06-484D-B748-030BC3A969A4","nodeType":"Color"},{"uuid":"A89ACC7D-5D06-484D-B748-030BC3A969A4","type":"f","value":1,"nodeType":"Float"},{"uuid":"CF8097C8-D0CC-4804-9390-1B86168FC909","type":"f","value":1,"nodeType":"Float"},{"uuid":"4CDBE029-309F-43B8-BDC7-436F13CE11DD","type":"i","value":0,"nodeType":"Int"},{"uuid":"E96217C7-C031-49FA-B2B5-7A8464B50BCC","type":"f","value":1,"nodeType":"Float"},{"uuid":"FDA395B6-4868-445E-9592-76C30C33A91B","type":"i","value":3,"nodeType":"Int"},{"uuid":"A8CDAD0C-90C2-4B5F-8D18-0B15D3DD87A3","type":"i","value":0,"nodeType":"Int"},{"uuid":"0EB5E831-3987-4E0E-AB95-5589941F694D","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"E84094B0-00A4-49FD-ACDD-43FBEFC69571","type":"f","value":10,"nodeType":"Float"},{"uuid":"95F8F0C1-5D3D-481E-848A-CC9DAF4D665B","type":"f","value":65,"nodeType":"Float"},{"uuid":"71EB657E-3D6A-423B-BA17-ADB8206F0213","type":"f","value":1,"nodeType":"Float"},{"uuid":"9E45DC64-12F0-4A7E-9A01-90B718B78445","type":"f","value":1,"nodeType":"Float"},{"uuid":"C4546F90-FC99-412B-B0D3-96437338BB51","type":"i","value":0,"nodeType":"Int"},{"uuid":"92A08D5B-C14A-4C02-861E-7EA908DAFAAF","type":"i","value":0,"nodeType":"Int"},{"uuid":"2BFB5C93-7AD2-4001-B726-D6AE89EE44EA","type":"f","value":700,"nodeType":"Float"},{"uuid":"6A5CD771-12A2-4D92-ABA2-78F528E71CF3","type":"f","value":1000,"nodeType":"Float"},{"uuid":"3EA1F499-AAC5-43BF-847E-D76494E16F11","type":"f","value":0,"nodeType":"Float"},{"uuid":"B755A5A9-79DD-4104-A360-C29F6F053F2C","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"38E887AF-FA58-4AFE-88B1-09D5BA4AE276","type":"c","r":1,"g":0.3607843137254902,"b":0.8627450980392157,"value":16735452,"nodeType":"Color"},{"uuid":"69EAD696-F700-429B-8130-1F2C2055F027","type":"c","r":0,"g":0,"b":0,"value":0,"nodeType":"Color"},{"uuid":"3AEF5396-0E95-4F36-913F-74281DD00C10","type":"f","value":1,"nodeType":"Float"},{"uuid":"34846E22-FC1B-4ACC-B8BA-DBF2BA2B2DE3","type":"i","value":2,"nodeType":"Int"},{"uuid":"ABEBB0C7-C672-4C47-B318-119A7BC4B3E3","type":"f","value":794,"nodeType":"Float"},{"uuid":"7E7172C6-E9CC-4451-8419-6C15DC45B6AA","type":"f","value":915,"nodeType":"Float"},{"uuid":"10519437-05A4-4D9E-81C2-9B88DE0778F9","type":"f","value":0,"nodeType":"Float"},{"uuid":"7AE0944C-8686-48F6-9AE6-60B7E6734FB2","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"F706EB7E-CC46-43AA-881D-A6100061233A","type":"c","r":1,"g":0.47843137254901963,"b":0,"value":16742912,"nodeType":"Color"},{"uuid":"70E49D12-B60D-47F3-9C28-08EFA36AD84D","type":"c","r":0,"g":0,"b":0,"value":0,"nodeType":"Color"},{"uuid":"F15FD15B-4DC8-4B31-AA96-573F53D8C827","type":"f","value":1,"nodeType":"Float"},{"uuid":"CC037DFE-98FB-4F85-8ACD-2739F3853846","type":"i","value":2,"nodeType":"Int"},{"uuid":"C136131E-3F1C-4747-B426-AE231092576C","type":"c","r":1,"g":0.3764705882352941,"b":0.3764705882352941,"value":16736352,"nodeType":"Color"},{"uuid":"819B0A8F-2F3E-46FB-927C-003DB328609C","type":"f","value":0.1,"nodeType":"Float"},{"uuid":"D587814B-C45E-42B5-AB3B-C02BC9FBB17A","type":"f","value":1,"nodeType":"Float"},{"uuid":"A86A5A05-6C15-4EC9-94DD-0A06D15DA827","type":"f","value":2,"nodeType":"Float"},{"uuid":"94CAD86B-5659-40E7-A455-113ECB93103C","type":"f","value":1,"nodeType":"Float"},{"uuid":"49CEAC26-BB06-4544-983E-372E14620860","type":"f","value":1,"nodeType":"Float"},{"uuid":"7DFD5EF1-E5DE-4FE2-A754-900085AD7820","type":"i","value":2,"nodeType":"Int"},{"uuid":"C4395415-070C-4578-A7B6-32793603259A","type":"c","r":0.11372549019607843,"g":0.7176470588235294,"b":0.3254901960784314,"value":1947475,"alpha":"F5045298-D4C8-4E68-8964-A39492798435","nodeType":"Color"},{"uuid":"F5045298-D4C8-4E68-8964-A39492798435","type":"f","value":1,"nodeType":"Float"},{"uuid":"8DC866E6-7ADA-43EE-84D7-2BAA8E145603","type":"f","value":1,"nodeType":"Float"},{"uuid":"CC32B0CF-8558-418F-9DCC-646FC2839E01","type":"i","value":0,"nodeType":"Int"},{"uuid":"84B175AC-EF9A-46DA-982D-F5DA73EFD3BA","type":"f","value":1,"nodeType":"Float"},{"uuid":"6F6E9D57-FB34-4F93-817E-41A4C6D739D4","type":"i","value":3,"nodeType":"Int"},{"uuid":"3F28C06F-F11F-4842-95B6-8227DFB3A08A","type":"i","value":0,"nodeType":"Int"},{"uuid":"89E407E8-4E99-46FE-B7B8-B6CF4F016196","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"6D38F36E-A72B-462B-8535-8E8609590629","type":"f","value":10,"nodeType":"Float"},{"uuid":"7FB52410-7101-4480-A60E-F6E3C22B6382","type":"f","value":65,"nodeType":"Float"},{"uuid":"5BE4B64F-7E88-4AF2-9749-E43175DE81F8","type":"f","value":360,"nodeType":"Float"},{"uuid":"B1B56710-4CFD-4D4E-8EDA-FD19E47707A5","type":"f","value":1,"nodeType":"Float"},{"uuid":"F1D4F0C5-8542-4422-8570-5DA519703C8A","type":"i","value":0,"nodeType":"Int"},{"uuid":"F60E0454-1D31-4B50-9B0C-914A67E71EAE","type":"i","value":0,"nodeType":"Int"},{"uuid":"B7858638-7716-40AA-9503-3D596E219544","type":"f","value":700,"nodeType":"Float"},{"uuid":"6193E3AC-40C1-4648-92D4-8A8DF847FC39","type":"f","value":1000,"nodeType":"Float"},{"uuid":"36C217AF-7029-4E2E-BB26-4F9CA51FFA61","type":"f","value":0,"nodeType":"Float"},{"uuid":"7A579840-5494-4D0B-897F-B6AEAD77FD72","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"3308A0C5-0485-4235-B5B4-67CA2460C0ED","type":"c","r":1,"g":0.3607843137254902,"b":0.8627450980392157,"value":16735452,"nodeType":"Color"},{"uuid":"628AD516-BEB7-4024-B134-2B2AC8F2AB6A","type":"c","r":0,"g":0,"b":0,"value":0,"nodeType":"Color"},{"uuid":"A5161112-CC71-4B9E-B1C2-2A951FB2021B","type":"f","value":1,"nodeType":"Float"},{"uuid":"6146DDBE-339B-4B3F-BD54-F29F58AF5B0C","type":"i","value":2,"nodeType":"Int"},{"uuid":"6F124CA4-943E-45E2-9B36-030B72C7AE50","type":"f","value":794,"nodeType":"Float"},{"uuid":"858C3D19-B3A0-473B-AAA4-02D8CE08DD84","type":"f","value":915,"nodeType":"Float"},{"uuid":"52709A75-C589-4113-BEA9-ECD93B9A37D4","type":"f","value":0,"nodeType":"Float"},{"uuid":"485CFD29-B103-4A25-8D6D-BEEB360824D5","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"9BAE5A73-AC16-47F0-A113-731363C57F52","type":"c","r":1,"g":0.47843137254901963,"b":0,"value":16742912,"nodeType":"Color"},{"uuid":"83E1C980-0BF1-4857-B919-322B81FACC3C","type":"c","r":0,"g":0,"b":0,"value":0,"nodeType":"Color"},{"uuid":"2A1B6582-DAF5-4353-B153-9F0912F0C253","type":"f","value":1,"nodeType":"Float"},{"uuid":"16D8FA51-D25C-4A6B-8CC8-D57CFEF9D1E8","type":"i","value":2,"nodeType":"Int"},{"uuid":"97A12F58-6ECB-4907-A720-1E2CAF827F7C","type":"c","r":1,"g":0.3764705882352941,"b":0.3764705882352941,"value":16736352,"nodeType":"Color"},{"uuid":"C97A8234-72DA-4971-84C1-A5C72F6FAC21","type":"f","value":0.1,"nodeType":"Float"},{"uuid":"2DB5D970-6D2A-4C66-BC21-D8C847DB020D","type":"f","value":1,"nodeType":"Float"},{"uuid":"5174E8EC-3B8C-47FF-AECA-7324F8DE13A7","type":"f","value":2,"nodeType":"Float"},{"uuid":"86E3F040-E3F6-4B96-A7C3-214542F39572","type":"f","value":1,"nodeType":"Float"},{"uuid":"4C6FFD91-620C-41D2-817D-C1E280C49C70","type":"f","value":1,"nodeType":"Float"},{"uuid":"38C6C28E-0193-497E-B501-CA2A591B0AF9","type":"i","value":2,"nodeType":"Int"},{"uuid":"C89DCDC3-1CFB-4293-A7C0-7D43519F6F79","type":"c","r":0.11372549019607843,"g":0.7176470588235294,"b":0.3254901960784314,"value":1947475,"alpha":"EF6B24C2-574C-4D97-8364-CE54AF686694","nodeType":"Color"},{"uuid":"EF6B24C2-574C-4D97-8364-CE54AF686694","type":"f","value":1,"nodeType":"Float"},{"uuid":"96F79248-CC01-4197-B2C8-F6A9D41EFD54","type":"i","value":0,"nodeType":"Int"},{"uuid":"C86769AA-6AD5-42EB-9E07-09EEAFE996DD","type":"f","value":1,"nodeType":"Float"},{"uuid":"B04305EB-5D88-4A18-9C7D-293DC261EFC4","type":"i","value":3,"nodeType":"Int"},{"uuid":"D74F068E-D23C-4C64-9600-DEE1249C5697","type":"i","value":0,"nodeType":"Int"},{"uuid":"21444366-A7EC-4CA2-9FC4-F0F4CDA6D230","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"CB532022-57DC-4239-AC2B-5AED1B3A67DA","type":"f","value":10,"nodeType":"Float"},{"uuid":"6775DD84-C9D7-45BB-A546-AB4D1006C8FE","type":"f","value":65,"nodeType":"Float"},{"uuid":"CC50A1D5-A81B-4AFF-BA9F-BBD73025FAB0","type":"f","value":1,"nodeType":"Float"},{"uuid":"88A85A23-B51D-4949-939A-9D636E1F309D","type":"f","value":1,"nodeType":"Float"},{"uuid":"372D4765-E7EF-4B0B-8055-508E92CF9E4C","type":"i","value":0,"nodeType":"Int"},{"uuid":"1FFCD4D2-97FB-4D55-9038-D0EF4AB69C9F","type":"i","value":0,"nodeType":"Int"},{"uuid":"04332EF3-8556-471E-A625-977E0821F1E4","type":"f","value":700,"nodeType":"Float"},{"uuid":"A430E8C8-3D67-4323-B308-6D2E7CEA4433","type":"f","value":1000,"nodeType":"Float"},{"uuid":"F4A87D67-1A79-47D9-8C5B-42180BA72144","type":"f","value":0,"nodeType":"Float"},{"uuid":"408F9FFC-D777-4D53-ADC5-2E79B94342F7","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"3FC07EAE-1E81-47D6-AB6B-96AE354B5DE3","type":"c","r":1,"g":0.3607843137254902,"b":0.8627450980392157,"value":16735452,"nodeType":"Color"},{"uuid":"F8B551B1-25F6-4241-A14E-7181BBD24E9E","type":"c","r":0,"g":0,"b":0,"value":0,"nodeType":"Color"},{"uuid":"4D4FCCB9-96D6-466C-B1A2-B4ACE28AF6B1","type":"f","value":1,"nodeType":"Float"},{"uuid":"A39F21CF-A239-45AF-BFC2-7A7F05752B52","type":"i","value":2,"nodeType":"Int"},{"uuid":"8763D334-72CE-42AE-87B1-DC195E73E518","type":"f","value":794,"nodeType":"Float"},{"uuid":"76DA6F3A-9CD4-4F6C-B59D-12CD301D0339","type":"f","value":915,"nodeType":"Float"},{"uuid":"6F25A343-16FD-4CF1-BDF3-CC2DB62A3987","type":"f","value":0,"nodeType":"Float"},{"uuid":"D3254543-98F8-4C88-9530-DEE07B581856","type":"v3","x":0,"y":0,"z":0,"nodeType":"Vector3"},{"uuid":"21C3C027-91DB-4D5A-B07A-0D83498BE47C","type":"c","r":1,"g":0.47843137254901963,"b":0,"value":16742912,"nodeType":"Color"},{"uuid":"765B6A44-048E-4F3A-8FC9-9ED601D5F86C","type":"c","r":0,"g":0,"b":0,"value":0,"nodeType":"Color"},{"uuid":"9FC268EA-E91F-4372-A4EE-50AAFE9B5E27","type":"f","value":1,"nodeType":"Float"},{"uuid":"36DC8F96-DBCC-47DF-A7ED-72DDD1D350EA","type":"i","value":2,"nodeType":"Int"},{"uuid":"7BD21B4A-1476-43C7-8950-52885E165060","type":"c","r":1,"g":0.3764705882352941,"b":0.3764705882352941,"value":16736352,"nodeType":"Color"},{"uuid":"F1C60691-4E1B-4E56-8D35-BD21E8DB0983","type":"f","value":0.1,"nodeType":"Float"},{"uuid":"D7968ACE-E12E-403C-8464-ADD025510A7F","type":"f","value":1,"nodeType":"Float"},{"uuid":"814B536F-525B-4CB9-B6FC-0FAD4F27D2BC","type":"f","value":2,"nodeType":"Float"},{"uuid":"C0031CF1-92CA-4704-88F5-D351DC3CCF3B","type":"f","value":1,"nodeType":"Float"},{"uuid":"299128FF-44B7-4266-8643-EA5A69896D89","type":"f","value":1,"nodeType":"Float"},{"uuid":"CE1BA534-2A86-4AED-BD5E-C9C584D6646A","type":"i","value":2,"nodeType":"Int"},{"uuid":"91B618B2-1F62-4793-8F97-00E9F9CA8B06","type":"standard","position":"5DD25D5F-482A-47E4-9C24-47D5D3931BDB","color":"C89DCDC3-1CFB-4293-A7C0-7D43519F6F79","roughness":"80161073-27A9-44EA-981C-68B50BA78ED9","metalness":"500F76C4-B7FC-4546-9E24-DCCDB0AF95B8","alpha":"97D6DAAF-C62F-499F-B57A-D16B8E6A57B3","reflectivity":"E3611D27-9EA2-43D0-AB77-8F02507A73FA","shadingAlpha":"C86769AA-6AD5-42EB-9E07-09EEAFE996DD","shadingBlend":"B04305EB-5D88-4A18-9C7D-293DC261EFC4","afterColor":"0560F3A0-13FC-4006-8216-55E73BCDAD7F","nodeType":"Standard"},{"uuid":"5DD25D5F-482A-47E4-9C24-47D5D3931BDB","type":"v3","intensity":"6775DD84-C9D7-45BB-A546-AB4D1006C8FE","scale":"CB532022-57DC-4239-AC2B-5AED1B3A67DA","movementOrTexture":"CC50A1D5-A81B-4AFF-BA9F-BBD73025FAB0","cropOrOffset":"21444366-A7EC-4CA2-9FC4-F0F4CDA6D230","displacementTypeIndex":{"uuid":"D74F068E-D23C-4C64-9600-DEE1249C5697","type":"i","value":0,"nodeType":"Int"},"noiseFunctionIndex":{"uuid":"1FFCD4D2-97FB-4D55-9038-D0EF4AB69C9F","type":"i","value":0,"nodeType":"Int"},"nodeType":"VertexDisplacement"},{"uuid":"80161073-27A9-44EA-981C-68B50BA78ED9","type":"f","value":0.48,"nodeType":"Float"},{"uuid":"500F76C4-B7FC-4546-9E24-DCCDB0AF95B8","type":"f","value":0,"nodeType":"Float"},{"uuid":"97D6DAAF-C62F-499F-B57A-D16B8E6A57B3","type":"f","value":1,"nodeType":"Float"},{"uuid":"E3611D27-9EA2-43D0-AB77-8F02507A73FA","type":"f","value":0.5,"nodeType":"Float"},{"uuid":"0560F3A0-13FC-4006-8216-55E73BCDAD7F","type":"v3","a":"308C4DB3-E390-4637-906D-7F0C28EDCDAF","b":"62803E9E-0782-41F0-B860-6132BA31261F","alpha":"C00FF4CD-E764-47A1-8197-CFAD5EF44423","mode":"CE1BA534-2A86-4AED-BD5E-C9C584D6646A","nodeType":"Blend"},{"uuid":"308C4DB3-E390-4637-906D-7F0C28EDCDAF","type":"v3","a":"DC17EAB3-1474-4970-BDF5-1D5DB53322F6","b":"E36E9CF2-CB86-470C-A85A-90CACA3A9BA3","alpha":"BE415CE8-1AD8-480F-B999-DB1B1E67459B","mode":"36DC8F96-DBCC-47DF-A7ED-72DDD1D350EA","nodeType":"Blend"},{"uuid":"DC17EAB3-1474-4970-BDF5-1D5DB53322F6","type":"v3","a":"D93DF179-F431-4D6D-8075-29945FDC69C9","b":"CC5369DB-FF20-45B0-BBB9-8096E5906954","alpha":"0D1C9A2B-B3FB-45A3-BCEE-8CD63BB94AEB","mode":"A39F21CF-A239-45AF-BFC2-7A7F05752B52","nodeType":"Blend"},{"uuid":"D93DF179-F431-4D6D-8075-29945FDC69C9","type":"f","src":"outgoingLight","isMethod":false,"useKeywords":true,"extensions":{},"keywords":{},"nodeType":"Expression"},{"uuid":"CC5369DB-FF20-45B0-BBB9-8096E5906954","type":"v3","near":"04332EF3-8556-471E-A625-977E0821F1E4","far":"A430E8C8-3D67-4323-B308-6D2E7CEA4433","isVector":"F4A87D67-1A79-47D9-8C5B-42180BA72144","origin":"408F9FFC-D777-4D53-ADC5-2E79B94342F7","colorA":"3FC07EAE-1E81-47D6-AB6B-96AE354B5DE3","colorB":"F8B551B1-25F6-4241-A14E-7181BBD24E9E","alpha":"4D4FCCB9-96D6-466C-B1A2-B4ACE28AF6B1","nodeType":"Depth"},{"uuid":"0D1C9A2B-B3FB-45A3-BCEE-8CD63BB94AEB","type":"f","src":"alpha / clamp(alpha + accumAlpha, 0.001, 1.0 )","isMethod":false,"useKeywords":true,"extensions":{},"keywords":{"alpha":"4D4FCCB9-96D6-466C-B1A2-B4ACE28AF6B1"},"nodeType":"Expression"},{"uuid":"E36E9CF2-CB86-470C-A85A-90CACA3A9BA3","type":"v3","near":"8763D334-72CE-42AE-87B1-DC195E73E518","far":"76DA6F3A-9CD4-4F6C-B59D-12CD301D0339","isVector":"6F25A343-16FD-4CF1-BDF3-CC2DB62A3987","origin":"D3254543-98F8-4C88-9530-DEE07B581856","colorA":"21C3C027-91DB-4D5A-B07A-0D83498BE47C","colorB":"765B6A44-048E-4F3A-8FC9-9ED601D5F86C","alpha":"9FC268EA-E91F-4372-A4EE-50AAFE9B5E27","nodeType":"Depth"},{"uuid":"BE415CE8-1AD8-480F-B999-DB1B1E67459B","type":"f","src":"alpha / clamp(alpha + accumAlpha, 0.001, 1.0 )","isMethod":false,"useKeywords":true,"extensions":{},"keywords":{"alpha":"9FC268EA-E91F-4372-A4EE-50AAFE9B5E27"},"nodeType":"Expression"},{"uuid":"62803E9E-0782-41F0-B860-6132BA31261F","type":"v3","color":"7BD21B4A-1476-43C7-8950-52885E165060","bias":"F1C60691-4E1B-4E56-8D35-BD21E8DB0983","scale":"D7968ACE-E12E-403C-8464-ADD025510A7F","intensity":"814B536F-525B-4CB9-B6FC-0FAD4F27D2BC","factor":"C0031CF1-92CA-4704-88F5-D351DC3CCF3B","alpha":"299128FF-44B7-4266-8643-EA5A69896D89","mode":"CE1BA534-2A86-4AED-BD5E-C9C584D6646A","calpha":"g62803E9E078241F0B8606132BA31261F_calpha","nodeType":"Fresnel"},{"uuid":"C00FF4CD-E764-47A1-8197-CFAD5EF44423","type":"f","src":"g62803E9E078241F0B8606132BA31261F_calpha","isMethod":false,"useKeywords":true,"extensions":{},"keywords":{},"nodeType":"Expression"}],"assets":{"materials":{}},"editor":{"publish":{"type":2,"web":{"quality":"low","logo":true}},"orbitControls":{"useKeyEvents":false,"enableDamping":true,"enablePan":false,"enableZoom":false,"enableRotate":true,"rotationLimitsMode":0,"rotationVerticalOffset":{"min":1.5707963267948966,"max":1.5707963267948966},"rotationHorizontalOffset":{"min":1.5707963267948966,"max":1.5707963267948966},"autoRotate":false,"autoRotateSpeed":2,"autoRotateClockwise":true},"helperState":true}}')},410:function(e,t,r){"use strict";r(287)},411:function(e,t,r){var n=r(90)((function(i){return i[1]}));n.push([e.i,"/*purgecss start ignore*/\n@media screen and (max-width:1024px){\n#canvas3d[data-v-133bed8f]{\n    width:75%!important;\n    height:75%!important;\n    transition:all .4s ease-out\n}\n}\n@media screen and (min-width:1024px){\n#canvas3d[data-v-133bed8f]{\n    width:60%!important;\n    height:60%!important;\n    transition:all .4s ease-out\n}\n}\n\n/*purgecss end ignore*/",""]),n.locals={},e.exports=n},415:function(e,t,r){"use strict";r.r(t);r(12),r(28),r(32),r(180);var n=r(296);window.THREE=n;var o={name:"hero",props:[],mounted:function(){if(!this.isMobile){var e=r(297).SpeRuntime,t=r(409),n=JSON.stringify(t),o=(new TextEncoder).encode(n),l=new Blob([o],{type:"application/json;charset=utf-8"});(new e.Application).start(URL.createObjectURL(l))}},data:function(){return{}},methods:{scrollTo:function(){this.$store.dispatch("scrollTo","#sec-projects")}},computed:{isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}}},l=(r(410),r(38)),component=Object(l.a)(o,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"hero min-h-screen bg-base-300",attrs:{id:"sec-hero"}},[n("div",{staticClass:"flex-col hero-content lg:flex-row-reverse"},[e.isMobile?n("img",{attrs:{id:"canvas3d",src:r(295)}}):n("canvas",{staticClass:"xl:ml-10",attrs:{id:"canvas3d"}}),e._v(" "),n("div",{directives:[{name:"rellax",rawName:"v-rellax",value:{speed:7},expression:"{ speed: 7 }"}],staticClass:"lg:text-left text-center"},[n("h1",{staticClass:"mb-5 text-5xl font-bold"},[e._v("Hi! I'm aera128")]),e._v(" "),n("p",{staticClass:"mb-5"},[e._v("\n        French Fullstack developer and amateur music composer.\n      ")]),e._v(" "),n("button",{staticClass:"btn btn-primary",on:{click:e.scrollTo}},[e._v("Learn More")])])])])}),[],!1,null,"133bed8f",null);t.default=component.exports}}]);